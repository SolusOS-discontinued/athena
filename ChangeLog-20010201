2001-02-01  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-clickable-image.h:
	A little better documentation.

	* libathena-extensions/athena-labeled-image.c:
	(athena_labeled_image_new),
	(athena_labeled_image_new_from_file_name),
	(athena_labeled_image_button_new_from_file_name),
	(athena_labeled_image_toggle_button_new),
	(athena_labeled_image_toggle_button_new_from_file_name),
	(athena_labeled_image_check_button_new_from_file_name),
	(athena_labeled_image_set_pixbuf_from_file_name),
	(athena_labeled_image_set_tile_pixbuf_from_file_name):
	* libathena-extensions/athena-labeled-image.h:
	New functions for creating stock buttons from pixbuf filenames.
	Also a little better documentation.
	
2001-02-01  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/athena-clickable-image.c:
	(athena_clickable_image_realize),
	(athena_clickable_image_unrealize):
	* libathena-extensions/athena-clickable-image.h:
	Need to store the connection ids to properly diconnect them on
	unrealize.  Otheriwse bad things happen.
	
	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	* components/services/athena-dependent-shared/eazel-services-extensions.c:
	(eazel_services_image_new_clickable),
	(eazel_services_label_new), (eazel_services_label_new_clickable):
	Add new functions to create clickable images and labels.
	
	* components/services/athena-dependent-shared/eazel-services-footer.c:
	(eazel_services_footer_initialize), (footer_destroy),
	(footer_item_clicked_callback), (footer_item_enter_callback),
	(footer_item_leave_callback), (footer_item_new):
	Made a lot simpler by using clickable images.  It could be even
	simpler if the clickable images handled all the prelighting
	details.  Thats a possible improvement.
	
2001-02-01  Eskil Heyn Olsen  <eskil@eazel.com>

	This patch is temporarily going to break a few things, will sync
	up with Robey tomorrow. Eg. eazel-install (cli tool) now sigsegvs
	on error.
	
	* components/rpmview/athena-rpm-view-install.c:
	s/packagedata_destroy/gtk_object_unref/

	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_destroy):
	s/packagedata_destroy/gtk_object_unref/

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_preflight_check_signal):
	If there were problems, abort.
	
	* components/services/install/command-line/eazel-test-softcat.c:
	(main):
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_download_progress), (impl_download_failed), (impl_dep_check),
	(impl_install_progress), (impl_uninstall_progress),
	(impl_md5_check_failed):
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install_simple_query):
	s/packagedata_destroy/gtk_object_unref/

	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_download_packages),
	(eazel_install_check_for_file_conflicts), (ei_revert_transaction),
	(eazel_install_do_transaction_all_files_check),
	(eazel_install_prune_packages), (eazel_install_fetch_dependencies),
	(eazel_install_do_file_conflict_check),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse),
	(eazel_uninstall_check_for_install):
	ifdeffed out a lot of old code that's no longer used, but it still
	compiles. logic.c will soon be entirely removed.
	s/packagedata_destroy/gtk_object_unref/
	Uninstall stuff uses the new PackageBreaks objects.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (eazel_install_check_existing_packages),
	(get_softcat_info), (dedupe_foreach_depends), (is_satisfied),
	(check_update_for_no_more_file_conflicts), (check_tree_helper),
	(find_break_by_package_name), (add_file_conflict),
	(check_no_two_packages_has_same_file),
	(package_is_upgrading_and_doesnt_need_file),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency), (install_packages_helper):
	Nicer output.
	Fixes 6172 and 6173.
	s/packagedata_destroy/gtk_object_unref/
	
	* components/services/install/lib/eazel-install-protocols.c:
	Removed unused define
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_do_rpm_dependency_check):
	More code ifdeffed out, see comment for eazel-install-logic.c
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (eazel_install_packagedata_to_xml_int),
	(eazel_install_packagelist_to_xml), (osd_parse_shared):
	Use the new PackageBreak objects.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(make_rpm_argument_list), (rpm_packagedata_new_from_file),
	(eazel_package_system_rpm3_query_impl),
	(eazel_package_system_rpm3_compare_version):
	s/packagedata_destroy/gtk_object_unref/

	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(categorydata_destroy_foreach), (packagedependency_new),
	(packagedependency_copy), (packagedependency_destroy),
	(packagedata_finalize), (packagedata_class_initialize),
	(packagedata_initialize), (packagedata_copy),
	(packagedata_remove_soft_dep), (packagedata_get_readable_name),
	(packagedata_add_pack_to), (packagedata_add_to_breaks),
	(packagedata_add_pack_to_soft_depends),
	(packagedata_add_pack_to_modifies), (packagedata_list_prune),
	(add_string_list), (dump_package_break_list),
	(packagedata_dump_int), (packagebreaks_finalize),
	(packagebreaks_class_initialize), (packagebreaks_initialize),
	(packagebreaks_get_type), (packagebreaks_new),
	(packagebreaks_set_package), (packagebreaks_get_package),
	(packagefileconflict_finalize),
	(packagefileconflict_class_initialize),
	(packagefileconflict_initialize), (packagefileconflict_get_type),
	(packagefileconflict_new), (packagefeaturemissing_finalize),
	(packagefeaturemissing_class_initialize),
	(packagefeaturemissing_initialize),
	(packagefeaturemissing_get_type), (packagefeaturemissing_new):
	s/packagedata_destroy/gtk_object_unref/
	Wrote some objects representing package breakage.

	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_is_installed):
	s/packagedata_destroy/gtk_object_unref/

	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_available_update):
	Fixed the function so it matches the intended semantics
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_update_from_uri):
	s/packagedata_destroy/gtk_object_unref/

	Merge from PR3 branch
	
	2001-01-26  Eskil Olsen  <eskil@eazel.com> 

 	reviewed by: Ramiri Estrugo <ramiro@eazel.com>

 	* components/services/install/command-line/eazel-test-packsys.c:
 	(test_version_compare):
 	Testing the Mozilla hack...
 	
 	* components/services/install/lib/eazel-package-system-rpm3.c:
 	(eazel_package_system_rpm3_compare_version):
 	Special case for Mxx versions because rpmvercmp is not obeying
 	the laws of mathematics...
 	
 	* components/services/install/lib/eazel-softcat.c:
 	(get_search_url_for_package):
 	Fix for 6055 - no longer use hardcoded RedHat62 as distro.

2001-02-01  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/Makefile.am:
	New files.
	* libathena-extensions/athena-art-extensions.c:
	(athena_art_irect_align):
	* libathena-extensions/athena-art-extensions.h:
	Make the align function actually work.  The previous version was
	copied from GtkPixmap and i didnt realize it did not work.  Remove
	the padding parameters which are not really needed for alignment.

	* libathena-extensions/athena-clickable-image.h:
	* libathena-extensions/athena-clickable-image.c:
	New class.  A clickable image.

	* libathena-extensions/athena-labeled-image.h:
	* libathena-extensions/athena-labeled-image.c:
	New class.  A labeled image.
	
	* libathena-extensions/athena-image.h:
	* libathena-extensions/athena-image.c:
	(athena_image_expose_event), (image_get_pixbuf_bounds),
	(image_is_smooth), (athena_image_set_is_smooth),
	(athena_image_get_is_smooth), (athena_image_new_solid),
	(athena_image_set_never_smooth):
	Add never smooth attribute to force behavior to match GTK+ for
	cases when consistency is most important.
 	Update for alignment art extensions api change.
	Some minor paramter name changes to lose abbreviations.
	
	* libathena-extensions/athena-label.h:
	* libathena-extensions/athena-label.c:
	(athena_label_size_request), (athena_label_expose_event),
	(label_get_text_bounds), (label_is_smooth),
	(athena_label_set_is_smooth), (athena_label_get_is_smooth),
	(athena_label_new_solid), (athena_label_set_never_smooth):
	Add never smooth attribute to force behavior to match GTK+ for
	cases when consistency is most important.
 	Update for alignment art extensions api change.
 	Update for alignment art extensions api change.
	Some minor paramter name changes to lose abbreviations.

	* libathena-extensions/athena-smooth-widget.c:
	(smooth_widget_get_tile_origin_point),
	(athena_smooth_widget_get_preferred_frame):
	Add some comments explaining why using 0 for ancestor offsets
	works.
	Fix a really dumb bug, the paddings where multiplies by 2 twice
	instead of once.
	
	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-athena-clickable-image.c: (clicked_callback),
	(enter_callback), (leave_callback), (clickable_image_new), (main):
	* test/test-athena-label-background.c:
	* test/test-athena-label-scrolled.c: (label_window_new_scrolled),
	(label_window_new_table):
	* test/test-athena-label-simple.c: (main):
	* test/test-athena-label.c: (main):
	* test/test-athena-labeled-image.c: (labeled_image_new),
	(labeled_image_window_new), (labeled_image_button_window_new),
	(main):
	* test/test-athena-pixbuf-tile.c:
	(pixbuf_drawing_area_expose_event),
	(drawable_drawing_area_expose_event), (main):
	* test/test-athena-preferences-change.c: (main):
	* test/test.c: (test_init):
	New tests for clickable and labeled images.  Many updates to other
	tests.

	Also, changed many instances of AthenaFooDetail to
        AthenaFooDetails as well as the corresponding members.
	
2001-02-01  Gene Z. Ragan  <gzr@eazel.com>

	Additional work on first time druid gmc to athena conversion routines.
	
	* src/athena-first-time-druid.c: (druid_finished),
	(convert_gmc_desktop_icons), (transition_value_changed):

	Make gmc link to Athena link conversion more complete
	
	* libathena-extensions/athena-gnome-extensions.c:
	* libathena-extensions/athena-gnome-extensions.h:
	(athena_gnome_get_terminal_path):
	New utility routine to return path to an installed terminal application
	
	(athena_gnome_open_terminal):
	Call above function
	
	* libathena-extensions/athena-link.c:
	* libathena-extensions/athena-link.h:
	(athena_link_local_create),
	
	(athena_link_local_create_from_gnome_entry):
	New function to create a athena link from .desktop entry data
		
	It's hard to be hated by millions.  Make gmc to athena link transition much better.
	We now can support converted .desktop links that require a terminal. Also, get rid
	of gnome-vfs symlinks and use the command: specifier to launch instead.  This was not possible
	earlier, but due to a recent bug fix by me, we can now use this specifier in a
	Athena link.
	
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link),
	(icon_view_create_athena_links),
	(update_home_link_and_delete_copies),
	(update_trash_link_and_delete_copies):
	
2001-01-31  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com> and Eli Goldberg
	<eli@eazel.com>

	* THANKS: Gave credit where it's due. Added a section for testers.
	* check-THANKS.pl: Don't fail if the about box file is not present
	so this script can be used on modules other than Athena; also,
	added some address aliases.

2001-01-31  Rebecca Schulman  <rebecka@eazel.com>

	Fixed bug 5245, that words used in the search bar were used
	elsewhere, such that they could not be translated correctly for
	both contexts.  The fix was to wrap all of the strings used to
	display both the search bar, and the description of
	search results in bracketed context and write a function
	to remove the bracketed text before displaying.

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-search-uri.c: 
	Added comments and wrapped the text to be translated in bracketed
	context.
	(get_translated_criterion), (get_nth_criterion_prefix),
	(parse_uri):  Call athena_str_remove_bracketed_text
	on appropriate strings before displaying.
	
	* libathena-extensions/athena-string.h:
	* libathena-extensions/athena-string.c:
	(athena_str_remove_bracketed_text), (athena_self_check_string):
	Add the debracketing function and tests for it.

	* src/athena-search-bar-criterion.c: 
	Added comments and wrapped the text to be translated in bracketed
	context.
	(athena_search_bar_criterion_destroy),
	(athena_search_bar_criterion_new_from_values),
	(athena_search_bar_criterion_update_valid_criteria_choices):
	Call athena_str_remove_bracketed_text on appropriate strings
	before displaying.
	
2001-01-31  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6162 (need option to stop "xx items" from being
	calculated for ftp:// locations)

	Added a speed tradeoff preference for showing directory
	counts. It's "local-only" for Beginner and "always" (but
	changeable) for Intermediate/Advanced.

	Fixed bug 1856 (fix hideous hack to kick-start embedded-text
	reading when preference changes)

	Fixed bug 2396 (properties window doesn't show/hide
	"special flags" when preference changes) 

	* libathena-extensions/athena-directory-async.c:
	(dequeue_pending_idle_callback): Update for name change.
	(lacks_directory_count): Now checks preference by calling
	athena_file_should_show_directory_item_count.
	(should_get_directory_count_now): Renamed to add the "_now"
	to help distinguish from 
	athena_file_should_show_directory_item_count.
	(directory_count_start): Update for name change.
	
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory.c:
	(emit_change_signals_for_all_files): New function, emits change
	signals for self-as-file (if applicable) and all contained files.
	(async_state_changed_one): New hash-table function, calls
	emit_change_signals_for_all_files on a directory.
	(async_data_preference_changed_callback): New preferences-changed
	callback, calls async_state_changed_one on each directory.
	(add_preferences_callbacks): Renamed from add_filtering_callbacks,
	now adds callbacks for top-left text and item counts preferences.
	(remove_preferences_callbacks): Renamed from remove_filtering_callbacks,
	now removes callbacks for top-left text and item counts preferences.
	(athena_directory_get_internal): Update for name change.
	(athena_directory_emit_change_signals): renamed from
	_emit_change_signals_deep to avoid recursion connotation.
	(athena_directory_emit_metadata_changed),
	(call_files_changed_free_list),
	(call_files_changed_unref_free_list): Update for name change.

	* libathena-extensions/athena-file.c:
	(get_speed_tradeoff_preference_for_file): New utility function,
	returns boolean based on local-ness of file and value of
	specified speed-tradeoff preference.
	(athena_file_should_get_top_left_text): Now calls
	get_speed_tradeoff_preference_for_file.
	(athena_file_should_show_directory_item_count): New function,
	calls get_speed_tradeoff_preference_for_file.
	(athena_file_get_directory_item_count),
	(athena_file_get_deep_counts): Bail out early without computation
	if _should_show_directory_item_count is FALSE.
	(athena_file_changed): Update for name change.
	
	* libathena-extensions/athena-file.h: Make
	athena_file_should_show_directory_item_count public so the
	preferences window can make UI decisions based on it.
	
	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog): Add new preference
	ATHENA_PREFERENCES_SHOW_DIRECTORY_ITEM_COUNTS and wire up
	default values and UI.
	
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize), (fm_directory_view_destroy):
	Remove hideous hack.
	
	* src/file-manager/fm-properties-window.c: 
	(append_separator): Return widget instead of row number.
	(attach_directory_contents_value_field): Return widget.
	(update_visibility_of_table_rows): New helper function to
	update visibility of a series of table rows & contained
	widgets.
	(update_visibility_of_item_count_fields): New function
	to update visibility of directory item count widgetry.
	(update_visibility_of_item_count_fields_wrapper): Simple
	wrapper for above.
	(remember_directory_contents_widget),
	(append_directory_contents_fields): Remember item counts
	widgetry so it can be shown/hidden later; set up prefs
	callback; change signature for to pass window.
	(create_basic_page), (create_permissions_page): 
	store table in window->details; update for changed signatures.
	(append_special_execution_checkbox): Now takes window,
	don't use GTK_EXPAND to avoid resizing column unnecessarily,
	count number of special flags rows.
	(remember_special_flags_widget),
	(update_visibility_of_special_flags_widgets): New function
	to update visibility of special flags widgetry.
	(update_visibility_of_special_flags_widgets_wrapper):
	Simple wrapper for above.
	(append_special_execution_flags): Remember special flags
	widgetry so it can be shown/hidden later; set up prefs
	callback; change signature to pass window.
	(real_destroy): free widget lists.

2001-01-31  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* src/athena-application.c (athena_application_startup): Don't
	loop more than 20 times when we get OAF_REG_ALREADY_ACTIVE trying
	to register the factory, instead display an error message that
	suggests killing oafd.

2001-01-31  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* librsvg/rsvg-ft.c: (rsvg_ft_glyph_insert): Updated to evict from
	the cache whenever above the high water mark instead of only when
	inserting would put you above the mark.

2001-01-31  Darin Adler  <darin@eazel.com>

	reviewed by: Michael Engber <engber@eazel.com>

	Fix bug 6192 ("mapped before underway" warning when clicking on
	any sidebar tab).
	
	* src/athena-view-frame.c: (athena_view_frame_map): Remove
	inappropriate check of state, and replace it with a simple NULL
	check that handles the failed case.
	
	* libathena-extensions/athena-directory-background.c:
	(athena_file_background_is_set): Fixed backwards logic by
	removing an erroneous "!".
	
	* libathena-extensions/athena-icon-factory.c: Formatting
	tweaks.
	* src/file-manager/fm-directory-view.c: Formatting tweak.
	* src/athena-application.c: (athena_application_startup):
	Fixed comment.
	(check_for_and_run_as_super_user): Formatting tweak.

2001-01-31  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	Fix 5324 (Should get rid of stack-based GnomeVFSFileInfo)

	* components/adapter/bonobo-stream-vfs.c: (vfs_get_info):
	Nuked some unused code that contained gnome_vfs_file_info_init.
	
	* components/adapter/athena-adapter-progressive-load-strategy.c:
	(athena_adapter_progressive_load_strategy_load_location):
	* libathena-extensions/athena-icon-factory.c:
	(path_represents_svg_image), (get_cache_time):
	* libathena-extensions/athena-thumbnails.c:
	(first_file_more_recent):
	* src/athena-window-menus.c: (get_static_bookmarks_file_path):
	Get rid of gnome_vfs_file_info_init.
	Replace all instances of stack-based GnomeVFSFileInfo
	structures, replace all calls to gnome_vfs_file_info_init
	with gnome_vfs_file_info_new.
	Replace most calls to gnome_vfs_file_info_clear with
	gnome_vfs_file_info_unref.

	* libathena-extensions/athena-preferences-item.c:
	(has_image_file):
	Rework to use gnome_vfs_uri_exists instead of trying to get
	file info.

	* components/adapter/athena-adapter-progressive-load-strategy.c:
	(athena_adapter_progressive_load_strategy_load_location):
	Fixed a bug where file info fields were being used after a
	gnome_vfs_file_info_clear call


	Fix 6146 ("Duplicate File" reports "You cannot copy a file
		   over itself")

	* libathena-extensions/athena-file-operations.c:
	(athena_file_operations_copy_move):
	Make copying iside the same directory while the
	GNOME_VFS_XFER_USE_UNIQUE_NAMES move_option is set legal.

2001-01-31  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* components/services/inventory/Trilobite_Service_inventory.oaf.in:
	Fixed a tyop in the path to the trilobite-inventory-service

	* components/services/inventory/eazel-inventory-utils.h:
	* components/services/inventory/eazel-inventory-service.c:
	Moved the GConf path for machine name to 

	(impl_Trilobite_Eazel_Inventory_upload):
	Improved error reporting / debugging. Actually save the MD5.

	* components/services/inventory/eazel-inventory-utils.c:
	(add_package_info), (add_software_info),
	(eazel_inventory_local_path)
	Fixed memory leaks.

	(eazel_inventory_update_md5):
	Added a function to store the MD5.

	* athena.spec.in:
	Add inventory files to the right RPMs.

2001-01-31  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 3853, Intermittent crash with warnings from
	"rsvg_ft_glpyh_insert" by refactoring the method for inserting and
	removing glyph's from the cache.
	
	* librsvg/rsvg-ft.c: (rsvg_ft_glyph_evict),
	(rsvg_ft_glyph_insert), (rsvg_ft_measure_or_render_string):
	Refactored to use a high water mark based eviction rather then a
	limit and to evict with respect to that mark.

2001-01-31  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: George Lebl  <jirka@5z.com>
	
	Fix bug 4448 (install-server needs session management juju)
	
	* components/services/install/server/main.c: (main): Add call to
	`gnome_client_disable_master_connection'

	* components/services/trilobite/sample/service/main.c: (main): Add
	call to `gnome_client_disable_master_connection'

2001-01-30  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>

	Mass refactoring of summary view code to make needed summary view
	fixes more managable. In the process, fixed bugs 4555 (Version
	display for featured softcat downloads) and 5795 (Summary View
	text doesn't wrap.) Also, cleaned up assorted pieces of text.

	* components/services/summary/athena-view/athena-summary-view.c
	: (update_header), (create_header), (update_footer),
	(create_footer), (summary_view_button_callback),
	(summary_view_button_new), (summary_view_item_label_new),
	(summary_view_item_large_header_label_new),
	(summary_view_item_header_label_new),
	(summary_view_item_body_label_new), (append_hseparator_to_vbox),
	(generate_eazel_news_entry_row), (summary_view_update_pane),
	(summary_view_create_pane), (update_news_pane),
	(create_news_pane),
	(generate_service_entry_row), (update_services_list_pane),
	(create_services_list_pane), (generate_update_news_entry_row),
	(update_featured_downloads_pane),
	(create_featured_downloads_pane),
	(generate_summary_form), (athena_summary_view_initialize),
	(athena_summary_view_destroy), (summary_load_location_callback),
	(text_resize_callback): Factor the monolithic summary view code up
	more. The next step is to create a widget class to manage each
	pane, and to create the base layout once and only change the pane
	contents on recipt of summary XML or login.

	* components/services/summary/athena-view/athena-summary-callbacks.h,
	components/services/summary/athena-view/athena-summary-callbacks.c:
	Remove tab selected callbacks since they are no longer used.

	* components/services/summary/athena-view/athena-summary-view-private.h:
	Removed lots of unneeded fields in the details struct; changed
	button labels, "Go There!" --> "Go There", "More Info!" --> "More
	Info", "Install Me!" --> "Install"

2001-01-30  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* libathena-extensions/athena-debug-drawing.c:
	(debug_pixbuf_viewer_expose_event):
	* libathena-extensions/athena-gdk-extensions.c:
	* libathena-extensions/athena-gdk-extensions.h:
	Remove unused code.

2001-01-30  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_from_packagedata),
	(packagedata_from_corba_packagedatastruct):
	* components/services/install/lib/eazel-install-logic.c:
	(dump_one_package):
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach),
	(get_detailed_uninstall_messages_foreach),
	(get_detailed_cases_foreach),
	(get_detailed_uninstall_cases_foreach):
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_initialize), (packagedata_finalize),
	(packagedata_copy), (packagedata_fill_in_missing),
	(packagedata_destroy), (packagedata_dump_int):
	* components/services/install/lib/eazel-package-system-types.h:
	* components/rpmview/athena-rpm-view-install.c:

	Remove unused hard_depends member from PackageData.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (prune_failed_packages_helper),
	(prune_failed_packages), (eazel_install_check_existing_packages),
	(get_softcat_info), (dedupe_foreach_depends), (is_satisfied),
	(check_tree_helper), (check_tree_for_conflicts),
	(download_packages), (set_toplevel), (install_packages):
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package), (flatten_tree_func):
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(make_rpm_argument_list),
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(rpm_packagedata_new_from_file),
	(eazel_package_system_rpm3_load_package):
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_load_package):

	Backport Eskil's recursive-dep fix from PR3.  Use
	name/sense/version to hash completed dependencies, so files will
	work (not just softcat packages).
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (eazel_install_packagedata_to_xml_int),
	(eazel_install_packagedata_to_xml), (osd_parse_shared):

	The best of all worlds: some backported PR3 patches from Eskil,
	some removal of hard_depends usage, and some new code to encode &
	decode the RPM filesize from the XML generated across the corba
	pipe.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_destroy),
	(athena_install_parse_uri), (update_package_info_display),
	(athena_service_install_downloading),
	(athena_service_install_preflight_check),
	(athena_service_install_download_failed),
	(athena_service_install_installing),
	(athena_service_install_done), (athena_service_install_failed),
	(athena_service_install_view_update_from_uri),
	(athena_service_install_view_load_uri),
	(service_install_stop_loading_callback):
	* components/services/install/athena-view/athena-service-instal
	l-view.h:

	Backport changes to the install view from PR3 (I should've done
	this when I checked them into PR3 but I was brain-fried): No
	longer cylon (use the throbber to indicate busy-ness) and handle
	early cancels better.  Also some new stuff to use the more
	accurate filesize counts.
	
2001-01-30  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fix bug 5763 - Largest fitting font logic in Sidebar title causes
	font criticals.  Cleanup some related stuff in the process.
	
	* libathena-extensions/athena-font-factory.h:
	* libathena-extensions/athena-font-factory.c:
	(athena_font_factory_get_font_by_family),
	(athena_font_factory_get_font_from_preferences):
	Move these functions to athena-gdk-font-extensions.[ch].
	
	* libathena-extensions/athena-gdk-font-extensions.h:
	* libathena-extensions/athena-gdk-font-extensions.c:
	(athena_gdk_font_get_largest_fitting), Rewrite the function to
	not depend on any hard coded font sizes or XLFD names.
	(athena_gdk_font_get_name), New function.
	(athena_gdk_font_get_size_in_pixels), (unref_fixed_font),
	(athena_gdk_font_get_fixed),
	(athena_gdk_font_xlfd_string_new), Move these 2 here from
	athena-font-factory.
	(athena_self_check_ellipsize_start),
	(athena_self_check_gdk_font_extensions):
	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-scalable-font.c:
	(parse_font_description_file), (font_compare),
	(font_family_find_font), (font_family_lookup),
	(font_family_lookup_with_insertion), (font_family_table_add_fonts),
	(athena_scalable_font_new),
	(athena_scalable_font_measure_text),
	(athena_scalable_font_text_width),
	(athena_scalable_font_draw_text),
	(athena_scalable_font_measure_text_lines),
	(athena_scalable_font_draw_text_lines_with_dimensions),
	(athena_scalable_font_draw_text_lines),
	(athena_scalable_font_largest_fitting_font_size), Rewrite this
	function to work just like athena_gdk_font_get_largest_fitting()
	for greater consistency.
	(font_family_table_for_each_append),
	(font_family_table_for_each_free),
	(athena_scalable_font_query_font), (text_layout_free_row),
	(athena_text_layout_new), (athena_text_layout_paint):
	Use signed integers for dimensions.  Lots of cleanup to comply
	with the Athena coding style.
	
	* libathena-extensions/athena-string-list.h:
	* libathena-extensions/athena-string-list.c:
	(athena_string_list_new_from_tokens),
	(athena_string_list_get_index_for_string),
	(athena_string_list_as_concatenated_string),
	(athena_string_list_get_longest_string),
	(athena_string_list_get_longest_string_length),
	(athena_self_check_string_list):
	Use signed integers instead of guint.

	* src/athena-sidebar-title.c: (update_font):
	Update for largest fitting font api changes.  Get rid of the hard
	coded list of font sizes.
	
2001-01-30  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 5726 (In single-window mode, activating desktop icons
	should use frontmost window).

	* src/athena-window-manage-views.c:
	(get_topmost_athena_window): New function.
	(open_location): For desktop in one-window mode, reuse the topmost
	window if there is one instead of making new window every time.

2001-01-30  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* applets/preferences-applet/athena-preferences-applet.c:
	(quit_button_clicked_callback), (main):
	Add a quit button that invokes "athena --quit."
	
2001-01-30  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 6147 (selected icons flash unselected/selected rapidly):
	
	* src/athena-window-manage-views.c: (change_selection): Don't
	send out selection change notices to the view that reported the
	selection change.
	(change_selection_callback): Pass in view that requested the
	change so we can know not to send a selection change to that view.
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_send_selection_change): Clear flag that says we
	have a selection change for the shell.
	(selection_changed_callback): Add code to indicate this selection
	change is due to the shell, so we don't tell the shell about
	something it just told us.
	(done_loading): Set flag so we don't tell the shell about selection
	changes that are part of the first load of the directory.
	(display_selection_info_idle_callback): Only send a selection change
	to the shell if the change was initiated here. Also remove the code
	that ref's the AthenaView object -- wasn't helping.
	(update_menus_timeout_callback), (display_pending_idle_callback),
	(display_pending_timeout_callback): Remove the code that ref's the
	AthenaView object -- wasn't helping.
	(fm_directory_view_notify_selection_changed): Propagate flag that
	tells the idle code we have made the change to the selection and
	the shell should be notified.
	
	Fix bug 6158 (athena --quit shouldn't check for
	~/.athena/first-time-wizard-flag).

	* src/athena-main.c: (main): Don't do the first-time druid check
	when the --quit or --restart option is used.
	
	Fix bug 803 (All metafile tags should be lower case).
	
	* libathena-extensions/athena-metadata.h: Use lower-case for
	metadata tags.
	* libathena-extensions/athena-directory-metafile.c:
	(create_metafile_root), (get_file_node),
	(athena_directory_rename_file_metadata),
	(athena_directory_copy_file_metadata),
	(athena_directory_set_metafile_contents): Change metadata tags
	to be lower-case.
	* libathena-extensions/athena-directory.c:
	(athena_self_check_directory): Use lower-case in metadata
	self-test for clarity.
	* libathena-extensions/athena-file.c:
	(athena_file_get_keywords), (athena_file_set_keywords): Change
	metadata tags to be lower-case.
	
	* data/top/.athena-metafile.xml
	* icons/ardmore/ardmore.xml:
	* icons/arlo/arlo.xml:
	* icons/arlo/i-directory.xml:
	* icons/arlo/i-regular.xml:
	* icons/crux_eggplant/crux_eggplant.xml:
	* icons/crux_eggplant/i-directory.xml:
	* icons/crux_eggplant/i-regular.xml:
	* icons/default.xml:
	* icons/gnome/gnome.xml:
	* icons/i-directory-accept.xml:
	* icons/i-directory.xml:
	* icons/i-regular.xml:
	* icons/villanova/villanova.xml:
	Change XML to use lower-case.

	* libathena-extensions/athena-link-set.c: (create_new_link):
	Use lower-case for link XML tags.
	* libathena-extensions/athena-link.c:
	(athena_link_local_create), (athena_link_local_set_link_uri),
	(athena_link_local_set_type),
	(athena_link_local_get_link_uri),
	(athena_link_local_get_link_type),
	(athena_link_get_link_uri_given_file_contents): Use lower-case
	for link XML tags.
	
	* src/athena-sidebar-title.c:
	(athena_sidebar_title_select_text_color),
	(athena_sidebar_title_theme_changed): Use lower-case for theme
	XML tags.
	* components/throbber/athena-throbber.c:
	(get_bonobo_properties), (athena_throbber_initialize),
	(athena_throbber_load_images),
	(athena_throbber_button_press_event): Change theme XML tags to be
	lower-case.
	* libathena-extensions/athena-icon-container.c:
	(start_rubberbanding): Use lower-case for theme XML tags.
	(athena_icon_container_initialize): Fix comment.
	(update_label_color), (athena_icon_container_theme_changed): Use
	lower-case for theme XML tags.
	* libathena-extensions/athena-icon-factory.c: (set_theme): Use
	lower-case for theme XML tags.
	(get_themed_icon_file_path): Use lower-case for icon XML file
	tags.
	(icon_theme_changed_callback): Use lower-case for theme XML tags.
	* src/athena-sidebar-tabs.c:
	(athena_sidebar_tabs_load_theme_data), (get_text_offset): Use
	lowe-case for theme XML tags.
	* src/athena-sidebar.c: (athena_sidebar_update_appearance):
	Use lower-case for theme XML tags.
	* src/athena-window-toolbars.c: (get_file_name_from_icon_name):
	Use lower-case for theme XML tags.
	* src/athena-zoom-control.c: (draw_number): Use lower-case for
	theme XML tags.

	Change code that used GSList when it should use GList. We use
	GList so that we can share utility functions. It's arbitrary. We
	could have decided to use all GSList instead, but we chose GList
	(because of its name, initially).

	* components/tree/athena-tree-expansion-state.c:
	(expansion_state_load_callback),
	(athena_tree_expansion_state_load_table_from_gconf),
	(hash_table_get_keys_callback), (hash_table_get_keys),
	(athena_tree_expansion_state_save_table_to_gconf): Update to use
	GList instead of GSList.
	* libathena-extensions/athena-gconf-extensions.h:
	* libathena-extensions/athena-gconf-extensions.c:
	(athena_gconf_handle_error), (athena_gconf_set_string_list),
	(athena_gconf_get_string_list): Change to work with GList
	instead of GSList to match the rest of Athena, so that the lists
	can be manipulated with all the GList utility functions.
	* libathena-extensions/athena-glib-extensions.h:
	* libathena-extensions/athena-glib-extensions.c:
	(athena_round): Changed name from athena_g_round -- "g" for
	"gratuitous".
	(athena_g_list_from_g_slist), (athena_g_slist_from_g_list):
	Added utility functions to help make GSLists from GLists and vice
	versa. Useful when dealing with functions that yield/expect
	GSLists.
	* libathena-extensions/athena-icon-text-item.c: (iti_destroy),
	(iti_update), (iti_paint_text), (iti_draw), (iti_render),
	(iti_event): Use athena_round by its new name.
	* libathena-extensions/athena-preferences.h:
	* libathena-extensions/athena-preferences.c:
	(athena_preferences_set_string_list),
	(athena_preferences_get_string_list),
	(athena_preferences_default_set_string_list),
	(athena_preferences_default_get_string_list): Change to use
	GList instead of GSList.
	* libathena-extensions/athena-search-uri.c:
	(free_tokenized_uri), (tokenize_uri), (get_translated_criterion),
	(get_nth_criterion_prefix), (parse_uri): Change to use GList
	instead of GSList.
	* src/athena-application.h:
	* src/athena-application.c:
	(athena_application_get_window_list): Renamed from
	athena_application_windows and changed to use GList instead of
	GSList.
	(athena_application_destroyed_window),
	(athena_application_create_window), (volume_unmounted_callback):
	Change to use GList instead of GSList.
	* src/athena-shell.c: (save_window_states),
	(restore_window_states): Use GList instead of GSList.
	* src/athena-window-manage-views.c: (just_one_window): Use GList
	instead of GSList.
	(open_location_prefer_existing_window_callback): Use GList instead
	of GSList.
	* src/athena-window.c: (athena_forget_history): Use GList
	instead of GSList and the new name for
	athena_application_get_window_list.
	
	Other changes.

	* src/athena-shell.c: (display_caveat_first_time): Turn off the
	caveat -- we're close enough to 1.0.
	
	* libathena-extensions/athena-view-identifier.c:
	(athena_view_identifier_new_from_oaf_server_info): Use free_deep
	call.
	
	* libathena/athena-view-standard-main.h: Use
	BEGIN/END_GNOME_DECLS.
	
	* src/file-manager/fm-desktop-icon-view.c: Remove unneeded
	include.

2001-01-30  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* components/tree/libmain.c: (tree_shlib_object_destroyed):
	Removed accidentally checked in call to `oaf_plugin_unuse' to fix
	bug 6154 (creating new window after closing initial window crashes
	creating tree view). It's not actually safe to unload a shared
	library that declares a GtkType because it makes Gtk unhappy.

2001-01-30  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions):
	* libathena-extensions/athena-preferences.c:
	Fix bug 5899 - "Do slower, complete search" preference needs to
	include explanation.
	
2001-01-30  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6153 (confusing error message after trying to
	navigate to "foo")

	* src/athena-window-manage-views.c:
	(athena_window_end_location_change_callback):
	Improved the error message for this case so that it's
	more likely to be helpful.

2001-01-30  Martin Norbäck  <d95mback@dtek.chalmers.se>

        * libathena-extensions/athena-file-operations-progress.c:
        (athena_file_operations_progress_new_file):
        Marked string for translation.

2001-01-30  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 5863 (visiting a directory makes its property-window
	deep count start again from scratch)

	* libathena-extensions/athena-directory-async.c:
	(athena_directory_invalidate_count_and_mime_list):
	Renamed from _invalidate_counts, no longer resets the
	deep count when resetting the shallow count and MIME
	list. (There's already a separately-used API for resetting
	the deep count.)
	(athena_directory_force_reload):
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory.c:
	(invalidate_one_count), (invalidate_count_and_unref):
	Updated for name change.

2001-01-29  Ramiro Estrugo  <ramiro@eazel.com>

	* test/test-athena-label-wrapped.c: (size_allocate_callback),
	(create_athena_label):
	Add an example of how to do dynamic wrapping.
	
2001-01-29  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_from_packagedata),
	(packagedata_from_corba_packagedatastruct):
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_initialize), (packagedata_finalize),
	(packagedata_copy), (packagedata_fill_in_missing),
	(packagedata_get_readable_name):
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-softcat.c:
	(get_search_url_for_package), (eazel_softcat_get_info):

	Add "suite_id" field to the PackageData and corba struct, for
	packages that actually refer to a group of packages, not just one.
	
	* components/services/install/lib/eazel-install-logic.c:
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_start_signal), (eazel_install_end_signal),
	(eazel_install_progress_signal), (eazel_install_failed_signal):

	Move four signal calls into the file they're used in, so that
	someday in the startrek future, we can get rid of the old
	logic.[ch] files.
	
2001-01-29  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	Fixed 5781 (results of load_directory must be passed in chunks
		instead of the entire list)
	Fixed 1438 (use plain GList instead of GnomeVFSDirectoryList)

	* components/music/athena-music-view.c:
	(athena_music_view_update):
	* components/services/vault/command-line/vault-operations.c:
	(vault_list):
	* components/text/athena-text-view.c: (add_services_to_menu):
	* libathena-extensions/athena-customization-data.c:
	(athena_customization_data_new),
	(athena_customization_data_get_next_element_for_display),
	(athena_customization_data_destroy):
	* libathena-extensions/athena-directory-async.c:
	(directory_load_callback), (directory_count_callback),
	(start_monitoring_file_list), (directory_count_start),
	(deep_count_callback), (deep_count_load), (mime_list_callback),
	(mime_list_load):
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-preferences-item.c:
	(add_icon_themes):
	* src/file-manager/fm-directory-view.c:
	* src/athena-link-set-window.c: (get_link_set_names):
	* src/athena-location-bar.c: (try_to_expand_path):
	* src/athena-theme-selector.c:
	(populate_list_with_themes_from_directory):
	Switch the uses of GnomeVFSDirectoryList to a simple GList.
	Get rid of the sort and reverse arguments to the load_directory
	calls.

2001-01-29  Arik Devens  <arik@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/athena-preferences-box.c:
	(preferences_box_category_list_recreate): Fixed my breakage of the
	build by finishing cleanup Ramiro asked me to do.

2001-01-29  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5974 (menu item to change Athena theme
	should mention "theme" in its name)

	* src/athena-shell-ui.xml: After bugzilla discussion
	with Vera, renamed "Change Appearance..." -> "Athena Themes..."

	* libathena-extensions/athena-stock-dialogs.c:
	Reduced timed-wait initial timeout from 5 seconds to
	3 after playing around with the gnome-vfs test-method.
	
2001-01-29  Darin Adler  <darin@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	Fixed bug 2131 (Change Athena to use OAF asynchronous activation
	interface). In making view activation work right, I also
	eliminated the state machine that was almost gone from
	AthenaWindow. There's still some additional simplification we
	can do, but it's simpler than it was. At the same time, made sure
	all incoming CORBA calls are deferred until idle time. This is
	most of what the old state machine was accomplishing, believe it
	or not, although it didn't do it 100%.

	Also fixes bug 2457 (Silent error loading content view), bug 2461
	(progress from old and new content view sometimes confused), and
	bug 6109 (Assertion hit on clicking the refresh button many times
	very quickly). Perhaps others too, we need to test some old bugs
	to see if they have changed behavior.
	
	* libathena-extensions/athena-bonobo-extensions.c:
	(activation_handle_done), (activation_idle_callback),
	(activation_cancel), (oaf_activation_callback),
	(athena_bonobo_activate_cancel): Change implementation so that
	the actual callback happens at idle time, since CORBA callbacks
	can happen at almost any time.
	
	* libathena/Makefile.am:
	* libathena/athena-idle-queue.h:
	* libathena/athena-idle-queue.c: (execute_queued_functions),
	(athena_idle_queue_new), (athena_idle_queue_add),
	(athena_idle_queue_destroy): Factored out the idle queueing that
	I added to AthenaView so we can use it on the AthenaViewFrame
	side too.
	
	* libathena/athena-view.c: (queue_incoming_call),
	(athena_view_initialize), (athena_view_destroy): Change to use
	the new AthenaIdleQueue so we can share code.
	
	* src/athena-view-frame-private.h:
	* src/athena-view-frame-corba.c: (list_free_deep_callback),
	(free_location_and_selection_callback), (open_in_this_window),
	(open_prefer_existing_window), (open_force_new_window),
	(report_selection_change), (report_status),
	(report_load_underway), (report_load_progress),
	(report_load_complete), (report_load_failed), (set_title),
	(impl_Athena_ViewFrame_open_location_in_this_window),
	(impl_Athena_ViewFrame_open_location_prefer_existing_window),
	(impl_Athena_ViewFrame_open_location_force_new_window),
	(impl_Athena_ViewFrame_report_selection_change),
	(impl_Athena_ViewFrame_report_status),
	(impl_Athena_ViewFrame_report_load_underway),
	(impl_Athena_ViewFrame_report_load_progress),
	(impl_Athena_ViewFrame_report_load_complete),
	(impl_Athena_ViewFrame_report_load_failed),
	(impl_Athena_ViewFrame_set_title): Deal with all incoming CORBA
	calls through the idle queue.
	
	* src/athena-view-frame.h: Moved all the fields into
	details. Renamed client_loaded to view_loaded. Renamed load_client
	to load_view. Eliminated load_client_sync. Renamed get_iid to
	get_view_iid. Eliminated get_is_underway. Added
	get_is_view_loaded.
	* src/athena-view-frame.c:
	(athena_view_frame_queue_incoming_call): Simple cover for
	putting an incoming CORBA call on the idle queue.
	(athena_view_frame_initialize_class): Change client_loaded
	signal name to view_loaded.
	(athena_view_frame_initialize): Allocate the idle queue.
	(stop_activation): New function that stops a load_view that is
	underway.
	(destroy_view): Use the "view" field to tell if a view was
	loaded. The old code used the "iid" field, but now we set that
	even before the load is completed.
	(athena_view_frame_destroy): Destroy the idle queue. Also put
	the view into "failed" state once it's destroyed so additional
	calls are harmless.
	(athena_view_frame_finalize): Check that we're in the failed
	state.
	(emit_zoom_parameters_changed): New function so we can share more
	code.
	(view_frame_activated): Emit the zoom_parameters_changed signal
	here since a new view should always should get this signal.
	(view_frame_underway): Make this do nothing in the failed case
	instead of complaining.
	(view_frame_loaded): Make this do nothing in the failed case
	instead of complaining.
	(view_frame_failed): Stop whatever's in progress when the view
	fails. Also, allow calling this on a view that's already failed.
	(check_if_view_is_gone): Consolidate the calls to
	deregister_dead_components so we don't need an explicit call here.
	(emit_zoom_parameters_changed_callback),
	(zoom_parameters_changed_callback),
	(emit_zoom_level_changed_callback), (zoom_level_changed_callback):
	Redo these so they queue onto the idle queue, since they are
	triggered by incoming CORBA calls that can happen at any time.
	(create_corba_objects): Factor out the part of the code that makes
	the CORBA objects. Make error handling more complete and keep
	around pointers to the Bonobo objects for various parts of the
	aggregate so we can connect the appropriate signal handlers.
	(attach_view): Change code so it no longer connects signals to the
	BonoboObjectClient, since the signals won't go out on that
	GtkObject. Connect to the exception signals for all objects in the
	aggregate (any failure means "view failed"). Also connect to the
	"destroy" signal for one object (doesn't matter which since the
	entire aggregate goes away at once) and to the zoom-related
	signals. Report errors with signals rather than returning a
	boolean.
	(activation_callback): Add code to handle failure case.
	(athena_view_frame_load_view): Renamed. Got rid of "sync."
	version.
	(athena_view_frame_stop): Stop OAF activation of the view if
	it's in progress.
	(athena_view_frame_selection_changed): Make it a quiet no-op to
	send a selection change notice if no view is loaded. This helps
	keep the code simple for sidebars. Later we may make the view
	frame responsible for sending the selection on once the view is
	loaded.
	(athena_view_frame_title_changed): Same change as for selection,
	same idea.
	(athena_view_frame_get_is_zoomable),
	(athena_view_frame_get_zoom_level),
	(athena_view_frame_set_zoom_level),
	(athena_view_frame_get_min_zoom_level),
	(athena_view_frame_get_max_zoom_level),
	(athena_view_frame_get_has_min_zoom_level),
	(athena_view_frame_get_has_max_zoom_level),
	(athena_view_frame_get_is_continuous),
	(athena_view_frame_get_preferred_zoom_levels),
	(athena_view_frame_zoom_in), (athena_view_frame_zoom_out),
	(athena_view_frame_zoom_to_fit): Since a failed view has a
	zoomable_frame field set to NULL, got rid of all the explicit
	failure-case code for these functions.
	(athena_view_frame_get_view_iid): Renamed from get_iid. 
	(athena_view_frame_report_load_underway),
	(athena_view_frame_report_load_complete),
	(athena_view_frame_report_load_failed): Moved the "quiet"
	handling of failed views down into the underlying functions, so
	these no longer need explicit failure-case code.
	(athena_view_frame_set_label): It's OK to allow this even for a
	failed view.
	(athena_view_frame_map): Use a kept-around reference to the
	control frame instead of relying on query_local_interface.
	(athena_view_frame_get_is_view_loaded): Add this so callers can
	tell when a sidebar view is not yet loaded. Might not need this
	when we clean things up more, but it's no big deal either way.
	
	* src/athena-window-manage-views.c: (update_title): No need to
	send the title change to the new content view -- it gets a title
	change once it comes up "for real".
	(set_displayed_location): Handle location of NULL here so we don't
	need to worry about it elsewhere.
	(check_bookmark_location_matches): Remove "uri" from name.
	(location_has_really_changed): Now that the state machine is gone,
	it's easy to see that this is never called with pending_ni equal
	to cancel_tag, so remove the code for that and add an assert.
	(set_view_location_and_selection): New name for what was called
	update_view.
	(set_sidebar_panels_location_and_selection): Cover since this loop
	occurs in two places.
	(update_for_new_location_and_selection): New name for what was
	called set_view_location_and_selection. Since it's now clear this
	can't be called with new_content_view equal to NULL, remove the
	code to handle that (fixes bug 2457).
	(load_content_view): Use async. view loading here. Get rid of
	"Avoid being fooled by extra done notifications from the last
	view. This is a HACK because the state machine SUCKS." by
	eliminating the "cv_progress_done" and "cv_progress_error" flags
	altogether. In the case where we reuse the same view, just call
	update_for_new_location_and_selection -- the old code set
	"view_activation_complete", but I eliminated that flag.
	(handle_view_failure): Remove the old view using
	athena_window_set_content_view_widget instead of having
	duplicate code here. Use a call to cancel_location_change instead
	of setting the "reset_to_idle" and "cv_progress_error" flags
	(both gone now).
	(free_location_change): No need to clean up "error_views" any
	more, because that field is gone.
	(end_location_change): New helper to stop the throbber from
	throbbing and then free the location change state.
	(cancel_location_change): Get rid of special case for NULL
	location now that set_displayed_location can handle it.
	(athena_window_end_location_change_callback): Remove
	"superstitiously" added call to update_state and call
	load_content_view_for_new_location directly.
	(athena_window_begin_location_change): Use a call to
	cancel_location_change to deal with the possibility that we may
	have a change already in progress.
	(athena_window_stop_loading): Use cancel_location_change to stop
	the loading.
	(athena_window_set_content_view): Remove calls to update_state
	-- there's no state to update any more.
	(athena_window_set_sidebar_panels): Do an async. load here and
	finish the setup in the view_loaded callback.
	(failed_callback): Do a handle_view_failed right here, now that we
	have no state machine to satisfy.
	(load_underway_callback): Change code to handle the two
	interesting cases separately without a state machine. When the new
	content view says "underway", it's time for
	location_has_really_changed. When an existing content view says
	"underway", we restart the throbber (fixes 1/2 of bug 2461).
	(load_complete_callback): Since view frames now ensure we get an
	underway call before a complete call, we can simplify the
	logic. If the main content view says "complete", it's time to stop
	the throbber (fixes other 1/2 of bug 2461).
	(view_loaded_callback): Renamed the client_loaded callback. Also
	made it update location and selection for sidebar panels when they
	are loaded. Also made it update the title for any view when it's
	loaded.

	* src/athena-window.h:
	* src/athena-window.c: (athena_window_synch_view_as_menu):
	Handle case of NULL content view.
	(athena_window_set_content_view_widget): Destroy the view when
	it's going away instead of removing it from the parent. Also make
	this function handle the NULL case so we can use it to remove the
	old view, not just to add the new one.

	* libathena-extensions/athena-bonobo-extensions.h: Whitespace
	tweak.

	* src/athena-sidebar.c:
	(athena_sidebar_active_panel_matches_id): Update for
	athena_view_frame_get_view_iid name change.
	
2001-01-29  Arik Devens  <arik@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>

	Fixed bug 6122, Switching user levels always selects but does not
	necessarily display first category.
	
	* libathena-extensions/athena-preferences-box.c:
	(athena_preferences_box_destroy), (preferences_box_select_pane),
	(preferences_box_iterate_clist),
	(preferences_box_category_list_recreate): Added a new convience
	function to iterate through the category clist looking for a
	specific entry and return its row. Added the setting of the active
	row in the clist to the previously selected pane if it exists in
	your user level.

2001-01-29  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 5508, Athena crashes when pressing 'Esc' in
	copy/duplicate progress dialog

	* libathena-extensions/athena-file-operations.c:
	(handle_close_callback), (create_transfer_dialog):
	Set the cancel state to true if the user uses the Escape key
	or close box to dismiss the dialog.  This will cancel the
	transfer properly.
	
2001-01-29  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_create_boolean):
	Justify labels to the left.
	
2001-01-29  Robey Pointer  <robey@eazel.com>

	* icons/Makefile.am:

	Un-revert some changes Andy accidentally reverted last week that
	cause the password-change view to display incorrectly.

2001-01-29  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-program-choosing.c:
	Launch an application with a uri as a parameter for
	applications that accept uris for all locations, and 
	non-file parameters where applications expect 
	uris for non-file locations.  This fixes bug 4962,
	"Open with mpg123 fails for local files"
	* libathena-extensins/athena-file-utilities.h:
	* libathena-extensins/athena-file-utilities.c
	(athena_uri_get_scheme), (athena_uri_is_local_scheme):
	Add new uri_get_scheme function and fix a lack of 
	colons in the athena_uri_is_local_scheme function
	that was causing us to do a istr_has_prefix (uri, "file")
	to check if a uri was of scheme file.
	* libathena-extensions/athena-file.c: 
	(athena_file_get_uri_scheme) refactor the code in here
	to use the athena_uri_get_scheme function 

2001-01-29  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Arik Devens  <arik@eazel.com>

	* libathena-extensions/athena-preferences-box.c:
	(athena_preferences_box_initialize),
	(preferences_box_select_pane),
	(preferences_box_category_list_recreate),
	(category_list_select_row_callback),
	(athena_preferences_box_update):
	Fix bug 6119 - Preferences pane is blank after changing user
	levels from advanced to beginner.  Whenever we recreate the
	category list, we update the selection.
		
2001-01-29  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>
	
	Fixed bug 6098, mounting and unmounting a cdrom
	volume incorrectly reports error.
	
	* libathena-extensions/athena-volume-monitor.c:
	(close_error_pipe):
	Loop on read until we get an error or end of read.
	
	* src/file-manager/fm-desktop-icon-view.c:
	(create_unique_volume_name):
	Tweak the index so the created name accurately reflects
	the number of occurence the file is.
	
	Initial work on adding a GMC to Athena transition mechanism
	to the first time wizard.
	* src/athena-first-time-druid.c: (druid_finished),
	(convert_gmc_desktop_icons), (transition_value_changed),
	(set_up_gmc_transition_page), (athena_first_time_druid_show):
	
2001-01-29  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 4427 (Should not execute text files by default).

	Now it asks whether to run or display executable text files.
	Advanced users can set a new preference.

	* libathena-extensions/athena-stock-dialogs.h:
	* libathena-extensions/athena-stock-dialogs.c:
	(create_message_box): New bottleneck function, contains former
	guts of show_message_box but doesn't call gtk_widget_show.
	(show_message_box): Now just a simple wrapper for 
	calling create_message_box and showing the result.
	(athena_show_info_dialog), (athena_show_warning_dialog), 
	(athena_show_error_dialog), (athena_show_yes_no_dialog), 
	(athena_show_error_dialog_with_details):
	Renamed to add verb "show" to names.
	(athena_run_simple_dialog): Renamed to add verb "run" to name.
	(athena_create_question_dialog): New public function, does
	not show the dialog yet so caller can add more buttons or
	whatever before showing.

	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog): Add new preference for
	what to do when an executable text file is activated. It
	defaults to "Ask" and is visible only at Advanced level.

	* libathena-extensions/athena-file-private.h:
	* libathena-extensions/athena-file.h: Moved
	athena_file_contains_text into public header.
	
	* src/file-manager/fm-directory-view.c:
	(get_executable_text_file_action): New function, uses preference
	and dialog (if necessary) to determine how to handle activating
	an executable text file.
	(activate_callback): Now handles executable text files specially
	by using get_executable_text_file_action. Restructured the control
	flow a little.

	* components/music/athena-music-view.c: (set_album_cover),
	(play_current_file), (athena_music_view_update):
	* components/rpmview/athena-rpm-view-install.c:
	(athena_rpm_view_install_done):
	* components/services/summary/athena-view/athena-summary-dialogs.c: 
	(athena_summary_login_failure_dialog),
	(generate_error_dialog):
	* components/text/athena-text-view.c: (file_read_callback):
	* libathena-extensions/athena-file-operations.c:
	(confirm_empty_trash),
	(handle_transfer_vfs_error), (handle_transfer_overwrite),
	(athena_file_operations_copy_move),
	(handle_new_folder_vfs_error),
	(athena_file_operations_move_to_trash):
	* libathena-extensions/athena-icon-dnd.c:
	(confirm_switch_to_manual_layout):
	* libathena-extensions/athena-program-chooser.c:
	(athena_program_chooser_show_no_choices_message):
	* libathena-extensions/athena-program-choosing.c:
	(athena_launch_application):
	* libathena-extensions/athena-volume-monitor.c:
	(display_mount_status):
	* src/file-manager/fm-desktop-icon-view.c:
	(icon_view_create_athena_links):
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_confirm_multiple_windows),
	(real_file_limit_reached), (fm_directory_view_confirm_deletion),
	(confirm_delete_from_trash), (report_broken_symbolic_link),
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file), (fm_report_error_setting_group),
	(fm_report_error_setting_owner),
	(fm_report_error_setting_permissions):
	* src/file-manager/fm-properties-window.c: (set_custom_image):
	* src/file-manager/fm-search-list-view.c: (load_location_callback),
	(load_error_callback), (display_indexed_search_problems_dialog),
	(real_file_limit_reached):
	* src/file-manager/athena-indexing-info.c:
	(update_file_index_callback),
	(show_search_service_not_available_dialog):
	* src/athena-application.c: (check_required_directories),
	(athena_application_startup):
	* src/athena-location-bar.c: (drag_data_received_callback):
	* src/athena-property-browser.c: (remove_pattern),
	(remove_emblem), (emblem_image_file_changed),
	(add_pattern_to_browser), (add_color_to_browser),
	(emblem_dialog_clicked):
	* src/athena-sidebar.c: (receive_dropped_uri_list):
	* src/athena-theme-selector.c: (add_theme_to_icons),
	(theme_select_row_callback):
	* src/athena-window-manage-views.c: (handle_unreadable_location),
	(report_content_view_failure_to_user_internal),
	(report_sidebar_panel_failure_to_user),
	(athena_window_end_location_change_callback):
	* src/athena-window-menus.c: (forget_history_if_confirmed),
	(show_bogus_bookmark_window): Updated for dialog API name changes.

	* libathena-extensions/athena-file.c: (get_description):
	Lucky Aaron gets missing mime description complaints now.

2001-01-29  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(athena_background_draw):
	Allocate buffer when needed rather than keeping it around.

2001-01-29  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Arik Devens  <arik@eazel.com>

	Bug fixes.

	5776 - Preferences dialog layout updates incorrectly after
	switching user level.

	5791 - Preference section title are visible even when section is
	empty.
	
	* libathena-extensions/athena-preferences-box.h:
	* libathena-extensions/athena-preferences-box.c:
	(athena_preferences_box_initialize_class),
	(athena_preferences_box_initialize),
	(athena_preferences_box_destroy), (preferences_box_select_pane),
	(preferences_box_category_list_recreate), (pane_info_new),
	(pane_info_free), (category_list_select_row_callback),
	(athena_preferences_box_new),
	(athena_preferences_box_add_pane),
	(athena_preferences_box_update):
	Lots of cleanup.  Fix typos in many class macros and methods.
	Comply with the Athena style more.  Remove unused code.

	Recreate the category list whenever the preference box gets
	updated in order to honor user level visibilities.

	* libathena-extensions/athena-preferences-dialog.h:
	* libathena-extensions/athena-preferences-dialog.c:
	(athena_preferences_dialog_destroy),
	(athena_preferences_dialog_get_prefs_box),
	(athena_preferences_dialog_update),
	(user_level_changed_callback):
	Fix class macros typos.
	
	* libathena-extensions/athena-preferences-group.h:
	* libathena-extensions/athena-preferences-group.c:
	(athena_preferences_group_get_num_visible_items):
	Fix misspelled method.
	
	* libathena-extensions/athena-preferences-pane.h:
	* libathena-extensions/athena-preferences-pane.c:
	(athena_preferences_pane_destroy),
	(athena_preferences_pane_set_title),
	(athena_preferences_pane_set_description),
	(athena_preferences_pane_add_group),
	(athena_preferences_pane_add_item_to_nth_group),
	(athena_preferences_pane_update),
	(athena_preferences_pane_get_num_visible_groups):
	Lots of cleanup.  Remove unused and crufty code.  Made the widget
	a lot simpler.
	
2001-01-29  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	Fixed bug 5627, Preferences window needs better sizing.
	
	* libathena-extensions/athena-preferences-box.c:
	(prefs_box_construct), (prefs_box_select_pane),
	(athena_preferences_box_add_pane): Added a notebook view to put
	the preference panes in. Removed hiding and showing of panes.
	libathena-extensions/athena-preferences-dialog.c:
	(athena_preferences_dialog_construct): Added setting of default
	size to the preferences dialog for the default font size.
	libathena-extensions/athena-preferences-dialog.h:
	libathena-extensions/athena-preferences-pane.c:
	(prefs_pane_construct), (athena_preferences_pane_add_group):
	Added showing of preference panes on creation so that the notebook
	view sizes correctly.

2001-01-27  Gene Z. Ragan  <gzr@eazel.com>

	Added logic to handle volume mount name collisions.
	Check for possible filename collison on desktop and create
	unique alternate names for mounted devices.
	
	* libathena-extensions/athena-volume-monitor.c:
	* libathena-extensions/athena-volume-monitor.h:

	(athena_volume_monitor_get_volume_name),
	(modify_volume_name_for_display), (update_modifed_volume_name),
	(mount_lists_are_identical), (verify_current_mount_state),
	(athena_volume_monitor_set_volume_name),
	(get_iso9660_volume_name), (get_ext2_volume_name),
	(get_msdos_volume_name), (get_nfs_volume_name),
	(get_floppy_volume_name), (get_generic_volume_name):
	
	* src/file-manager/fm-desktop-icon-view.c:
	(create_unique_volume_name), (create_mount_link),
	(volume_unmounted_callback):

Fri Jan 26 23:58:42 2001  George Lebl <jirka@5z.com>

	Holy piss sprinkled on this by Arik <arik@eazel.com>

	* components/adapter/main.c (main)
	  components/help/hyperbola-main.c (main)
	  components/image-viewer/athena-image-view.c (init_server_factory)
	  components/mozilla/main.c (main)
	  components/music/main.c (main)
	  components/notes/athena-notes.c (main)
	  components/services/install/athena-view/main.c (main)
	  components/services/inventory/main.c (main)
	  components/services/login/athena-view/main.c (main)
	  components/services/summary/athena-view/main.c (main)
	  components/shell/shell.c (init_bonobo)
	  components/text/main.c (main)
	  components/throbber/main.c (main)
	  components/tree/main.c (main)
	  libathena/athena-view-standard-main.c
	  (athena_view_standard_main_multi):
	  Add gnome_client_disable_master_connection call to all out of
	  process component main functions since they should not register
	  with the session manager.  Fixes bug #6051

2001-01-26  Seth Nickell  <seth@eazel.com>

	* icons/eazel/sidebar_tab_pieces/.cvsignore:
	And another .cvsignore entry...
	
2001-01-26  Seth Nickell  <seth@eazel.com>

	* icons/eazel/.cvsignore:
	* icons/vector/.cvsignore:
	Added Makefile and Makefile.in to the ignore file
	
	* libathena-extensions/athena-mime-actions.c:
	(application_supports_uri_scheme):
	Add a cast to gpointers being passed to strcmp to
	satisfy C++-ish compilers

2001-01-26  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	Fix 5352 (Tab Order messed up by "Layout" order of folder)
	Fix 5478 (Icon view tab order doesn't follow the layout order)
	* libathena-extensions/athena-icon-container.c: (sort_icons),
	(compare_icons_by_name), (sort_icons_by_name),
	(build_icon_list_sorted_by_name), (select_previous_or_next_name),
	(athena_icon_container_initialize_class):
	* libathena-extensions/athena-icon-container.h:
	* src/file-manager/fm-icon-view.c:
	(icon_container_compare_icons_callback),
	(icon_container_compare_icons_by_name_callback),
	(create_icon_container):
	Add a new signal "compare_icons_by_name" that circumvents the
	selected sort order and sort kind in a window and uses the unmollested
	sort by name function.
	Hook up the select-previous/next function to use the sort-by-name
	call instead of athena_strcoll.
	
2001-01-26  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5747, Athena freezes while mounting a device
	
	There were several issues here.  The first involved the use
	of popen to call the mount/umount command. If a mount/umount
	call causes a lengthy response, such as a hard drive spinning
	up, it would block the UI.  I changed the code to spawn a thread
	and schedule a gtk_idle to display feedback if any was generated.
	I also create a thread to call eject, instead of using a possibly
	blocking ioctl call. Another benefir of this is that we now have
	a more flexible eject mechanism. Zip drives and other removable
	media can no wbe ejected.  In the course of making these changes,
	another issue was found.  The dynamic creation of the removable
	volumes menus was causing a UI lock up.  I get around this by
	creating a list of removable volumes at volume monitor initialization
	instead of a dynamic list.  The downside of this is that any new
	entries added to the fstab while Athena is running will be overlooked.
	We will have to monitor the file in the future to work around this issue.
	
	* libathena-extensions/athena-volume-monitor.c:
	* libathena-extensions/athena-volume-monitor.h:
	(athena_volume_monitor_initialize),
	(athena_volume_monitor_destroy),
	Add and cleanup list of removable volumes.
	
	(athena_volume_monitor_volume_is_removable):
	Check is_removable filed of volume.
	
	(athena_volume_monitor_get_removable_volumes):
	Return const pointer to monitor's removable volume list.
	
	(get_removable_volumes):
	Contruct list of removable volumes
	
	(volume_is_removable), (volume_is_read_only):
	New functions that check against fstab to see if the volume
	is removable and read-only.

	(eject_device):
	New threaded eject function.
	
	(mount_volume_deactivate),
	(mount_volume_floppy_add), (mount_volume_iso9660_add),
	(display_mount_status), (close_error_pipe),
	(athena_volume_monitor_mount_unmount_removable),
	(mount_volume_add_filesystem):
	
	(mount_unmount_callback):
	Thread function to mount/umount
	
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link),
	(update_disks_menu):

2001-01-26  Maciej Stachowiak  <mjs@eazel.com>

	* src/athena-window-manage-views.c
	(disconnect_and_destroy_sidebar_panel): Hold a ref on the widget
	to avoid it being finalized before we can destroy it.

2001-01-26  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-dnd.c:
	(athena_icon_container_item_at):
	fixed bug 5750, accepting drops by folders quirky at zoom levels
	below 100%. The problem was that athena_icon_container_item_at
	was constructing a single pixel rectangle for hit-testing, that
	sometimes turned into a zero pixel rectangle when scaled down,
	depending on how things rounded off.  Fixed by using the
	canvas scale factor when building the rectangle, ensuring that
	it never becomes empty.
	
2001-01-26  Rebecca Schulman  <rebecka@eazel.com>
	Fix bugs 4094, 4425, 5201 and 4106 about inappopriate
	applications being offered to view remote files.
	This change filters applications that don't support
	a uri scheme from a file's short list.

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_actions_get_minimum_file_attributes),
	(athena_mime_get_short_list_applications_for_file),
	(application_supports_uri_scheme):
	Filter out applications from the short list that do not
	support the uri scheme for the file in question.
	* libathena-extensions/athena-program-choosing.c:
	(athena_launch_application):
	Change "can_open_uris" to "expects_uris" to go along with
	the gnome vfs change
	* test/test-athena-mime-actions.c: (append_comma_and_scheme),
	(format_supported_uri_schemes_for_display), (print_application):
	update the tests similarly to the way the gnome-vfs tests were
	updated, so that all of the fields of the GnomeVFSMimeApplication
	structure are correctly printed.

	* libathena-extensions/athena-glib-extensions.c:
	Correct spelling and naming error in a comment
	
2001-01-25  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Some preparation work for doing async. activation. This amounts
	to another pass cleaning up the legendary "state machine" as well
	as some other cleanups in the async. activation code.

	* libathena-extensions/athena-bonobo-extensions.h:
	* libathena-extensions/athena-bonobo-extensions.c:
	(oaf_activation_callback), (athena_bonobo_activate_from_id),
	(athena_bonobo_activate_cancel): Fix interface of activation to
	be cleaner. Also handle case where callback is called right away.

	Add queuing to AthenaView so that all incoming CORBA calls are
	dispatched at idle time. This can fix some otherwise-difficult
	re-entrancy problems. The widget destroy call can still come in at
	any time though. Also this same fix may be needed for the
	AthenaViewFrame side.
	
	* libathena/athena-view.h:
	* libathena/athena-view.c: (execute_queued_calls): Function
	to dequeue and execute calls.
	(dequeue_calls_at_idle): Cover to call it at idle time.
	(discard_queued_calls): Discard calls without executing them, for
	use at destroy time.
	(queue_incoming_call): Simple cover to queue and schedule an
	idle-time dequeue pass.
	(athena_g_list_from_uri_list): Need to make a full copy, not
	a shallow copy, now that we are queuing things for a hile.
	(call_load_location), (call_stop_loading),
	(call_selection_changed), (call_title_changed),
	(call_history_changed): Simple functions that get queued.
	(list_deep_free_cover): GDestroyNotify-compatible function for one
	destroy case.
	(history_dup): Function to copy the history list, since that is
	now queued instead of used right away.
	(impl_Athena_View_load_location),
	(impl_Athena_View_stop_loading),
	(impl_Athena_View_selection_changed),
	(impl_Athena_View_title_changed),
	(impl_Athena_View_history_changed): Change these all to queue
	the incoming call instead of doing work right away.
	(athena_view_destroy): Discard the queue.
	
	* src/athena-view-frame-corba.c:
	(impl_Athena_ViewFrame_open_location_force_new_window),
	(impl_Athena_ViewFrame_report_selection_change): These calls now
	use the deep copy, since the shallow one is no longer available.
	This is good since we probably will be doing queuing here later,
	so we'll need the deep copy.
	
	* src/athena-view-frame.h:
	* src/athena-view-frame.c:
	(athena_view_frame_initialize_class): Set up a map default signal
	handler to activate the control. This is better than the old way,
	where we had an explicit call to do it.
	(athena_view_frame_destroy_client): Remove unused
	CORBA_Environment.
	(view_frame_activated): Remove unneeded ACTIVATING state. Also
	send the client_loaded signal in here, so you can't "forget".
	(view_frame_wait), (view_frame_underway),
	(view_frame_wait_is_over), (view_frame_loaded),
	(view_frame_failed): Remove unneeded ACTIVATING state.
	(check_if_view_is_gone): Simplify logic and make sure to check the
	value of the exception and not just the function result.
	(attach_client): Fix CORBA_Exception that was allocated twice and
	that could also be allocated and not freed in some cases.
	(activation_callback), (athena_view_frame_load_client_async):
	Better names, use new API, still not tested.
	(athena_view_frame_load_client): Get rid of function result and
	use unified interface for telling about success and failure so that
	sync. and async. interfaces will be the same.
	(athena_view_frame_stop): Renamed this single function, which
	will soon stop either activation that's in process or loading
	that's in process with a single call. For now it's just the same
	as the old stop_loading call.
	(athena_view_frame_map): New override to activate the control.
	This replaces the old explicit activate call.
	(send_history), (athena_view_frame_get_is_underway): Remove
	unneeded ACTIVATING state.

	* src/athena-window.h:
	* src/athena-window-manage-views.c:
	(location_has_really_changed): Assume that new_content_view is not
	NULL. The old code was trying to be inappropriately "general".
	(disconnect_destroy_unref_view): Remove now-unused function.
	(load_content_view): Don't use a return value any more, since it's
	important to set up new_content_view before any signals happen.
	Get rid of code that handles failure right at the start, since
	we now get all failures through the signal handler.
	(handle_view_failure): Add FIXME comments. Minor refactoring.
	(cancel_location_change): Eliminated now-uneeded views_shown and
	view_bombed_out booleans.
	(load_view_for_new_location): New load_content_view doesn't return
	a value any more.
	(update_state): Changed this to be a loop instead of returning a
	boolean and always being called in a loop. Also simplified logic
	so that views_shown and view_bombed_out aren't needed any more.
	(athena_window_end_location_change_callback): Use update_state
	directly instead of calling the old clunky change_state cover.
	(athena_window_begin_location_change): Use update_state directly
	instead of calling the old clunky change_state cover.
	(stop_loading): Call the new simple athena_view_frame_stop
	instead of athena_view_frame_stop_loading.
	(natuilus_window_stop_loading): Use update_state directly instead
	of calling the old clunky change_state cover.
	(athena_window_set_content_view): Use update_state directly instead
	of calling the old clunky change_state cover.
	(athena_window_set_sidebar_panels): Handle failures with
	callback instead of looking at return value (which no longer
	exists).
	(client_loaded_callback): Add this new callback that's done when
	the view is activated and ready to go.
	(failed_callback): Use update_state directly instead of calling
	the old clunky change_state cover.
	(load_underway_callback): Use update_state directly instead of
	calling the old clunky change_state cover.
	(load_complete_callback): Use update_state directly instead of
	calling the old clunky change_state cover.

	* src/athena-window.c:
	(athena_window_set_content_view_widget): Get rid of explicit
	activation, no longer needed now that AthenaViewFrame handles it
	directly.
	
	* test/test-athena-async-activation.c: (activation_callback),
	(main): Change to use new async. API.
	
	* user-guide/gnufdl/.cvsignore: Add to ignore some missing files.

2001-01-25  Maciej Stachowiak  <mjs@eazel.com>

	* src/athena-window-manage-views.c
	(disconnect_and_destroy_sidebar_panel): Fix build (I suck).

2001-01-25  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	Fix bug 5997 (Segmentation fault when enabling then disabling tree
	panel) two different ways (one is useful for future robustness).
	
	* components/tree/athena-tree-expansion-state.c: Move expansion
	state preference from "sidebar-panels/tree/expansion_state" to
	"tree-sidebar-panel/expansion_state" to avoid making Athena
	think the set of active sidebar panels is changing when this
	setting gets set.
	
	* src/athena-window-manage-views.c: (handle_view_failure,
	athena_window_set_sidebar_panels): Call
	`disconnect_and_destroy_sidebar_panel' instead of
	`disconnect_view_and_destroy' followed by
	`athena_window_remove_sidebar_panel', which left the possibility
	of an inconsistent state where a destroyed view is in the sidebar
	panel list.
	(disconnect_and_destroy_sidebar_panel): New function that
	disconnects signal handlers, removes the sidebar panel from the
	window, and then finally destroys it, to avoid the possibility of
	the sidebar panel list being in an inconsistent state.

2001-01-24  Maciej Stachowiak  <mjs@eazel.com>

	Merging Mike Fleming's partial fix for 5968 from branch. This
	updates all the user agent strings in Athena.

	2001-01-24  Mike Fleming  <mfleming@eazel.com>

	        reviewed by: <robey@eazel.com>

		User-Agent Changes for PR3

		"Trilobite/" --> "Trilobite/0.2.0"
		"Athena/1.0" (in the Mozilla User-Agent) --> "Athena/1.0PR3"

		* components/mozilla/athena-mozilla-content-view.c:
		(mozilla_content_view_one_time_happenings):
		* components/services/install/lib/eazel-install-protocols.c:
		(http_fetch_remote_file),
		(eazel_install_fetch_definitive_package_info):
		* components/services/install/lib/eazel-softcat.c:
		(eazel_softcat_get_info):
		* components/services/inventory/eazel-inventory-service.c:
		(impl_Trilobite_Eazel_Inventory_upload):
		* components/services/trilobite/libtrilobite/Makefile.am:
		* components/services/trilobite/libtrilobite/trilobite-core-network
		-slim.c: (trilobite_fetch_uri):
		* components/services/trilobite/libtrilobite/trilobite-core-network
		.c: (trilobite_open_uri):
		* components/services/trilobite/libtrilobite/trilobite-core-utils.c
		: (trilobite_get_useragent_string):
		* components/services/trilobite/libtrilobite/trilobite-core-utils.h
		:

	
2001-01-25  Robey Pointer  <robey@eazel.com>

	* components/services/install/command-line/.cvsignore:

	Remove cruft.
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_from_packagedata),
	(packagedata_from_corba_packagedatastruct):
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_implementation):
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_initialize), (packagedata_finalize),
	(packagedata_copy), (packagedata_fill_in_missing),
	(packagedata_dump_int):
	* components/services/install/lib/eazel-package-system-types.h:

	Add "filesize" item to the PackageData struct, and the corba one,
	and parse it out of the softcat XML.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), (dedupe_foreach_depends),
	(is_satisfied):
	* components/services/install/lib/eazel-softcat.c:
	(remove_directories_from_provides_list):
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (install_message_new), (generate_install_form):

	Retrofit some PR3 patches to the trunk.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_matches_versioning):

	Compress Eskil's package version comparison function into
	something a bit smaller and easier to follow for mere mortals like
	myself. :)
	
	* athena-installer/src/installer.c: (create_install_page),
	(eazel_install_progress), (eazel_download_progress),
	(get_detailed_errors_foreach), (get_detailed_errors),
	(download_failed), (eazel_install_preflight),
	(eazel_install_dep_check):
	* athena-installer/src/installer.h:
	* athena-installer/src/main.c: (segv_handler), (main):
	* athena-installer/src/prescript:

	First bit of 1.0 installer fixes: Bring it up to speed with
	changes in the install library.

2001-01-25  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	Fix 5879 (Close copy source & destination windows -> crash at
		  end of copy operation).

	* libathena-extensions/athena-directory-metafile.c:
	(athena_directory_remove_file_metadata):
	Merge a fix from PR3 branch.
	
	* libathena-extensions/athena-gtk-extensions.c:
	(null_the_reference), (athena_gtk_null_reference_if_destroyed),
	(athena_gtk_stop_null_reference_if_destroyed):
	* libathena-extensions/athena-gtk-extensions.h:
	Add new magic calls that set up a reference to get nulled out
	when the object it points to is destroyed.

	* libathena-extensions/athena-file-operations.c:
	(transfer_info_new), (transfer_info_destroy),
	(handle_transfer_ok), (athena_file_operations_copy_move),
	(athena_file_operations_move_to_trash),
	(athena_file_operations_delete), (do_empty_trash):
	Null out a saved reference to the parent window so
	that we don't try to use it after the window gets closed.
	Clean up creation and destruction of TransferInfo.
	
	* libathena-extensions/athena-file-operations.c:
	(handle_transfer_ok):
	Fix a case where TransferInfo could get leaked.
	
	* libathena-extensions/athena-file-operations.c:
	(new_folder_transfer_callback),
	(athena_file_operations_new_folder):
	Rework to make deleting of NewFolderTransferState cleaner.
	Set up parent_view to get nulled out when the view gets closed.
	
	* libathena-extensions/athena-preferences-dialog.c:
	(dialog_clicked), (dialog_show), (dialog_destroy),
	Tweaks. Get rid of unneeded casts.

	* src/athena-property-browser.c: (add_new_pattern),
	(show_color_selection_window), (add_new_color), (add_new_emblem):
	* src/athena-theme-selector.c: (add_new_theme_button_callback):
	* src/athena-view-frame-corba.c:
	(impl_Athena_ViewFrame__destroy),
	(impl_Athena_ViewFrame__create):
	Use new magic calls to null out references.
	
	* src/athena-property-browser.c:
	(athena_property_browser_destroy):
	Disconnect from the destroy-watching signal.

	* libathena-extensions/athena-icon-container.c:
	(set_pending_icon_to_reveal):
	(athena_preferences_dialog_construct):
	* src/file-manager/fm-directory-view.c: (copy_move_done_data_free),
	(pre_copy_move), (copy_move_done_partition_func),
	(copy_move_done_callback):
	Use new magic calls to null out references.
	Fix a memory trasher where CopyMoveDoneData was being destroyed too
	early.

2001-01-25  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5981, Desktop Eazel-Services link won't work without
	Mozilla installed
		
	* src/athena-first-time-druid.c: (druid_finished):
	Use the eazel: protocol instead of the http: services
	URI.
	
2001-01-25  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>
	
	Fixed bug 6002, programs run from Athena Link files leave zombie processes

	* libathena-extensions/athena-gnome-extensions.c:
	* libathena-extensions/athena-gnome-extensions.h:
	(athena_gnome_shell_execute):
	Rename function and make it available to outside callers
	
	(athena_gnome_open_terminal):
	Rename function calls to athena_gnome_shell_execute
	
	* src/file-manager/fm-directory-view.c: (activate_callback):
	Call athena_gnome_shell_execute instaed of calling forking
	and calling exec.  Using athena_gnome_shell_execute does the
	right thing and avoids creating zombie processes.

2001-01-25  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 5590 (List view uses anti-aliased graphics always)

	* src/file-manager/fm-list-view.c
	(fm_list_view_update_smooth_graphics_mode): new function, put
	into the FMDirectoryView method table, and called by
	set_up_list ()

	* libathena-extensions/athena-list.c (AthenaListDetails):
	added an `anti_aliased_mode' boolean field

	(draw_cell_pixbuf): support both normal and anti-aliased
	drawing styles

	* libathena-extensions/athena-list.[ch]
	(athena_list_set_anti_aliased_mode): new function

	* libathena-extensions/athena-list.c
	(athena_list_set_single_click_mode): call
	gtk_widget_queue_draw () on the list widget. Fixes the
	(unfiled?) bug where toggling the `Activate items with a foo
	click' doesn't immediately change how the list view is drawn

2001-01-25  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 5569 (Desktop should not show up in history list)

	I also prevented Control-B on the desktop from adding the
	desktop to the Bookmarks list.

	* src/file-manager/athena-desktop-icon-view-ui.xml:
	overrode command "Add Bookmark" to be insensitive.
	
	* src/athena-window.h: Declare function pointer for
	add_current_location_to_history_list.

	* src/athena-window-private.h: Declare private function
	athena_window_add_current_location_to_history_list.

	* src/athena-window.c: 
	(athena_window_initialize_class),
	(real_add_current_location_to_history_list): Fill in
	add_current_location_to_history_list function pointer
	with simple function.
	(athena_window_add_current_location_to_history_list):
	wrapper for calling the new virtual function.
	(athena_forget_history):
	Call athena_window_add_current_location_to_history_list
	where it was doing the work directly, to get the indirection.
	
	* src/athena-window-manage-views.c: (update_for_new_location):
	Call athena_window_add_current_location_to_history_list
	where it was doing the work directly, to get the indirection.

	* src/athena-desktop-window.c:
	(athena_desktop_window_initialize_class),
	(real_add_current_location_to_history_list): Override
	add_current_location_to_history_list to do nothing.

2001-01-25  Michael Engber  <engber@eazel.com>

	reviewed by: John Harper

	* libathena-extensions/athena-directory-background.c:
	(initialize_background_from_settings),
	(saved_settings_changed_callback),
	(athena_connect_background_to_file_metadata):
	Fixed trying to set the background on a window before it was realized. 

2001-01-25  Mike Fleming  <mfleming@eazel.com>
 
	reviewed by: <sullivan@eazel.com>
 
 	Bug 6032: summary view was crashing because widget was being
 	destroyed during finish_button_activation.
 
 	Added a ref to the button across the timer callback and
 	avoided calling gtk_button_clicked and gtk_button_released
 	if the widget is already destroyed.
 	
 	* libathena-extensions/athena-gtk-extensions.c:
 	(finish_button_activation), (athena_gtk_button_auto_click):
 
2001-01-25  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fix bug 5561 (Add a function to athena to iterate through
	windows in stacking order):

	* libathena-extensions/athena-gtk-extensions.c,
	libathena-extensions/athena-gtk-extensions.h
	(athena_get_window_list_ordered_front_to_back): new function,
	returns a list of all top-level windows in stacking order (from
	top to bottom)

	Fixed parts of bug 5553 (Enlightenment-related problems)

	* src/athena-desktop-window.c
	(athena_desktop_window_delete_event): connected to
	`delete_event' signal of the desktop window. Unconditionally
	returns TRUE. This stops GTK+ deleting the window in response
	to WM_DELETE_WINDOW requests, and thus fixes the bug where it's
	possible to delete the desktop window in Enlightenment

	* src/athena-desktop-window.c (realize): added SKIP_FOCUS to
	the _WIN_HINTS we set (even though, ages ago, I told Gene not
	to. Otherwise Enlightenment includes the desktop window in its
	M-TAB list)

2001-01-25  Michael Engber  <engber@eazel.com>

	reviewed by: John Harper

	* libathena-extensions/athena-directory-background.c:
	(saved_settings_changed_callback), (background_reset_callback):
	The root & desktop pixmaps are now updated in response to changes
	in the gnome_config settings - bug 6033.

2001-01-25  Michael Engber  <engber@eazel.com>

	reviewed by: John Harper

	* libathena-extensions/athena-background.c:
	(athena_background_draw_pixbuf_free), (athena_background_draw):
	Background are now always drawn with the aa code, ensuring
	their gradients are never striated - bug 5584.

2001-01-25  Josh Barrow  <josh@eazel.com>

	* icons/theme_preview.png:
	Updated for the new k-rad look of the default theme.

2001-01-25  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 5506 (Show Properties always shows full path,
	making window ludicrously wide)

	Also made some other contents of the properties
	window handle window-stretching more attractively.

	* libathena-extensions/athena-ellipsizing-label.h:
	* libathena-extensions/athena-ellipsizing-label.c:
	(athena_ellipsizing_label_initialize_class),
	(athena_ellipsizing_label_initialize), (real_destroy),
	(athena_ellipsizing_label_new), (recompute_ellipsized_text),
	(athena_ellipsizing_label_set_text), (real_size_request),
	(real_size_allocate), (real_style_set): New files. This is
	a subclass of GtkLabel that requests no specific width, and
	ellipsizes the text to fit whatever width it is given.

	* libathena-extensions/Makefile.am: Add new files to build.

	* src/file-manager/fm-properties-window.c:
	(value_field_update_internal): New function, contains code
	formerly in value_field_update but takes boolean to handle
	ellipsized case.
	(value_field_update): Now just a simple wrapper for
	value_field_update_internal for the non-ellipsized case.
	(ellipsizing_value_field_update): New function, simple wrapper
	for value_field_update_internal for the ellipsized case.
	(attach_label): added an ellipsize_text boolean to this
	bottleneck function.
	(attach_value_label), (attach_title_field): pass FALSE for 
	ellipsize_text to attach_label
	(attach_ellipsizing_value_label): new function, pass TRUE for
	ellipsize_text to attach_label
	(attach_value_field_internal): New function, contains code
	formerly in attach_value_field but takes boolean to handle
	ellipsized case.
	(attach_value_field): Now just a simple wrapper for
	attach_value_field_internal for the non-ellipsized case.
	(attach_ellipsizing_value_field): New function, simple wrapper for
	attach_value_field_internal for the ellipsized case.
	(attach_option_menu): Don't use GTK_EXPAND, so option menu gets no
	wider than it needs to be.
	(append_separator): Don't use GTK_EXPAND, so the presence of
	separators doesn't cause table columns to stretch.
	(append_title_and_ellipsizing_value): New function, like
	append_title_value_pair but uses ellipsizing label.
	(create_basic_page): Change gtk_table_attach options for icon
	and name field so that they don't cause table columns
	to stretch.

2001-01-25  Arik Devens  <arik@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 5490, Preferences dialog "OK" button does not work when
	preferences window content is clipped:
	
	* libathena-extensions/athena-preferences-dialog.c
	(athena_preferences_dialog_construct): Temporary fix by removing
	the dialogs usize and letting it resize itself based on
	content. The longer fix is detailed in #5627.

2001-01-25  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-thumbnails.c:
	(make_thumbnail_path):
	fixed bug 5817, removing the extension from images makes their
	thumbnails show up.  Fixed by correcting where it tests for the
	presence of an extension in make_thumbnail_path by only looking
	for periods in the leaf part of the path instead of in the
	entire path.
	
2001-01-25  Darin Adler  <darin@eazel.com>

	* README: Add missing xml-i18n-tools to list of modules
	needed to build from cvs.

2001-01-25  Laszlo Kovacs  <laszlo.kovacs@sun.com>

	* break in Eazel-hacking build when Scrollkeeper is
	  enabled inside the Athena component is fixed now

2001-01-25  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Tweaked the recent menu-updating speedup.

	* src/file-manager/fm-directory-view.c:
	(remove_update_menus_timeout_callback): New helper function,
	removes timeout callback if non-zero.
	(fm_directory_view_destroy): Use helper function where it was
	calling the guts directly.
	(update_menus_if_pending): New function, does nothing if
	no menu update is pending, otherwise removes callback and
	does an update now.
	(fm_directory_view_pop_up_selection_context_menu),
	(fm_directory_view_pop_up_background_context_menu): Use
	update_menus_if_pending instead of directly updating. This both
	avoids an unnecessary update if none is pending and prevents an 
	unnecessary future update is one is pending.

2001-01-25  Laszlo Kovacs  <laszlo.kovacs@sun.com>

	* added various changes to the hyperbola component,
	  some of these are Scrollkeeper related and disabled
	  as Scrollkeeper is not in Eazel-hacking yet
	  Scrollkeeper related changes:
	    - remove empty branches for Scrollkeeper generated
	      category tree
	    - remove old way of populating of the Applications
	      branch with the Gnome help docs
	    - fixing bug in code that goes around alphabetical
	      ordering of section titles 
	  Not Scrollkeeper related changes:
	    - fix in manpath handling when looking for man pages
	      and manpath does not return anything
	    - fix in title extraction from man page names
	    - moving all the Man pages below the Manuals branch
	      (in pages.map)

2001-01-25  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied):
	Changed a return from TRUE to FALSE (also in PR3 branch)

2001-01-25  Eskil Heyn Olsen  <eskil@eazel.com>

	These are some recent PR3 fixes
	Bug 6009, 5978 and 5979
	
	* components/services/install/command-line/eazel-test-packsys.c:
	(test_is_installed), (main):
	Code to test changes made to eazel_package_system_is_installed.
	
	* components/services/install/lib/Makefile.am:
	Fix for 5978.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new), (make_rpm_argument_list),
	(monitor_rpm_process_pipe_percent_output),
	(rpm_packagedata_fill_from_file),
	(eazel_package_system_rpm3_install_uninstall):
	Fix for 5978 and 5979
	
	* components/services/install/lib/eazel-package-system-rpm4.c:
	Fix for 5978
	
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_finalize):
	See bug 6007
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_matches_versioning),
	(eazel_package_system_is_installed):
	Fix for 6009
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_update_from_uri):
	Removed debug output
	
	* configure.in:
	Fix for 5979

2001-01-24  Dan Mueth <dan@eazel.com>

	* user-guide/gnufdl: Adding this directory for the GNU FDL.  
	  This is a temporary solution.  When GNOME 1.4 is out, we
	  will have gnome-core installing 'fdl' and we will point to
	  that instead of 'gnufdl'.
	* user-guide/C/: Removing old docs stuff, and adding Vera's
	  new docs.

Wed Jan 24 21:21:52 2001  George Lebl <jirka@5z.com>

	Maciej (mjs@eazel.com) approved this, so blame him if this makes
	hair grow on the palms of your hands or gives your dog headaches

	* components/adapter/athena-adapter-control-embed-strategy.c
	  (athena_adapter_control_embed_strategy_new): Unref the zoomable
	  interface after a query interface.  Fixes bug #5966

	* components/image-viewer/athena-image-view.c
	  (control_destroy_callback): take out the FIXME.

2001-01-24  Pavel Cisler  <pavel@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_destroy),
	(schedule_update_menus):
	A simple tweak to reduce the number of menu item updates --
	schedule fm_directory_view_update_menus using a gtk_timeout_add
	instead of gtk_idle_add, use a 300 ms interval for coalescing
	menu item updates.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_pop_up_selection_context_menu),
	(fm_directory_view_pop_up_background_context_menu):
	Call fm_directory_view_update_menus directly to make sure the
	context menu comes up set up right instead of flickering.

2001-01-24  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 5710, Images no longer snap to size after hitting Refresh
	
	* components/image-viewer/athena-image-view.c: (redraw_control),
	(load_image_from_stream), (scrolled_window_size_allocate_callback):
	Restore the previous zoom setting when reloading a file from a stream.
			
	Fixed a logic flaw dealing with renaming AthenaLinks.  The icon view
	had duplicated some logic that was present in AthenaFile.  There were
	slight differences in the logic that lead to some confusion in determing
	if a link could be renamed.
	
	* libathena-extensions/athena-file.c:
	(athena_file_can_rename):
	* src/file-manager/fm-icon-view.c: (fm_icon_view_update_menus):

2001-01-24  Andy Hertzfeld  <andy@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/athena-window-menus.c: (get_static_bookmarks_file_path):
	fixed bug 5985, we should use timestamps to determine which
	static bookmarks file to use; now it does.
	
2001-01-24  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Eskil Olsen  <eskil@eazel.com>

	* Makefile.am:
	Add Makefile.shared to EXTRA_DIST.
	
2001-01-24  Michael Engber  <engber@eazel.com>

	reviewed by: Ramiro Estrugo

	* components/music/athena-music-view.c: (add_play_controls):
	Set alignment of playtime so it's flush left, otherwise it jumps
	around slightly.

2001-01-24  Josh Barrow  <josh@eazel.com>

	* icons/i-directory-192.png:
	Removed this file.  This was one of the old GNOME icons, and it
	was no longer in use.

2001-01-24  Michael Engber  <engber@eazel.com>

	reviewed by: Ramiro Estrugo

	* components/music/athena-music-view.c:
	(athena_music_view_initialize), (add_play_controls):
	Removed a call to problematic call to gtk_widget_set_usize
	and added FIXMEs for the remaining calls to it - bug 5967.

2001-01-24  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 5797 (Critical received when double-clicking on throbber):

	* src/athena-window-private.h:
	* src/athena-window.c: (location_change_at_idle_callback):
	Callback to do actual location change at idle time instead of
	right inside the property bag callback from the throbber.
	(throbber_location_change_request_callback): Use the new idle
	approach instead of changing the location right away.
	(athena_window_destroy): Cancel the idle if it's still
	outstanding.

	* libathena-extensions/athena-file.c:
	(athena_file_get_string_attribute_with_default): Mark a string
	for translation.
	(get_description): Mark some warning strings for translation since
	they are warnings we think real users might see.

	* applets/launcher/.cvsignore:
	* applets/preferences-applet/.cvsignore:
	Ignore some files.
	
2001-01-24  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: athena-suggested now requires
	mozill-psm and mozilla-mail, updated version
	required for serveral packages.

2001-01-24  Ramiro Estrugo  <ramiro@eazel.com>

	* data/static_bookmarks.xml:
	A tiny fix from Brian Frank.  Also, save the file as a regular
	text file without the DOS extra CRs.

	* src/athena-sidebar-title.c:
	(sidebar_title_create_title_label),
	(sidebar_title_create_more_info_label): Center justify the sidebar
	title labels.
	
2001-01-24  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c:
	(athena_property_browser_initialize), (make_category_link):
	removed some set_usize calls that I had only commented out before.
	
2001-01-24  Darin Adler  <darin@eazel.com>

	* AUTHORS:
	* THANKS:
	* src/athena-window-menus.c: (help_menu_about_athena_callback):
	Updated based on recent check-ins and other contributions.

	* check-THANKS.pl: Updated to check the about list against the
	AUTHORS file and to fix some other things.

	* libathena/athena-view-component.idl: Fix a comment and
	remove a stray empty line.

2001-01-24  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/launcher/athena-launcher-applet.c: (create_pixbufs),
	(applet_change_pixel_size), (image_enter_event),
	(image_leave_event), (get_root_window),
	(window_set_cursor_for_state), (set_is_launching),
	(get_is_launching), (image_button_press_event),
	(image_button_release_event), (event_filter),
	(root_listen_for_property_changes), (main):
	Backout some dumb changes that i stupidly checked in.
	
2001-01-23  Michael Engber  <engber@eazel.com>

	reviewed by: George Lebl

	* components/image-viewer/athena-image-view.c:
	(control_destroy_callback), (control_factory_common):
	image-view was using freed (widget) memory.

2001-01-24  Andy Hertzfeld  <andy@eazel.com>

	removed files that I inadvertently checked in to the
	wrong branch.
	
	* components/rss-control/.cvsignore:
	* components/rss-control/Makefile.am:
	* components/rss-control/main.c:
	* components/rss-control/athena-rss-control.c:
	* components/rss-control/athena-rss-control.h:
	* components/rss-control/athena-rss-control.oafinfo:
	* data/top/Clock:
	* data/top/Slashdot:

2001-01-23  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-theme-selector.c: (remove_button_callback),
	(exit_remove_mode):
	fixed recently introduced problem where it was still
	treating button labels as athena_labels instead of
	gtk_labels.
	
2001-01-23  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize), (remove_button_callback),
	(exit_remove_mode):
	fixed bug 5972, remove theme button uses aa text, by using
	a gtk_label instead of a athena_label.
		
	* libathena-extensions/athena-theme.c:
	(athena_theme_make_selector):
	fixed a crash when an installed theme lacked a preview icon,
	cleaned up code and fixed a memory leak.

2001-01-23  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Partial fix for bug 5902 (Rapidly changing between Icon and
	Image/Text crashes Athena).

	* src/athena-view-frame.c:
	(athena_view_frame_load_client_async),
	(athena_view_frame_load_client),
	(athena_view_frame_stop_activation),
	(athena_view_frame_load_location),
	(athena_view_frame_stop_loading),
	(athena_view_frame_selection_changed),
	(athena_view_frame_title_changed),
	(athena_view_frame_is_zoomable),
	(athena_view_frame_get_zoom_level),
	(athena_view_frame_set_zoom_level),
	(athena_view_frame_get_min_zoom_level),
	(athena_view_frame_get_max_zoom_level),
	(athena_view_frame_get_has_min_zoom_level),
	(athena_view_frame_get_has_max_zoom_level),
	(athena_view_frame_get_is_continuous),
	(athena_view_frame_get_preferred_zoom_levels),
	(athena_view_frame_zoom_in), (athena_view_frame_zoom_out),
	(athena_view_frame_zoom_to_fit),
	(athena_view_frame_open_location_in_this_window),
	(athena_view_frame_open_location_prefer_existing_window),
	(athena_view_frame_open_location_force_new_window),
	(athena_view_frame_report_selection_change),
	(athena_view_frame_report_status),
	(athena_view_frame_report_load_underway),
	(athena_view_frame_report_load_progress),
	(athena_view_frame_report_load_complete),
	(athena_view_frame_report_load_failed),
	(athena_view_frame_set_title), (athena_view_frame_get_title),
	(athena_view_frame_get_label), (athena_view_frame_set_label),
	(athena_view_frame_activate), (get_history_list),
	(send_history),
	(athena_view_frame_get_is_underway): Silently do nothing if the
	view frame has failed. Based on suggestions from Darin. Also
	includes return_if_fail fixes from Darin.

2001-01-23  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (md5_check_failed), (delete_files):
	Changed output in md5_failed to be readable.
	Only ask about deleting files if any where downloaded (the check
	was commented out for some reason)

	* components/services/install/command-line/eazel-test-packsys.c:
	(test_package_load), (test_query), (test_query_owns_mem),
	(is_installed), (test_install), (test_uninstall), (test_verify),
	(main):
	s/packagedata_destroy/gtk_object_unref/ - eazel-test-packsys now
	no longer leaks packagedata objects.

	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_md5_check_failed):
	Removed an debug output.

	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied), (is_satisfied_features):
	(check_dependencies_foreach), (check_dependencies):
	Fixed nasty bug that caused the install service to loop on some
	packages that have circular dependency (found by Ken).	

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_install_parse_uri),
	(athena_service_install_view_update_from_uri):
	Fixed the port thing again (should fix 5960)

2001-01-23  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/Makefile.am:
	* applets/launcher/Makefile.am:
	* applets/launcher/athena-launcher-applet.c: (button_toggled),
	(show_desktop_changed_callback), (delete_event), (main):
	* applets/launcher/athena-launcher-applet.gnorba:
	* applets/preferences-applet/Makefile.am:
	* applets/preferences-applet/athena-preferences-applet.c:
	(accept_all_cookies), (preference_toggle_destroy_callback),
	(boolean_preference_changed_callback), (button_toggled),
	(boolean_toggle_button_new), (main):
	* applets/preferences-applet/athena-preferences-applet.gnorba:
	* configure.in:
	A very simple applet to debug show desktop and smooth graphics
	preferences.
	
2001-01-23  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-directory-background.c:
	(theme_image_path_to_uri):
	fixed bug 5908, assert hit when background pattern is deleted, by
	testing explicitly for the file missing and returning NULL in that
	case instead of asserting.
	
2001-01-23  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 2153 (deep count calculation in properties window
	could be faster)

	Fixed bug 5687 (Sidebar flickers and CPU thrashes during
	deep count calculation in properties window)

	Changed the deep count calculation to send a specialized
	signal when the in-progress count updates, instead of using
	"file_changed", since many parts of the UI react to file_changed
	by doing (in this case unnecessary) work. My stopwatch measurement
	on a large directory showed that the time to calculate 20000
	contained files went from 147 seconds to 8 seconds, and the CPU
	usage pegged around 15% (formerly 100%).

	* libathena-extensions/athena-directory-async.c:
	(deep_count_callback): Call athena_file_changed only when
	count is finished; call athena_file_updated_deep_count_in_progress
	after every new higher value is computed.
	
	* libathena-extensions/athena-file-private.h:
	Added prototype for athena_file_updated_deep_count_in_progress.
	
	* libathena-extensions/athena-file.h:
	* libathena-extensions/athena-file.c:
	(athena_file_initialize_class): define "updated_deep_count_in_progres"
	signal.
	(athena_file_updated_deep_count_in_progress): send this new signal
	for this file (which must be a directory) and any links pointing to
	it.
	
	* src/file-manager/fm-properties-window.c:
	(attach_directory_contents_value_field): Make text field in properties
	window react to new signal instead of "changed".

2001-01-23  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5959 (File name in "no applications available"
	dialog should be in quotes)

	* libathena-extensions/athena-program-chooser.c:
	(athena_program_chooser_show_no_choices_message):
	Put quotes around file name in dialog.

2001-01-23  Andy Hertzfeld  <andy@eazel.com>

	* components/hardware/athena-hardware-view.c:
	(hardware_view_load_location_callback):
	fixed bug 5746, hardware title in hardware view not translated, by
	explicitly setting the title using a localized string.  This also
	fixes the minor problem of the title not being capitalized
	
	* icons/villanova/villanova.xml:
	fixed bug 5658, Sierra theme lacks description, by adding a
	description to the xml file.
	
2001-01-23  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c:
	(athena_property_browser_initialize), (make_category_link):
	fixed bug 5587, hard-coded button geometry in the property browser,
	fixed by removing the set_usizes and allowing gtk to adaptively
	size them and replacing the table that was holding them with a
	box so they will be centered properly.
	
2001-01-23  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fixed bug 5943 (Throbber crashes on athena startup (crashing
	Athena) with some themes and configurations)

	* components/help/hyperbola-main.c: (main):
	* components/image-viewer/athena-image-view.c:
	(init_server_factory):
	* components/mozilla/main.c: (main):
	* components/music/main.c: (main):
	* components/notes/athena-notes.c: (main):
	* components/services/install/athena-view/main.c: (main):
	* components/services/login/athena-view/main.c: (main):
	* components/services/summary/athena-view/main.c: (main):
	* components/shell/shell.c:
	* components/text/main.c: (main):
	* components/throbber/main.c: (main):
	* components/tree/main.c: (main):
	* libathena/athena-view-standard-main.c:
	(athena_view_standard_main_multi):
	* athena-installer/src/main.c: (main):
	* src/athena-main.c: (main): Added gdk_rgb_init calls. The
	throbber one was causing a real 100% reproducible crash for me on
	Athena startup, the rest are pre-emptive.

2001-01-23  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: changed mozilla required version
	to 0.7 this messes upgrades since 0.7 is lower than M18

2001-01-23  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize):
	Band aid fix for bug 5910 - Font size for Theme name is too large
	in "Athena Theme Selector" dialog.  I made the column larger to
	fit up to and including the length of the currently largest known
	theme name "Crux-Eggplant"

	There are many reason why this is a lame band aid fix.  The real
	fix is to not hard code any geometry in this code.  I filed a bug
	for that (5951).
	
2001-01-22  Andy Hertzfeld  <andy@eazel.com>

	* data/browser.xml:
	fixed typo in "terracotta" pattern name that caused it not to be
	capitalized in the property browser.
	
2001-01-22  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line), (something_failed):
	Removed the --port argument (since --server is now in server:port
	form).
	Removed --tmp as you shouldn't set it anymore.
	Rename --noauth to --no-auth and --ssl_rename to --ssl-rename.
	Default behaviour is now that no server or no-auth argument causes
	eazel-install to use trilobite server setting and proxy. --no-auth
	just uses trilobite server and no proxy, --server sets the server
	and no proxy.
	Changed output in something_failed.
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_start_signal), (eazel_install_failed_signal):
	Don't emit progress in uninstall (since the EazelInstall object
	didn't have them, I was currently emitting install progress
	signals)	
	Only emit failed signals on the toplevel.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), (get_softcat_info),
	(is_satisfied):
	More ifdeffed debug.
	Uncommented a commented out gtk_object_unref.
	Commented out a unref and emit_failed, since the pruner is doing
	this.
	In is_satisifed, if no version in dep, check if package is
	installed before checking features list. Faster and safer.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(make_rpm_argument_list),
	(monitor_rpm_process_pipe_percent_output),
	(monitor_rpm_process_pipe), (eazel_package_system_rpm3_execute):
	Some ifdeffed code for --percent handling.
	Set go==FALSE in execute if root helper fails (fixes a bug where
	the installer would hang if wrong password was entered).
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_update_from_uri):
	Default to port 80 if trilobite_get_services_address did not
	include a port.
	
2001-01-22  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 5914 - First run of Athena on clean system crashes.
	
	* src/athena-application.c: (athena_application_initialize),
	(athena_application_destroy), (athena_application_startup):
	Add the preference callback for show_desktop much later in the
	initialization of the Athena Application.  Otherwise, the first
	time druid triggers prefernece changes that cause the desktop to
	turn on in the middle of the first time druid being presented to
	the user.
	
2001-01-22  Rebecca Schulman  <rebecka@eazel.com>

	* libathena-extensions/athena-search-uri.c:
	(athena_self_check_search_uri):
	Fixed "make check."  Oh, the woes.
	Earlier I removed a field from a struct in
	athena-search-uri and broke binary compatibility
	between the many mysterious structs here.  It seems
	they all must be the same size.
	Added a fixme so that we know this in the future,
	hopefully.  Also added an additional test during
	debugging.

2001-01-22  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar-tabs.c: (draw_one_tab_themed),
	(draw_or_layout_all_tabs):
	fixed bug 5895, critical errors when you make the sidebar small.
	Fixed by clipping the amount we draw to fit within the destination
	buffer before calling gdk_pixbuf_composite.  Also fixed another crash
	when trying to draw aa-text for the tab labels when the starting
	offset is bigger than the buffer; in that case, don't draw anything.
	
2001-01-22  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/Makefile.am:
	Dumshit me, forgot to checkin the Makefile.
	
2001-01-22  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	Removed C++ style comments from copied code

2001-01-22  Michael Engber  <engber@eazel.com>

	reviewed by: Ramiro Estrugo

	* libathena-extensions/athena-directory-background.c:
	(desktop_background_realized),
	(athena_connect_desktop_background_to_file_metadata),
	(image_loading_done_callback),
	(athena_connect_background_to_file_metadata):
	Desktop backgrounds were being drawn before they were initialized.
	Bugs 5853 & 5896.

2001-01-22  Rebecca Schulman  <rebecka@eazel.com>
       Fix bug 5316, that search results code has
	empty strings marked for translation.

	* libathena-extensions/athena-search-uri.c: (parse_uri):
	Remove "prefixes" for search criteria that were
	always blank.

2001-01-22  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 5831 - Clipping problems in summary view draing scrollable
	labels.
	
	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-viewport.c:
	(athena_viewport_initialize_class),
	(athena_viewport_initialize), (athena_viewport_draw),
	(athena_viewport_paint), (athena_viewport_new):
	* libathena-extensions/athena-viewport.h:
	New files.  A sublcass of GtkViewport that takes into account the
	width and height of the widget style xthickness and ythickness
	when painting.

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form):
	Use AthenaViewport instead of GtkViewport to avoid clipping
	problems when painting labels inside scrollable viewports.

2001-01-22  Josh Barrow  <josh@eazel.com>

	* icons/crux_eggplant/.cvsignore:
	* icons/crux_eggplant/backgrounds/.cvsignore:
	* icons/crux_eggplant/sidebar_tab_pieces/.cvsignore:
	* icons/crux_eggplant/throbber/.cvsignore:

	Make CVS shutup.

2001-01-22  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(mozilla_dom_key_press_callback),
	(mozilla_dom_mouse_click_callback):

	Bug 5905: Softcat Search button doesn't work.

	I don't know when this stopped working but maybe it was while I
	was dorking with the key-initiated-navigation.

	Anyway, I polished stuff up to use the real constants for indicating
	to Moz whether to handle events or not.  This problem went away and
	everything else seemed to continue to work as expected.
	
2001-01-22  Stanislav Brabec  <utx@penguin.cz>

	* configure.in: Added support for db1 emulation in Berkeley DB3.
	DB3 needs --enable-compat185.

	* README: Describe solutions of linking errors with mozilla libs
	(partially copied from Galeon's FAQ).

2001-01-22  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: upped version to 0.8.1 to be higher
	than branch 

2001-01-22  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix 5613 - Icon captions in sidebar get cropped when toggling
	"smooth graphics.
	
	* libathena-extensions/athena-label.c:
	(label_force_cached_requisition_flush),
	(athena_label_set_is_smooth):
	Flush the GtkLabel's requisition cache when the is_smooth
	attribute is changed.
	
	* src/athena-property-browser.c:
	(athena_property_browser_initialize),
	(athena_property_browser_destroy),
	(athena_property_browser_theme_changed):
	Remove attempt at fixing parts of 5613.  The fix above should fix
	it everywhere.
	
2001-01-22  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com> (except
	fix for bug 5884, which nobody reviewed)

	Fixed bug 5766 (assertion when switching views)
	Fixed bug 5884 (Rename file dialog for missing file
	quotes intended name rather than current)

	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_get_default_action_type_for_file),
	(athena_mime_get_default_action_for_file),
	(athena_mime_get_default_application_for_file_internal),
	(athena_mime_get_default_component_for_file_internal),
	(athena_mime_get_short_list_applications_for_file),
	(athena_mime_get_short_list_components_for_file),
	(athena_mime_get_short_list_methods_for_file),
	(athena_mime_get_all_applications_for_file),
	(athena_mime_get_all_components_for_file):
	These functions were all using return_val_if_fail if
	athena_mime_actions_check_if_minimum_attributes_ready
	returned FALSE. In keeping with the style used in
	AthenaFile, changed these to check and return, but
	not complain, in these cases where the answer is
	"not enough info yet". I did not change the setters;
	they still complain.

	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file): Use "original_name" instead
	of "new_name" in error message.

2001-01-22  Rebecca Schulman  <rebecka@eazel.com>
        Fix bugzilla.eazel.com bug 2659, that behavior
	with backup search is inconsistent, because content
	backup searches are unavailable.  

	* src/file-manager/fm-search-list-view.c: (load_location_callback),
	(load_error_callback), (display_indexed_search_problems_dialog):
	Add checks to handle both the case where the indexed search is not
	available and the case where a backup search is not available.
	Explain why an index search cannot be performed, and also if
	applicable why a backup search can't be performed.
	* src/file-manager/athena-indexing-info.c:
	(athena_indexing_info_get_last_index_time):
	Return NULL if there are no indices, instead of 
	the timestring for time = 0.

2001-01-22  Arlo Rose  <arlo@eazel.com>

	* data/patterns/Makefile.am:
	Missed a file!

2001-01-22  Arlo Rose  <arlo@eazel.com>

	* data/browser.xml:
	* data/patterns/brushed_metal.png:
	* icons/default.xml:
	Added new background pattern for the "Default" theme.
	I also let it show up in the normal pattern dialog
	as well.

2001-01-22  Arlo Rose  <arlo@eazel.com>

	* icons/crux_eggplant/crux_eggplant.xml:
	Changed selection rectangle

2001-01-22  Robey Pointer  <robey@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_download_progress), (impl_download_failed):
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_from_packagedata):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_fetch_remote_package_list),
	(eazel_install_emit_download_progress),
	(eazel_install_emit_download_progress_default),
	(eazel_install_emit_download_failed),
	(eazel_install_emit_download_failed_default):
	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file), (ftp_fetch_remote_file),
	(gnome_vfs_xfer_callback), (gnome_vfs_fetch_remote_file),
	(local_fetch_remote_file), (eazel_install_fetch_file),
	(eazel_install_fetch_package):
	* components/services/install/lib/eazel-install-protocols.h:
	* components/services/install/lib/eazel-install-public.h:

	Change the download_progress and download_failed signals to pass a
	PackageData struct (and not a char*) just like every other signal,
	now that we can do that.  Fix a missing bytesize fill-in in one of
	the corba conversion functions.  Also, make the non-slim build use
	the file-rename trick from the bootstrap installer, to ensure that
	uncompleted downloads are never treated like valid package files.
	
	* components/rpmview/athena-rpm-view-install.c:
	(athena_rpm_view_download_progress_signal),
	(athena_rpm_view_download_failed):
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_download_progress_signal), (download_failed),
	(something_failed):

	Fix rpm view and command-line install to use the new download
	signal signatures.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_downloading),
	(athena_service_install_preflight_check),
	(athena_service_install_download_failed),
	(athena_service_install_installing),
	(athena_service_install_done),
	(athena_service_install_view_update_from_uri):

	Use the new download signal signatures to draw a nifty progress
	bar for the overall download (where 90% of most users' time will
	be spent in this view).  Scale the progress bar to match the
	package files' expected sizes (softcat bug to be fixed in 1.0).
	Leave the throbber on during the downloads so they can be
	aborted.  Don't offer to erase rpms if the package was already
	installed (and therefore not downloaded).

2001-01-22  Arlo Rose  <arlo@eazel.com>

	A whole mess of files checked in to add a new color variation
	of Crux.  I'm not happy with the folders... I may need to tint
	them later.
	
	* configure.in:
	* icons/Makefile.am:
	* icons/arlo/arlo.xml:
	* icons/crux_eggplant/Back.png:
	* icons/crux_eggplant/Forward.png:
	* icons/crux_eggplant/Home.png:
	* icons/crux_eggplant/Makefile.am:
	* icons/crux_eggplant/Refresh.png:
	* icons/crux_eggplant/Search.png:
	* icons/crux_eggplant/SearchWeb.png:
	* icons/crux_eggplant/Stop.png:
	* icons/crux_eggplant/Up.png:
	* icons/crux_eggplant/backgrounds/Makefile.am:
	* icons/crux_eggplant/backgrounds/background_pattern.png:
	* icons/crux_eggplant/backgrounds/window_pattern.png:
	* icons/crux_eggplant/crux_eggplant.xml:
	* icons/crux_eggplant/decrement-i.png:
	* icons/crux_eggplant/decrement.png:
	* icons/crux_eggplant/emblem-nowrite-72.png:
	* icons/crux_eggplant/emblem-nowrite-96.png:
	* icons/crux_eggplant/emblem-nowrite.png:
	* icons/crux_eggplant/i-directory-192-aa.png:
	* icons/crux_eggplant/i-directory-72-aa.png:
	* icons/crux_eggplant/i-directory-72.png:
	* icons/crux_eggplant/i-directory-96-aa.png:
	* icons/crux_eggplant/i-directory-aa.png:
	* icons/crux_eggplant/i-directory.png:
	* icons/crux_eggplant/i-directory.xml:
	* icons/crux_eggplant/i-regular-192-aa.png:
	* icons/crux_eggplant/i-regular-192.png:
	* icons/crux_eggplant/i-regular-72-aa.png:
	* icons/crux_eggplant/i-regular-72.png:
	* icons/crux_eggplant/i-regular-96-aa.png:
	* icons/crux_eggplant/i-regular-96.png:
	* icons/crux_eggplant/i-regular-aa.png:
	* icons/crux_eggplant/i-regular.png:
	* icons/crux_eggplant/i-regular.xml:
	* icons/crux_eggplant/increment-i.png:
	* icons/crux_eggplant/increment.png:
	* icons/crux_eggplant/number_strip.png:
	* icons/crux_eggplant/sidebar_tab_pieces/Makefile.am:
	* icons/crux_eggplant/sidebar_tab_pieces/fill-active-prelight.png:
	* icons/crux_eggplant/sidebar_tab_pieces/fill-active.png:
	* icons/crux_eggplant/sidebar_tab_pieces/fill-empty-space.png:
	* icons/crux_eggplant/sidebar_tab_pieces/fill-prelight.png:
	* icons/crux_eggplant/sidebar_tab_pieces/fill.png:
	* icons/crux_eggplant/sidebar_tab_pieces/left-bumper-active-preligh
	t.png:
	* icons/crux_eggplant/sidebar_tab_pieces/left-bumper-active.png:
	* icons/crux_eggplant/sidebar_tab_pieces/left-bumper-prelight.png:
	* icons/crux_eggplant/sidebar_tab_pieces/left-bumper.png:
	* icons/crux_eggplant/sidebar_tab_pieces/middle-normal-normal.png:
	* icons/crux_eggplant/sidebar_tab_pieces/middle-normal-prelight.png
	:
	* icons/crux_eggplant/sidebar_tab_pieces/middle-prelight-normal.png
	:
	* icons/crux_eggplant/sidebar_tab_pieces/right-bumper-prelight.png:
	* icons/crux_eggplant/sidebar_tab_pieces/right-bumper.png:
	* icons/crux_eggplant/sidebar_tab_pieces/right-empty-space.png:
	* icons/crux_eggplant/sidebar_tab_pieces/right-top-active-prelight.
	png:
	* icons/crux_eggplant/sidebar_tab_pieces/right-top-active.png:
	* icons/crux_eggplant/sidebar_tab_pieces/right-top-prelight.png:
	* icons/crux_eggplant/sidebar_tab_pieces/right-top.png:
	* icons/crux_eggplant/theme_preview.png:
	* icons/crux_eggplant/throbber/001.png:
	* icons/crux_eggplant/throbber/002.png:
	* icons/crux_eggplant/throbber/003.png:
	* icons/crux_eggplant/throbber/004.png:
	* icons/crux_eggplant/throbber/005.png:
	* icons/crux_eggplant/throbber/006.png:
	* icons/crux_eggplant/throbber/007.png:
	* icons/crux_eggplant/throbber/008.png:
	* icons/crux_eggplant/throbber/009.png:
	* icons/crux_eggplant/throbber/010.png:
	* icons/crux_eggplant/throbber/011.png:
	* icons/crux_eggplant/throbber/012.png:
	* icons/crux_eggplant/throbber/013.png:
	* icons/crux_eggplant/throbber/014.png:
	* icons/crux_eggplant/throbber/015.png:
	* icons/crux_eggplant/throbber/016.png:
	* icons/crux_eggplant/throbber/017.png:
	* icons/crux_eggplant/throbber/018.png:
	* icons/crux_eggplant/throbber/019.png:
	* icons/crux_eggplant/throbber/020.png:
	* icons/crux_eggplant/throbber/021.png:
	* icons/crux_eggplant/throbber/022.png:
	* icons/crux_eggplant/throbber/023.png:
	* icons/crux_eggplant/throbber/024.png:
	* icons/crux_eggplant/throbber/025.png:
	* icons/crux_eggplant/throbber/026.png:
	* icons/crux_eggplant/throbber/027.png:
	* icons/crux_eggplant/throbber/028.png:
	* icons/crux_eggplant/throbber/Makefile.am:
	* icons/crux_eggplant/throbber/rest.png:
	* icons/crux_eggplant/zoom_body.png:
	* athena.spec.in:

2001-01-22  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-drag.c:
	(athena_drag_default_drop_action_for_icons):
	Switch the order of the arguments to
	gnome_vfs_check_same_fs_uris so that
	the source uri is first and the target uri
	of the drag second. This is rest of the fix 
	for bugzilla.eazel.com 5498, which necessitated
	making the uri arguments to this function have
	a required ordering.

2001-01-21  Andy Hertzfeld  <andy@eazel.com>

	* data/browser.xml:
	* data/patterns/Makefile.am:
	* data/patterns/50s.png: removed
	* data/patterns/blue_ridge.png: added
	* data/patterns/blue_type.png: added
	* data/patterns/camouflage.png: modified
	* data/patterns/countertop.png: added
	* data/patterns/dots.png: added
	* data/patterns/fibers.png: added
	* data/patterns/floral.png: added
	* data/patterns/fossil.png: added
	* data/patterns/green_weave.png: added
	* data/patterns/moss_ridge.png: added
	* data/patterns/ocean_stripes.png: added
	* data/patterns/purple_marble.png: added
	* data/patterns/rough_paper.png: modified
	* data/patterns/sky_ridge.png: added
	* data/patterns/snow_ridge.png: added
	* data/patterns/terracotta.png: added
	* data/patterns/white_ribs: removed
	
	added, renamed and modified patterns to replace the recently
	deleted ones.
	
2001-01-21  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <arik@gnome.org> (Wincing)
	
	Bug 5625: Fonts were incorrect size.
	Bug 5872: HTTP proxy setting and auto-detect broken due to preference
	changes.

	* src/athena-first-time-druid.c:
	(make_hbox_user_level_radio_button), (set_up_user_level_page),
	(set_up_service_signup_page), (set_up_update_page),
	(proxy_address_entry_key_press), (set_up_proxy_config_page),
	(set_up_update_feedback_page), (initiate_file_download),
	(set_http_proxy):

2001-01-21  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 5809 - Athena is slow to startup because of prefernces
	setup code.  The reason for the slowdown was the constant
	suggestion to gconf to sync.  Now, we sync only after setters that
	ara result of an operation in Athena.  All internal setters, such
	as defaults and visibilities happen with no sync in between each
	one, making things a lot faster.

	* libathena-extensions/athena-gconf-extensions.c:
	(athena_gconf_set_boolean), (athena_gconf_set_integer),
	(athena_gconf_set_string), (athena_gconf_set_string_list),
	(athena_gconf_monitor_directory), (athena_gconf_suggest_sync):
	* libathena-extensions/athena-gconf-extensions.h:
	Dont suggest a sync after each set.  Instead make a new function
	to let callers decide when to suggest a sync.  For example, after
	a batch of many operations.
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_get_dialog),
	(global_preferences_install_sidebar_panel_defaults),
	(global_preferences_install_sidebar_panel_descriptions),
	(global_preferences_install_home_location_defaults),
	(athena_global_preferences_initialize):
	Don't install the descriptions until needed when the dialog is
	about to be created.  Split the sidebar defaults installer into a
	defaults and a descriptions installer.  Remove the proxy defaults
	installer which was superfluous.  My last change simplified the
	usage of proxy settings and a whole separate function for that is
	no longer needed.
	
	* libathena-extensions/athena-preferences.c:
	(athena_preferences_set_boolean),
	(athena_preferences_set_integer), (athena_preferences_set),
	(athena_preferences_set_string_list),
	(athena_preferences_set_user_level):
	Suggest a gconf sync right after all the setters.
	(preferences_something_changed_notice): Add a fixme.  Also remove
	unused variables and tweak a tiny bit.

2001-01-21  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/Makefile.am:
	Generate eazel-test-install-types instead of eazel-test-types.

	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages), (check_feature_consistency)
	(do_file_conflict_check), (install_packages):
	Fixed 4589.
	Ensure nulling and freeing of packages list in pruner if 0 
	elements left after prune.

	* components/services/install/server/main.c: (main):
	Some commented out debug code to enable dropping to gdb 
	on glib warnings.

2001-01-21  Andy Hertzfeld  <andy@eazel.com>

	removed the "vector" theme at Arlo's request, and many of the
	least popular patterns
	
	* configure.in:
	removed vector from the build
	* data/browser.xml:
	* data/patterns/Makefile.am:
	removed lots of specific patterns
	* icons/Makefile.am:
	removed vector theme
	* icons/ardmore/ardmore.xml:
	* icons/gnome/gnome.xml:
	fixed bug 5868, GNOME theme has white text on light background, by
	setting the text color in the theme
	
	* icons/vector/.cvsignore:
	* icons/vector/Makefile.am:
	* icons/vector/i-directory-accept.svg:
	* icons/vector/i-directory.svg:
	* icons/vector/i-regular.svg:
	* icons/vector/i-regular.xml:
	* icons/vector/vector.xml:
	the vector theme is no more
	
	* athena.spec.in:
	removed the vector theme from the rpm spec file
	* po/POTFILES.in:
	removed the vector theme from the localized files
	
	* src/athena-property-browser.c: (make_property_tile),
	(athena_property_browser_get_category_width):
	tweaked the layout
	
	* src/athena-sidebar-title.c:
	(athena_sidebar_title_theme_changed):
	changed default shadow to 1 pixel
	
	* src/athena-theme-selector.c: (done_button_callback),
	(athena_theme_selector_initialize):
	added a done button like the property browser
	
2001-01-20  Pavel Cisler <pavel@eazel.com>

	* Makefile.am:
	Fix Tinderbox.

2001-01-20  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c:
	(athena_property_browser_initialize), (make_property_tile),
	(athena_property_browser_update_contents):
	fixed bug 3165, Customization Dialog needs layout tweaking, by
	working with Arlo to improve it.  We also made it more GTK-theme
	compliant
	
	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize):
	Arlo and I also improved the theme selector in a similar fashion,
	including making it GTK-theme complaint.
	
2001-01-20  Kenneth Christiansen  <kenneth@gnu.org>

	* athena.desktop.in: Added new file
	The desktop file is soon going to be generated.

2001-01-19  Andy Hertzfeld  <andy@eazel.com>

	* icons/Makefile.am:
	* icons/i-symlink.png:
	* icons/i-symlink-aa.png:
	fixed bug 5107, we need a non-broken symlink icon, by adding
	new icons from Susan
	
	* icons/ardmore/ardmore.xml:
	changed name for Susan
	
	* icons/gnome/gnome.xml:
	used the blue arlo tabs in the GNOME theme
	
	* icons/villanova/Makefile.am:
	* icons/villanova/Sierra_desktop.png:
	* icons/villanova/villanova.xml:
	added tweaks from Susan
	
2001-01-19  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/main.c: (main):

	Set log handler so debug messages don't spam everywhere.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (install_message_new),
	(athena_service_install_downloading),
	(athena_service_install_preflight_check),
	(athena_service_install_done):
	* components/services/install/athena-view/athena-service-instal
	l-view.h:

	Track and report the total kB (or MB) to be downloaded during an
	install.  This is slightly off (the bytesize provided by softcat
	is very rough) but will do for now.  Better in 1.0.  Also, don't
	ask to delete RPMs when none were downloaded.
	
	* components/services/trilobite/libtrilobite/trilobite-core-messagi
	ng.c: (trilobite_add_log), (trilobite_set_log_handler):

	Allow null filehandle (no logging).

2001-01-19  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (check_md5_on_files),
	(eazel_install_check_existing_packages), (get_softcat_info),
	(is_satisfied), (is_satisfied_features), (do_file_conflict_check),
	(install_packages_helper):
	Removed old FIXME's
	Trying to fix the memory corruption wrt ->minor.
	Added more ifdefs around debug output.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_preflight_check),
	(eazel_install_emit_dependency_check):
	Do the proper thing with total_packages and total_bytes.
	Use gtk_object_unref to delete packagedata object in dep_check
	signal.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_provides):
	Parse <FEATURE> in <PROVIDES> and blurp on unknown tags.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(check_if_all_packages_seen):
	No more start and end signals around failed signals.

2001-01-11  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: added Athena_Control_throbber.oaf
	BUG 5822 - throbber not appearing in rpm builds

2001-01-19  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_load_uri),
	(mozilla_load_location_callback),
	(mozilla_location_changed_callback), (mozilla_open_uri_callback),
	(make_full_uri_from_relative), (mozilla_translate_uri_if_needed),
	(eazel_services_scheme_untranslate):

	Bug 5249 -- resolve deadlock by calling load_underway sooner in the
	case where athena directs the navigation.  (Other changes were to debug
	printfs)
	
	* components/services/install/server/main.c: (main):
	* components/services/inventory/main.c: (main):
	* components/services/summary/athena-view/main.c: (main):
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_redirect_parse_xml):

	Remove obnx debug messages

2001-01-19  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix for bug 5475 (assertion and crash trying to return using Up
	from web link):

	* libathena-extensions/athena-file.c: (get_description): Instead
	of asserting that the MIME type is not NULL or empty string, just
	change the code  to return an empty description for those cases.

	* autogen.sh: Fix one silly "ignore non-fatal errors" message.

2001-01-19  Andy Hertzfeld  <andy@eazel.com>

	* athena.spec.in:
	added the sidebar_tab_images for the default theme, which I
	forgot to add previously.
	
2001-01-19  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	(eazel_install_configure_check_jump_after_install):
	* components/services/install/lib/eazel-install-metadata.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_get_info):
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_downloading),
	(athena_service_install_dependency_check),
	(athena_service_install_preflight_check),
	(athena_service_install_done):
	* components/services/trilobite/doc/gconf.txt:
	
	Make the install view jump to the softcat page after an install
	completes.  Fix NULL-dereference crash caused by installing a
	package by id.

2001-01-19  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-directory-async.c:
	(top_left_read_callback): Change code so it doesn't send a file
	changed message and then assume nothing changed.
	
	* libathena-extensions/athena-link.c:
	(athena_link_local_get_image_uri): Handle the case where it
	can't create the directory without seg faulting.

2001-01-19  John Sullivan  <sullivan@eazel.com>

	Fixed bug 1404 (Preferences panes should be in some
	sensible order)

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_create_dialog): Reordered panes to
	match Arlo's simplest-to-least-simple design.

2001-01-19  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5830 ("Show only folders in tree" shown at
	wrong user level)

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_visibility): Made it visible
	starting at intermediate level.

2001-01-19  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 5807 (view switches to manual layout only after
	hitting Refresh), and other metadata-reading-related problems.

	This was a long-standing race condition exposed by recent 
	timing changes. The directory view was waiting for its
	metadata-as-file, but not for its metadata-as-directory, and
	it needed both before trying to lay out the contained icons.

	* src/file-manager/fm-directory-view.c: 
	added metadata_for_directory_as_file_pending and 
	metadata_for_files_in_directory_pending	to details struct.
	(load_directory): set both pending flags to TRUE before
	using call_when_ready to get metadata; use call_when_ready
	for getting contained-files metadata as well as 
	directory-as-file metadata.
	(finish_loading_if_all_metadata_loaded): New function,
	finishes loading (which lays out the icons) only if neither
	metadata is still pending.
	(metadata_for_directory_as_file_ready_callback): 
	clear metadata_for_directory_as_file_pending flag before calling 
	finish_loading_if...
	(metadata_for_files_in_directory_ready_callback): 
	clear metadata_for_files_in_directory_pending flag before calling 
	finish_loading_if... 
	(disconnect_model_handlers): cancel both metadata callbacks.

2001-01-19  Andy Hertzfeld  <andy@eazel.com>

	* athena.spec.in:

	better remove it from the spec file, too.
	
2001-01-19  Andy Hertzfeld  <andy@eazel.com>

	removed the obsolete eazel theme, as well as the old,
	non-componentized throbber.
	
	* configure.in:
	* icons/Makefile.am:
	* icons/eazel/.cvsignore:
	* icons/eazel/Makefile.am:
	* icons/eazel/eazel.xml:
	* icons/eazel/*.png:
	* icons/eazel/i-directory-accept.xml:
	* icons/eazel/i-directory.xml:
	* icons/eazel/i-regular.xml:
	* icons/eazel/sidebar_tab_pieces/.cvsignore:
	* icons/eazel/sidebar_tab_pieces/Makefile.am:
	* icons/eazel/sidebar_tab_pieces/*.png:
	* icons/eazel/throbber/.cvsignore:
	* icons/eazel/throbber/Makefile.am:
	* icons/eazel/throbber/*.png:
	* po/POTFILES.in:
	* src/athena-throbber.c:
	* src/athena-throbber.h:

2001-01-19  Mike Fleming  <mfleming@eazel.com>

	Half of bug 5975

	Now the fonts are right, but the line wrapping is busted

	* components/services/athena-dependent-shared/eazel-services-exte
	nsions.c: (eazel_services_label_new):
	* components/services/athena-dependent-shared/eazel-services-exte
	nsions.h:
	* components/services/athena-dependent-shared/eazel-services-foot
	er.c: (footer_item_new), (eazel_services_footer_update):
	* components/services/athena-dependent-shared/eazel-services-head
	er.c: (eazel_services_header_title_new):
	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_eazel_news_entry_row), (generate_update_news_entry_row):


2001-01-19  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-label.c:
	Accidentally checked in a huge default font size.
	
2001-01-19  Rebecca Schulman  <rebecka@eazel.com>

	* src/file-manager/fm-search-list-view.c:
	(display_indexed_search_problems_dialog):
	Remove extra commas that broke compilation.

2001-01-19  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(check_conflicts_against_already_installed_packages):

	Add comment about how a hack also fixes bug 5799.

	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_softpkg):

	Parse REVISION tag in softcat XML for the install lib.

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (generate_install_form), (show_overall_feedback),
	(athena_install_parse_uri), (current_progress_bar_complete),
	(athena_service_install_downloading),
	(athena_service_install_dependency_check),
	(flatten_package_tree_foreach), (flatten_package_tree),
	(athena_service_install_preflight_check),
	(athena_service_install_view_update_from_uri):

	Re-layout a little bit of the top of the install view, to make the
	overall feedback label not flicker.  Remove some redundant redraws
	that had been stuck in to work around the AthenaLabel redraw
	sizing bug.  Sneak in support for multiple packages in the eazel-
	install URI scheme.  Remove repeating package names from the final
	list during preflight.  Give some overall feedback during package
	dependency checking so the user doesn't think we're lost in space.

2001-01-19  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/file-manager/fm-search-list-view.c: (load_location_callback),
	(display_indexed_search_problems_dialog):
	Added dialogs to explain problems that may occur when running a search.
	There are separate dialogs to explain each of the following errors:
	1.  No index files available 
	2.  Index still being created
	3.  Index files are available, but the search daemon isn't running
	4.  No index files, and no reindexing service avaialble
	We may be able to actually do something about some of these 
	problems in the future (ie launch the search or indexing daemons
	if they're not already running) but for PR3 explaining what is
	going on in each of these cases should be a big step forward
	* src/file-manager/athena-indexing-info.c:
	(athena_indexing_info_show_dialog):
	Show the index files status dialog if there are index files,
	or indexing is going on, rather than if the search service
	is available, so that a user can follow indexing progress,
	even if an index isn't ready yet.

2001-01-19  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-test-packsys.c:
	(test_package_load):
	Wrote test for the fix to 5262
	
	* components/services/install/lib/eazel-install-logic.c:
	Moved get_total_size to logic2.c
	
	* components/services/install/lib/eazel-install-logic2.h:
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (eazel_install_check_existing_packages),
	(eazel_install_get_total_size_of_packages), (execute):
	Setup infoblock so the callback signals make sense, removed a
	g_assert_not_reached.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	Don't load dependencies when loading the package after download.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpm_sense_to_softcat_sense),
	(eazel_package_system_rpm3_packagedata_fill_from_header):
	Fixed 5262

	* components/services/install/lib/eazel-package-system-types.c:
	(packagedependency_new), (packagedependency_destroy),
	(packagedata_fill_in_missing), (packagedata_dump_int):
	Allow fill_in_missing into a packagedata object with depends set.
	Moved output of features and provides upwards in dump_int.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_update_from_uri):
	Deallocate the EazelInstall object in update_from_uri if already
	set. The ensures a reload of the install-view doesn't leak
	EazelInstall objects.

2001-01-19  Darin Adler  <darin@eazel.com>

	reviewed by: Michael Engber <engber@eazel.com>

	* src/athena-view-frame-corba.c: (view_widget_gone),
	(impl_Athena_ViewFrame__destroy),
	(impl_Athena_ViewFrame__create),
	(impl_Athena_ViewFrame_open_location_in_this_window),
	(impl_Athena_ViewFrame_open_location_prefer_existing_window),
	(impl_Athena_ViewFrame_open_location_force_new_window),
	(impl_Athena_ViewFrame_report_selection_change),
	(impl_Athena_ViewFrame_report_status),
	(impl_Athena_ViewFrame_report_load_underway),
	(impl_Athena_ViewFrame_report_load_progress),
	(impl_Athena_ViewFrame_report_load_complete),
	(impl_Athena_ViewFrame_report_load_failed),
	(impl_Athena_ViewFrame_set_title):
	Since the AthenaViewFrame object is a widget, we don't
	control its lifetime completely. So we disconnect from it
	when it is destroyed and stop trying to make calls on it.

2001-01-19  Michael Engber  <engber@eazel.com>

	reviewed by: Brian Frank

	* data/static_bookmarks.xml:
	Changes for PR3 default bookmarks. Use redirects.

2001-01-19  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Finished bug 2146 (Properties window for desktop Trash
	should show Trash properties). The last two changes were
	to remove the "accessed" field for all directories, since
	it seems useless, and to fill in the "where" field with
	"on the desktop".

	* libathena-extensions/athena-file.c:
	(athena_file_get_where_string): New function, calls
	virtual function so trash and normal files can report
	different strings.
	(athena_file_get_string_attribute): Changed "parent_uri"
	string attribute to "where", since it is not the parent_uri
	in the Trash case.
	* libathena-extensions/athena-file.h: Virtual function
	pointer for get_where_string.
	* libathena-extensions/athena-trash-file.c:
	(trash_file_get_where_string),
	(athena_trash_file_initialize_class): Supply get_where_string
	function that returns "on the desktop".
	* libathena-extensions/athena-vfs-file.c:
	(vfs_file_get_where_string), (athena_vfs_file_initialize_class):
	Supply get_where_string function that returns parent_uri string.
	* src/file-manager/fm-properties-window.c:
	(should_show_accessed_date): New function, returns FALSE for
	directories and TRUE for other files.
	(create_basic_page): Honor should_show_accessed_date, and use
	"where" instead of "parent_uri" string attribute.
	* src/file-manager/fm-search-list-view.c:
	(real_get_column_specification): Use "where" instead of "parent_uri"
	string attribute.

2001-01-19  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (install_message_new):
	Add a tiny bit of padding to this label to prevent the bottom from
	being cut off.  Im not sure exactly why the bottom is getting cut
	off.  I suspect that the part container is constraining the widget
	somehow, perhaps to match the geometry of the label on the right.
	
	* libathena-extensions/athena-label.c:
	(label_composite_pixbuf_callback), (athena_label_expose_event):
	Fix for bugs 5607, 5608 and 5611.  Remove previous workaround for
	bug 5608.  Do the clipping of the area that we need to copy into
	the temporary buffer more carefully.  The temporary buffer itself
	is a workaround for a related bug (2784).

2001-01-19  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/bug-5712-pr3-workaround--gdkimage.c:
	(ATHENA_BUG_5712_PR3_WORKAROUND__gdk_image_get):
	Remove a debug printf that I stupidly left in.
	
2001-01-19  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Nobody, because the "fix" is so revolting that none
	of the high integrity Athena hackers would approve it.

	* libathena-extensions/Makefile.am:
	* libathena-extensions/bug-5712-pr3-workaround--gdk-pixbuf-drawable.c:
	* libathena-extensions/bug-5712-pr3-workaround--gdk-pixbuf-private.h:
	* libathena-extensions/bug-5712-pr3-workaround--gdkimage.c:
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(athena_gdk_pixbuf_get_from_window_safe):
	Workaround for bug 5712.  This is a temporary evil until GTK+
	1.2.9 is released.
	
2001-01-19  John Sullivan  <sullivan@eazel.com>

	Ramiro sent me this patch, which I tweaked slightly.

	Fix for bug 5792 (Sidebar panel choices visible at beginner
	user level, but shouldn't be)

	* libathena-extensions/athena-global-preferences.c:
	add visible_user_level field to known_sidebar_panels struct.
	Set this field appropriately for each of the 4 known sidebar
	panels. Remove the 5th known sidebar panel since it was an
	accidental duplication of the 2nd one.
	(global_preferences_install_sidebar_panel_defaults): Set the
	visible user level when installing default values.

2001-01-19  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Ramiro Estrugo <ramiro@eazel.com>

	Fixed 4348: trying to trash a file already deleted outside Athena crashes.
	* libathena-extensions/athena-file-operations.c:
	(athena_file_operations_copy_move):
	The problem was that the "find trash near" operation was failing because
	the trahsed file was non-existent.
	Added code that deals with a NULL target_directory_uri handle.	

2001-01-19  Stanislav Visnovsky <visnovsky@nenya.ms.mff.cuni.cz>

        * configure.in: Added sk to ALL_LINGUAS.

2001-01-19  Andy Hertzfeld  <andy@eazel.com>

	more clean-up and fixes for the default theme change
	
	* icons/ardmore/ardmore.xml:
	* icons/arlo/arlo.xml:
	* icons/default.xml:
	* icons/eazel/eazel.xml:
	* icons/gnome/gnome.xml:
	* icons/vector/vector.xml:
	* icons/villanova/villanova.xml:
	at Arlo's request, capitalized the theme names and also made
	them localizable, and tweaks to some of the theme files to fix
	problems caused by the new default
	
	* src/athena-sidebar-tabs.c:
	(athena_sidebar_tabs_load_theme_data):
	added a way to specify the non-pixmap tabs, since it uses
	pixmap ones in the default now
	
	* src/athena-theme-selector.c:
	(get_theme_description_and_display_name), (add_theme):
	made it use a localizable name in the xml file instead of the
	actual folder name.
	
	* src/athena-window-toolbars.c: (get_file_name_from_icon_name):
	added a way to get the stock gnome toolbar icons, now that we have
	our own in the default theme
	
	* athena.spec.in:
	added the throbber component to our package

2001-01-19  Pavel Cisler <pavel@eazel.com>

	Fix 3558: Athena crashes with specific sequence of icon dragging
	and mouse movement
	* libathena-extensions/athena-list.c:
	(athena_list_button_release), (athena_list_motion):
	The drag start code was assuming an actual item was clicked,
	added a check that checked the clicked row index first.
	
	* libathena-extensions/athena-self-checks.c:
	(athena_report_check_failure):
	Missed one printf -> fprintf (stderr...
	
2001-01-18  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_feature_list), (osd_parse_implementation):

	Parse the "features" list for toplevel packages, if one is
	provided by softcat (the next softcat release will do it).

	* components/services/install/lib/eazel-softcat.c:
	(remove_directories_from_provides_list):

	Remove debugging line I accidentally left in.

2001-01-18  Andy Hertzfeld  <andy@eazel.com>

	fixed some damage from the default theme change, including getting
	the sidebar tabs installed correctly, and making semi-transparent
	icon selection highlight in aa-mode work properly again.  There are
	still some more to do to finish this, though.
	
	* icons/sidebar_tab_pieces/Makefile.am:
	install the tabs in the proper place
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_theme_changed):
	use ATHENA_COLOR_RGBA to set up the highlight color
	
2001-01-18  Arlo Rose  <arlo@eazel.com>

	* icons/arlo/arlo.xml:
	I didn't like the name I picked today... changed it again...
	(Thanks Wingpea!)

2001-01-18  Eskil Olsen  <eskil@eazel.com>

	* components/services/login/athena-view/Makefile.am:
	Fixing stuff

2001-01-18  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_file_list):
	* components/services/install/lib/eazel-softcat.c:
	(is_filename_probably_a_directory),
	(remove_directories_from_provides_list), (eazel_softcat_get_info):

	Make softcat module remove obvious directories from the file list
	provided by XML.  There are still files that could slip through
	the cracks (forseti bug 1279).

2001-01-18  Andy Hertzfeld  <andy@eazel.com>

	made the real default theme, based on what was formerly the
	eazel theme.  This isn't quite finished yet (the sidebar tabs
	arent right yet, Arlo needs to add the desktop, plus some other
	details), and some of the other themes might be slightly wrong
	from this change, but I'll fix everything up soon.
	
	* configure.in:
	* icons/Makefile.am:
	* icons/default.xml:
	* icons/gnome/gnome.xml:
	* icons/i-directory-accept.xml:
	* icons/i-directory.xml:
	* icons/sidebar_tab_pieces/.cvsignore:
	* icons/sidebar_tab_pieces/Makefile.am:
	* plus lots of images
	
2001-01-18  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>
	(only the first 2 changes, others unreviewed)

	* libathena-extensions/athena-trash-directory.c:
	(trash_destroy): Fix problem that might be what's killing the
	Tinderbox. We need to disconnect the signal handlers we add to the
	trash monitor.
	
	* src/file-manager/fm-directory-view.c: (load_location_callback):
	Always reload when navigating. This smooths over many anomalies,
	and hopefully will fix the nasty problems described in bug 4873
	(files created in home directory (outside Athena) don't show up
	when I navigate there) and bug 4963 (starting the search service
	while running athena doesn't let you run searches).

	* configure.in: Fix gnome-http check that was previously just
	checking whether gnome-config was there or not!
	
	* src/athena-application.c: (athena_application_startup):
	Replace incorrect references to athena.oafinfo to instead
	mention Athena_Shell.oaf.
	
	* test/.cvsignore: Add a generated file.

2001-01-18  Robey Pointer  <robey@eazel.com>

	* icons/Makefile.am:
	* icons/bubble-LL.png:
	* icons/bubble-LR.png:
	* icons/bubble-UL.png:
	* icons/bubble-UR.png:
	* icons/tiny-alert.png:

	Add Arlo's icons for the new password-change view.

2001-01-18  Arlo Rose  <arlo@eazel.com>

	* icons/arlo/arlo.xml:
	Tweaked XML file to represent the "Luxe" family name.
	This fits with the Sawfish and GTK theme names.

2001-01-18  Robey Pointer  <robey@eazel.com>

	* components/services/login/athena-view/Makefile.am:
	* components/services/login/athena-view/athena-change-password-
	view.c: (run_away_timer), (generate_change_password_form),
	(entry_changed_cb), (authn_succeeded), (authn_failed),
	(start_change_password), (change_password_button_cb):
	* components/services/login/athena-view/password-box.c:
	(add_padding_to_box), (add_filler_to_box), (line_expose),
	(vertical_line_new), (make_empty_viewport),
	(gtk_widget_set_colors), (make_bubble_shell),
	(change_bubble_shell_colors), (password_box_set_colors),
	(password_box_get_entry), (password_box_set_error_text),
	(password_box_show_error), (password_box_new):
	* components/services/login/athena-view/password-box.h:

	Implement new change-password UI according to Arlo's screenshots.
	Rounded password text-entry blobs are now in their own file for a
	modicum of modularity.  Reponse codes from ammonite are now
	correctly decoded and translated into text.

2001-01-18  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file):
	* athena-installer/src/HACKING:

	Change the bootstrap installer download function to use the new
	gnome-http call to avoid buffering 8MB of package files in memory
	at once.
	
	* components/services/trilobite/libtrilobite/trilobite-core-network
	-slim.c: (trilobite_xml_get_string), (trilobite_fetch_uri),
	(trilobite_fetch_uri_to_file):

	Forgot to add this once -- needed by the bootstrap installer.

2001-01-18  Eskil Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_do_rpm_dependency_check):
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-softcat.c:
	(get_search_url_for_package):
	Fixing build issues against newest rpm (4.0.2-0.27).

2001-01-18  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 3417 (Put existing preferences at right levels)

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_defaults),
	(global_preferences_install_visibility): First pass at setting
	appropriate defaults and user levels for preferences.
	
	(global_preferences_create_dialog): Put "show only folders in
	tree view" before other preferences that appear only in higher
	user levels, 'cuz it looks better that way.
	
	* src/athena-shell-ui.xml:
	* src/athena-window-menus.c: (user_level_customize_callback):
	Renamed "Edit Settings" menu item & dialog to "Preferences";
	marked dialog title for localization.

2001-01-18  Andy Hertzfeld  <andy@eazel.com>

	now that the bonobo problems are resolved, we can go back to
	the componentized throbber.
	
	* src/Makefile.am:
	* src/athena-window-toolbars.c:
	(athena_window_initialize_toolbars):
	* src/athena-window.c: (throbber_location_changed_callback),
	(athena_window_constructed), (athena_window_destroy),
	(athena_window_allow_stop):
	* src/athena-window.h:

2001-01-18  Michael Engber  <engber@eazel.com>

	reviewed by: John Sullivan

	* libathena-extensions/athena-directory-background.c:
	(theme_image_path_to_uri),
	(athena_file_background_get_default_settings_for_theme),
	(athena_file_background_get_default_settings),
	(athena_file_background_read_desktop_settings),
	(athena_file_background_write_desktop_settings),
	(athena_file_background_is_set):
	* libathena-extensions/athena-theme.c:
	(athena_theme_get_theme_data_from_theme),
	(athena_theme_get_theme_data):
	* libathena-extensions/athena-theme.h:
	The desktop can now be reset to the "default" meaning when
	you change themes it will use the default desktop setting
	for the new theme - bug 5730.

2001-01-18  Arlo Rose  <arlo@eazel.com>

	* icons/Makefile.am:
	* icons/emblem-symbolic-link.png:
	* icons/emblem-broken-link.png:
	More elegant symbolic link emblem, and the addition of
	a broken one in the event we hook it up.

2001-01-18  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug where selecting the first item in a list view, then
	hitting Shift-TAB would always trigger an assertion

	* src/file-manager/fm-list-view.c
	(select_previous_next_common): deleted the bogus assertion

2001-01-18  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 5666 (dragging to directory in the tree view always
	crashes)

	* libathena-extensions/athena-file-operations.c
	(athena_file_operations_copy_move): check that
	relative_item_points isn't null before dereferencing it (since
	athena_tree_view_move_copy_files passes NULL as this
	parameter)

2001-01-18  Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/athena-thumbnails.c:
	(check_for_thumbnails):
	Fix a crash that was blocking Eli -- a close was being called
	without checking the result of a previous create.
	This will need more work, just wanted to do a quick fix to
	unblock Eli.

2001-01-18  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line),
	(eazel_download_progress_signal), (tree_helper_helper),
	(tree_helper), (something_failed):
	Fixed 5754 (add --cgi-path), made some modifications needed for
	the change signals for ei2. Also added --noauth that disables
	eazelauth.
	Now also takes --server=host[:port] args.
	
	* components/services/install/command-line/eazel-test-packsys.c:
	(test_version_compare), (test_query), (test_query_owns_mem),
	(main):
	Wrote some more tests.
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	Added the file_conflict_check call, not implemented yet.
	Also added the cgi, debug and auth attributes.
	
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install__set_debug), (impl_Eazel_Install__get_debug),
	(impl_Eazel_Install__set_auth), (impl_Eazel_Install__get_auth),
	(impl_Eazel_Install__set_cgi), (impl_Eazel_Install__get_cgi),
	(eazel_install_get_epv):
	Setup the cgi, debug and auth in the vtable.
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_start_transaction):
	Some code moved to logic2.c
	
	* components/services/install/lib/eazel-install-logic2.h:
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (check_md5_on_files),
	(prune_failed_packages_helper), (prune_failed_packages),
	(eazel_install_check_existing_packages), (get_softcat_info),
	(get_package_info_foreach), (dedupe_foreach_depends),
	(dedupe_foreach), (dedupe), (is_satisfied),
	(is_satisfied_features), (check_dependencies_foreach),
	(is_filename_probably_a_directory), (check_tree_helper),
	(check_tree_for_conflicts), (check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency), (do_file_conflict_check),
	(do_dep_check_internal), (do_dep_check), (download_packages),
	(clean_up_dedupe_hash), (clean_up_dep_ok_hash), (execute),
	(install_packages_helper), (install_packages):
	Finished first hit at ei2 install, seems to work now. This closes
	a lot of the bugs with ei2 in the comment.
	
	* components/services/install/lib/eazel-install-metadata.c:
	(eazel_install_configure_softcat):
	Default to port 80, not 443.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_emit_preflight_check):
	Uses ei2 for install, still uses logic.c for uninstall and revert.
	emit_preflight no longer checks for toplevel if ei2 is set.
	
	* components/services/install/lib/eazel-install-private.h:
	Wrote comments for the two ei2 hashes.
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_cases_foreach),
	(get_detailed_uninstall_cases_foreach),
	(eazel_install_problem_tree_to_case),
	(eazel_install_problem_tree_to_string):
	More debug info and uses gtk_object_unref for deallocating
	packagedata structures.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_file):
	If the file is already present, still emit signals.
	
	* components/services/install/lib/eazel-install-public.h:
	Moved some enums here.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(eazel_install_packagedata_to_xml):
	Add ->depends to the SOFT_DEPEND field.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_compare_version):
	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(eazel_package_system_rpm3_execute),
	(eazel_package_system_rpm3_compare_version),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-skeleton.c:
	(eazel_package_system_skeleton_compare_version),
	(eazel_package_system_implementation):
	Added the compare_version call to EazelPackageSystem (fixes bug
	5663).
	Also use free instead of xfree to maintain rpm 4.0.2
	compatibility.
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(at_exit_package_data_info), (categorydata_new),
	(categorydata_destroy_foreach), (packagedata_initialize),
	(packagedata_finalize), (packagedependency_destroy),
	(packagedata_copy), (packagedata_destroy),
	(packagedata_get_readable_name), (packagedata_add_pack_to),
	(packagedata_add_pack_to_breaks),
	(packagedata_add_pack_to_modifies),
	(flatten_packagedata_dependency_tree_helper),
	(flatten_packagedata_dependency_tree):
	Wrote some functions to convert a packagedata tree into a flat
	structure based on ->depends.
	Some nifty atexit debug output showing non-deallocated packagedata
	structures.
	More gtk_object_ref/unref repair.
	Fixed get_readable_name (a y2k bug!!)
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_install_parse_uri),
	(athena_service_install_view_update_from_uri):
	Don't set auth to TRUE when uri has host...
	
	* configure.in:
	Changed librpmio test so it works with rpm 4.0.2

2001-01-18  Arlo Rose  <arlo@eazel.com>

	I forgot to check these two image in a few days ago...
	* icons/eazel/sidebar_tab_pieces/left_bumper-prelight.png:
	* icons/eazel/sidebar_tab_pieces/left_bumper.png:

2001-01-18  Andy Hertzfeld  <andy@eazel.com>

	backed out the Bonobo component throbber temporarily due
	to Bonobo problems and restored the old one; hopefully, the
	new one will come back soon.
	
	* src/Makefile.am:
	* src/athena-window-toolbars.c:
	(athena_window_initialize_toolbars):
	* src/athena-window.c: (athena_window_constructed),
	(athena_window_destroy), (athena_window_allow_stop):
	* src/athena-window.h:

	fixed bug 5393, custom emblems arent scaling properly, by
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_update_icon):
	* libathena-extensions/athena-icon-factory.c:
	(get_themed_icon_file_path), (load_pixbuf_svg),
	(load_specific_icon):

2001-01-18  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 2147 (AthenaFile for trash needs non-empty values for
	more properties), bug 5652 (MIME type field appears but shouldn't
	in properties window for Trash), and bug 4620 (trash sidebar
	should show number of items).

	* libathena-extensions/athena-file.h:
	* libathena-extensions/athena-file-private.h:
	* libathena-extensions/athena-file.c:
	(athena_file_new_from_relative_uri): Create trash file subclass
	when appropriate.
	(athena_file_info_missing): Rename so it can be used in other
	source files.
	(athena_file_get_date): New method that returns numeric dates.
	(athena_file_get_date_as_string): Change to call
	athena_file_get_date to get the numeric date.
	(athena_file_get_file_type): Turn into a method.

	* libathena-extensions/athena-merged-directory.h:
	* libathena-extensions/athena-merged-directory.c:
	(merged_call_when_ready): Rolled in the old
	merged_callback_connect_directory function.
	(merged_contains_file): Moved down to a more appropriate part of
	the source file.
	(athena_merged_directory_get_real_directories): New public
	function for use by trash.
	
	* libathena-extensions/athena-trash-file.c:
	(trash_callback_hash), (trash_callback_equal),
	(trash_callback_destroy), (trash_callback_check_done),
	(trash_callback_remove_file), (ready_callback),
	(real_file_changed_callback), (monitor_add_file), (add_real_file),
	(trash_callback_remove_file_cover), (monitor_remove_file),
	(remove_real_file), (add_real_file_given_directory),
	(add_directory_callback), (remove_directory_callback),
	(trash_file_call_when_ready), (trash_file_cancel_call_when_ready),
	(trash_file_check_if_ready), (trash_file_monitor_add),
	(trash_file_monitor_remove), (trash_file_get_file_type),
	(trash_file_get_item_count), (trash_file_get_deep_counts),
	(trash_file_get_date), (remove_all_real_files),
	(athena_trash_file_initialize), (trash_destroy),
	(athena_trash_file_initialize_class):
	New code. First implementation of getting some attributes for the
	merged trash. Gets list of directories from the
	AthenaTrashDirectory object. The code in here is similar to the
	AthenaMergedDirectory class and at some point perhaps we can
	make the two share more.
	
	* libathena-extensions/athena-vfs-file.c:
	(vfs_file_get_file_type), (vfs_file_get_date),
	(athena_vfs_file_initialize_class): Implement the two new
	methods for the standard vfs case.
	
	Fixed various things that affect the properties window for the
	trash that showed up while I was testing the above work:
	
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_name_for_regular_file),
	(athena_icon_factory_get_icon_name_for_file): Move trash special
	case out so it doesn't matter what type the trash seems to be. The
	old code relied on trash not being a directory.
	
	* src/file-manager/fm-properties-window.c:
	(create_properties_window), (create_properties_window_callback),
	(cancel_create_properties_window_callback),
	(directory_view_destroyed_callback), (remove_pending_file): Rework
	code to fix problems where the timed wait or the signal handler
	wasn't properly cleaned up.

	Fixed remaining bit of bug 5631 (Tear-offs of right-click menus
	don't work.):
	
	* src/file-manager/athena-desktop-icon-view-ui.xml: Mark Disks
	right-click submenu so it won't get a tear-off item.

	Fixed bug 5650 (athena --quit fails to return to prompt
	sometimes):
	
	* src/athena-application.c: (athena_application_startup): Add
	special case so "athena --quit" doesn't hang waiting for a
	response from the (now quit) "server" instance of Athena.
	* src/athena-shell-interface.idl: Had to make the quit call no
	longer be "oneway" to get it to work right, otherwise the quit
	message could be lost when the sending application exited too
	fast.

	Fix bug 5675 (Nitpicks in new "could not be moved to new special
	location" dialog):

	* libathena-extensions/athena-file-operations.c:
	(handle_transfer_overwrite): Updated message wording as Eli (and
	Vera) suggest.

	Other changes:
	
	* libathena-extensions/athena-view-identifier.c:
	(get_lang_list): Fix comment and a small storage leak in the case
	where lang_with_locale is non-NULL but empty.
	
	* po/POTFILES.ignore: Obsolete file, no longer used.
	
	* src/file-manager/fm-desktop-icon-view.c:
	(update_home_link_and_delete_copies): Update comment to help
	translators understand better.
	
	* libathena-extensions/athena-directory-async.c:
	(directory_load_callback): Added a new assertion that could help
	in future gnome-vfs debugging.
	
	* libathena/athena-view-component.idl: Removed long-ago-fixed
	FIXME comment.

	* src/athena-window-manage-views.c: Tweak spacing.

2001-01-18  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_from_input):
	* libathena-extensions/athena-link-set.c:
	(athena_link_set_install):
	Used new gnome_vfs_expand_initial_tilde in two places
	that were doing this independently (one of which is 
	where the code for the gnome-vfs routine came from).

2001-01-18  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5260: (Should revise 'Music view is unable to play
	back sound' dialog)

	* components/music/athena-music-view.c: (play_current_file):
	Improved an error message per Eli and Vera.

2001-01-18  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_install_proxy_defaults),
	(global_preferences_install_home_location_defaults),
	(athena_global_preferences_initialize):
	* libathena-extensions/athena-global-preferences.h:
	Make comments reflect reality more.  Changed the structure of the
	file a bit to have the defaults, descriptions and visibility
	installing functions be at the top.
	
2001-01-18  Pavel Cisler <pavel@eazel.com>

	Fix 4221 (Pressing Cancel button does not cancel)

	* libathena-extensions/athena-file-operations.c:
	(transfer_dialog_clicked_callback), (handle_transfer_ok):
	Redo cancellation to use a flag in the Transfer state and
	return a request to cancel during the next callback instead
	of issuing a gnome_vfs_async_cancel and destroying the
	dialog. The latter approach would now work too with my
	latest change to gnome_vfs_xfer, this new way of cancelling
	is cleaner and causes all the item that actually do get
	copied to show up in their new locations.

2001-01-18  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_defaults):
	Add a FIXME for a bug that was shuffled in my last checkin.
	
2001-01-17  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Lots of bug fixes:

	2848 - User level agnostic config settings have nowhere to live.
	2654 - Need default values even for non user level preferences.
	3414 - Show more preferences at higher user levels.
	3415 - Make preference the same for all levels at which it is not visible
	3416 - Make preference changes affect all levels at which they are visible
	4357 - Web search URL setting should be reset upon Athena update
	5160 - Tree view doesnt exist when starting athena as a beginner
	5234 - Sidebar panel preferences are not properly separated among user levels
	
	* components/mozilla/mozilla-preferences.cpp:
	Update for gnome vfs proxy changes.  Proxy host and port are now
	stored in separate gconf settings.
	
	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-enumeration.h:
	* libathena-extensions/athena-enumeration.c:
	(athena_enumeration_new), (athena_enumeration_free),
	(athena_enumeration_insert),
	(athena_enumeration_get_nth_entry),
	(athena_enumeration_get_nth_description),
	(athena_enumeration_get_nth_value),
	(athena_enumeration_get_num_entries),
	(athena_self_check_enumeration):
	New files.  An enumeration data structure.
	
	* components/tree/athena-tree-expansion-state.c:
	No longer need to give the full path to a gconf setting.

	* components/tree/athena-tree-view.c:
	(filtering_changed_callback), (athena_tree_view_initialize):
	* libathena-extensions/athena-directory-async.c:
	(can_use_public_metafile),
	(get_filter_options_for_directory_count):
	* libathena-extensions/athena-file-operations.c:
	(confirm_empty_trash):
	* libathena-extensions/athena-file.c:
	(athena_file_should_get_top_left_text):
	* libathena-extensions/athena-font-factory.c:
	(athena_font_factory_get_font_from_preferences):
	Update for preferences api changes.

	* libathena-extensions/athena-gconf-extensions.h:
	* libathena-extensions/athena-gconf-extensions.c:
	(global_client_free), (athena_gconf_client_get_global),
	(athena_gconf_handle_error), (athena_gconf_set_boolean),
	(athena_gconf_get_boolean), (athena_gconf_set_int),
	(athena_gconf_get_int), (athena_gconf_set_string),
	(athena_gconf_get_string), (athena_gconf_set_string_list),
	(athena_gconf_get_string_list), (athena_gconf_is_default),
	(athena_gconf_monitor_directory):
	New files.  Useful gconf extensions; make peeking and poking
	settings a little easier.

	* libathena-extensions/athena-icon-container.c:
	(button_press_event):
	* libathena-extensions/athena-icon-canvas-item.c:
	(in_single_click_mode):
	Update for preferences api changes.

	* libathena-extensions/athena-icon-factory.c:
	(icon_theme_changed_callback),
	(should_display_image_file_as_itself):
	Update for preferences api changes.  Also no longer need to define
	a default theme.

	* libathena-extensions/athena-lib-self-check-functions.h:
	Add entries for enumeration and preferences.  Remove preference
	entry.  Note plural vs not.
	
	* libathena-extensions/athena-preference.c:
	* libathena-extensions/athena-preference.h:
	Retire these 2.  No longer use a GtkObject to store each
	preference.  We simply use the string name instead.
	
	* libathena-extensions/athena-preferences-box.h:
	* libathena-extensions/athena-preferences-box.c:
	(athena_preferences_box_add_pane),
	(athena_preferences_box_update):
	New function.  Should be called when user level changes so that
	the box updates its panes.
	
	* libathena-extensions/athena-preferences-dialog.h:
	* libathena-extensions/athena-preferences-dialog.c:
	(athena_preferences_dialog_initialize),
	(athena_preferences_dialog_destroy),
	(athena_preferences_dialog_get_prefs_box),
	(athena_preferences_dialog_update),
	(user_level_changed_callback):
	Keep track of user level changes.  
	New function to update the dialog when user level changes.
	
	* libathena-extensions/athena-preferences-group.h:
	* libathena-extensions/athena-preferences-group.c:
	(athena_preferences_group_initialize),
	(athena_preferences_group_destroy),
	(athena_preferences_group_add_item): Collect the group's items
	in a list.  Update to user a string to represent a preference
	instead of a GtkObject.  
	(athena_preferences_group_update): New function.  Updates the
	group's items to respect preferences visibility based on the user
	level.
	(athena_preferences_get_num_visible_items):  New function.
	Return the number of currently visible items.

	Collect the group's items in a list.   Update to user a string to
	represent a preference instead of a GtkObject.  
	
	* libathena-extensions/athena-preferences-item.h:
	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_construct), (preferences_item_create_enum),
	(preferences_item_create_short_enum),
	(preferences_item_create_boolean),
	(preferences_item_create_editable_string),
	(preferences_item_create_integer),
	(preferences_item_create_font_family),
	(preferences_item_create_theme),
	(enum_radio_group_changed_callback),
	(editable_string_changed_callback), (integer_changed_callback),
	(athena_preferences_item_get_name): 
	New function to fetch the item's preference name.
	Add a new kind of preference - INTEGER.  Update for string
	vs. GtkObject preferences representation changes.  

	* libathena-extensions/athena-preferences-pane.h:
	* libathena-extensions/athena-preferences-pane.c:
	(athena_preferences_pane_update):
	New function.  Updates the pane's groups to respect preferences
	visibility based on the user level.

	* libathena-extensions/athena-preferences.h:
	* libathena-extensions/athena-preferences.c:
	(preferences_get_path), (preferences_get_defaults_path),
	(preferences_get_visibility_path),
	(preferences_get_user_level_key),
	(preferences_preference_is_internal),
	(preferences_preference_is_user_level), (preferences_key_make),
	(preferences_key_make_for_default),
	(preferences_key_make_for_default_getter),
	(preferences_key_make_for_visibility),
	(preferences_global_client_remove_notification),
	(preferences_global_client_get),
	(preferences_preference_is_default),
	(preferences_make_user_level_filtered_key),
	(athena_preferences_get_visible_user_level),
	(athena_preferences_set_visible_user_level),
	(athena_preferences_set_boolean),
	(preferences_key_make_for_getter),
	(athena_preferences_get_boolean), (athena_preferences_set_int),
	(athena_preferences_get_int), (athena_preferences_set),
	(athena_preferences_get), (athena_preferences_set_string_list),
	(athena_preferences_get_string_list),
	(athena_preferences_get_user_level),
	(athena_preferences_set_user_level),
	(athena_preferences_default_set_int),
	(athena_preferences_default_get_int),
	(athena_preferences_default_set_boolean),
	(athena_preferences_default_get_boolean),
	(athena_preferences_default_set_string),
	(athena_preferences_default_get_string),
	(athena_preferences_default_set_string_list),
	(athena_preferences_default_get_string_list),
	(preferences_callback_entry_invoke_function),
	(preferences_something_changed_notice),
	(preferences_global_table_check_changes_function),
	(preferences_user_level_changed_notice),
	(preferences_entry_add_callback),
	(preferences_entry_remove_callback),
	(preferences_callback_entry_free),
	(preferences_callback_entry_free_func), (preferences_entry_free),
	(preferences_entry_free_func), (preferences_global_table_free),
	(preferences_global_table_get_global),
	(preferences_global_table_lookup),
	(preferences_global_table_insert),
	(preferences_global_table_lookup_or_insert),
	(athena_preferences_add_callback),
	(preferences_while_alive_disconnector),
	(athena_preferences_add_callback_while_alive),
	(athena_preferences_remove_callback),
	(athena_preferences_enumeration_insert),
	(athena_preferences_enumeration_get_nth_entry),
	(athena_preferences_enumeration_get_nth_description),
	(athena_preferences_enumeration_get_nth_value),
	(athena_preferences_enumeration_get_num_entries),
	(athena_preferences_set_description),
	(athena_preferences_get_description),
	(athena_preferences_get_user_level_name_for_display),
	(athena_preferences_get_user_level_name_for_storage),
	(preferences_user_level_check_range),
	(athena_preferences_monitor_directory),
	(athena_preferences_is_visible),
	(athena_self_check_preferences):
	Many changes.  Redid to support the preferences system described
	in bugs 3414, 3415 and 3416.
	
	* libathena-extensions/athena-smooth-widget.c:
	(preferences_get_is_smooth):
	* libathena-extensions/athena-sound.c:
	(kill_sound_if_necessary), (athena_sound_initialize),
	(athena_sound_kill_sound), (athena_sound_register_sound),
	(athena_sound_can_play_sound):
	* libathena-extensions/athena-theme.c:
	(athena_theme_get_theme), (athena_theme_get_theme_data),
	(athena_theme_get_image_path):
	Update for preferences api changes.

	* libathena-extensions/athena-user-level-manager.c:
	* libathena-extensions/athena-user-level-manager.h:
	Retire.  No longer needed.  User level things are handled in
	athena-preferences.[ch] now.  The current user level design is
	much simpler and does no require its own GtkObject.

	* src/file-manager/fm-desktop-icon-view.c:
	(update_home_link_and_delete_copies), (real_update_menus):
	* src/file-manager/fm-directory-view.c: (open_location),
	(confirm_delete_from_trash), (real_update_menus),
	(fm_directory_view_activate_files), (filtering_changed_callback):
	* src/file-manager/fm-icon-text-window.c:
	(changed_attributes_option_menu_callback),
	(fm_get_text_attribute_names_preference_or_default):
	* src/file-manager/fm-icon-view.c: (should_preview_sound),
	(fm_icon_view_update_click_mode),
	(fm_icon_view_update_smooth_graphics_mode):
	* src/file-manager/fm-list-view.c:
	(fm_list_view_update_click_mode):
	* src/file-manager/fm-properties-window.c:
	(create_permissions_page):
	* src/athena-application.c: (desktop_changed_callback):
	* src/athena-complex-search-bar.c:
	(athena_complex_search_bar_get_location):
	* src/athena-first-time-druid.c: (user_level_selection_changed),
	(make_hbox_user_level_radio_button), (set_up_user_level_page):
	* src/athena-main.c: (main):
	* src/athena-property-browser.c:
	(athena_property_browser_update_contents):
	* src/athena-sidebar.c: (athena_sidebar_sidebar_panel_enabled),
	(toggle_sidebar_panel), (athena_sidebar_size_allocate):
	* src/athena-switchable-search-bar.c:
	(athena_switchable_search_bar_new),
	(athena_search_uri_to_search_bar_mode):
	Update for preferences api changes.

	* src/athena-window-manage-views.c:
	(position_and_show_window_callback),
	(athena_window_end_location_change_callback):
	Update for preferences api changes.  Also, no longer need to pass
	in a default location to the preferences getter.

	* src/athena-window-menus.c: (user_level_customize_callback),
	(switch_to_user_level), (refresh_bookmarks_menu),
	(user_level_changed_callback), (add_user_level_menu_item),
	(athena_window_initialize_menus), (update_user_level_menu_items),
	(convert_user_level_to_path):
	A lot of simplification.  The "Edit Settings..." menu item no
	longer changes it wording based on the user level.  We know allow
	it to edit settings on all user levels, since we have the ability
	to hide preferences at higher user levels.  No longer need to
	update the preferences dialog or its title.
	
	* src/athena-window.c: (athena_window_constructed),
	(athena_window_close), (athena_window_go_web_search),
	(athena_window_go_home), (athena_window_show):
	Update for preferences api changes.

	* libathena-extensions/athena-global-preferences.h:
	Update all the preferences defines to not include a full gconf
	path.  We dont need to do this anymore to get non user level
	coupled prefernces.

	* libathena-extensions/athena-global-preferences.c:
	(compare_view_identifiers), (global_preferences_create_dialog),
	(athena_global_preferences_get_enabled_sidebar_panel_view_identif
	iers), (global_preferences_install_sidebar_panel_defaults),
	(global_preferences_is_sidebar_panel_enabled),
	(global_preferences_install_speed_tradeoff_descriptions),
	(register_proxy_preferences), (global_preferences_register),
	(global_preferences_install_defaults),
	(athena_global_preferences_set_dialog_title):
	Lots of changes to support new preferences design.

	Set the WM_CLASS here once instead of everytime the dialog title
	is changed.  This was causing criticals.

	No longer need to create parallel proxy preferences and map them
	to the gconf ones.  We can use the gconf ones directly now.

	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-athena-preferences-change.c:
	(user_level_changed_callback), (fruits_changed_callback),
	(int_picker_changed_callback),
	(user_level_picker_changed_callback), (picker_new),
	(user_level_picker_new), (main):
	* test/test-athena-preferences-display.c: (text_caption_update),
	(user_level_caption_update), (user_level_changed_callback),
	(green_changed_callback), (yellow_changed_callback),
	(red_changed_callback), (apple_changed_callback),
	(orange_changed_callback), (pear_changed_callback), (entry_new),
	(user_level_frame_new), (colors_frame_new), (fruits_frame_new),
	(main):
	* test/test.c: (test_pixbuf_draw_rectangle_tiled),
	(test_text_caption_set_text_for_int_preferences),
	(test_text_caption_set_text_for_string_preferences),
	(test_text_caption_set_text_for_default_int_preferences),
	(test_text_caption_set_text_for_default_string_preferences),
	(test_text_caption_get_text_as_int),
	(test_window_set_title_with_pid):
	* test/test.h:
	New tests for preferences changes.

	* test/test-athena-preferences.c:
	Retire old prefs test which didnt really work.
	
	* test/test-athena-smooth-graphics.c:
	(smooth_graphics_mode_changed_callback), (main):
	Update for preferences api changes.

2001-01-17  Andy Hertzfeld  <andy@eazel.com>

	changed the throbber component to use the new translated oaf file
	scheme.  The throbber still doesn't show up, due to recent bonobo
	changes, which I'm looking into further.
	
	* components/throbber/.cvsignore:
	cvs should ignore the translated oaf file
	* components/throbber/Makefile.am:
	change use of oaf files
	* components/throbber/Athena_Control_throbber.oaf.in:
	added new style oaf file\
	* components/throbber/athena-throbber.oafinfo:
	removed the old file
	* src/athena-window-toolbars.c:
	(athena_window_initialize_toolbars):
	more descriptive message when we get an exception

2001-01-17  Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/athena-self-checks.c:
	(athena_report_check_failure), (athena_before_check_function):
	Make make check results go to stderror.

2001-01-17  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Work to fix bugs 1939 and 4614 -- text in list view is hard to
	read when the foreground color specified by the gtk theme
	conflicts with the background colors:

	* libathena-extensions/athena-gdk-extensions.h,
	libathena-extensions/athena-gdk-extensions.c
	(athena_gdk_color_is_dark,
	athena_gdk_choose_foreground_color,
	athena_gdk_gc_choose_foreground_color): new functions, used
	for testing whether a foreground/background color pair is
	suitable for drawing text, and if not, choosing a new
	foreground color

	* libathena-extensions/athena-list.c (AthenaListDetails):
	added gc fields: text_color, selected_text_color, link_text_color
	(unref_gcs, make_gcs_and_colors): handle the new gcs

	(athena_list_setup_style_colors): use
	athena_gdk_gc_set_foreground_color () to create the gcs that
	will be used for drawing text

	(draw_cell): when drawing text cells, don't use the default
	foreground gc, use one of the specially chosen gcs

2001-01-17  Rebecca Schulman  <rebecka@eazel.com>

	* src/file-manager/athena-indexing-info.c:
	(update_file_index_callback), (show_indexing_info_dialog):
	Make changes necessary because of the slight change in the
	medusa_indexing_service api, and change "hide when closed"
	on the index status dialig to TRUE.  We still need to free
	the dialog when we exit athena (Added a fixme) but 
	setting this value to false caused us to reference
	 the freed dialog. 

2001-01-17  Andy Hertzfeld  <andy@eazel.com>

	fixed bugs 5674, 5697 and 5699, Athena shows a broken image
	icon instead of a mime-type icon for image types that it doesn't
	support.  Fixed by generating a zero-length placeholder thumbnail
	instead of the broken image icon; the icon factory tests for the
	placeholder and uses the proper mime-type icon when it's present.
	
	* libathena-extensions/athena-icon-factory.c:
	(should_display_image_file_as_itself),
	(athena_icon_factory_get_icon_for_file):
	made should_display_image_file_as_itself return FALSE when the
	placeholder is present.
	
	* libathena-extensions/athena-thumbnails.c:
	(make_invalid_thumbnail_uri),
	(athena_thumbnail_has_invalid_thumbnail), (check_for_thumbnails):
	added routine to test if a placeholder is present, and made it
	generate the placeholder when thumbnailing fails.
	
	* libathena-extensions/athena-thumbnails.h:
	added athena_thumbnail_has_invalid_thumbnail
	
2001-01-17  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-self-checks.h:
	* libathena-extensions/athena-self-checks.c:
	(athena_before_check_function), (athena_after_check_function):
	Write the names of the self-check functions as we run them.
	Maybe this will help us figure out what's up with the Tinderbox.

2001-01-17  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/athena-complex-search-bar.c:
	(athena_complex_search_bar_initialize):
	Remove some spacing settings that caused the 
	"More Options", "Fewer Options" and "Find Them"
	buttons in the search bar too have way too much
	space beneath them, fixing bug 4917
	* src/athena-window-private.h:
	Up the minimum width of athena so that
	the search controls are always still
	readable (from 450 to 480). However,
	this does not guarantee that on all
	configurations you wil be able to see the
	controls, but it should for the default case.

2001-01-17  Ian McKellar  <ian@eazel.com>

	reviewed by: Mike Fleming  <mfleming@eazel.com>

	* components/services/summary/athena-view/athena-summary-dialog
	s.c: (generate_login_dialog):
	* components/services/summary/athena-view/athena-summary-view-p
	rivate.h:
	Keep track of the currently displayed login dialog (for each view).
	If a login dialog is open when a dialog open request is recieved,
	close the old one.

2001-01-17  Andy Hertzfeld  <andy@eazel.com>

	* components/throbber/main.c: (main):	
	* components/throbber/athena-throbber.c:
	(athena_throbber_destroy):
	fixed problem that Pavel pointed out where the throbber
	component is left around after Athena exists, by calling
	gnome_vfs_shutdown when we exit, and also unrefing the
	throbber's bonobo control when the widget is destroyed.
	
2001-01-17  Andy Hertzfeld  <andy@eazel.com>

	reviewed by: <darin@eazel.com>

	* src/athena-window-manage-views.c: (unref_callback),
	(ref_now_unref_at_idle_time), (location_has_really_changed),
	(load_underway_callback):
	this is actually Darin's change, checked in by Andy, that's a
	better fix for bug 5657, the "destroying components messes up
	idle routines" crash.  Instead of deferring the window state change
	to idle time, it does an extra ref of the view and unrefs it when
	idle rolls around.
	
2001-01-16  Eskil Olsen  <eskil@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-view-identifier.c:
	(get_lang_list):
	LANG might contain an underscore, so add both the la_LC var, 
	but also only the la to the list. This fixes the "View as xxx"
	translation issue.

2001-01-17  Pavel Cisler  <pavel@eazel.com>

	Fix 5188: Duplicate in list view -> Athena crashes.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_duplicate_selection):
	It was really only an inaccurate assert.

2001-01-16  Ian McKellar  <ian@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_preflight_check):
	Removed check that package has been installed in preflight check 
	because this will never occur.

	(athena_install_service_describe_menu_entry),
	Added this function which is used to generate a text description
	of a menu item.

	(athena_install_service_locate_menu_entries),
	Check for files in an /applnk/ directories as well as in /gnome/apps/
	directories. Closed GnomeDesktopEntry leak.

	(athena_service_install_done),
	Implement the equivalent of the preflight check that I removed,
	but at a point where we know whether the install has succeed, failed,
	been cancelled or been struck by lightning.

	(athena_service_install_view_load_uri):
	Reset some state variables, so that some weird random things 
	don't happen.

2001-01-16  Mike Fleming  <mfleming@eazel.com>

	Dialog re-wording suggested by Vera.

	* components/services/summary/athena-view/athena-summary-callba
	cks.c: (authn_cb_failed):

2001-01-16  Pavel Cisler  <pavel@eazel.com>

	Fix 5511: Dropping a file in same folder asks about replacing it.
	Fix 5606: Left drag into window where file exists deletes file.
	
	* src/file-manager/fm-list-view.c: (fm_list_receive_dropped_icons):
	During a file move, add a check to see if the dragged items are in the
	target directory.
	
	* libathena-extensions/athena-list.c:
	(athena_list_get_drop_action):
	Tiny tweak.
	
2001-01-16  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-directory-background.c:
	Removed comment detailing differences with the background-capplet
	code since I just propagated the same fixes to the capplet.

2001-01-16  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-properties-window.c:
	(property_button_focused_out), (create_emblems_page):
	fixed bug 5572, black rectangle left behind after clicking
	on an emblem in Properties window, by attaching to the
	focus_out signal and redrawing
	
	* src/athena-property-browser.c:
	(athena_property_browser_initialize),
	(athena_property_browser_destroy),
	(athena_property_browser_theme_changed),
	(athena_property_browser_smooth_graphics_changed):
	fixed some of bug 5614, label text in property browser is
	corrupted when smooth text option changed, by monitoring the
	smooth_graphics preference and updating when it changes.  The
	rest of this bug will be fixed when Ramiro fixes the athena_label
	geometry problems as part of bug 5607
	
	* components/text/athena-text-view.c: (file_read_callback):
	corrected the name of the "file too big to load" dialog
	
2001-01-16  Michael Engber  <engber@eazel.com>

	reviewed by: Gene Z. Ragan

	* libathena-extensions/athena-directory-background.c:
	(athena_gnome_config_string_match_no_case_with_default),
	(athena_file_background_read_desktop_settings):
	Use theme defaults for desktop background when ~/.gnome/Background
	is missing.

2001-01-16  Seth Nickell  <seth@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-directory-metafile.c:
	(athena_directory_rename_file_metadata),
	(athena_directory_remove_file_metadata):
	* libathena-extensions/athena-file.c:
	(sort_keyword_list_and_remove_duplicates):

	Add casts to strcmp's performed on gpointers so they will
	not generate warnings.
	
2001-01-16  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	More work on bug 2146 (Properties window for desktop Trash icon
	should show Trash properties). Mostly this was clean-up of the
	properties window code to make future changes easier. The only
	substantive change is to remove the "Type" field for the trash.

	* src/file-manager/fm-properties-window.c: 
	Removed enums for basic page and permissions page row numbers.
	The rows are now added (and table sized) as needed.
	(append_row): New helper function, appends one row to a GtkTable
	and returns the index of the new last row.
	(append_title_field): New function, like attach_title_field
	but appends row instead of taking a row parameter.
	(append_separator), (append_directory_contents_fields),
	(append_title_value_pair), (append_special_execution_checkbox),
	(append_special_execution_flags): Renamed from attach_xxx, now 
	append a row instead of taking a row parameter.
	(create_page_with_table_in_vbox): Now returns GtkTable * instead
	of GtkWidget *, for callers' convenience.
	(get_adjusted_permissions_row): Removed this somewhat hacky function.
	(should_show_file_type): New function, returns FALSE for
	special trash location but TRUE for everything else.
	(create_basic_page): Check should_show_file_type; use new
	append_xxx calls instead of using predefined row numbers.
	(create_permissions_page): use new append_xxx calls instead of
	using predefined row numbers.

2001-01-16  Gene Z. Ragan  <gzr@eazel.com>

	Fixed mistake in asserting on a NULL value. Assert if the
	value is NULL, not non-NULL.
	
	* libathena-extensions/athena-file-operations.c:
	(extract_and_ellipsize_file_name_for_dialog):

2001-01-16  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(get_label_font): It's illegal to unref a new widget since you
	don't own a ref to it. Sink it instead.
	(ellipsize_string_for_dialog): New function.
	(format_and_ellipsize_uri_for_dialog): Rename this function and
	change it to use athena_format_uri_for_display. Also add FIXME
	about where the ellipsis goes.
	(extract_and_ellipsize_file_name_for_dialog): Added a seprate
	function for the case where we want to extract the file name
	part only. The old code mixed the URI and file name cases in a
	way that would lead to anomalies with unusual names.
	(handle_transfer_vfs_error): Fixed storage leak.
	(is_special_link): Rewrote this function and also made it take
	a URI in text form, not a GnomeVFSURI.
	(handle_transfer_overwrite): Use is_special_link instead of
	duplicate its test. Removed incorrect use of AthenaFile (without
	waiting for results). Added quotes around file name in
	message. Use extract_and_ellipsize_file_name_for_dialog instead of
	our own ad-hoc functions.
	(make_next_duplicate_name): Get rid of bizarre buffer/sprintf that
	was used by someone who didn't know you can use printf formatting
	with g_warning.
	(vfs_uri_is_special_link): Created cover for one remaining caller
	of is_special_link that needs to pass a GnomeVFSURI.
	(athena_file_operations_copy_move): Use the new is_special_link
	(athena_file_operations_move_to_trash): Use
	extract_and_ellipsize_file_name_for_dialog instead of an old
	strange combination of calls.
	
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_name_for_regular_file): Fix
	obsolete comment and rearrange code now that plain text special
	case is gone.

2001-01-16  Josh Barrow  <josh@eazel.com>

	* src/athena-first-time-druid.c: (druid_finished):
	Make the new services icon use big_services_icon.png.  This is a
	much better choice until we get something official.

2001-01-16  Gene Z. Ragan  <gzr@eazel.com>

	Checked in broken code before. Doh!
	
	* libathena-extensions/athena-link.c:
	* src/athena-first-time-druid.c: (druid_finished):

2001-01-16  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>

	Fixed bug 4358, Please put a services icon on the desktop
	
	* libathena-extensions/athena-link.c:
	(athena_link_local_create):
	Perform NULL checking on arguments
	
	* src/athena-first-time-druid.c: (druid_finished):
	Create a link to services on the desktop.

2001-01-16  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <ramiro@eazel.com>

	Bug 4411 -- implement keypress hook for Mozilla so that URL navigation
	initiated by keypress are handled the same as mouse-initiated navigation
	events (eg, correctly have their schemes translated if necessary)

	* components/mozilla/main.c: (mozilla_object_destroyed),
	(mozilla_make_object), (main):
	* components/mozilla/mozilla-events.cpp:
	* components/mozilla/mozilla-events.h:
	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize),
	(mozilla_open_uri_callback), (mozilla_dom_key_press_callback),
	(mozilla_dom_mouse_click_callback):

2001-01-16  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5677, Drag files w/names of Specials to desktop -> malloc crash
	Fixed bug 5673, Spaces are escaped in new "replace special desktop icon"
	dialog.
	
	* libathena-extensions/athena-file-operations.c:
	(handle_transfer_overwrite):

2001-01-15  John Sullivan  <sullivan@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Removed stuff I added earlier as part of a failed fix
	for bug 2068, which I ended up fixing a different way.

	Fixed bug 5661 (Hardwired button sizes for custom icons
	in properties window)

	Fixed bug 1682 ("Go There" button taller than others
	in "Open with Other" dialog)

	* libathena-extensions/athena-scrolled-window.h:
	* libathena-extensions/athena-scrolled-window.c:
	Removed these files from cvs.

	* libathena-extensions/Makefile.am:
	Removed the removed files from the build.
	
	* libathena-extensions/athena-metadata.h:
	removed ATHENA_METADATA_KEY_ICON_VIEW_SCROLL_ORIGIN

	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize): Changed back to inheriting
	from GtkScrolledWindow instead of now non-existent
	AthenaScrolledWindow.

	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_button_set_standard_padding): New function,
	wrapper for athena_gtk_button_set_padding that uses
	a standard amount of padding instead of taking a parameter.
	This is preferred so we can change a single number if we
	change our minds about what the standard padding should be.

	* libathena-extensions/athena-program-chooser.c:
	(athena_program_chooser_new): Use 
	athena_gtk_button_set_standard_padding. Also added a vbox
	so that "Go There" button doesn't grow taller to match the 
	height of the adjacent text. This fixed bug 1682.
	* src/athena-bookmarks-window.c: (create_bookmarks_window):
	Use athena_gtk_button_set_standard_padding.
	* src/file-manager/fm-properties-window.c: (create_basic_page):
	Use athena_gtk_button_set_standard_padding instead of
	hardwiring button sizes. This fixed bug 5661.

2001-01-16  Carlos Perelló Marín <carlos@gnome-db.org>

        * configure.in: Added es to ALL_LINGUAS.

2001-01-16  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-string-list.c:
	(athena_string_list_get_length):
	Allow for NULL to be treated as a zero length string list.
	
	* libathena-extensions/athena-string-picker.h:
	* libathena-extensions/athena-string-picker.c:
	(athena_string_picker_set_selected_string_index),
	(athena_string_picker_get_index_for_string):
	Two new functions to manipulate the string picker using indeces.
	
	* libathena-extensions/athena-text-caption.h:
	* libathena-extensions/athena-text-caption.c:
	(athena_text_caption_get_text), (athena_text_caption_set_text):
	Make the signature of get_text() use a const object.
	
	(athena_text_caption_set_editable): New function to change
	whether the caption's text is editable.

2001-01-16  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-window-manage-views.c: (change_state_at_idle),
	(load_underway_callback):
	fixed bug 5657, crash during menu update when switching views.  This is
	also behind several other reported bugs.  Fixed it as Darin suggested,
	which is to defer the window state change associated with loading
	a new component until idle time, so it doesn't wreak havoc
	by interrupting other idle routines.
	
	* components/throbber/athena-throbber.c:
	(athena_throbber_initialize_class), (get_bonobo_properties),
	(set_bonobo_properties), (athena_throbber_destroy),
	(athena_throbber_initialize),
	(athena_throbber_button_press_event):
	added a location property and made it issue a notification when the
	throbber is clicked on.  Also, removed the no longer used
	"location_changed" signal and better memory management of the
	property bag.
		
	* src/athena-window.c: (throbber_location_changed_callback),
	(athena_window_constructed), (athena_window_destroy):
	make clicking on the throbber work by adding a listener for
	the throbber location property and changing the location
	accordingly when the event is posted.  Also, fixed a leak
	of the bonobo object.
	
	* src/athena-window-private.h:
	added a field to hold the event source listener ID.

2001-01-15  Andy Hertzfeld  <andy@eazel.com>

	* components/throbber/main.c: (main):
	fixed recently introduced bug where the throbber wasn't respecting
	the theme; I had forgotten to initialize global preferences in the
	throbber component.
	
2001-01-15  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 4369, throbber frozen during long refresh, by making the
	throbber a bonobo component so it's driven by its own thread.
	Note that clicking on the throbber is temporarily broken; I'll
	fix that soon.  Also, made the frame delay be specified by the
	theme and set the default to spin somewhat slower than before.
	
	* configure.in:
	* components/Makefile.am:
	* components/throbber/.cvsignore:
	* components/throbber/Makefile.am:
	* components/throbber/athena-throbber.oafinfo:
	added throbber component
	
	* components/throbber/main.c: (throbber_object_destroyed),
	(throbber_make_object), (main):
	factory for the throbber component
	
	* components/throbber/athena-throbber.c,h:
	(athena_throbber_initialize_class), (is_throbbing),
	(get_bonobo_properties), (set_bonobo_properties),
	(athena_throbber_destroy), (athena_throbber_get_control),
	(get_throbber_dimensions), (athena_throbber_initialize),
	(athena_throbber_new), (athena_throbber_theme_changed),
	(draw_pixbuf), (select_throbber_image), (draw_throbber_image),
	(athena_throbber_draw), (athena_throbber_expose),
	(athena_throbber_map), (bump_throbber_frame),
	(athena_throbber_start),
	(athena_throbber_remove_update_callback),
	(athena_throbber_stop), (athena_throbber_unload_images),
	(load_themed_image), (make_throbber_frame_name),
	(athena_throbber_load_images),
	(athena_throbber_button_press_event),
	(athena_throbber_set_small_mode),
	(athena_throbber_size_allocate),
	(athena_throbber_size_request):
	throbber widget for the bonobo component

	* src/athena-window-toolbars.c: (theme_changed_callback),
	(athena_window_initialize_toolbars):
	set up throbber component in the toolbar
	
	* src/athena-window.c,h: (athena_window_constructed),
	(athena_window_allow_stop):
	use property interface to start and stop the throbber
	
	* icons/default.xml:
	added delay specification to throbber in default theme
	
	* athena-clean.sh:
	clean throbber component as necessary
	
	* src/Makefile.am:
	* src/athena-throbber.c,h
	removed old throbber widget
	
	
2001-01-15  Michael Engber  <engber@eazel.com>

	reviewed by: John Sullivan

	* libathena-extensions/athena-stock-dialogs.c:
	(athena_timed_wait_start_with_duration),
	(athena_timed_wait_start):
	* libathena-extensions/athena-stock-dialogs.h:
	* libathena-extensions/athena-trash-directory.c:
	(find_directory_start):
	Increase delay before putting up "searching for trash dialog"

2001-01-15  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Arlo Rose <arlo@eazel.com>

	Fixed bug 1420, pane splitter drag outline edges are indistinct

	* libathena-extensions/athena-horizontal-splitter.c:
	(splitter_xor_line):
	Make line appears as single pixel on off dash.
	
2001-01-15  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Engber <engber@eazel.com>

	Fixed bug 5651, Mounting write-protected disk gives Mount Error
	
	I examined the source code to mount. There is one case where
	an error message is returned but it is not an error.  I now
	check for that case in the error checking code.
	
	* libathena-extensions/athena-volume-monitor.c:
	(mount_volume_get_cdrom_name), (eject_cdrom), (close_error_pipe),
	(locate_audio_cd):
	Also remove some old debugging code and make sure audio cd
	mounting is ifdefed out.

2001-01-15  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <pavel@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(handle_transfer_vfs_error):

	Fixed error message for the case where a file was moved to an unwritable
	target where permissions were not known in advance (eg, Eazel vault).

	Previously: "The file or its directory cannot be changed"
	Now: "You do not have permissions to write to this folder"

2001-01-15  Michael Engber  <engber@eazel.com>

	reviewed by: Gene Z. Ragan

	* libathena-extensions/athena-directory-background.c:
	(set_root_pixmap): Fixed leaking x-server memory.

2001-01-15  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Some work on bug 2146 (Properties window for desktop Trash icon
	should show Trash properties)

	* src/file-manager/fm-properties-window.c:
	(is_merged_trash_directory): New helper function, checks whether
	window is displaying special trash location.
	(should_show_custom_icon_buttons): New helper function, returns
	FALSE for special trash location since custom icons don't work
	with the trash (see bug 5642)
	(should_show_mime_type): New helper function, extracted for
	code clarity (returns FALSE for directories).
	(create_basic_page): Now takes only one parameter, gets file
	and notebook from details struct; uses should_show_mime_type
	and should_show_custom_icon_buttons.
	(create_emblems_page), (create_permissions_page): Now take only
	one parameter, get file and notebook from details struct.
	(should_show_emblems): New helper function, returns FALSE for
	special trash location since emblems don't work with the
	trash (see bug 5643)
	(should_show_permissions): New helper function, returns FALSE for
	special trash location since it's not really a file system object
	for which permissions make sense.
	(create_properties_window): Respect should_show_emblems and
	should_show_permissions.

	Eli ran into a case where the "can't set permissions" error message
	was the vague default case when the disk was locked. I added that
	case to the set of specifically handled cases.

	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file), (fm_report_error_setting_group),
	(fm_report_error_setting_owner),
	(fm_report_error_setting_permissions): Handle
	GNOME_VFS_ERROR_READ_ONLY_FILE_SYSTEM cases.

2001-01-15  Ian McKellar  <ian@eazel.com>

	* components/services/inventory/eazel-inventory-service.c:
	(impl_Trilobite_Eazel_Inventory__get_machine_name):
	The default hostname is now guessed if:
	It now guesses a default if:
	 - gethostname succeds; and
	 - the hostname doesn't start with "localhost."
	 - the hostname doesn't equal "localhost"
	The hostname stored is the name, up to but not including the 
	first "." in the name (if any).

2001-01-15  Darin Adler  <darin@eazel.com>

	Fix bug 5557 (Intermittent crash in
	Athena_View_history_changed):
	
	* src/athena-view-frame.c: (send_history): Added a check for
	NULL so we don't try to send a NULL history list through the
	history machinery.

	Fix bug 5360 ("menthos's Home" string is hard to translate):

	* src/file-manager/fm-desktop-icon-view.c:
	(update_home_link_and_delete_copies): Added comment to help
	translators understand what to do with "%s's Home".

	Fix bug 5641 ("xfree" does not work with newer versions of RPM 4
	headers):
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header): Just
	use "free" instead of "xfree".

	Fix bug 5631 (Tear-offs of right-click menus don't work):
	
	* src/athena-shell-ui.xml:
	* src/file-manager/athena-directory-view-ui.xml:
	* src/file-manager/athena-icon-view-ui.xml:
	Mark popups and submenus of the popups with tearoff="0" so they
	don't have tear-off menu items.
	
	More work on bug 2147 (AthenaFile for trash needs non-empty
	values for more properties).
	
	* libathena-extensions/athena-file.h:
	* libathena-extensions/athena-file.c:
	(athena_file_new_from_relative_uri),
	(athena_file_new_from_info), (athena_file_monitor_add),
	(athena_file_monitor_remove),
	(athena_file_get_directory_item_count),
	(athena_file_get_deep_counts), (athena_file_check_if_ready),
	(athena_file_call_when_ready),
	(athena_file_cancel_call_when_ready):
	Put more of the machinery in place to make enough of AthenaFile
	virtual so that we can implement the trash case.
	
	* libathena-extensions/athena-merged-directory.h:
	* libathena-extensions/athena-merged-directory.c:
	(merged_add_real_directory),
	(athena_merged_directory_add_real_directory),
	(merged_remove_real_directory),
	(athena_merged_directory_remove_real_directory),
	(remove_all_real_directories),
	(athena_merged_directory_initialize_class):
	Make adding and removing directories use signals so we can share
	this list with the AthenaTrashFile.

	* libathena-extensions/athena-trash-file.c:
	(add_directory_callback), (remove_directory_callback),
	(athena_trash_file_initialize), (trash_destroy):
	Use a AthenaTrashDirectory object for the list of directories.
	
	* libathena-extensions/athena-vfs-file.c:
	(vfs_file_monitor_add), (vfs_file_monitor_remove),
	(vfs_file_call_when_ready), (vfs_file_cancel_call_when_ready),
	(vfs_file_check_if_ready), (vfs_file_get_item_count),
	(vfs_file_get_deep_counts), (athena_vfs_file_initialize_class):
	Move the guts of these functions into the "VFS" subclass.

	Other stuff:
	
	* libathena-extensions/athena-trash-directory.c:
	(find_directory_start), (find_directory_end),
	(find_directory_callback), (add_volume), (remove_trash_volume):
	Fix bug in the recently-added timed-wait, to handle the case where
	the call is cancelled as well as the case where it succeeds or
	fails.
	
	* src/file-manager/fm-directory-view.c:
	(zoomable_set_zoom_level_callback): Formatting tweak.
	
	* src/athena-main.c: (main): Fix the FIXME.

2001-01-15  Ian McKellar  <ian@eazel.com>

	* components/services/inventory-view/athena-inventory-config-page
	.c: (athena_inventory_config_page_initialize):
	Retreive the previously assigned machine name (if one exists).
	Retreive the previously set "warn before upload" setting.

	* components/services/inventory/eazel-inventory-client.c: (main):
	Added default values so that this actually works.

	* components/services/inventory/eazel-inventory-service.c:
	(impl_Trilobite_Eazel_Inventory__set_machine_name),
	(impl_Trilobite_Eazel_Inventory_upload):
	Added some temporary debugging code, and the beginnings of better
	error checking/reporting.
	Removed hardcoded filesystem paths.

	* components/services/inventory/eazel-inventory-utils.h:
	* components/services/inventory/eazel-inventory-utils.c:
	(eazel_gather_inventory), (eazel_inventory_local_path):
	Removed hardcoded filesystem paths.

2001-01-15  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5533, Need good dialog text for failed
	replace of special desktop icons.
	
	* libathena-extensions/athena-file-operations.c:
	(handle_transfer_overwrite):

2001-01-15  J Shane Culpepper  <pepper@eazel.com>

	reviewed by: Michael Engber <engber@eazel.com>

	* src/athena-application.c: (athena_application_startup):
	* src/athena-application.h:
	* src/athena-first-time-druid.c: (druid_finished):
	* src/athena-main.c: (main):

	Fix for bug #1555.  There is already an error dialog but there
	was an infinite loop problem hiding it.  If the first time druid
	failed to create .athena, etc it would just run over and over
	again.

2001-01-15  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5635, RPM view crashed if click "Install"
	after unmounting volume containing RPM
	
	Fixed bug 5636, Unmounting a volume doesn't close
	it's associated windows.
		
	* src/athena-application.c: (athena_application_initialize),
	(volume_mounted_callback), (volume_unmounted_callback):
	Connect to volume monitor signals.  When a volume is unmounted,
	examine open window list and close any windows that originate
	from the volume being unmounted.
			
	Add code to mount audio cds on desktop. It is all
	ifdefed out right now.
	
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link),
	(update_disks_menu):

	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_volume_is_removable),
	(athena_volume_monitor_get_removable_volumes),
	(athena_volume_monitor_get_target_uri),
	(mount_volume_get_cdda_name), (mount_volume_activate_cdda),
	(mount_volume_get_name), (mount_volume_activate),
	(get_current_mount_list), (mount_volumes_check_status),
	(mount_volume_cdda_add), (mount_volume_add_filesystem),
	(open_cdda_device), (locate_audio_cd):
	* libathena-extensions/athena-volume-monitor.h:

2001-01-14  J Shane Culpepper  <pepper@eazel.com>

	* src/athena-view-frame.c: (attach_client):

	Upped the timeout from 10 seconds to 12 seconds to be paranoid on
	really slow machines. I think this is really generous for bug #4757.
	In an attempt to reproduce the crash I started a build of mozilla
	and gcc "emulate" a slow machine since I don't have one.  Adding
	additional comments to bugzilla bug #4757.

2001-01-13  Jim Garrison <garrison@users.sourceforge.net>

	* athena.spec.in: package "extras" no longer depends on mpg123

2001-01-13  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5414, Don't create a link for launchers dragged onto desktop
	that require a terminal
	
	* src/file-manager/fm-desktop-icon-view.c: (create_link_callback),
	(icon_view_create_athena_links):
	Display a simple dialog telling user that we don't support htis feature yet.

2001-01-13  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-canvas-item.c: (hit_test):
	fixed bug 4731, expanding folders cause oscillation, by hit-testing
	to the bounding box instead of the pixmap when an icon is highlighted
	for dropping.
	
2001-01-12  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Arik Devens  <arik@gnome.org>

	* components/music/athena-music-view.c:
	(music_view_set_selected_song_title), (reset_playtime),
	(play_status_display), (slider_moved_callback),
	(add_play_controls):
	Fix bug 5617.  Playtime in music view keeps growing forever.
	
2001-01-12  John Sullivan  <sullivan@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	Fixed bug 5437 (date column is too wide for default athena width)

	* src/file-manager/fm-list-view.c: (real_get_column_specification):
	Tweaked the default column widths so they're more balanced in the
	default window width. The tradeoff is that you lose the date column
	more quickly if you resize the window thinner (but of course the
	user can stretch the columns to get it back). The column widths
	in the search results view already look decent, for slightly
	mysterious historical reasons.

2001-01-12  Michael Engber  <engber@eazel.com>

	reviewed by: Gene Z. Ragan

	* libathena-extensions/athena-icon-canvas-item.c:
	(draw_stretch_handles_aa), (draw_label_text_aa),
	(athena_icon_canvas_item_render):
	Removed last vestiges of affine/libart code which was
	slowing up icon drawing - bug 5381.

2001-01-12  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/install/athena-view/athena-service-install-view.c:
	(athena_service_install_downloading):
	I meant to actually remove the code rather than comment it out.

2001-01-12  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Arik Devens  <arik@gnome.org>

	* libathena-extensions/athena-label.c:
	(athena_label_expose_event),
	(athena_label_set_background_mode), (athena_label_set_text),
	(athena_label_get_text):
	* libathena-extensions/athena-label.h:
	Change the get_text() prototype to use a const object.  Add a
	workaround for bug 5608 while I debug the problem.

	reviewed by: Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/athena-service-install-view.c:
	(athena_service_install_downloading):
	Remove queue_resize() workarounds for improperly displaying
	labels.  I checked in a workaround in AthenaLabel instead.
	
2001-01-12  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 5198, removing an active sidebar panel messes up the
	remaining ones. I had already fixed this but missed the case when
	multiple windows were open. Fixed by adding a sidebar call to
	close the active panel if it matches a passed-in id, and used that
	in athena window to close the panel if necessary before
	destroying it.
	
	* src/athena-sidebar.c:
	(athena_sidebar_hide_active_panel_if_matches),
	(toggle_sidebar_panel):
	added routine to close the active panel if it matches a passed-in
	id.
	* src/athena-sidebar.h:
	added above mentioned routine
	
	* src/athena-window-manage-views.c: (handle_view_failure),
	(athena_window_set_sidebar_panels):
	close the active panel if necessary before destroying it.
	
2001-01-12  John Sullivan  <sullivan@eazel.com>

	Fixed the corner of bug 3405 that valiant bug verifier Brett
	discovered while verifying. Yay for bug verification!

	* src/file-manager/fm-icon-view.c: (switch_to_manual_layout):
	I had neglected to remove an extra call to
	athena_icon_container_reset_scroll_region here. It's already
	handled one level lower, where the empty directory case is
	taken into account.

2001-01-12  John Sullivan  <sullivan@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	Fixed bug 2207 (Search needs to gracefully handle too
	many items found)

	* libathena-extensions/athena-directory-async.c:
	(directory_load_done): Don't treat GNOME_VFS_OK as an
	error case here. This was happening when the file limit
	was reached, and the resulting propogated error was making
	it to the search list view code, which was putting up
	an error dialog saying no error had occurred.
	
	* libathena-extensions/athena-directory.h:
	Added FIXME with bug number for new bug 5603, which complains
	that the file list limit isn't as hard as it claims.
	
	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize_class),
	(fm_directory_view_file_limit_reached), (real_file_limit_reached),
	(check_for_directory_hard_limit): Broke out the code that handles
	the UI when the directory contains too many files such that
	subclasses can override the behavior.

	(fm_directory_view_get_containing_window): Renamed from
	"get_containing_window" and made public so subclasses don't have
	to reimplent.
	(fm_directory_view_confirm_multiple_windows),
	(fm_directory_view_launch_application), (choose_program),
	(fm_directory_view_confirm_deletion), (confirm_delete_from_trash),
	(report_broken_symbolic_link), (fm_directory_view_activate_file):
	Updated for function name change.
	
	* src/file-manager/fm-search-list-view.c: 
	(load_error_callback): Marked strings for localization; reworded to
	avoid use of "directory".
	(fm_search_list_view_initialize_class),	(real_file_limit_reached):
	Put up dialog that's been worded specifically for search results
	when too many items are found.

2001-01-12  Ramiro Estrugo  <ramiro@eazel.com>

	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-athena-label-offset.c: (main):
	* test/test.h:

	Add a test for debugging bug 5608.
	
2001-01-12  Zbigniew Chyla  <cyba@gnome.pl>

	* libathena-extensions/athena-gtk-macros.h:
	Define empty ATHENA_ASSIGN_MUST_OVERRIDE_SIGNAL macro if
	G_DISABLE_ASSERT is defined.

2001-01-11  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_start_transaction):

	Reverse the package list just before installing, so that the
	install view gets info on toplevel packages before their
	dependencies (this keeps the user from being bored, since they'll
	see the package detailed info on toplevel packages while the
	others are installing).
	
	* components/services/install/lib/eazel-install-metadata.c:
	(init_default_install_configuration):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_uninstall_packages):

	Remove last vestigal uses of a literal "/var" path.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (install_message_new), (generate_install_form),
	(current_progress_bar_complete),
	(athena_service_install_downloading),
	(previous_install_finished), (athena_service_install_installing),
	(athena_service_install_done):
	* components/services/install/athena-view/athena-service-instal
	l-view.h:

	Finish Arlo'ification of the install view: Pin the message box at
	a specific height, clean up lots of nastiness caused by the new
	font system, and fix up the text displayed per-package when the
	package is done being installed.  Also, fix a bug that caused a
	cancelled install to report that it was successful.
	
	* components/services/athena-dependent-shared/eazel-services-head
	er.c: (eazel_services_header_middle_new):

	Change positioning of the middle header so that it doesn't cause
	mondo amounts of empty space to appear beneath it.  (Not sure why;
	GTK magic.)

2001-01-11  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fixed bug 5589 (crash when dragging from list view), that I'd
	introduced when making list view icons anti-aliased

	* libathena-extensions/athena-list.h,
	libathena-extensions/athena-list.c
	(athena_list_get_pixbuf): new function, returns the GdkPixbuf
	stored in a cell, or a null pointer if there isn't one

	* src/file-manager/fm-list-view.c (fm_list_get_drag_pixmap):
	use athena_list_get_pixbuf to fetch the GdkPixbuf from the
	row, then gdk_pixbuf_render_pixmap_and_mask to turn it into the
	required format (instead of accessing the AthenaClist widget
	directly, assuming that a Pixmap is stored in the cell)

2001-01-12  Rebecca Schulman  <rebecka@eazel.com>

	* src/athena-complex-search-bar.c:
	(athena_complex_search_bar_get_location):
	Change "index-only" to "index-if-available"
	in search uris, to take advantage of the new
	option in medusa to perform a slow search
	only if an index is unavailable

2001-01-11  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fixed bug 2068 (Dragging icons adjusts scroll area in a way
	that causes immediate scrolling)

	Fixed bug 3402 (Dragging singleton icon to edge of window in
	manual layout mode puts it back at top-left)

	Fixed bug 3405 (Dropping an icon into empty manual-layout
	window always puts it at top-left)

	Fixed bug 3570 (Relayout glitch after removing an item from
	a view)

	I had earlier started to fix these by trying to save and
	restore the scroll position per directory. But this path
	turned evil, and I gave up on it. There is still some
	partly-implemented work from my start in the evil direction,
	which I will remove in my next checkin.

	The new fix was to always include the visible white space
	when recomputing the icon container's scroll region, unless
	a caller has specifically requested not to.

	* libathena-extensions/athena-icon-container.h:
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_reset_scroll_region): New function,
	sets a flag in the details struct that's respected in the
	next scroll region update.
	(reset_scroll_region_if_not_empty): New helper function,
	calls _reset_scroll_region unless container is empty.
	(athena_icon_container_update_scroll_region_include_visible_area):
	Removed this function; its equivalent is to call reset_scroll_region
	before calling update_scroll_region.
	(athena_icon_container_update_scroll_region): Now that the
	_include_visible_area variant is gone, merged the local function
	update_scroll_region with this public one. It decides whether to
	include the visible area or not based on the flag set by
	_reset_scroll_region (also, it never includes the visible area
	if the container is empty).
	(athena_icon_container_set_auto_layout): Reset the scroll region
	when changing the auto_layout state.
	(athena_icon_container_sort): reset the scroll region before
	sorting.

	* libathena-extensions/athena-icon-dnd.c: (handle_local_move):
	Call athena_icon_container_update_scroll_region instead of
	_update_scroll_region_include_visible_area, which no longer exists.
	
	* libathena-extensions/athena-icon-private.h: Store flag for
	resetting scroll region in details; eliminate prototype for
	athena_icon_container_update_scroll_region_include_visible_area.
	
	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize_class), (done_loading),
	(fm_directory_view_begin_loading), (fm_directory_view_end_loading):
	Added end_loading signal that's sent when a directory is finished
	loading, parallel to existing begin_loading signal.

	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_add_file): Reset the scroll region for the first
	icon added when loading a directory.
	(fm_icon_view_begin_loading), (fm_icon_view_end_loading): 
	Remember that we're loading, so	fm_icon_view_add_file can test correctly.
	(set_sort_criterion_by_id): Bail out early if state hasn't changed.
	(switch_to_manual_layout): Bail out early if state hasn't changed.
	Also, reset scroll region before switching to manual layout.
	(fm_icon_view_initialize_class): Attach fm_icon_view_end_loading to
	virtual function slot.

2001-01-11  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-property-browser.c: (make_category_link):
	Add a fixme for a problem i just spotted.
	
2001-01-11  Robin * Slomkowski  <rslomkow@eazel.com>

	* test/Makefile.am: added test/test.h to EXTRA_DIST

2001-01-11  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Mike Fleming  <mfleming@eazel.com>

	* libathena-extensions/athena-art-extensions.c:
	(athena_art_irect_align):
	* libathena-extensions/athena-art-extensions.h:
	New function to align a rectangle within another.
	
	* libathena-extensions/athena-image.c:
	(image_get_pixbuf_bounds):
	* libathena-extensions/athena-label.c: (label_get_text_bounds):
	Share more code between these two widgets by using a common
	alignment routine.
	
2001-01-11  Michael Meeks  <michael@helixcode.com>

	* components/adapter/athena-adapter-embeddable-embed-strategy.c
	(athena_adapter_embeddable_embed_strategy_new): remove redundant
	bonobo_item_container_add.

2001-01-11  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c: (make_category_link):
	make the category links use athena-image for anti-aliased
	graphics like we intended, now that Ramiro has fixed the
	background problems.
	
	* icons/eazel/Back.png
	* icons/eazel/Forward.png
	* icons/eazel/Home.png
	* icons/eazel/Refresh.png
	* icons/eazel/Search.png
	* icons/eazel/SearchWeb.png
	* icons/eazel/Services.png
	* icons/eazel/Stop.png
	* icons/eazel/Up.png
	newer toolbar buttons from Susan
	
2001-01-11  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-about.c: (athena_about_draw_info),
	(athena_about_update_authors):

	Fix bug 5056 - hard coded fonts in About dialog.
	
2001-01-11  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-preferences.c:
	(preferences_hash_node_check_changes_func):
	Yank FIXME for bug 1273 which no longer exists.
	
2001-01-11  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/launcher/athena-launcher-applet.c: (image_leave_event),
	(set_is_launching), (image_button_press_event),
	(image_button_release_event), (main):
	Fix imminent build bustage.  Updates for AthenaImage api changes.
	
2001-01-11  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-corba-callback.c:
	(eazel_install_callback_initialize), (eazel_install_callback_new):

	Turn g_error to g_warning in the EazelInstallCallback initializer,
	so that it doesn't kill off the view when the install service
	isn't around.  Instead, set some fields to NULL and return
	normally.  The *_new call then returns NULL on failure.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_installing),
	(athena_service_install_view_update_from_uri):

	Notice if the eazel_install_callback_new call returns NULL, and
	gracefully handle it by ceasing operations and popping up a dialog
	about the failure.  This solves the "don't crash if the install
	service is missing" bug.

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_add_repository):
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-protocols.c:
	(my_copy_file), (eazel_install_fetch_file):
	* components/services/install/lib/eazel-install-public.h:
	* athena-installer/src/installer.c: (get_candidate_dirs),
	(search_for_local_cds), (eazel_installer_initialize):
	* athena-installer/src/main.c:

	Retrofit the --cache-dir option and code to automatically add
	mounted CD packages to the repository, from the PR3 installer
	branch.
	
	* athena-installer/src/Makefile:

	Help me, Obi-wan, you're my only hope.

2001-01-11  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fix bugs 4711, 2322, 3778, 4989, 5044, 5166, 5408, 4418, 3779 (parts),
	5051, 2783 and maybe other relating to (ab)use of fonts,
	backgrounds and other sacred attrbiutes of Gtk themes.
	
	* components/hardware/athena-hardware-view.c: (setup_form_title),
	(setup_overview_form), (setup_CPU_form), (setup_RAM_form),
	(setup_IDE_form):
	Fix hard coded fonts.
	
	* components/music/athena-music-view.c:
	(athena_music_view_initialize),
	(music_view_set_selected_song_title), (reset_playtime),
	(play_status_display), (slider_moved_callback),
	(add_play_controls):
	Fix hard coded fonts.
	
	* components/rpmview/athena-rpm-verify-window.c:
	(athena_rpm_verify_window_initialize):
	Fix hard coded fonts.
	
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize):
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (horizontal_line_new), (install_message_new),
	(generate_install_form),
	(athena_service_install_view_initialize),
	(current_progress_bar_complete),
	(athena_service_install_installing):
	Fix hard coded fonts.
	
	* components/services/login/athena-view/athena-change-password-
	view.c: (generate_change_password_form), (authn_succeeded),
	(authn_failed), (change_password_button_cb),
	(athena_change_password_view_initialize):
	Fix hard coded fonts.  Cleanup header inclusion a bit.
	
	* components/services/athena-dependent-shared/Makefile.am:
	Retire some crufty code.
	
	* components/services/athena-dependent-shared/eazel-services-exte
	nsions.c: (eazel_services_image_new),
	(eazel_services_image_new_from_uri):, (eazel_services_label_new):
	Update for label, image and hard coded font changes.
	
	* components/services/athena-dependent-shared/eazel-services-exte
	nsions.h:
	Make the colors opaque.  Remove a bunch of hard coded font stuff.
	Also remove a bunch of hard coded offsets.  We use alignments and
	paddings instead.

	* components/services/athena-dependent-shared/eazel-services-foot
	er.c: (label_enter_event), (label_leave_event),
	(image_enter_event), (footer_item_new),
	(eazel_services_footer_update):
	Update for label, image and hard coded font changes.

	* components/services/athena-dependent-shared/eazel-services-head
	er.c: (eazel_services_header_title_new),
	(eazel_services_header_middle_new):
	* components/services/athena-dependent-shared/shared-service-util
	ities.c:
	* components/services/athena-dependent-shared/shared-service-util
	ities.h:
	* components/services/athena-dependent-shared/shared-service-widg
	ets.c:
	* components/services/athena-dependent-shared/shared-service-widg
	ets.h:
	* components/services/summary/athena-view/athena-summary-callba
	cks.c:
	* components/services/summary/athena-view/athena-summary-dialog
	s.c: (generate_login_dialog):
	* components/services/summary/athena-view/athena-summary-footer
	.c:
	* components/services/summary/athena-view/athena-summary-menu-i
	tems.c:
	* components/services/summary/athena-view/athena-summary-view-p
	rivate.h:
	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_eazel_news_entry_row), (generate_update_news_entry_row):
	Update for label, image and hard coded font changes.
	
	* libathena-extensions/Makefile.am:
	Add new smooth/label/image widget stuff.  Retire buffered widget.
	
	* libathena-extensions/athena-art-extensions.c:
	(athena_art_irect_get_width), (athena_art_irect_get_height):
	* libathena-extensions/athena-art-extensions.h:
	Two new very simple functions to get the width/height of an
	ArtIRect. 
	
	* libathena-extensions/athena-art-gtk-extensions.c:
	(athena_irect_gtk_widget_get_frame):
	* libathena-extensions/athena-art-gtk-extensions.h:
	New simple function to get the dimensions of a widget as an
	ArtIRect frame.

	* libathena-extensions/athena-buffered-widget.c:
	* libathena-extensions/athena-buffered-widget.h:
	Retire.  We dont use this no more.
	
	* libathena-extensions/athena-customization-data.c:
	(athena_customization_data_get_next_element_for_display):
	Update for image and hard coded font changes.

	* libathena-extensions/athena-debug-drawing.c:
	(debug_pixbuf_viewer_initialize_class),
	(debug_pixbuf_viewer_initialize), (debug_pixbuf_viewer_destroy),
	(debug_pixbuf_viewer_size_request),
	(debug_pixbuf_viewer_expose_event),
	(debug_pixbuf_viewer_set_pixbuf),
	(athena_debug_draw_rectangle_and_cross), (destroy_debug_window),
	(athena_debug_show_pixbuf):
	* libathena-extensions/athena-debug-drawing.h:
	Back to using a widget to display the debug pixbuf.  But since we
	cant use AthenaImage (because we want to use this debug stuff to
	debug AthenaImage itselft) we need something else.  Thus a new
	private and simple widget to display the debug pixbuf.
	
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(athena_gdk_pixbuf_draw_to_drawable),
	(athena_gdk_pixbuf_draw_to_pixbuf_alpha): Fix a very dumb typo.
	(draw_tile_to_pixbuf_callback),
	(athena_gdk_pixbuf_draw_to_pixbuf_tiled),
	(athena_gdk_pixbuf_draw_to_drawable_tiled),
	(athena_gdk_pixbuf_get_from_window_safe):
	Rename opacity macros to FULLY_OPAQUE and FULLY_TRANSPARENT for
	clarity. 

	* libathena-extensions/athena-gdk-pixbuf-extensions.h:
	Rename opacity macros to FULLY_OPAQUE and FULLY_TRANSPARENT for
	clarity. 
	
	* libathena-extensions/athena-icon-factory.c: (embed_text):
	Update opacity macros.  Tiny update for change in font constructor.

	* libathena-extensions/athena-image-with-background.h:
	* libathena-extensions/athena-image-with-background.c:
	(find_background_ancestor), (draw_background_callback),
	(athena_image_new_with_background):
	Create a AthenaImage that uses AthenaBackground to
	draw the background.  We put this in a separate file to avoid the
	ugly dependency chain in AthenaBackground so that AthenaImage
	can be used by standalone components in the future.

	* libathena-extensions/athena-image.h:
	* libathena-extensions/athena-image.c:
	(athena_image_initialize_class), (athena_image_initialize),
	(athena_image_destroy), (athena_image_set_arg),
	(athena_image_get_arg), (athena_image_size_request),
	(image_paint_pixbuf_callback), (image_composite_pixbuf_callback),
	(athena_image_expose_event),
	(athena_image_set_is_smooth_signal), (image_get_pixbuf_frame),
	(image_get_pixbuf_bounds), (image_get_tile_frame),
	(athena_image_new), (athena_image_set_is_smooth),
	(athena_image_get_is_smooth), (athena_image_set_tile_pixbuf),
	(athena_image_get_tile_pixbuf), (athena_image_set_pixbuf),
	(athena_image_set_pixbuf_from_file_name),
	(athena_image_get_pixbuf), (athena_image_set_pixbuf_opacity),
	(athena_image_get_pixbuf_opacity),
	(athena_image_set_tile_opacity),
	(athena_image_get_tile_opacity), (athena_image_set_tile_width),
	(athena_image_get_tile_width), (athena_image_set_tile_height),
	(athena_image_get_tile_height),
	(athena_image_set_tile_mode_vertical),
	(athena_image_get_tile_mode_vertical),
	(athena_image_set_tile_mode_horizontal),
	(athena_image_get_tile_mode_horizontal),
	(athena_image_set_tile_pixbuf_from_file_name),
	(athena_image_set_background_mode),
	(athena_image_get_background_mode),
	(athena_image_set_solid_background_color),
	(athena_image_get_solid_background_color),
	(athena_image_new_solid):
	Fixed many problems.  Properly handles rendering 
	on top of arbitrary Gtk backgrounds.  Does not allocate a buffer
	the size of the widget anymore.  All rendering occurs on exposure
	events.  Honrts the the GtkMisc superclass attrbutes for alignment
	and padding.  The widget is a lot simpler now.
	
	* libathena-extensions/athena-label-with-background.h:
	* libathena-extensions/athena-label-with-background.c:
	(find_background_ancestor), (draw_background_callback),
	(athena_label_new_with_background):
	Create a AthenaLabel that uses AthenaBackground to
	draw the background.  We put this in a separate file to avoid the
	ugly dependency chain in AthenaBackground so that AthenaLabel
	can be used by standalone components in the future.

	* libathena-extensions/athena-label.h:
	* libathena-extensions/athena-label.c:
	(athena_label_initialize_class), (athena_label_initialize),
	(athena_label_destroy), (athena_label_set_arg),
	(athena_label_get_arg), (athena_label_size_request),
	(label_paint_pixbuf_callback), (label_composite_pixbuf_callback),
	(athena_label_expose_event),
	(athena_label_set_is_smooth_signal), (label_draw_text_to_pixbuf),
	(label_get_default_line_wrap_width), (label_get_text_frame),
	(label_get_text_bounds), (label_get_tile_frame), (label_peek_text),
	(label_get_empty_line_height),
	(label_get_total_text_and_line_offset_height),
	(label_line_geometries_clear), (label_line_geometries_recompute),
	(athena_label_new), (athena_label_set_smooth_font),
	(athena_label_get_smooth_font),
	(athena_label_set_smooth_font_size),
	(athena_label_get_smooth_font_size),
	(athena_label_set_is_smooth), (athena_label_get_is_smooth),
	(athena_label_set_tile_pixbuf), (athena_label_get_tile_pixbuf),
	(athena_label_set_text_opacity),
	(athena_label_get_text_opacity),
	(athena_label_set_tile_opacity),
	(athena_label_get_tile_opacity), (athena_label_set_tile_width),
	(athena_label_get_tile_width), (athena_label_set_tile_height),
	(athena_label_get_tile_height),
	(athena_label_set_tile_mode_vertical),
	(athena_label_get_tile_mode_vertical),
	(athena_label_set_tile_mode_horizontal),
	(athena_label_get_tile_mode_horizontal),
	(athena_label_set_tile_pixbuf_from_file_name),
	(athena_label_set_background_mode),
	(athena_label_get_background_mode),
	(athena_label_set_solid_background_color),
	(athena_label_get_solid_background_color),
	(athena_label_set_smooth_line_wrap_width),
	(athena_label_get_smooth_line_wrap_width),
	(athena_label_set_text_color), (athena_label_get_text_color),
	(athena_label_set_smooth_drop_shadow_offset),
	(athena_label_get_smooth_drop_shadow_offset),
	(athena_label_set_smooth_drop_shadow_color),
	(athena_label_get_smooth_drop_shadow_color),
	(athena_label_set_justify), (athena_label_get_text_justify),
	(athena_label_set_text), (athena_label_get_text),
	(athena_label_set_wrap), (athena_label_get_wrap),
	(athena_label_new_solid), (athena_label_make_bold),
	(athena_label_make_larger), (athena_label_make_smaller):
	Fixed many problems.  Properly handles rendering 
	on top of arbitrary Gtk backgrounds.  Does not allocate a buffer
	the size of the widget anymore.  All rendering occurs on exposure
	events.  Honors the the GtkMisc superclass attrbutes for alignment
	and padding.  AthenaLabel is now subclassed from GtkLabel
	itself.  That means that the is_smooth attribute can be toggled to
	make both religions happy.  Support for making the label larger,
	smaller and/or bold based on the current font.  Renamed a lot of
	methods to make it obvious that they apply only to the smooth case.
	Also made the api match GtkLabel more closely.  So many functions
	got renamed.
	
	* libathena-extensions/athena-radio-button-group.c:
	(athena_radio_button_group_set_entry_pixbuf):
	Tiny update for changes in the AthenaImage constructor.

	* libathena-extensions/athena-scalable-font-private.h:
	New file.  Some private font stuff lives here.  I need this
	changed for a checkin that I will make later regarding improvement
	of performance in the icon container smooth fonts.
	
	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-scalable-font.c:
	(athena_scalable_font_initialize), (font_entry_new),
	(font_entry_free), (athena_scalable_font_new),
	(athena_scalable_font_make_bold),
	(athena_scalable_font_draw_text),
	(athena_scalable_font_draw_text_lines_with_dimensions),
	(athena_scalable_font_draw_text_lines),
	(athena_scalable_font_get_default_font),
	(athena_scalable_font_get_rsvg_handle),
	(athena_scalable_font_get_rsvg_context),
	(athena_text_layout_paint):
	Change the constructor to return the type itself instead of
	GtkObject.  Some minor style tweaks.  Keep track of the font entry
	that was used to allocate the font.  New private functions for
	accessing the rsvg context and font handles.  Remove an unsed
	function. 
	
	* libathena-extensions/athena-smooth-widget.h:
	* libathena-extensions/athena-smooth-widget.c:
	(widget_is_smooth), (smooth_widget_set_is_smooth),
	(preferences_get_is_smooth), (smooth_widget_destroy),
	(smooth_graphics_mode_changed_callback),
	(athena_smooth_widget_register),
	(smooth_widget_get_tile_origin_point),
	(smooth_widget_get_gtk_background), (smooth_widget_get_background),
	(smooth_widget_paint_tile_opaque),
	(smooth_widget_paint_tile_transparent),
	(smooth_widget_paint_content_opaque),
	(smooth_widget_paint_content_transparent),
	(smooth_widget_paint_tile_and_content_transparent),
	(athena_smooth_widget_paint),
	(athena_smooth_widget_get_tile_bounds),
	(athena_smooth_widget_get_preferred_frame):
	Shared code between AthenaLabel and AthenaImage.  ALl the code
	to support smooth toggable widgets lives here.  Also, keep track
	of smooth widgets and toggle their is_smooth attribute in response
	to athena smooth graphics preferences changes.
	
	* libathena-extensions/athena-tabs.c:
	(athena_tabs_initialize), (draw_tab_label):
	Tiny update for change in font constructor.  Add a FIXME for a
	hard coded font issue im going to fix later.  Opacity macro
	update. 
	
	* src/file-manager/fm-properties-window.c:
	(create_image_widget_for_file):
	Using the new image widget makes this code a lot simpler.  No
	longer need to check smooth preference.  It all happens
	automatically. 
	
	* src/file-manager/athena-indexing-info.c:
	(update_progress_display), (show_reindex_request_information),
	(show_index_progress_bar), (show_indexing_info_dialog):
	Fix a bunch of hard coded font issues.
	
	* src/athena-about.c: (draw_aa_string),
	(athena_about_draw_info), (athena_about_update_authors):
	Tiny update for change in font constructor.  Opacity macro
	update. 
	
	* src/athena-first-time-druid.c: (label_new_left_justified),
	(make_hbox_user_level_radio_button), (set_up_user_level_page),
	(set_up_service_signup_page), (set_up_update_page),
	(set_up_proxy_config_page), (set_up_update_feedback_page),
	(athena_first_time_druid_show):
	Fix a bunch of hard coded font issues.  Also fix the rendering
	problems with image usage inside selectable buttons.
	
	* src/athena-property-browser.c:
	(athena_property_browser_initialize),
	(set_emblem_image_from_file), (make_property_tile),
	(make_properties_from_directories), (add_reset_property),
	(make_properties_from_xml_node),
	(athena_property_browser_update_contents):
	Fix hard coded fonts.  Update for AthenaImage and AthenaLabel
	changes. 
	
	* src/athena-search-bar-criterion.c:
	Remove unused #include.
	
	* src/athena-shell.c: (display_caveat):
	Fix hard coded fonts.
	
	* src/athena-sidebar-tabs.c:
	(athena_sidebar_tabs_load_theme_data), (draw_one_tab_plain),
	(draw_one_tab_themed):
	Fix hard coded fonts.  Opacity macros update.
	
	* src/athena-sidebar-title.c:
	(athena_sidebar_title_initialize),
	(athena_sidebar_title_select_text_color), (update_icon),
	(update_font), (update_title), (update_more_info), (add_emblem),
	(sidebar_title_create_title_label),
	(sidebar_title_create_more_info_label),
	(smooth_graphics_mode_changed_callback):
	Update for AthenaImage and AthenaLabel changes.  Made the
	widget a lot simpler.  

	We no longer need to keep track of smooth changes in the sidebar
	title.  They are taked care automatically by the widgets.  

	We no longer need to create 2 labels to honor smoothness.
	AthenaLabel does it all now.
	
	Removed a set_background() function that already
	exists in athena-extensions.

	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize), (set_help_label),
	(exit_remove_mode):
	Fix hard coded fonts.
	
	* test/font-test.sh:
	Retire.  Not needed.

	* test/.cvsignore:
	* test/Makefile.am:
	Add a bunch of tests.

	* test/test.h:
	* test/test.c:
	Put shared test code here.
	
	* test/test-athena-font-simple.c:
	* test/test-athena-font.c:
	* test/test-athena-image-background.c:
	* test/test-athena-image-scrolled.c:
	* test/test-athena-image-simple.c:
	* test/test-athena-image-tile.c:
	* test/test-athena-image.c:
	* test/test-athena-label-background.c:
	* test/test-athena-label-flavorful.c:
	* test/test-athena-label-scrolled.c:
	* test/test-athena-label-simple.c:
	* test/test-athena-label-wrapped.c:
	* test/test-athena-label.c:
	* test/test-athena-pixbuf-tile.c:
	* test/test-athena-smooth-graphics.c:
	* test/test-athena-wrapped-label.c:
	Some new tests.  Many updates to old label and image tests.

2001-01-11  Robin * Slomkowski  <rslomkow@eazel.com>

	* components/services/inventory/Makefile.am: added $(IDL) to
	EXTRA_DISTS

2001-01-11  Ian McKellar  <ian@eazel.com>

	* components/services/install/command-line/Makefile.am:
	Don't build the inventory test code here as the inventory code has
	moved to the inventory component.

	* components/services/inventory/eazel-inventory-service-interface.i
	dl:
	This file was missing from mjs' checkin of the inventory upload code.

2001-01-11  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 5338, switching to and from "tighter layout" messes up
	icon labels, by adding a call to invalidate an item's cached label
	size, and making the icon canvas invalidate the items when appropriate.
	This also fixes a similar problem when the anti-aliased mode changes.
	
	* libathena-extensions/athena-icon-canvas-item.c:
	(athena_icon_canvas_item_initialize),
	(athena_icon_canvas_item_invalidate_label_size),
	(athena_icon_canvas_item_set_arg):
	renamed internal invalidation routine to make it externally accessible
	
	* libathena-extensions/athena-icon-canvas-item.h:
	added athena_icon_canvas_item_invalidate_label_size
	
	* libathena-extensions/athena-icon-container.c:
	(invalidate_label_sizes),
	(athena_icon_container_set_anti_aliased_mode),
	(athena_icon_container_set_tighter_layout):
	added an invalidate_label_sizes routine and called it when
	tighter layout or the anti-aliased mode changes.
	
2001-01-11  Robin * Slomkowski  <rslomkow@eazel.com>

	reviewed by: <Josh Barrow  <josh@eazel.com>

	* components/services/Makefile.am: fixed typo for
	variable INSTALL_SERVICES

2001-01-11  Michael Engber  <engber@eazel.com>

	reviewed by: John Sullivan

	* libathena-extensions/athena-stock-dialogs.c:
	(timed_wait_delayed_destroy_dialog_callback), (timed_wait_free),
	(timed_wait_cancel_callback), (timed_wait_callback),
	(athena_timed_wait_start), (athena_timed_wait_stop):
	* libathena-extensions/athena-trash-directory.c:
	(find_directory_callback), (add_volume):
	We now put up a dialog when searching for trash is slow - bug 3990.
	Also added a minimum time up to athena_timed_wait dialogs
	so they don't disappear before the user has a chance to read them.
	Also, athena_timed_wait_start will now accept NULL for the
	cancel_callback, resulting in a dialog without a cancel button.

2001-01-11  Michael Engber  <engber@eazel.com>

	* configure.in:
	Missed configure.in in prior check in.

2001-01-11  Josh Barrow  <josh@eazel.com>


	* components/services/Makefile.am:
	Fixed typo that said, "INSTALLS_SERVICE".  Changed it to
	"INSTALL_SERVICE"

2001-01-11  Maciej Stachowiak  <mjs@eazel.com>

	pair programmed with Ian McKellar <ian@eazel.com>

	Fix bugs 5100 ("First time dialog" for inventory preferences) and
	5099 (Need configuration preferences for inventory control). Ian
	and I did a first cut at a component for inventory gathering and
	upload, as well as a start on the client-side UI for this.

	* components/services/Makefile.am, configure.in: Add
	components/services/inventory and
	components/services/inventory-view directories to build.

	* components/services/install/lib/eazel-inventory-utils.c,
	components/services/install/lib/eazel-inventory-utils.h: Move
	these files to components/services/inventory.
	* components/services/install/lib/Makefile.am: Remove from build
	here.

	* components/services/inventory-view/.cvsignore:
	* components/services/inventory-view/Makefile.am:
	* components/services/inventory-view/Athena_View_inventory.oaf.in
	:
	* components/services/inventory-view/main.c: (main):
	* components/services/inventory-view/athena-inventory-config-page
	.c: (athena_inventory_config_page_initialize_class),
	(next_button_callback),
	(athena_inventory_config_page_initialize),
	(athena_inventory_config_page_new),
	(athena_inventory_config_page_destroy):
	* components/services/inventory-view/athena-inventory-config-page
	.h:
	* components/services/inventory-view/athena-inventory-view.c:
	(athena_inventory_view_initialize_class),
	(athena_inventory_view_initialize),
	(athena_inventory_view_destroy),
	(inventory_load_location_callback):
	* components/services/inventory-view/athena-inventory-view.h:

	First cut at the inventory view component. Right now it only
	provides a config page, over time it may also do inventory
	display.

	* components/services/inventory/.cvsignore:
	* components/services/inventory/Makefile.am:
	* components/services/inventory/Trilobite_Service_inventory.oaf.in:
	* components/services/inventory/eazel-inventory-client.c:
	(gboolean_to_yes_or_no), (main):
	* components/services/inventory/eazel-inventory-service.c:
	(get_enabled), (impl_Trilobite_Eazel_Inventory__get_enabled),
	(impl_Trilobite_Eazel_Inventory__set_enabled),
	(impl_Trilobite_Eazel_Inventory__get_machine_name),
	(impl_Trilobite_Eazel_Inventory__set_machine_name),
	(get_warn_before_upload),
	(impl_Trilobite_Eazel_Inventory__get_warn_before_upload),
	(impl_Trilobite_Eazel_Inventory__set_warn_before_upload),
	(impl_Trilobite_Eazel_Inventory_upload),
	(eazel_inventory_service_get_epv),
	(eazel_inventory_service_finalize),
	(eazel_inventory_service_unref),
	(eazel_inventory_service_class_initialize),
	(eazel_inventory_service_create_corba_object),
	(eazel_inventory_service_initialize),
	(eazel_inventory_service_get_type), (eazel_inventory_service_new):
	* components/services/inventory/eazel-inventory-service.h:
	* components/services/inventory/eazel-inventory-utils.c:
	(eazel_inventory_gconf_done), (check_gconf_init),
	(eazel_create_configuration_metafile), (eazel_gather_inventory):
	* components/services/inventory/main.c:
	(eazel_inventory_service_factory_destroy),
	(eazel_inventory_service_factory), (main):

	First cut at back end inventory gathering and upload
	component. Right now it uses libeazelinstall directly, it should
	probably be changed to use the install/package system CORBA
	component for package info.
	
2001-01-10  Mike Fleming  <mfleming@eazel.com>

	* components/services/summary/athena-view/athena-summary-callba
	cks.c: (authn_cb_failed):

	Dialog rewording.  Commented out the "Login failed" dialog that I had
	added.  The user keeps getting re-prompted for now.

2001-01-10  Andy Hertzfeld  <andy@eazel.com>

	* components/text/athena-text-view.c:
	(athena_text_view_initialize), (athena_text_view_destroy),
	(done_file_read), (file_read_callback), (file_opened_callback),
	(athena_text_view_update):
	fixed bug 3256, loading a huge text file crashes athena.  Now,
	if the file size exceeds a predetermined threshold, currently
	set at a megabyte, it truncates it to the threshold amount and
	warns the user with an error dialog.  As part of this, I made
	the text view load files asynchronously and progressively, as
	Maciej suggested; however, we won't see the benefit of this
	until Pavel checks in some gnome-vfs optimizations he's working
	on since currently gnome-vfs doesn't give the main loop much
	time to run if it has ongoing activity.
	
	* components/text/services/Makefile.am:
	* components/text/services/french_to_english.xml:
	at Bud's request, checked in the "frech to english" text service
	
	* src/file-manager/fm-properties-window.c: (create_emblems_page):
	removed debug message that I accidentally checked in.
	
2001-01-10  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 5427, Right-click menu for disk should include
	a way to unmount it.
	
	* src/file-manager/fm-desktop-icon-view.c:
	(unmount_volume_callback), (volume_link_is_selection),
	(real_update_menus), (real_merge_menus):
	Add a context sensitive menu to Athena volume links
	which allows the volume it represents to be unmounted.
	Only allow this if the volume is removable. Currently
	only removable volumes are shown on the desktop.
	
	* src/file-manager/athena-desktop-icon-view-ui.xml:
	Add command path for new unmount volume command
	
2001-01-10  Michael Engber  <engber@eazel.com>

	reviewed by: John Harper

	* configure.in:
	* libathena-extensions/athena-background-canvas-group.c:
	(athena_background_canvas_group_initialize_common),
	(athena_background_canvas_group_initialize),
	(athena_background_canvas_group_supplant_root_class):
	* libathena-extensions/athena-background-canvas-group.h:
	* libathena-extensions/athena-background.c:
	(athena_background_set_up_canvas):
	Turned on dithering for canvases (aa mode). We no longer expose
	AthenaBackgroundCanvasGroupClass, in athena-background-canvas-
	group.h. Now we just provide an API to do the class change.

2001-01-10  Pavel Cisler  <pavel@eazel.com>

	* components/services/install/athena-view/athena-service-install-view.c:
	(install_message_new):
	Fix a warning and the build.
	
2001-01-09  Mike Fleming  <mfleming@eazel.com>

	Added dialogs as specified in:

	3871 
		Logging in to account that has not been activated
		should produce activation instructions

	3399
		no bad passwd lockout dialog in Athena

	Also, changed the way the "max login retries" condition was handled
	(it previously wasn't) 

	* components/services/summary/athena-view/athena-summary-callba
	cks.c: (authn_cb_failed), (login_button_cb):
	* components/services/summary/athena-view/athena-summary-dialog
	s.c: (athena_summary_login_failure_dialog),
	(generate_login_dialog):
	* components/services/summary/athena-view/athena-summary-dialog
	s.h:
	* components/services/summary/athena-view/athena-summary-view-p
	rivate.h:

2001-01-09  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/Athena_View_install.o
	af.in:

	Give the install view a reasonable name that won't make people's
	heads explode.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (line_expose), (horizontal_line_new),
	(install_message_destroy), (install_message_new),
	(generate_install_form), (show_overall_feedback),
	(athena_service_install_view_initialize), (deps_destroy_foreach),
	(athena_service_install_view_destroy),
	(athena_service_install_view_get_athena_view),
	(athena_install_parse_uri), (current_progress_bar_complete),
	(athena_service_install_downloading),
	(athena_service_install_dependency_check),
	(athena_service_install_download_failed),
	(athena_service_install_installing),
	(athena_service_install_failed),
	(athena_service_install_view_update_from_uri),
	(athena_service_install_view_load_uri),
	(service_install_stop_loading_callback):
	* components/services/install/athena-view/athena-service-instal
	l-view.h:
	* components/services/athena-dependent-shared/eazel-services-exte
	nsions.h:

	Many changes to make the install view prettier and less annoying
	-- mostly Arlo'ified now, with some tweaking left to do.

2001-01-09  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Work to make icons in list view draw anti-aliased in respect to
	the background. Fixes bug 1659

	* cut-n-paste-code/widgets/athenaclist/athenaclist.h
	(AthenaCellType): added new type ATHENA_CELL_PIXBUF at end
	of this enum

	* libathena-extensions/athena-list.c (AthenaListDetails):
	added fields for RGB values of all background colors

	(athena_gdk_set_shifted_foreground_gc_color): return the
	shifted RGB value

	(athena_list_setup_style_colors): save RGB values of all
	background colors into the details structure

	(get_cell_style): added another parameter: `bg_rgb', when a non
	null pointer it gets set to the RGB value of the chosen
	background color

	(draw_cell_pixbuf): added another parameter: `bg_rgb'.
	Composite the pixbuf onto a square of this color (using the
	full 8-bit alpha), then blit the entire square onto the
	drawable

	(draw_cell): added cases to handle ATHENA_CELL_PIXBUF type.
	Also pass the extra arg to draw_cell_pixbuf in
	ATHENA_CELL_PIXBUF_LIST case

	(athena_list_set_cell_contents): handle ATHENA_CELL_PIXBUF
	case

	(athena_list_set_pixbuf_list): broke out contents into the
	new function set_list_cell, parameterized by the
	AthenaCellType in addition
	(athena_list_set_pixbuf): new function, calls set_list_cell

	* src/file-manager/fm-list-view.c (install_row_images): get the
	file's icon as a pixbuf, not a pixmap/mask pair. Then use
	athena_list_set_pixbuf to install it in the list cell

2001-01-09  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Engber <engber@eazel.com>

	Fixed bug 5220, Default desktop icon overwritten by dragging
	same-named file to Desktop

	* libathena-extensions/athena-file-operations.c:
	(handle_transfer_overwrite):
	We now check for special link files being overwritten and
	notify the user that such an action is not allowed.
	
2001-01-08  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-customization-data.c:
	(athena_customization_data_destroy):
	fixed recently introduced memory leak by calling
	athena_g_hash_table_destroy_deep instead of
	g_hash_table_destroy
	
	* src/athena-sidebar-title.c: (update_icon):
	fixed problem in the sidebar where web pages were getting the
	generic icon instead of the web icon. Fixed by adding
	"http:" to the protocols the sidebar special-cases.
	
2001-01-08  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	A cut at an ability to build without Medusa, starting with a patch
	that Eric Fischer wrote. This change is not fully tested.

	Fixed bug 5513 ("athena --help" displays "Help options" twice).

	* acconfig.h: Add HAVE_MEDUSA.
	* configure.in: Add code to detect HAVE_MEDUSA.
	
	* libathena-extensions/athena-customization-data.c:
	(athena_customization_data_destroy), (load_name_map_hash_table):
	Added a FIXME.
	
	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-file.h:
	* libathena-extensions/athena-trash-file.h:
	* libathena-extensions/athena-trash-file.c:
	(athena_trash_file_initialize), (trash_destroy),
	(athena_trash_file_initialize_class):
	* libathena-extensions/athena-vfs-file.h:
	* libathena-extensions/athena-vfs-file.c:
	(athena_vfs_file_initialize), (vfs_destroy),
	(athena_vfs_file_initialize_class):
	Initial cut at breaking out the special trash version of
	AthenaFile. Sadly we need this as well as
	AthenaTrashDirectory.
	
	* src/file-manager/fm-search-list-view.c:
	(load_location_callback): Add _() so things get localized and put
	the code to compose the indexing message inside ifdef HAVE_MEDUSA.
	
	* src/file-manager/athena-indexing-info.h:
	* src/file-manager/athena-indexing-info.c:
	Put HAVE_MEDUSA ifdefs around most of this file.
	(get_text_for_progress_label): Mark string for translation.
	(update_progress_display): Remove code to "handle" timeout left
	around after dialog is destroyed.
	(update_file_index_callback): Change error messages to be more
	easily localizable. Use athena_error_dialog instead of
	gnome_error_dialog.
	(timeout_remove_callback): Get rid of the timeout when the object
	is destroyed.
	(show_index_progress_bar): Connect handler to get rid of the
	timeout when the object is destroyed.
	(show_indexing_info_dialog): Move code that puts up dialog into a
	new function. Also use athena_gtk_window_present to put up a
	window. Change the AthenaLabel to use line wrapping.
	(show_search_service_not_available_dialog): Put this dialog in its
	own function so you can use it multiple times.
	(athena_indexing_info_request_reindex): Put HAVE_MEDUSA around
	the content of this function.
	(athena_indexing_info_get_last_index_time): Put HAVE_MEDUSA
	around the function, with a small simple implementation for the
	other case.
	(athena_indexing_info_show_dialog): Put HAVE_MEDUSA around the
	function, with a small invocation of the "not available" dialog.
	
	* src/athena-main.c: (main): Remove redundant AUTOHELP.
	
	* src/athena-search-bar-criterion.c: (make_emblem_value_menu):
	Fix emblem_name storage lifetime problem.

	* src/file-manager/fm-icon-view.c: Whitespace tweak.

2001-01-08  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Some infrastructure for bug 2068 and related bugs.
	No actual user-visible changes yet.

	* libathena-extensions/athena-scrolled-window.h:
	* libathena-extensions/athena-scrolled-window.c:
	New files, implement a subclass of GtkScrolledWindow
	that sends a signal when the scroll position changes.
	This was tragically left out of GtkScrolledWindow.
	(athena_scrolled_window_initialize_class),
	(athena_scrolled_window_initialize): The usual stuff.
	(get_hadjustment), (get_vadjustment): Little helper
	functions to avoid repeating some casting.
	(adjustment_changed_callback): Callback that emits the
	scroll_changed signal when the scroll changes.
	(connect_adjustment): Helper function that disconnects
	old signals and sets up new ones when the adjustment
	objects change.
	(real_set_arg): virtual function overridden to connect
	up adjustment_changed_callback.
	(athena_scrolled_window_set_vadjustment),
	(athena_scrolled_window_set_hadjustment): New functions
	that call through to gtk_scrolled_window_xxx and connect
	up adjustment_changed_callback.
	
	* libathena-extensions/Makefile.am: Add the new
	files to the build.
	
	* libathena-extensions/athena-metadata.h:
	#define ATHENA_METADATA_KEY_ICON_VIEW_SCROLL_ORIGIN

	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize): Make FMDirectoryView inherit
	from AthenaScrolledWindow instead of GtkScrolledWindow so
	it can hook into the scroll_changed signal.

2001-01-08  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5507, athena crashes when you unmount a drive while a file is
	viewed in music viewer
	
	* libathena-extensions/athena-volume-monitor.c:
	(close_error_pipe):
	In the case of a failed unmount, I was just assigning a string to memory
	that was later being freed, rather than allocating the memory and
	copying the string. I now allocate memory and copy the string.

2001-01-08  Eric Fischer  <eric@eazel.com>

	* configure.in:

	Add check for gnome-xml version; insist on version 1.x.
	(reviewed by robin@eazel.com)

2001-01-08  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied), (is_filename_probably_a_directory),
	(no_two_packages_with_same_file),
	(package_is_upgrading_and_doesnt_need_file),
	(check_conflicts_with_other):

	Rough drafts for 2 of the functions Eskil left in pseudocode form.

	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	* components/services/trilobite/libtrilobite/trilobite-core-network
	.c: (trilobite_open_uri):

	Fix two typos (no code change).

2001-01-08  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_preflight_check),
	(athena_service_install_installing):

	Add gnome-vfs and oaf to the list of packages that trigger a
	Athena restart.
	
	* athena-installer/src/Makefile:
	* athena-installer/src/gtk-hackery.c: (gtk_box_nth):
	* athena-installer/src/installer.c: (find_old_tmpdir):
	* athena-installer/src/package-tree.c:
	(package_customizer_set_package_list), (table_hbox_nth),
	(focus_next), (handle_focus), (jump_to_package_tree_page):

	Add mondo code to do keyboard focus management (as well as GTK
	will let us) in the package selector.

2001-01-08  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(athena_background_draw),
	(athena_background_is_too_complex_for_gtk_style),
	(athena_background_is_dark):
	* src/athena-sidebar.c: (background_settings_changed_callback),
	(athena_sidebar_update_appearance):
	Draw sidebar gradients dithered to avoid striation - bug 5458.

2001-01-07  Andy Hertzfeld  <andy@eazel.com>

	fixed bugs 5189, 5190 and 5046, pattern and emblem names
	not translated, and upper-casing emblem names is bad for
	translation, by introducing a translatable display name
	specified in the browser xml file.
	
	* libathena-extensions/athena-customization-data.c:
	(athena_customization_data_new),
	(athena_customization_data_get_next_element_for_display),
	(athena_customization_data_destroy), (format_name_for_display),
	(load_name_map_hash_table):
	made it load a display name mapping from the browser xml file into
	a hash table when a athena customization is created; use the mapping
	to return a label with a translated name.
	
	* src/file-manager/fm-properties-window.c: (create_emblems_page):
	rewrote the emblem code in the properties window to use
	athena_customization instead of ad hoc code, so it will use
	the translated names.
	
	* src/athena-property-browser.c: (get_color_category):
	replaced custom xml code with a standard routine from xml_extensions.
	
	* src/athena-search-bar-criterion.c: (make_emblem_value_menu):
	fixed a memory leak and tweaked the code a bit for translated names.
	
	* data/browser.xml:
	added display name mappings for patterns and emblems
	
2001-01-05  Gene Z. Ragan  <gzr@eazel.com>

	* components/music/athena-music-view.c: (selection_callback),
	(value_changed_callback), (athena_music_view_load_uri):
	Fixed a bug introduced when all widgets are being shown 
	when a URI is loaded.  This includes both the on and off
	states of the play and pause controls.  Update control
	state right after the control are shown to correct this.
	
	* libathena-extensions/athena-volume-monitor.c:
	* libathena-extensions/athena-volume-monitor.h:
	(athena_volume_monitor_volume_is_removable):

	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link):
	More work on detecting is a volume is removable or not.
	
2001-01-05  Maciej Stachowiak  <mjs@eazel.com>

	* athena.spec.in: Correct names of .oaf files.

2001-01-05  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: removed time service refrences
	left the following renamed files for mjs to fix
	athena-service-install-view.oaf
	trilobite-eazel-install-service.oaf
	athena-change-password-view.oaf
	athena-summary-view.oaf
	athena-rpm-view.oaf

2001-01-05  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-glib-extensions.c:
	(athena_shell_quote), (athena_g_round):
	* libathena-extensions/athena-glib-extensions.h:
	Added athena_g_round.

	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_start_renaming_selected_item):
	* libathena-extensions/athena-icon-text-item.c:
	(iti_stop_editing), (layout_text), (iti_edition_accept),
	(iti_entry_text_changed_by_clipboard), (iti_start_editing),
	(iti_destroy), (recompute_bounding_box), (iti_update), (iti_draw),
	(iti_render), (iti_point), (iti_start_selecting),
	(iti_stop_selecting), (iti_selection_motion), (iti_ensure_focus),
	(iti_event), (iti_bounds), (athena_icon_text_item_configure),
	(athena_icon_text_item_setxy), (athena_icon_text_item_select),
	(athena_icon_text_item_set_text),
	(athena_icon_text_item_get_type):
	* libathena-extensions/athena-icon-text-item.h:
	Overhauled athena-icon-text-item to be a more proper canvas
	item - mainly fixing it's use of coordinates.  Also simplified
	its configure api a bit. This fixed bug 4166. Also put in a
	workaround to fix bug 3973.
	

2001-01-05  George Lebl <jirka@5z.com>

	Darin saw this patch and says it should not destroy the world
	if I apply it.

	Fixes: 3988

	* libathena-extensions/athena-background.c
	  (athena_background_draw_flat_box):  Unset the mask on the bg_gc
	  from the style, not to leave the gc in a bad state

	* libathena-extentions/athena-list.c (athena_list_style_set)
	  (unref_gcs) (unref_a_gc) (athena_list_initialize_class) 
	  (athena_list_destroy) (athena_gdk_gc_copy)
	  (athena_list_realize) (make_gcs_and_colors)
	  (athena_list_unrealize):  Follow the theme by recopying the gcs
	  after a theme was changed.  Also do more sanity setting
	  when copying the gcs, just to be on the very safe side.

	* src/athena-theme-selector.c (theme_style_set_callback)
	  (setup_font_sizes_for_row) (setup_font_sizes_for_all_rows)
	  (clear_style_for_all_rows) (athena_theme_selector_initialize)
	  (add_theme):  Follow the current theme by binding to the style_set
	  signal and redoing the style stuff so that we don't get garbage
	  and other fun on changing of gtk theme.

2001-01-05  Robin * Slomkowski  <rslomkow@eazel.com>

	* components/notes/Makefile.am:
		added Athena_View_notes.oaf.in
	* components/services/login/athena-view/Makefile.am:
		added Athena_View_change-password.oaf.in
	* po/POTFILES.in: removed references to 
		components/services/time/command-line/main.c
		components/services/time/athena-view/main.c
		components/services/time/athena-view/trilobite-eazel-time-view.c
		components/services/time/service/main.c
		components/services/time/service/trilobite-eazel-time-service.c
		components/shell/Athena_View_shell.oaf.in

2001-01-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 5410 ("Esc" cancelling of icon stretch doesn't
	update menus)

	* libathena-extensions/athena-icon-container.h:
	Defined signals icon_stretch_started and icon_stretch_ended.
	
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_initialize_class): Set up new signals.
	(emit_stretch_started), (emit_stretch_ended): New convenience
	functions for emitting new signals.
	(icon_toggle_selected), (undo_stretching),
	(athena_icon_container_show_stretch_handles): Emit new signals.
	
	* src/file-manager/fm-icon-view.c: 
	(create_icon_container): Call fm_directory_view_update_menus
	when icon_stretch_begin/end signals are emitted.
	(show_stretch_handles_callback),
	(unstretch_icons_callback): Remove calls to update menus, since
	we'll now do it when we get the stretch-state-changed signals.

2001-01-05  Darin Adler  <darin@eazel.com>

	* Makefile.am: Fix for wrongly named ChangeLog-200001018.
	* components/Makefile.am: Removed obsolete comment.

2001-01-05  Andy Hertzfeld  <andy@eazel.com>

	* components/music/athena-music-view.c:
	(athena_music_view_initialize), (athena_music_view_load_uri):
	fixed bug 4045, unfinished widgets during load in music view, by
	not showing the widgets until the load is completed.
	
2001-01-05  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c: (ensure_uri_is_image),
	(add_pattern_to_browser):
	fixed bug 5265, you shouldn't be able to replace the reset image
	in the property browser, by testing for that case and putting up
	an error dialog instead.
	
2001-01-05  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: changed .oafinfo to .oaf

2001-01-05  Gene Z. Ragan  <gzr@eazel.com>
	
	My previous change dealing with desktop mounts was a bit too
	overzealous.  Removable volumes now appear on the desktop
	when mounted.
	
	* libathena-extensions/athena-volume-monitor.c:
	(mount_volume_floppy_add), (mount_volume_iso9660_add),
	(mount_volume_add_filesystem):
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link):

2001-01-05  Maciej Stachowiak  <mjs@eazel.com>

	xml-i18n-toolized Athena (plus a bit of other cleanup) as part
	of resolving bug 2693 (I will consider my work done once I have
	also handled Bonobo).

	* autogen.sh, configure.in: xml-i18n-toolize
	* .cvsignore: ignore xml-i18n scripts
	* Makefile.am: distribute xml-i18n-scripts

	* components/adapter/Athena_ComponentAdapterFactory_std.oaf.in:
	Renamed from components/adapter/athena-adapter.oafinfo; mark
	translatable strings transalatable.
	* components/adapter/Makefile.am: Deal w/ oaf file rename, do
	merge.
	* components/adapter/.cvsignore: Ignore .oaf file.

	* components/hardware/.cvsignore, components/hardware/Makefile.am,
	components/hardware/Athena_View_hardware.oaf.in,
	components/hardware/athena-hardware-view.oafinfo: Ditto.
	* components/history/.cvsignore, components/history/Makefile.am,
	components/history/Athena_View_history.oaf.in,
	components/history/athena-history-view.oafinfo: Ditto.
	
	* components/image-viewer/.cvsignore,
	components/image-viewer/Makefile.am,
	components/image-viewer/Athena_View_image.oaf.in,
	components/image-viewer/athena-image-view.oafinfo: Ditto.

	* components/loser/content/.cvsignore,
	components/loser/content/Makefile.am,
	components/loser/content/Athena_View_content-loser.oaf.in,
	components/loser/content/athena-content-loser.oafinfo: Ditto.
	
	* components/loser/sidebar/.cvsignore,
	components/loser/sidebar/Makefile.am,
	components/loser/sidebar/Athena_View_sidebar-loser.oaf.in,
	components/loser/sidebar/athena-sidebar-loser.oafinfo: Ditto.
	* components/mozilla/.cvsignore, components/mozilla/Makefile.am,
	components/mozilla/Athena_View_mozilla.oaf.in,
	components/mozilla/athena-mozilla-content-view.oafinfo: Ditto.
	* components/music/.cvsignore, components/music/Makefile.am,
	components/music/Athena_View_music.oaf.in,
	components/music/athena-music-view.oafinfo: Ditto.
	* components/notes/.cvsignore, components/notes/Makefile.am,
	components/notes/Athena_View_notes.oaf.in,
	components/notes/athena-notes.oafinfo: Ditto.
	* components/rpmview/.cvsignore, components/rpmview/Makefile.am,
	components/rpmview/Athena_View_rpm.oaf.in,
	components/rpmview/athena-rpm-view.oafinfo: Ditto.
	* components/sample/.cvsignore, components/sample/Makefile.am,
	components/sample/Athena_View_sample.oaf.in,
	components/sample/athena-sample-content-view.oafinfo: Ditto.
	* components/services/install/athena-view/.cvsignore,
	components/services/install/athena-view/Makefile.am,
	components/services/install/athena-view/Athena_View_install.oaf.in,
	components/services/install/athena-view/athena-service-install-view.oafinfo:
	Ditto.
	* components/services/install/server/.cvsignore,
	components/services/install/server/Makefile.am,
	components/services/install/server/Trilobite_Service_install.oaf.in,
	components/services/install/server/trilobite-eazel-install-service.oafinfo:
	Ditto.
	* components/services/login/athena-view/.cvsignore,
	components/services/login/athena-view/Makefile.am,
	components/services/login/athena-view/Athena_View_change-password.oaf.in,
	components/services/login/athena-view/athena-change-password-view.oafinfo:
	Ditto.
	* components/services/summary/athena-view/.cvsignore,
	components/services/summary/athena-view/Makefile.am,
	components/services/summary/athena-view/Athena_View_services-summary.oaf.in,
	components/services/summary/athena-view/athena-summary-view.oafinfo: Ditto.
	* components/services/trilobite/sample/.cvsignore,
	components/services/trilobite/sample/athena-view/Makefile.am,
	components/services/trilobite/sample/athena-view/Athena_View_service-sample.oaf.in,
	components/services/trilobite/sample/athena-view/athena-sample-service-view.oafinfo:
	Ditto.
	* components/services/trilobite/sample/service/.cvsignore,
	components/services/trilobite/sample/service/Makefile.am,
	components/services/trilobite/sample/service/Trilobite_Service_sample.oaf.in,
	components/services/trilobite/sample/service/trilobite-eazel-sample-service.oafinfo:
	Ditto.
	* components/text/.cvsignore, components/text/Makefile.am,
	components/text/Athena_View_text.oaf.in,
	components/text/athena-text-view.oafinfo: Ditto.
	* src/.cvsignore, src/Makefile.am, src/Athena_shell.oaf.in,
	src/athena.oafinfo: Ditto.
	* components/tree/.cvsignore, components/tree/Makefile.am,
	components/tree/Athena_View_tree.oaf.in,
	components/tree/athena-tree-view.oafinfo.shlib: Ditto, and
	removed ability to build tree view as an exe component (no one was
	really using it anyway).
	* components/tree/athena-tree-view.oafinfo.exe: Removed.
	* components/help/.cvsignore, components/help/Makefile.am,
	components/help/Athena_View_help.oaf.in:
	components/help/help-contents.oafinfo: Ditto, and merged other
	oafinfo files into Athena_View_help.oaf.in, commented out.
	* components/help/help-factory.oafinfo,
	components/help/help-index.oafinfo,
	components/help/help-search.oafinfo: Removed.

	* po/POTFILES.in: Added .oaf.in files.
	* po/README.tools, po/ui-extract.pl, po/ui-testcases.glade,
	po/ui-testcases.xml, po/update.pl, po/update.sh: Removed these
	now-obsolete files.

	* components/services/Makefile.am: Removed time service from build.
	* components/html/*, components/websearch/*: cvs deleted these
	obsolete long since non-built components.
	* ChangeLog-200001018: Renamed to ChangeLog-20001018 (whoops)
	
2001-01-04  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-factory.c:
	(should_display_image_file_as_itself):
	fixed bug 5134, shouldn't display thumbnails for images that we
	don't have read permission by explicitly test for read permission
	in should_display_image_file_as_itself.
	
2001-01-04  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-icon-view.c: (should_preview_sound):
	fixed bug 5108, remote sounds get preview image, but don't actually
	preview.  Fixed by making can_preview_sound return FALSE for
	non-local sounds.
	
2001-01-04  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	Fix 5451 - GnomeVFS-WARNING received at startup.

	* libathena/athena-view-standard-main.c:
	(athena_view_standard_main_multi):
	New standard module initialization call was not initializing
	or shutting down gnome_vfs.

	* components/adapter/main.c: (main):
	* components/hardware/main.c: (main):
	* components/html/ntl-web-browser.c: (main):
	* components/mozilla/main.c: (main):
	* components/music/main.c: (main):
	* components/notes/athena-notes.c: (main):
	* components/rpmview/main.c: (main):
	* components/text/main.c: (main):
	* components/tree/main.c: (main):
	All of the above modules were initializing gnome_vfs but never
	shutting it down. Add proper gnome_vfs_shutdown call.
	This very likely fixes a problem with the notes module, etc.
	sticking around after Athena quits.
	

2001-01-04  Darin Adler  <darin@eazel.com>

	Fix a screwup in my recent check-in that made hidden files
	show up on the desktop.

	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize): Don't try to special-case the
	desktop since it's too early to detect that case anyway.
	(fm_directory_view_destroy): Use the
	fm_directory_view_ignore_hidden_file_preferences call to
	disconnect the preferences callbacks. This prevents disconnecting
	them twice in case another caller makes that call.
	(fm_directory_view_ignore_hidden_file_preferences): Turn on the
	flag that says we're ignoring the preferences, disconnect the
	preference callbacks, and set the flags both to FALSE so we won't
	show hidden or backup files.

	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_initialize): Call the new
	fm_directory_view_ignore_hidden_file_preference to make it never
	show hidden or backup files on the desktop.

2001-01-04  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c: (set_emblem_image_from_file),
	(make_properties_from_directories):
	fixed bug 5392, custom image causes distortion in emblems dialog,
	by setting the background mode of the athena_image used to display
	the emblems to solid, which also improves performance.  Also, use
	a athena image instead of a pixmap widget in the emblem image
	selection dialog to better display the image.
	
2001-01-04  Darin Adler  <darin@eazel.com>

	Some FIXME cleanup.
	
	* components/help/converters/gnome-db2html2/sect-elements.c:
	(sect_article_end_element), (sect_inlinegraphic_start_element):
	* components/help/converters/gnome-db2html2/toc-elements.c:
	(toc_sect_end_element):
	* components/mozilla/mozilla-events.cpp:
	* components/mozilla/athena-mozilla-content-view.c:
	(make_full_uri_from_relative), (eazel_services_scheme_translate):
	* components/music/athena-music-view.c:
	(athena_music_view_initialize),
	(music_view_set_selected_song_title), (reset_playtime),
	(play_status_display), (slider_moved_callback),
	(add_play_controls):
	* components/notes/athena-notes.c: (notes_load_metainfo):
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_check_for_file_conflicts),
	(eazel_install_do_transaction_all_files_check),
	(eazel_install_prune_packages_helper),
	(eazel_install_check_existing_packages):
	* libathena-extensions/athena-string.c: (athena_strcmp),
	(athena_strcasecmp), (athena_strcmp_case_breaks_ties),
	(athena_strcoll), (athena_str_is_equal),
	(athena_istr_is_equal), (athena_strcmp_compare_func),
	(athena_strcoll_compare_func),
	(athena_strcasecmp_compare_func):
	* src/file-manager/fm-directory-view.c: (open_location):
	* src/athena-first-time-druid.c: (make_anti_aliased_label),
	(make_hbox_user_level_radio_button), (set_up_user_level_page):
	Added bug numbers to FIXMEs. At one point Josh made some bugs for
	FIXMEs but never got around to checking in the bug numbers in the
	source code. And I wrote one bug report.
	
	* components/music/athena-music-view.c:
	(athena_music_view_initialize): Removed a fixed FIXME. Also got
	rid of a hard-coded constant and took excess spaces out of some
	string constants.

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_dependency_check_default): Changed a FIXME
	into a non-FIXME comment, now the the bug is fixed.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpm_packagedata_fill_from_file): Removed an incorrect bug number
	from a FIXME.
	
	* components/services/install/athena-view/athena-service-install-view.h:
	* components/services/install/athena-view/athena-service-install-view.c:
	(athena_service_install_installing): Removed the FIXME from a
	comment that's about how a bug was fixed.
	
	* components/services/trilobite/libtrilobite/trilobite-md5-tools.h:
	* components/services/trilobite/libtrilobite/trilobite-md5-tools.c:
	* docs/style-guide.html:
	Removed FIXME and corrected misunderstanding about whether use of
	the guchar typedef is recommended in Athena coding style.

	* libathena-extensions/athena-gdk-font-extensions.h:
	* libathena-extensions/athena-gdk-font-extensions.c:
	Removed misguided use of const in here. Gdk and Gtk object types
	just aren't suitable for const, and you end up doing type casts
	that defeat the purpose.
	
	* src/athena-window-manage-views.c: (load_underway_callback):
	Remove a FIXME for a fixed bug.

2001-01-04  Robey Pointer  <robey@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (delete_files):

	Remove the restriction that files be physically downloaded before
	asking if the user would like to delete files.  That way all the
	packages could come from a previous cache and still be cleaned up
	afterwards.
	
	* components/services/install/lib/eazel-install-logic.c:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpm_open_db):
	* components/services/install/lib/eazel-package-system-types.c:
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_get_info):
	
	Fix up some documentation.
	
	* components/services/install/lib/eazel-install-object.c:
	(find_old_tmpdir), (create_temporary_directory),
	(eazel_install_delete_downloads),
	(eazel_install_install_packages):

	Clean up the tmpdir creation code: Make sure any new directory is
	created atomically.  If generating a new directory name,
	incorporate the username for uniqueness, and reuse any generated
	directory from a previous session.

2001-01-04  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 5435 (Irreproducible crash in athena_directory_destroy
	after copy/move operations).

	* libathena-extensions/athena-directory.c:
	(athena_directory_notify_files_moved): Removed an extra unref
	and slightly reordered the code to make it clearer why the rest of
	the ref count manipulation is correct.

2001-01-04  Darin Adler  <darin@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	Fixed bug 3811 (shallow file counts and top-left text are fetched
	even for non-displayed hidden/backup items).

	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory-async.c:
	(allow_metafile): Add "ghelp:" and "gnome-help:" to the
	unfortunate list of hard-coded schemes. If we hard-code "help:" we
	have to hard-code its synonyms too.
	(find_monitor): Use g_new0 so fields in the Monitor are not
	uninitialized in this case (the fields in question are ignored,
	but it's still nicer this way).
	(athena_directory_monitor_add_internal): Set up the "monitor
	hidden files" and "monitor backup files" in the Monitor structure
	based on new parameters.
	(should_display_file_name): Use
	athena_file_name_matches_hidden_pattern and
	athena_file_name_matches_backup_pattern.
	(monitor_includes_file): New function that encapsulates the rule
	about which monitor includes which file. Handles the new flags for
	not monitoring hidden or backup files.
	(is_needy): Call monitor_includes_file.
	(select_needy_file): Call monitor_includes_file.
	
	* libathena-extensions/athena-file-private.h:
	* libathena-extensions/athena-file.c:
	(athena_file_name_matches_hidden_pattern),
	(athena_file_name_matches_backup_pattern): New functions to
	share with the directory code.
	(athena_file_is_hidden_file), (athena_file_is_backup_file):
	Use the new functions and use the raw relative_uri -- no need to
	unescape to change to a file name since the "." and "~" characters
	are not encoded.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize): Share more code with the
	filtering_changed_callback. Handle the desktop view better by
	never setting the "show hidden" and "show backup" flags (so they
	are both FALSE) and not setting up the callbacks.
	(fm_directory_view_destroy): Since we don't set up the callbacks
	for desktop windows, don't remove them for desktop windows.
	(queue_pending_files): Remove the desktop special case from
	here. It was strange to set the flags up then wait until this
	moment to clear them both. It's better to keep them FALSE.
	(finish_loading): Renamed and changed to pass the appropriate
	values in to the athena_directory_file_monitor_add call -- this
	is the actual bug fix.
	(filtering_changed_callback): Remove the desktop special case,
	since this function will now never be called for the desktop.
	
	* libathena-extensions/athena-directory.h:
	* libathena-extensions/athena-directory.c:
	(athena_directory_file_monitor_add): Pass through the new
	"monitor hidden files" and "monitor backup files" parameters.
	(athena_self_check_directory): Pass TRUE for both.
	* libathena-extensions/athena-vfs-directory.c:
	(vfs_file_monitor_add): Pass through the new "monitor hidden
	files" and "monitor backup files" parameters.
	
	* libathena-extensions/athena-merged-directory.c:
	(merged_file_monitor_add), (monitor_add_directory): Store the
	"monitor hidden files" and "monitor backup files" and pass them
	through to the individual directory monitor calls.
	
	* components/tree/athena-tree-model.c:
	(athena_tree_model_node_begin_monitoring_no_connect):
	* libathena-extensions/athena-file.c:
	(athena_file_monitor_add):
	* libathena-extensions/athena-trash-monitor.c:
	(athena_trash_monitor_initialize):
	* src/athena-applicable-views.c:
	(got_minimum_file_info_callback):
	Pass in TRUE for "monitor hidden files" and "monitor backup files"
	to get the same behavior as before. (In some cases the booleans
	are just ignored, in other cases we just monitor all files as we
	used to.)
	
	* RENAMING: Remind myself to change the name of the
	ATHENA_CALL_VIRTUAL macro to ATHENA_CALL_METHOD some day.

2001-01-04  John Harper  <jsh@eazel.com>

	* libathena-extensions/athena-gdk-extensions.c,
	libathena-extensions/athena-gdk-extensions.h
	(athena_gdk_window_focus): added second argument,
	`timestamp', that's passed straight through to XSetInputFocus

	* libathena-extensions/athena-drag-window.c: save the
	timestamp in the WM_TAKE_FOCUS client message, and use it when
	eventually focusing the window (instead of implicitly using
	CurrentTime, which can lead to race conditions)

	* libathena-extensions/athena-icon-text-item.c
	(iti_ensure_focus): pass GDK_CURRENT_TIME as timestamp to
	athena_gdk_window_focus

2001-01-04  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	When renaming an icon, manually focus the associated top-level
	window. This fixes bug 5426 (can't rename icons in sloppy-focus
	mode)

	* libathena-extensions/athena-icon-text-item.c
	(iti_ensure_focus): new function, ensures that both the canvas
	item and the top-level window are focused
	(iti_event): call iti_ensure_focus in the button-press case
	(athena_icon_text_item_start_editing): call iti_ensure_focus
	instead of gnome_canvas_item_grab_focus to focus the item

2001-01-03  John Harper  <jsh@eazel.com>

	Small fix to the `drag doesn't focus' stuff I did earlier to
	work around button-release events not following button-press
	events. (E.g. this happens for some reason when clicking on the
	left hand pane of the property browser window)

	* libathena-extensions/athena-drag-window.c
	(wm_protocols_filter): don't only start the timeout when we
	don't think we're in the middle of a press-release sequence
	(button_press_emission_callback): if we already think we're in
	the middle of a press-release, commit any pending requests

2001-01-03  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 5235 ("Forget History" eliminates history from Go menu,
	not History sidebar panel).

	* components/history/athena-history-view.c:
	(install_icons): Fix leak of pixmap and bitmap.
	(update_history): Replaced dual lock system with a single one.
	(button_press_callback): Only respect button 1, ignore others.
	(button_release_callback): Only respect button 1, ignore others,
	(history_changed_callback): A new single callback for when the
	history list changes to replace the multiple callbacks before.
	(athena_history_view_initialize_class),
	(athena_history_view_initialize),
	(athena_history_view_destroy), (main): Change the history view
	to use athena_view_standard_main which requires a subclass. This
	gets rid of a lot of boilerplate code.
	
	* libathena/athena-view-component.idl: Make every AthenaView
	get an explicit history_changed call instead of requiring them to
	guess when to get history. Removed the old get_history_list call
	and also renamed the HistoryList sequence to History.
	* libathena/athena-view.h:
	* libathena/athena-view.c:
	(impl_Athena_View_history_changed),
	(athena_view_initialize_class): Added the necessary stuff to
	cover the new history_changed call.
	
	* src/athena-view-frame.h:
	* src/athena-view-frame.c: (athena_view_frame_initialize):
	Connect handlers so we can send history_changed calls to the
	AthenaView when either the history or the icons change.
	(athena_view_frame_destroy): Change state to EMPTY so the
	history signal won't be sent once the frame is destroyed.
	(view_frame_activated): Send a history_changed to every
	newly-activated view.
	(get_CORBA_object): Helper function to make code that makes CORBA
	calls simpler.
	(check_if_view_is_gone): Use get_CORBA_object.
	(attach_client): Gave a nicer name, removed the code that makes
	the Athena_HistoryFrame interface.
	(athena_view_frame_load_client): Do the attach_client (formerly
	athena_view_frame_set_to_component) before calling
	view_frame_activated. This is needed since view_frame_activated
	now sends a history_changed to the view.
	(athena_view_frame_load_location),
	(athena_view_frame_stop_loading),
	(athena_view_frame_selection_changed),
	(athena_view_frame_title_changed): Use get_CORBA_object.
	(get_history_list): Made this private.
	(send_history): Helper function that sends history to the view if
	it's in the appropriate state.
	
	* src/Makefile.am:
	* src/athena-history-frame.c:
	* src/athena-history-frame.h:
	Removed the old AthenaHistoryFrame, which is no longer needed
	since we put the history call right in the AthenaView class.
	
	* src/athena-window-manage-views.c: (get_history_list_callback):
	Updated for Athena_HistoryList -> Athena_History change.
	
	Fix bug 5391 ("Esc" Canceling of an icon stretch doesn't restore
	icon position.).

	* libathena-extensions/athena-icon-private.h:
	* libathena-extensions/athena-icon-container.c:
	(clear_drag_state): Add a single bottleneck function to make sure
	the context menu timeout always gets canceled.
	(continue_stretching): Remove the unused "update_position" parameter.
	(undo_stretching): Consolidate the cancel_stretching function and
	restore the icon's position as well as its size. Also use the new
	bottleneck to clear the drag state.
	(button_release_event): Use the new bottleneck to clear the drag
	state.
	(show_context_menu_callback): Use the new bottleneck to clear the
	drag state.
	(athena_icon_container_set_selection),
	(athena_icon_container_select_list_unselect_others): Take
	advantage of the defaults in g_hash_table_new and use NULL, NULL
	instead of g_direct_hash, g_direct_equal.
	(athena_icon_container_show_stretch_handles): Save the position
	as well as the size.
	(compute_stretch): Add a FIXME with a bug number.
	
	Fix bug 5407 (Make "Hardware Overview" title translatable).

	* components/hardware/athena-hardware-view.c:
	(athena_hardware_view_destroy): Remove unused uri field.
	(extract_info): Fix storage leak.
	(get_RAM_description): Get rid of code that non-portably relies on
	long long. Mark strings for translation.
	(get_IDE_description): Get rid of code that non-portably relies on
	long long. Mark strings for translation.
	(setup_overview_form): Marked string for translation.
	(setup_CPU_form), (setup_RAM_form), (setup_IDE_form),
	(is_location), (athena_hardware_view_load_uri): Disable the
	views other than the overview for now since they are not ready to
	be seen.
	(athena_hardware_view_drag_data_received): Get rid of the code
	that makes the hardware view accept a URI list drag.

	Fix bug 5405 (athena --check fails when using LC_ALL=sv_SE due
	to missing entry in POTFILES.in).
	
	* po/POTFILES.in: Added athena-glib-extensions.c.

	Other changes.
	
	* src/athena-signaller.h:
	* src/athena-signaller.c: (athena_signaller_initialize_class),
	(athena_signaller_get_current):
	Change the AthenaSignaller class so that the interface calls the
	object a GtkObject * and the details of the class are hidden.

	* src/athena-property-browser.c: (emit_emblems_changed_signal):
	* src/athena-search-bar-criterion.c:
	(athena_search_bar_criterion_destroy),
	(athena_search_bar_criterion_new_from_values):
	* src/athena-window-menus.c:
	(athena_window_initialize_go_menu):
	* src/athena-window.c: (athena_send_history_list_changed):
	Now that athena_signaller_get_current returns a GtkObject,
	remove some unnecessary casts.
	
	* components/html/glibwww-callbacks.c: (get_sock_info),
	(glibwww_timer_register):
	* components/tree/athena-tree-model.c:
	(athena_tree_model_initialize):
	* components/tree/athena-tree-view.c:
	(athena_tree_view_initialize):
	* libathena-extensions/athena-directory-async.c:
	(async_job_start):
	* libathena-extensions/athena-directory.c:
	(athena_directory_notify_files_added),
	(athena_directory_notify_files_removed),
	(athena_directory_notify_files_moved):
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_initialize):
	* libathena-extensions/athena-list.c:
	(athena_list_set_selection):
	* libathena-extensions/athena-merged-directory.c:
	(athena_merged_directory_initialize):
	* libathena-extensions/athena-trash-directory.c:
	(athena_trash_directory_initialize):
	* src/file-manager/fm-properties-window.c:
	(fm_properties_window_present):
	Take advantage of the defaults in g_hash_table_new and use NULL,
	NULL instead of g_direct_hash, g_direct_equal.
	
2001-01-03  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 5313 (location bar gets partly inactive during
	auto-completion)

	This was a GTK bug involving event timing. The fix was to
	add a workaround in AthenaEntry.

	* libathena-extensions/athena-entry.c:
	(athena_entry_initialize_class): Wire up default handler
	for selection_clear_event.
	(athena_entry_selection_clear): Bail out without doing anything
	if we are still the selection owner.

2001-01-03  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Work to make clicking on an inactive window not focus it if the
	click subsequently starts a drag. Fixes bug 1681, and removes
	fixme bugs 5030, 5032, and 5033

	* libathena-extensions/athena-drag-window.c,
	libathena-extensions/athena-drag-window.h
	(athena_drag_window_register): new module, hooks into a
	GtkWindow to retrofit a focus policy that makes sense with drag
	and drop sources. When dragging from a window, a button press
	event that subsequently causes a drag to be started doesn't
	focus (or raise) the window

	This uses a sawfish-specific WM_PROTOCOL to handle the `don't
	raise' part (_SAWFISH_WM_RAISE_WINDOW), but everything else
	should work with any ICCCM-compliant wm. (The sawfish specific
	part will have zero effect with other wm's. It currently
	requires a cvs version of sawfish)

	* src/athena-window.c (athena_window_constructed): 
	* src/athena-property-browser.c
	(athena_property_browser_initialize): 
	Call athena_drag_window_register () on the window, since it
	may be used as a drag source

	* libathena-extensions/athena-gdk-extensions.c,
	libathena-extensions/athena-gdk-extensions.h
	(athena_gdk_window_focus,
	athena_gdk_window_set_wm_protocols): new functions

2001-01-04  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_get_default_component_for_file_internal):
	Remove fixme for bug 1264, which is no longer relevant.
	

2001-01-03  Gene Z. Ragan  <gzr@eazel.com>

	Only display removable volumes on desktop.
	
	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_volume_is_removable):
	* libathena-extensions/athena-volume-monitor.h:
	* src/file-manager/fm-desktop-icon-view.c: (volume_in_black_list),
	(create_mount_link):

2001-01-03  Mike Fleming  <mfleming@eazel.com>

	* components/services/summary/athena-view/main.c: (main):
	* components/services/summary/athena-view/athena-summary-callba
	cks.c: (login_button_cb):
	* components/services/summary/athena-view/athena-summary-view.c
	: (athena_summary_view_destroy):

	Bug 5343 for real this time.

	My decision to move the ammonite_init call after the
	oaf_make_registration_id call was a poor one and caused another
	potential race.

2001-01-03  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5394, CRITICAL warning received when zooming a 1x1
	pixel image below 100%
	
	* components/image-viewer/athena-image-view.c: (rezoom_control),
	(control_size_allocate_callback):
	Don't allow a scale if the new width or height is less then 1.

2001-01-03  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(file_exists), (ensure_profile_dir), (ensure_cache_dir),
	(mozilla_content_view_one_time_happenings):
	Add support for using mozilla caching.
	
2001-01-03  George Lebl <jirka@5z.com>

	Reviewed by Maciej, so if I broke something, blame him.

	Fixes #5356

	* libathena-extensions/athena-directory-background.c
	  (make_root_pixmap): Do what the comment says and actually open
	  a new display before setting the close down mode to RetainPermanent.
	  This made athena windows stay persistent after a crash or whatnot.
	  This bug was inherited from control-center.

2001-01-03  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bugs 4677, 3031.
	
	* configure.in:
	* components/mozilla/Makefile.am:
	Use the right RPATH flags depending on where mozilla was found.
	This fixed the problem of trying to use mozilla built by
	eazel-hacking instead of from RPMS.
	
	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize_class),
	(mozilla_content_view_one_time_happenings),
	(mozilla_content_view_setup_profile_directory):
	Add support for setting up a Mozilla profile so that cookies and
	cache work.

2001-01-02  Ramiro Estrugo  <ramiro@eazel.com>

	* configure.in:
	Add "detection" of M19.  Remove the pre M18 detections.
	
2001-01-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	* libathena-extensions/athena-art-extensions.c:
	(athena_art_irect_contains_point):
	* libathena-extensions/athena-art-extensions.h:
	New function to test whether a rectangle contains a point.
	
	* libathena-extensions/athena-gdk-extensions.c:
	(athena_self_check_gdk_extensions):
	* libathena-extensions/athena-gdk-extensions.h:
	* libathena-extensions/athena-gdk-font-extensions.c:
	(athena_gdk_font_get_bold), (font_scalable_get_by_size),
	(font_bitmap_get_by_size), (athena_gdk_font_get_larger),
	(athena_gdk_font_get_smaller), (athena_gdk_font_equal),
	(athena_get_largest_fitting_font),
	(athena_string_ellipsize_start), (athena_gdk_font_list_fonts),
	(athena_gdk_font_get_name), (xlfd_string_get_nth),
	(xlfd_string_replace_nth), (xlfd_string_get_nth_as_int),
	(xlfd_string_is_scalable_non_bitmap),
	(xlfd_string_could_be_scalable_non_bitmap),
	(font_entry_has_bold_weight_test),
	(font_entry_is_scalable_non_bitmap_test),
	(compare_xlfd_by_size_in_points), (compare_xlfd_by_size_in_pixels),
	(athena_self_check_ellipsize_start),
	(athena_self_check_gdk_font_extensions):
	* libathena-extensions/athena-gdk-font-extensions.h:
	Move GdkFont extensions to their own file.  Add new functions to
	find a larger/smaller find given an existing font.  Change the
	bold flavor font function to query the system for fonts, this
	makes it work regardless of the user's selected font.  Before it
	worked only for some fonts.

	* libathena-extensions/athena-file-operations-progress.c:
	* libathena-extensions/athena-file-operations.c:
	* libathena-extensions/athena-icon-canvas-item.c:
	* src/athena-sidebar-title.c:
	Include athena-gdk-font-extensions.h.
	
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_label_make_bold), (athena_gtk_label_make_larger),
	(athena_gtk_label_make_smaller):
	* libathena-extensions/athena-gtk-extensions.h:
	New functions to make a GtkLabel larger/smaller.
	
	* libathena-extensions/athena-lib-self-check-functions.h:
	Add entry for athena-gdk-font-extensions.
	
	* libathena-extensions/athena-string-list.c:
	(athena_string_list_modify_nth),
	(athena_string_list_remove_nth),
	(athena_string_list_find_by_function),
	(athena_string_list_sort),
	(athena_string_list_sort_with_function):
	* libathena-extensions/athena-string-list.h:
	New functions to modify, remove and find specific string entries.
	New function to sort the string list given a compare function.

2001-01-02  Robey Pointer  <robey@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (main):
	* components/services/install/server/main.c: (main):
	* components/services/time/service/main.c: (main):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_init):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h
	:
	* components/services/trilobite/sample/command-line/main.c: (main):
	* components/services/trilobite/sample/service/main.c: (main):

	Add a parameter to trilobite_init to allow a service to pass its
	own popt options along (needed for the command-line installer).

2001-01-02  Andy Hertzfeld  <andy@eazel.com>

	* components/hardware/athena-hardware-view.c:
	(get_RAM_description), (get_IDE_description):
	Incorporated Bud's patch to the disk size calculation in the
	hardware view, which sidesteps integer overflow problems and makes
	it consistent with industry convention by using 1000 instead of
	1024 for the definition of a kbyte.  Also tweaked the RAM size
	calculation, but it's still not quite right yet.
	
	* libathena-extensions/athena-icon-canvas-item.c:
	(draw_pixbuf_aa):
	improved performance by using athena_gnome_canvas_draw_pixbuf
	to draw on the aa canvas instead of libart.

2001-01-02  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

        Fixed bug 4344 (assertion if you view a directory without a
	metafile).
	
	* libathena-extensions/athena-directory.c:
	(athena_directory_initialize), (athena_directory_destroy):
	Create and destroy the metafile hash table when the directory
	is created and destroyed instead of waiting until the metafile
	is read.

	* libathena-extensions/athena-directory-metafile.c:
	(get_file_node): Get rid of code to handle NULL for hash table.
	(athena_directory_metafile_destroy): Just destroy the contents
	of the hash table (hash table itself is destroyed elsewhere now).
	(athena_directory_rename_file_metadata),
	(athena_directory_remove_file_metadata): Get rid of code to
	handle NULL for the hash table.
	(athena_directory_set_metafile_contents): Don't create the
	hash table any more, just populate it.

2001-01-02  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/athena-window-menus.c: (help_menu_about_athena_callback):
	Added the year 2001 to the user-visible copyright notice and made it
	use the standard format with the word Copyright.

2001-01-02  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 5375 (reword the 4000-file limit so it doesn't
	mention the Athena Preview Release)

	* libathena-extensions/athena-directory.c:
	* libathena-extensions/athena-directory.h:
	Move the #define for the limit to a public place.
	
	* src/file-manager/fm-directory-view.c:
	(check_for_directory_hard_limit):
	Reword the dialog so it doesn't promise to go away
	soon. Also, use #define for the limit in case it
	changes, which is likely.

2001-01-02  Ali Abdin  <aliabdin@aucegypt.edu>

        A minor attempt at deallocating things correctly before we exit (so
        memory profilers can be used properly).

        * components/help/converters/gnome-db2html2/gdb3html.c:
        (parse_file): Free stuff that has been allocated by libxml before
        exiting this function. Now memprof stops showing one big large red
        bar.

        Call toc_free_data when done with the TOC.

        * components/help/converters/gnome-db2html2/toc-elements.c:
        (toc_copyright_characters): Add a comment about a memory leak I
        discovered.
        (toc_free_data): New function to free data allocated by toc_init_data

2001-01-02  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 5331 (Control-W closes the desktop)

	* src/file-manager/athena-desktop-icon-view-ui.xml:
	Added insensitive "Close" command that overrides the
	default one.
	
	* src/athena-window-menus.c:
	(athena_window_update_show_hide_menu_items),
	(refresh_bookmarks_menu),
	(athena_window_remove_bookmarks_menu_items),
	(athena_window_remove_go_menu_items),
	(athena_window_update_find_menu_item),
	(append_dynamic_bookmarks), (refresh_go_menu): Removed
	initial ATHENA_ from some #defines that are private to
	this file.

2001-01-01  Ali Abdin  <aliabdin@aucegypt.edu>

        More patches from John Fleck. A fixup for the QANDASET title showing
        up in the TOC.

        Also a fixup for bug #4409 (due to the switching of 'states' in the
        parser we sometimes would print out some extra HTML closing tags
        that shouldn't be there)

        Happy New Year.

        * components/help/converters/gnome-db2html2/gdb3html.h:
        * components/help/converters/gnome-db2html2/sect-elements.c:
        * components/help/converters/gnome-db2html2/sect-preparse.c:
        * components/help/converters/gnome-db2html2/toc-elements.c:
        Add QANDASET and QANDAENTRY.

        * components/help/converters/gnome-db2html2/sect-elements.c:
        (sect_title_start_element),
        (sect_title_end_element):
        Use a temporary boolean variable to reflect wether the we printed out
        the starting tags in sect_title_start_element. If we did, then we
        print out the closing in sect_title_end_element. Otherwise we don't.

        * components/help/converters/gnome-db2html2/toc-elements.c:
        (toc_title_start_element),
        (toc_title_end_element),
        (toc_title_characters):
        Ignore the QANDASET title's since they should not be in the TOC.

2000-12-29  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fixed bug 5374 (No-longer-mounted removable media linger as
	generic icons upon restart).

	* src/file-manager/fm-desktop-icon-view.c:
	(free_volume_black_list): Save code by using
	athena_g_list_free_deep.
	(create_mount_link): Save some g_strdup calls by using const char
	* for the icon_name.
	(fm_desktop_icon_view_initialize): Simplify the code that creates
	the black list by creating a local variable.
	(unlink_and_notify): Helper function that deletes a file and
	notifies the AthenaDirectory/File framework.
	(volume_unmounted_callback): Call unlink_and_notify to do the work.
	(create_link_callback): Pass NULL for default values when setting
	metadata, since we always want to set the metadata.
	(icon_view_create_athena_links): Avoid a storage leak by using
	const char * for the icon name.
	(update_link_and_delete_copies): New function shared for both the
	home and trash link cases. Simpler because it just lets the
	athena_link_xxx functions handle file vs. directory and . and
	.. and doesn't bother doing a stat itself. Also fixes leaks that
	were in the old versions as well as the questionable practice of
	using chdir instead of full paths. Also changes the logic to
	delete any links with the right type but wrong name, rather than
	trying to rename the first icon found of the right type.
	(update_home_link_and_delete_copies): Use the shared
	function. Also don't bother making unused home_link_path.
	(update_trash_link_and_delete_copies): Use the new shared
	function.
	(delete_all_mount_links): Turns out we can use the shared function
	for this case too just by passing in a name that will never match
	any existing link's name ("").

2000-12-29  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-global-preferences.h:
	Changed gconf key for the show desktop option in order to
	avoid using the old default value (OFF) in existing gconf
	databases (bug 5148)

2000-12-29  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-list-view.c:
	fixed bug 3900, emblems too big in list view, by lowering the
	minimum emblem size one notch
	
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_update_icon):
	fixed problem where images that are small in one dimension but large
	in the other were being scaled too large by the minimum size scaling.
	Fixed by pinning to both the minimum and maximum sizes.
	
	also, pinned icon view emblem sizes to MAXIMUM_EMBLEM_SIZE independent
	of scale factor, so they don't become enormous when the icons are
	large.
	
2000-12-29  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fixed bug 5067 (Moving a file doesn't update the directory in the
	link hash table).
	
	Fixed bug 5366 (error when passing two directories on the command
	line).

	* libathena-extensions/athena-directory.c:
	(athena_directory_remove_file): Change code that was doing "==
	FALSE" which is not such good style.
	(athena_directory_notify_files_moved): Change to properly update
	file names in all cases and to update the directory with a new
	athena_file_set_directory function.
	
	* libathena-extensions/athena-file-private.h: Moved the
	Knowledge enum up here. I was going to make a change that required
	it, and now I don't feel like moving it back.
	
	* libathena-extensions/athena-file.h: Add
	athena_file_set_directory (and reformat).

	* libathena-extensions/athena-file.c: (is_self_owned),
	(destroy): Moved is_self_owned so the destroy function can use it.
	(update_info_internal): Call the update_links functions before
	(athena_file_set_directory): New function that changes the
	parent directory and updates everything appropriately.
	(athena_file_mark_gone): Added a check that the file is not
	already marked gone.

	* src/athena-main.c: (main): Sort the command-line options, add
	some single-character versions, add code to initialize the
	"geometry" variable for the case where the option is not passed,
	removed some unused code that sets start_desktop twice.

2000-12-28  Pavel Cisler  <pavel@eazel.com>

	Fixed bug 4952 (Move or copy or large number of items fails).
	Final part of fix for bug 956 (UI takes time to become operational
	after drag&drop)
	
	* libathena-extensions/athena-file-changes-queue.c:
	(athena_file_changes_consume_changes): Fixed a bug in
	the logic that chunked up file change notifications into groups
	that could be all handled at once - before the fix each change
	was processed individually. Grouped move, metadata move, position
	setting and copy, metadata copy, position setting respectively
	into groups that would get all processed in a single chunk.
	Tweaked the maximum size of a changes chunk.
	
	* libathena-extensions/athena-file-changes-queue.c:
	(athena_file_changes_queue_schedule_metadata_copy),
	(athena_file_changes_queue_schedule_metadata_move),
	(athena_file_changes_queue_schedule_metadata_remove),
	(athena_file_changes_queue_schedule_position_setting):
	Some renamings.

	* libathena-extensions/athena-directory-async.c:
	Small tweak to make turning on debugging diagnostics easier.

2000-12-28  Mike Fleming  <mfleming@eazel.com>

	* components/services/summary/athena-view/main.c: (main):
	* components/services/summary/athena-view/athena-summary-view.c
	: (athena_summary_view_initialize):

	Fix for bug 5343, work around for bug 5365.  By avoiding the redundant
	activation of eazel-proxy, race condition described in 5365 is avoided.

2000-12-28  Darin Adler  <darin@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	Fixed bug 2808 (copy all metadata, not just certain items). There
	are still a few loose ends but it's basically there.

	Fixed bug 5296 (Hardware overview should be localized).
	Fixed bug 5299 (Spacing problems with sizes in bytes).

	* libathena-extensions/athena-directory-metafile.c:
	(get_file_node): Used a local variable for the hash table to make
	the code more readable because the full expression is too long.
	Removed the half-baked attempt at using xmlNode objects to
	represent "changes" data, which no longer seems a likely
	direction.
	(athena_directory_metafile_destroy): Local variable for hash
	table.
	(athena_directory_get_file_metadata): Return NULL, not FALSE,
	since the function returns char *, not gboolean.
	(athena_directory_rename_file_metadata): Local variable for hash
	table. Also added a FIXME for a case that won't work.
	(apply_file_changes): Broke out so it can be used elsewhere.
	(apply_one_file_changes): This is now the version that has the
	hash table iterator function interface.
	(athena_directory_get_integer_file_metadata): Use sscanf instead
	of atoi so we can do error checking.
	(athena_directory_copy_file_metadata): Removed the old code that
	copied fixed keys and wrote new code that copies all the metadata.
	(athena_directory_remove_file_metadata): Local variable for hash
	table.

	* icons/arlo/arlo.xml: Added an explicit H offset of 0 for the
	zoom control. It was inheriting the default theme's offset of
	-2. This seems to indicate a design problem with the "fall back on
	default" approach for themes, but for now it's nice to have the
	zoom control looking right again.

	* src/athena-window-menus.c:
	(help_menu_about_athena_callback): Use the real copyright
	character, not "(C)".

	* src/file-manager/fm-desktop-icon-view.c
	(find_and_update_home_link), (place_home_directory): Mark the
	"darin's Home" string for localization. Needs improvement beyond
	this, because just tacking "'s Home" onto the login name is
	probably no good.

	* components/hardware/athena-hardware-view.c: (read_proc_info):
	Tweak code style a bit. Use g_string_free (FALSE) instead of
	g_strdup and g_string_free (TRUE).
	(get_CPU_description): Make this a little more localizable by
	adding a strdup format string instead of appending things. Added
	FIXMEs about additional problems.
	(get_RAM_description): Add a little reality checking on the value
	read from the file and make a little more localizable.
	(get_IDE_description): Change to use the gnome-vfs file size
	formatting functions in the right way. The old code had been
	changed to not use them at all, probably because the first cut at
	this code was using it wrong and ran into a 32-bit limit. Use
	g_string_free (FALSE) instead of g_strdup and g_string_free
	(TRUE).

	* po/POTFILES.in: Marked athena-hardware-view.c as needing
	localization.
	
	* components/help/converters/gnome-db2html2/sect-elements.c:
	(sect_informaltable_start_element): Fixed a runaway string
	literal.

	* libathena-extensions/athena-directory-async.c: Moved the
	constants to the top of the file and put the compile-time switches
	at the top of the constants section.
	
	* NEWS: Removed out of date news.
	* README: Fixed a typo.
	* TODO: Removed out of date tasks.

2000-12-27  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background-canvas-group.c:
	(athena_background_canvas_group_draw),
	(athena_background_canvas_group_render):
	Bug number for FIXMEs.

2000-12-26  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-directory-background.c:
	(desktop_background_realized), (athena_background_set_desktop),
	(athena_background_is_desktop),
	(athena_background_get_desktop_background_window),
	(image_loading_done_callback),
	(athena_file_update_desktop_pixmaps),
	(background_changed_callback), (saved_settings_changed_callback),
	(background_reset_callback),
	(athena_connect_desktop_background_to_file_metadata):
	* libathena-extensions/athena-directory-background.h:
	* src/file-manager/fm-icon-view.c: (fm_icon_view_begin_loading):
	Set the background pixmap of the desktop xwindow so that the
	window manager paints background behind athena windows instead
	of leaving trails.

2000-12-26  Gene Z. Ragan  <gzr@eazel.com>

	* src/file-manager/fm-desktop-icon-view.c: (volume_in_black_list),
	(fm_desktop_icon_view_initialize):
	Compare mount point, not device path.

2000-12-25  Ali Abdin  <aliabdin@aucegypt.edu>

        Handle the <address> tag properly (including <street>, <city>,
        <country>, <postcode>, and <state>) - Fixes bug #2176

        Support the <literallayout> tag - Fixes bug #5341

        These patches contributed by John Fleck <jfleck@inkstain.net>

        Happy Eid and Merry Christmas!

        * components/help/converters/gnome-db2html2/gdb3html.h:
        * components/help/converters/gnome-db2html2/sect-elements.[ch]:
        * components/help/converters/gnome-db2html2/sect-preparse.c:
        * components/help/converters/gnome-db2html2/toc-elements.c:
        (sect_literallayout_start_element),
        (sect_literallayout_end_element):
        New functions to for LITERALLAYOUT tag support.
        (sect_country_start_element),
        (sect_city_start_element),
        (sect_street_start_element),
        (sect_address_end_element),
        (sect_address_start_element),
        (sect_address_characters):
        New functions to handle the ADDRESS/STREET/CITY/COUNTRY tags properly

        * components/help/converters/gnome-db2html2/ASSUMPTIONS:
        Removed an erroneous entry

        * components/help/converters/gnome-db2html2/TODO:
        Updated

        * components/help/converters/gnome-db2html2/AUTHORS:
        Added John Fleck (jfleck@inkstain.net)

2000-12-25  Gene Z. Ragan  <gzr@eazel.com>
	
	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_destroy), (free_volume_black_list),
	(volume_in_black_list), (create_mount_link),
	(startup_create_mount_links), (fm_desktop_icon_view_initialize),
	(volume_mounted_callback):
	Started work on volume black list.  Added proc and boot to
	list.  Need to figure out a way to expose this to the UI
	so it is easy for the user to specify what mounts they
	want displayed on the desktop.

	* libathena-extensions/athena-drag.c: (add_one_url_list),
	(add_one_path_list), (athena_drag_drag_data_get):
	* libathena-extensions/athena-icon-dnd.c:
	Work on supporting drags form Athena into the attachments
	frame of Netscape mail.
	
2000-12-23  John Harper  <jsh@eazel.com>

	* libathena-extensions/athena-gdk-extensions.c
	(athena_gdk_parse_geometry): moved this out of the `! defined
	(ATHENA_OMIT_SELF_CHECK)' preprocessor block where I had
	inserted it by mistake. Also removed a statement with no effect

2000-12-23  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/hyperbola-filefmt.c:
        (fmt_man_populate_tree):
        Look in /usr/share/man if the 'manpath' app returns nothing.

2000-12-23  Ali Abdin  <aliabdin@aucegypt.edu>

        So, I thought I was fixing this bug in the Eazel bugtracker. I hack
        away, and get gzipped man files showing up in the Help sidebar. Turns
        out, that the bug I /should/ have been working on was some info-files
        now showing up in the Help sidebar.

        Oh well, at least we now get gzipp'd man files showing up in the
        sidebar (which is most man files nowadays).

        So I continuied hacking and fixd bug #4414 (info files in Debian do
        not show up in Help sidebar)

        * components/help/hyperbola-filefmt.c:
        (extract_secnum_from_filename),
        (name_without_suffix): New functions

        (fmt_man_populate_tree_from_subdir):
        gnome-man2html2 actually supports gzip'd files. So this needed some
        major work to get it to support them gzip'd files.

        (fmt_info_populate_tree):
        Also populate tree from the /usr/share/info subdir. I think this helps
        destroy bug #4414

2000-12-23  Ali Abdin  <aliabdin@aucegypt.edu>

        More Fixing for bug #5118 (tags within a title do not appear in the
        TOC). There are a few 'difficult' cases that are still not supported
        and we probably won't support.

        Thanks to jfleck@inkstain.net

        * components/help/converters/gnome-db2html2/toc-elements.c:

        Filled in function table to use toc_tag_characters where
        appropriate.

        (toc_tag_characters),
        (toc_title_end_element),
        (toc_title_start_element):
        Some hackery to use an 'in_printed_title' variable (so we can
        distinguish on wether we need to actually print the tag within the
        title).

        * components/help/converters/gnome-db2html2/gdb3html.c:
        (xml_parse_document): This function was #if 0'd out and is now gone
        from the tree
        (parse_file): Remove #if 0'd code.
        (main): Remove a really old unncessary comment

        * components/help/converters/gnome-db2html2/gdb3html.c:
        * components/help/converters/gnome-db2html2/sect-elements.c:
        * components/help/converters/gnome-db2html2/toc-elements.c:
        i18n'd a bunch of strings as some preliminary work to getting i18n
        working with gnome-db2html2

        * po/POTFILES.in:
        Update to reflect the i18n'd strings in gnome-db2html2

2000-12-23  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 4158, dropping a file onto gnome-terminal
	doesn't insert a path name.
	
	* libathena-extensions/athena-drag.c: (add_one_path_list),
	(athena_drag_drag_data_get):
	Return a list a text paths.
	
	* libathena-extensions/athena-drag.h:
	Add new type and data type for "text/uri"
	
2000-12-22  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* libathena-extensions/athena-debug-drawing.c:
	(event_box_draw), (event_box_expose_event),
	(athena_debug_show_pixbuf):
	Dont use AthenaImage here because that create a chicken
	and egg problem when debuggin AthenaImage itself.  Use
	an event box instead.

	* libathena-extensions/athena-gdk-extensions.h:
	* libathena-extensions/athena-gdk-extensions.c:
	(athena_gdk_rgb_to_color_spec):
	New function to make a string color spec from an rgb value.
	
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	* libathena-extensions/athena-gdk-pixbuf-extensions.h:
	(athena_gdk_pixbuf_is_valid),
	(athena_gdk_pixbuf_get_frame):
	Make these public and add documentation for them.
	
2000-12-22  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>
	
	Fixed bug 4951, No error given selecting unmountable "Disks" volume.
	
	I added a pipe to monitor the result of the mount/umount command.
	If an error is in the pipe, a details error dialog is displayed.
	A generic mount failed error is first and the details button reveals
	the error message returned in the pipe.
		
	* libathena-extensions/athena-volume-monitor.c: (find_command),
	(open_error_pipe), (close_error_pipe),	
	(athena_volume_monitor_mount_unmount_removable):

	Renamed xfer to transfer.
	* libathena-extensions/athena-file-operations.c:
	(parent_for_error_dialog), (transfer_dialog_clicked_callback),
	(create_transfer_dialog), (handle_transfer_ok),
	(build_error_string), (handle_transfer_vfs_error),
	(handle_transfer_overwrite), (handle_transfer_duplicate),
	(update_transfer_callback), (sync_transfer_callback),
	(athena_file_operations_copy_move),
	(handle_new_folder_vfs_error), (new_folder_transfer_callback),
	(athena_file_operations_new_folder),
	(athena_file_operations_move_to_trash),
	(athena_file_operations_delete), (do_empty_trash):

	Added compatibility call.
	* libathena-extensions/athena-entry.c:
	* libathena-extensions/athena-entry.h:
	(athena_entry_new_with_max_length):
			
2000-12-22  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_register): Add missing _()

2000-12-22  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 5065 (When Athena moves a directory it doesn't rename
	the corresponding private metafile).

	Fixed bug 5066 (Moving a directory doesn't update infomrration
	about child directories in Athena).

	Fixed bug 5297 (Make all (C) strings use gettext).

	* libathena-extensions/athena-directory-metafile.c:
	(athena_directory_rename_file_metadata),
	(athena_directory_remove_file_metadata): Add check for NULL hash
	table. Without this check we kept running into asserts.
	
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory.c:
	(athena_directory_new): Share URI-setup code with the renaming
	case.
	(set_directory_uri): New function shared with new directories and
	renaming.
	(get_path_from_vfs_uri), (get_private_metafile_path): Utility
	functions to help get local paths for private metafiles.
	(change_directory_uri): Update URI for an existing
	AthenaDirectory object. This handles renaming the private
	metafile too.
	(collect_directories_by_prefix): Function to collect affected
	directories when you rename a directory.
	(str_replace_prefix): Utility to replace string prefix so we can
	turn old directory name into the new one.
	(athena_directory_moved): Renamed and changed to use URIs
	instead of a directory object so it can be called even when no
	directory exists. Also made it collect all affected directories
	and do the work with change_directory_uri on each one.
	* libathena-extensions/athena-file.c: (rename_callback): Use
	the new athena_directory_moved.
	
	* libathena-extensions/athena-file-utilities.h:
	* libathena-extensions/athena-file-utilities.c:
	(athena_get_build_time_stamp):
	* src/athena-about.h:
	* src/athena-about.c: (athena_about_new),
	(athena_about_draw_info):
	* src/athena-window-manage-views.c:
	(window_set_title_with_time_stamp), (update_title):
	* src/athena-window-menus.c:
	(help_menu_about_athena_callback):
	Rename "timestamp" -> "time stamp".

	* src/athena-window-menus.c:
	(help_menu_about_athena_callback): Mark "(C)" string for
	translation.
	
2000-12-21  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Work to allow geometry of initial window to be specified on
	command line. Fixes bug #5135

	* src/athena-shell.c (open_window): new arg `geometry'. When
	non-null, use athena_gtk_window_set_initial_geometry_from_string
	to affect the geometry of the unmapped window

	(corba_open_default_window, corba_open_windows): new arg,
	`geometry', passed to open_window () if a non-null string

	* src/athena-shell-interface.idl (open_windows,
	open_default_window): added `geometry' parameter. Pass a
	zero-length string to show no specified geometry

	* src/athena-main.c (main): new option `--geometry=GEOMETRY'.
	Pass the value to athena_application_startup (). This option
	is only allowed when no more than one URI is given on the
	command line (to prevent multiple windows appearing on top of
	one another)

	* src/athena-application.c, src/athena-application.h
	(athena_application_startup): added parameter `geometry', a
	string describing the geometry to give any created windows

	* src/athena-first-time-druid.c (druid_finished): pass null
	geometry parameter to athena_application_startup ()

	* libathena/athena-gdk-extensions.c,
	libathena/athena-gdk-extensions.h
	(AthenaGdkGeometryFlags, athena_gdk_parse_geometry): a
	wrapper for XParseGeometry () and associated bit definitions.
	Required since gnome_parse_geometry () offers no reliable way
	of detecting which of the geometry components were parsed
	successfully

	* libathena/athena-gtk-extensions.c,
	libathena/athena-gtk-extensions.h
	(athena_gtk_window_set_initial_geometry): takes an extra
	parameter, a AthenaGdkGeometryFlags value specifying which of
	the geometry parameters are valid

	(athena_gtk_window_set_initial_geometry_from_string): changed
	to allow the geometry string to specify one or both of position
	and dimensions. Also doesn't use g_return_if_fail to test for
	validity of input string (since it may come from the user),
	instead just use the parseable parts of the geometry string

2000-12-22  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Athena part of fix for bug 4798 (icon changes in MIME
	type capplet aren't reflected automatically in Athena)

	* libathena-extensions/athena-icon-factory.c:
	(get_icon_factory): connect to gnome_vfs_mime_monitor's
	"data_changed" signal. 
	(mime_type_data_changed_callback): emit "icons_changed"
	signal when gnome_vfs_mime_monitor says data has changed.

2000-12-21  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	* components/text/athena-text-view.oafinfo,
	components/hardware/athena-hardware-view.oafinfo: Fixed IID to
	standard format.
	
	* components/hardware/main.c (hardware_view_make_object, main),
	components/text/main.c: (text_view_make_object, main):
	Updated to match.

2000-12-21  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-icon-canvas-item.c:
	(draw_or_measure_label_text_aa):
	* libathena-extensions/athena-icon-factory.c: (embed_text):
	* libathena-extensions/athena-label.c: (render_buffer_pixbuf):
	* libathena-extensions/athena-scalable-font.c:
	(athena_scalable_font_draw_text),
	(athena_scalable_font_draw_text_lines_with_dimensions),
	(athena_scalable_font_draw_text_lines),
	(athena_text_layout_paint), (athena_gdk_pixbuf_new_from_text):
	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-tabs.c: (draw_tab_label):
	* src/athena-about.c: (draw_aa_string):
	* src/athena-sidebar-tabs.c: (draw_one_tab_plain),
	(draw_one_tab_themed):
	* test/test-athena-font.c: (main):
	Lost the "inverted" feature of smooth text drawing.  It wasnt used
	anywhere except a test program.  It never looked well and the
	athena icon container does something unrelated to select text.

	Also replace some hard coded 255 opacity values to use the
	ATHENA_OPACITY_NONE define.
	
2000-12-21  J Shane Culpepper  <pepper@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* components/services/install/lib/eazel-inventory-utils.c:
	(add_package_info), (add_hardware_info), (add_software_info),
	(eazel_create_configuration_metafile):

	Added the SOFTWARE node to the xml generation. Added 
	bogomips, flags, and distribution to information gathered.
	There are very few things missing from the collection engine
	now.

2000-12-21  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5218, The desktop is missing devices. (cdrom & vfat volume)
	
	Try and be more intelligent about determing the name of mounted
	volumes.  Until we can get the device name from the partition,
	we instead derive the name form the mount path.  If that fails, we fall
	back on a hrad coded string.
	
	* libathena-extensions/athena-volume-monitor.c:
	(mount_volume_get_name), (get_ext2_volume_name),
	(get_msdos_volume_name), (get_nfs_volume_name),
	(get_floppy_volume_name), (get_generic_volume_name):
	New and modified functions to return volume names.
	
2000-12-21  John Sullivan  <sullivan@eazel.com>

	* components/sample/main.c: (main): Changed
	athena_view_create_from_get_type to
	athena_view_create_from_get_type_function so it would
	compile. My guess is this was a last-minute rename from
	Maciej's previous checkin.

	Fixed bug 5319 (two menu items in Help menu use same underline
	accelerator key)
	Fixed bug 5293 ("Athena Feedback..." should just be "Feedback..."
	since it's not only for Athena feedback.)
	
	* src/athena-shell-ui.xml: Moved an underscore, changed a label,
	tweaked a tip.

2000-12-21  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 5282 (Two file-name-conflict dialogs renaming in
	Properties window)

	The problem was that the activate signal and the focus-out signal
	were both trying to rename using the bad name. Fixed by restoring
	the text in the name field to the original name when an error occurs.

	* src/file-manager/fm-properties-window.c:
	(fm_properties_window_initialize_class): Wire up finalize handler.
	(name_field_restore_original_name): Select text of original name
	after restoring it into text field.
	(set_pending_name): Helper function to save pending name.
	(name_field_done_editing): Remember pending name in case window
	and name field get destroyed before callback. Ref window so it
	won't be finalized before callback.
	(rename_callback): Restore original name when rename fails, use
	stored pending name for window, unref window.
	(name_field_focus_out), (name_field_activate): Now take window
	as callback data so it can be passed to done_editing.
	(create_basic_page): Remember name field in window details struct
	so it can be accessed in rename_callback; remove some unnecessary
	casts; pass window as callback data to two signal handlers.
	(real_destroy): Don't free details here; do so in finalize
	(real_finalize): Free pending_name and details here, so pending
	name is always accessible by rename_callback.

2000-12-21  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena/athena-view.c, libathena/athena-view.h
	(athena_view_construct,
	athena_view_construct_from_bonobo_control): New construct
	functions so it's possible for view implementations to be
	subclasses of AthenaView.
	(athena_view_new_from_bonobo_control): Implement in terms of construct function.
	* libathena/athena-view-standard-main.h,
	libathena/athena-view-standard-main.c:
	(athena_view_standard_main_multi, athena_view_standard_main,
	athena_view_create_from_get_type): New convenience functions
	that encapsulate and librarify most of the cut and pasted main.c
	code that is in every athena view.
	(object_destroyed, make_object): Helper functions. 
	* libathena/Makefile.am: Add athena-view-standard-main.[ch] to
	build.
	* libathena/athena-view-component.idl: Add license header
	comment.

	* libathena-extensions/athena-gtk-macros.h: Lined up the
	backslashes to make it easier to read and edit the multi-line
	macros.

	* components/sample/README: Explain that all files in this
	directory have "WHAT YOU NEED TO CHANGE" comments.
	* components/sample/main.c (main): Implement in terms of
	`athena_view_standard_main' and removed most of the rest of this
	file. Now all you have to change when writing your own view is an
	include and some defines at the top of the file. Added "WHAT YOU
	NEED TO CHANGE" comment.
	* components/sample/athena-sample-content-view.h,
	components/sample/athena-sample-content-view.c: Added "WHAT YOU
	NEED TO CHANGE" comments.
	(athena_sample_content_view_get_type,
	athena_sample_content_view_initialize,
	athena_sample_content_view_destroy, load_location,
	sample_load_location_callback, bonobo_sample_callback,
	sample_merge_bonobo_items_callback): Changed everything around so
	AthenaSampleContentView inherits from Athena view, not
	GtkLabel (the widget that happens to be in the main content
	area). This makes a lot more sense. Also fix bug 2410 but
	including alternative code to athena-only macros.
	
	* components/sample/athena-sample-content-view.oafinfo: Added
	"WHAT YOU NEED TO CHANGE" comment.
	* components/sample/Makefile.am: Added "WHAT YOU NEED TO CHANGE" comment.

2000-12-21  John Sullivan  <sullivan@eazel.com>

	* libathena-extensions/athena-search-uri.c:
	(athena_self_check_search_uri): Updated self-check
	expected results to match recent wording changes.
	This should fix the Tinderbox build.

2000-12-21  Rebecca Schulman  <rebecka@eazel.com>
	Fix for bug 5244, that search interface 
	text that are sentence fragments should have comments explaining
	the context of the text to improve translation quality.

	reviewed by: Christian Rose <menthos@menthos.com>

	* libathena-extensions/athena-search-uri.c:
	* src/athena-search-bar-criterion.c:
	Added comments directly above sentence fragments
	that will be translated.

2000-12-20  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-debug-drawing.h:
	* libathena-extensions/athena-debug-drawing.c:
	(athena_debug_show_pixbuf_in_eog), (debug_delete_event),
	(athena_debug_show_pixbuf):
	Add a debug function to show pixbufs in process without having to
	fork off eog. This is more useful than the eog version for
	asynchronous stuff.
	
	* libathena-extensions/athena-gdk-pixbuf-extensions.h:
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(pixbuf_draw_tiled), (draw_tile_to_pixbuf_callback),
	(draw_tile_to_drawable_callback),
	(athena_gdk_pixbuf_draw_to_pixbuf_tiled),
	(athena_gdk_pixbuf_draw_to_drawable_tiled),
	New function to tile pixbufs into drawables. In order to reuse the
	tiling algorithm from the "tile_to_pixbuf" function, I added a
	simple callback mechanism.
	
	(athena_gdk_pixbuf_get_global_buffer),
	New function to access a global buffer.
	
	(athena_gdk_pixbuf_get_from_window_safe):
	New function to wrap gdk_pixbuf_get_from_drawable with safety from
	x errors and race conditions. See code for detailed comments as to
	the specific problems this wrapper addresses.

	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_class_name_make_like_existing_type):
	New function that custom widgets can call to make themselves look
	like stock widgets wrt to the gtk thememing engine.

2000-12-21  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-art-gtk-extensions.h:
	* libathena-extensions/athena-art-gtk-extensions.c:
	(athena_irect_assign_gdk_rectangle),
	(athena_irect_screen_get_frame),
	(athena_irect_gdk_window_get_bounds),
	(athena_irect_gdk_window_get_screen_relative_bounds),
	(athena_irect_gtk_widget_get_bounds),
	(athena_irect_gdk_window_clip_dirty_area_to_screen):
	New functions that accept gtk/gdk structures and
	return their bounds/frames as ArtIRects.

	These are very useful in code that uses libart functions
	to do operations on ArtIRects (such as intersection)
	
2000-12-20  Maciej Stachowiak  <mjs@eazel.com>

	* components/services/inventory/lib/trilobite-eazel-inventory-public.h:
	Removed.

2000-12-20  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 5285 (Renaming file through 'properties' dialog causes
	Glib errors).

	Did some work on bug 2288 (Location bar should only escape /
	unescape unambiguously for URIs ).

	* libathena-extensions/athena-directory-metafile.c:
	(athena_directory_set_metafile_contents): Create hash table even
	when no metafile is read in. This fixes asserts people were
	seeing.
	
	* libathena-extensions/athena-file-utilities.c:
	(athena_format_uri_for_display): Use
	gnome_vfs_get_local_path_from_uri to unescape paths so we don't
	unintentionally munge them. There may still be an issue with using
	this function on a string that gets written into the location bar.
	(is_valid_scheme_character), (has_valid_scheme), (expand_tilde),
	(athena_make_uri_from_input): Redo function to implement a new
	scheme where we put http:// in front of anything that doesn't
	start with a URI scheme or a / and file:// in front of things that
	do start with / (converting the path to a URI by escaping
	characters are necessary).
	(athena_get_build_timestamp): Get rid of unneeded tests.
	(athena_self_check_file_utilities): Updated self-test for
	athena_make_uri_from_input.
	* src/athena-location-bar.c: (try_to_expand_path): Fix
	NULL-dereference in cases where gnome_vfs_unescape_string returns
	NULL.
	* src/athena-navigation-bar.c:
	(athena_navigation_bar_location_changed): Remove the broken
	get_mapped_location function (which called g_file_exists on
	partial paths so gave virtually "random" results) and just call
	get_location directly.

2000-12-20  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5186, Music View (and then Athena) crashes playing
	0-length MP3
	
	reviewed by: Pavel Cisler <pavel@eazel.com>

	Crash was caused by using an unitialized variable. Initializing
	the variable to NULL and then checking the result after the
	function is called solved the problem.
	
	* components/music/athena-music-view.c: (get_song_text),
	(music_view_set_selected_song_title):

2000-12-20  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5172, Music View doesn't always scroll when
	active song off-screen

	Borrowed code from AthenaCList to fix bug.
	Selection now scrolls into view in a logical manner during
	playback.
	
	* components/music/athena-music-view.c:
	(athena_music_view_initialize_class),
	(athena_music_view_initialize), (athena_music_view_destroy),
	(list_move_vertical), (list_moveto), (list_reveal_row),
	(play_current_file):

2000-12-20  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 4842 (Link to .Trash gives "You cannot copy the Trash"
	dialog) and part of bug 5221 (Trying to delete .Trash says
	"The Trash cannot be moved from the desktop")

	* libathena-extensions/athena-file-operations.c:
	(athena_file_operations_copy_move): Don't disallow linking
	to trash folders (was doing so accidentally); distinguish
	error wording for desktop Trash icon and other trash folders.

2000-12-20  J Shane Culpepper  <pepper@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/services/install/command-line/.cvsignore:
	* components/services/install/command-line/Makefile.am:
	* components/services/install/command-line/eazel-test-inventory.c:
	(main):
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_do_transaction_md5_check):
	* components/services/install/lib/eazel-inventory-utils.c:
	(eazel_create_configuration_metafile),
	(update_gconf_inventory_digest), (eazel_gather_inventory):
	* components/services/install/lib/eazel-inventory-utils.h:
	* components/services/trilobite/libtrilobite/trilobite-md5-tools.c:
	(trilobite_md5_get_digest), (trilobite_md5_get_digest_from_file),
	(trilobite_md5_get_digest_from_md5_string),
	(trilobite_md5_get_string_from_md5_digest), (main):
	* components/services/trilobite/libtrilobite/trilobite-md5-tools.h:

	Adding various fixes to the inventory engine and adding a test program
	to validate the inventory api.  Fixed the trilobite-md5-tools functions
	to namespace trilobite correctly.

2000-12-19  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/Makefile.am:
	Dumshit me forgot to add new files to makefile.
		
2000-12-19  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-debug-drawing.h:
	* libathena-extensions/athena-debug-drawing.c:
	(athena_debug_draw_rectangle_and_cross),
	(athena_debug_show_pixbuf_in_eog):
	New files.  Put drawing debugging functions here.
	
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	* libathena-extensions/athena-gdk-pixbuf-extensions.h:
	Move drawing debugging functions to athena-debug-drawing.[ch].

	* test/test-athena-font.c: (main):
	Update for debug drawing functions location change.
	
2000-12-19  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	This powerpatch introduces the first parts of the ei2 work.
	
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_update_from_uri):
	Updated the is_installed call to also pass a version sense.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line),
	(eazel_download_progress_signal), (main):
	Option to enable ei2.
	And since I was bored and played with adding KB/s to download.
	Also reenabled the use of gnome_init since otherwise the options
	were all incorrect.
	
	* components/services/install/command-line/eazel-test-packsys.c:
	(test_query), (progress_signal), (test_verify):
	Made the tests easier to tweak, by having defines for the
	packages/features etc that are used in the test queries.
	Fixed test_verify, so it' won't report badness on verify of
	multiple packages.
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(categorylist_flatten_to_packagelist),
	Moved a function from eazel-install-logic. It returns a flat list
	of all the packages in a set of categories.
	(packagedata_class_initialize), (packagedata_initialize),
	(packagedata_finalize), (packagedata_get_type), (packagedata_new),
	(packagedata_fill_in_missing), (packagedata_destroy),
	gtk'ified the packagedata object (I apologize)
	(eazel_install_package_matches_versioning):
	Made the matches_versioning use a version sense.
	Also added a PACKAGE_FILL_INVALID enum and a
	EAZEL_SOFTCAT_SENSE_ANY. Guess what they mean...
	Also added some gtk style defines for PackageDependency, for the
	day when we actually want to abuse it into a gtkobject (shudder)
	fill_in_missing now also sets the fillflag (needed for the ei2 work)
	
	* components/services/install/command-line/eazel-test-types.c:
	(test_eazel_install_package_matches_versioning):
	More test of matches_versioning to test the new sense ability.
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install__set_ei2), (impl_Eazel_Install__get_ei2),
	(impl_Eazel_Install__set_ignore_file_conflicts),
	(impl_Eazel_Install__get_ignore_file_conflicts),
	(eazel_install_get_epv):
	Added the evil ei2 boolean. If set, libeazelinstall will use the
	new ei2 features.
	
	* components/services/install/lib/Makefile.am:
	Added eazel-install-logic2.c which has the ei2 stuff.
	
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/eazel-install-logic.c:
	(ei_install_packages), (eazel_install_download_packages),
	(ei_uninstall_packages), (ei_revert_transaction),
	(eazel_install_check_existing_packages),
	(eazel_install_fetch_dependencies),
	(eazel_uninstall_check_for_install):
	Moved flatten_packages out.
	Prefixed soem functions with ei_ to seperate them from the ei2
	equivalents.
	Suffixed emit_dependency_check with _pre_ei2 to seperate it from
	the ei2 equivalent.
	
	* components/services/install/lib/eazel-install-logic2.h:
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (dump_tree), (get_softcat_info),
	(get_package_info_foreach), (get_package_info),
	(dedupe_foreach_depends), (dedupe_foreach), (dedupe),
	(is_satisfied), (is_satisfied_features),
	(check_dependencies_foreach), (check_dependencies),
	(no_two_packages_with_same_file), (check_conflicts_with_other),
	(feature_consistency_check), (do_file_conflict_check),
	(do_dep_check), (install_packages), (uninstall_packages),
	(revert_transaction):
	Implemented the first many steps of ei2. It now gets package info
	and correctly constructs a tree of needed packages. It still lacks
	the file and feature conflict checking.
	
	* components/services/install/lib/eazel-install-metadata.c:
	(init_default_install_configuration):
	Default debug to FALSE
	
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_set_arg), (eazel_install_class_initialize),
	(eazel_install_initialize), (eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_emit_dependency_check),
	(eazel_install_emit_dependency_check_pre_ei2),
	(eazel_install_set_debug):
	Shitload of code just to have one more arg (ei2). I remember how
	easy this was in Emerald... *sigh*
	_set_debug also sets VERBOSE debug in the packagesystem object.
	Initialise also inits some new hashes for ei2.
	The install, uninstall and revert checks for the ei2 setting, if
	true, use the new ones, of not, use the old ones (doh)
	Added a new emit_dependency that as second arg takes a
	PackageDependency and mutates a correct PackageData from it.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	Back to only getting with NO_PROVIDES|NO_DEPENDENCIES when using
	the old (non ei2) stuff.
	
	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_is_installed):
	Takes a sense as last argument, make it more flexible.	

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(eazel_package_system_rpm3_query_requires),
	(check_if_all_packages_seen):
	Removed a fixme comment.
	Added a fixme comment.
	Set the package fillflag in fill_from_header.
	Fixed some braindamage in query_requires to limit the amount of
	damage the query does.
	all_packages_seen changes according to the is_installed changes.
	
	* components/services/install/lib/eazel-softcat.c:
	* components/services/install/lib/eazel-softcat.h:
	Give robey more blame than me.
	
	* components/services/install/lib/makefile.staticlib.in:
	Added logic2.o
	
2000-12-19  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5258 (no UI for renaming new folder in View as List)

	After some email discussion, decided to bring up Properties
	window in this case. Fortunately, FMDirectoryView had this case
	beautifully factored so it was a cinch to add this.

	* src/file-manager/fm-list-view.c: 
	(real_start_renaming_item): New function, presents properties
	window.
	(fm_list_view_initialize_class): wire up real_start_renaming_item 
	as start_renaming_item function pointer,

2000-12-19  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>
	
	* libathena-extensions/athena-art-extensions.h:
	* libathena-extensions/athena-art-extensions.c:
	(athena_art_irect_assign),
	Convenience function to assign x,y,width,height values to an
	ArtIRect.

	* libathena-extensions/athena-gdk-pixbuf-extensions.h:
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(athena_gdk_pixbuf_is_valid),
	A simple private function that returns whether a pixbuf is "valid"
	or not.  Vailidy is meassured as not null, with valid pixel data
	and non zero dimensions.
	
	(athena_gdk_pixbuf_get_frame),
	Private function to return the frame of a GdkPixbuf in a stucture for
	better readability.

	(athena_gdk_pixbuf_fill_rectangle_with_color),
	Changed it to use ArtIRect's instead of GdkRectangles to avoid
	using unsigned and short integers.  Also, use art_irect_interset()
	to do clipping.

	(athena_gdk_pixbuf_save_to_file),
	Changed the pixbuf parameter to be const.

	(athena_gdk_pixbuf_unref_if_not_null),

	(athena_gdk_window_get_frame),
	Private function to return the frame of a GdkWindow in a stucture for
	better readability.
	
	(athena_gdk_pixbuf_draw_to_drawable),
	Renamed function to be consitent with the other pixbuf drawing
	functions.  Also made it use ArtIRect's instead of GdkRectangles
	to avoid using unsigned and short integers.  Rewrote the clipping
	operations using art_irect_intersect() for better readability.

	(athena_gdk_pixbuf_draw_to_pixbuf),
	Renamed function to be consitent with the other pixbuf drawing
	functions.  Also made it use ArtIRect's instead of GdkRectangles
	to avoid using unsigned and short integers.  Rewrote the clipping
	operations using art_irect_intersect() for better readability.

	(athena_gdk_pixbuf_draw_to_pixbuf_alpha),
	Renamed function to be consitent with the other pixbuf drawing
	functions.  Also made it use ArtIRect's instead of GdkRectangles
	to avoid using unsigned and short integers.  Changed the
	implementation to honor all parameters including the source_x and
	source_y.  This is needed to work around limitation in
	gdk_pixbuf_composite().  Rewrote the clipping operations using
	art_irect_intersect() for better readability.

	(athena_gdk_pixbuf_new_from_pixbuf_sub_area),
	(pixbuf_destroy_callback),
	New function to create pixbuf from a sub area.  The pixel data is
	shared an all memory bookeeping is taken care of for the caller by
	simply unreffing the resulting pixbuf.
	
	(athena_gdk_pixbuf_draw_to_pixbuf_tiled),
	Renamed function to be consitent with the other pixbuf drawing
	functions.  Made the implementation work and honor all its
	parameters including the origin.   Rewrote the clipping
	operations using art_irect_intersect() for better readability.

	There was a bug (5077) about this function claiming it was not
	used except in test code.  This was true, but now that it works im
	planning on using it in AthenaImage shortly.  I have marked that
	bug fixed.
	
	(athena_gdk_pixbuf_show_in_eog):
	New function to show a pixbuf externally in eog.  Useful for
	debugging pixbuf stuff.

	* libathena-extensions/athena-buffered-widget.c:
	(athena_buffered_widget_draw), (athena_gdk_pixbuf_tile_alpha):
	Use new gdk-pixbuf extension functions.
	
	* libathena-extensions/athena-scalable-font.c:
	(athena_text_layout_paint):
	Update for changes in fill_rectangle_with_color() api.
	
	* src/athena-about.c: (athena_about_update_authors):
	Update for changes in fill_rectangle_with_color() api.

	* test/test-athena-font.c: (main):
	Update for changes in pixbuf extensions.

2000-12-19  Darin Adler  <darin@eazel.com>

	* components/tree/athena-tree-model.c: (dump_one_file_node):
	Fixed code that cast a pointer to (unsigned), which won't work on
	the many platforms where pointers are bigger than ints.

2000-12-19  John Sullivan  <sullivan@eazel.com>

	* libathena-extensions/athena-thumbnails.c:
	(athena_update_thumbnail_file_renamed_one):
	Removed a g_assert (!vfs_file_exists). I ran into this while
	testing something unrelated and Darin convinced me that it is
	loony to assert anything about the state of the files on disk.

2000-12-19  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 2392 (need timed wait when activating file)

	* src/file-manager/fm-directory-view.c: 
	(get_containing_window): Rewrote to avoid applying
	GTK_WINDOW () cast on potential NULL object.
	(fm_directory_view_activate_file): Start timed-wait when
	activating file, so user can cancel it if the call_when_ready
	takes a really long time.
	(activate_callback): Cancel timed-wait when we hear back from
	the call_when_ready.
	(cancel_activate_callback): Cancel call_when_ready if the user
	clicks the Cancel button in the timed-wait dialog.
	
	* src/file-manager/fm-properties-window.c:
	(fm_properties_window_present): Fixed a doubled character in
	a string from my previous checkin.

2000-12-19  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 2292 (no way to cancel opening a Properties window,
	which could wait forever checking if a file is a directory). 
	Now there's a hashtable of pending files, which is used to 
	avoid trying to show the same window twice and to cancel 
	showing a window. 

	* src/file-manager/fm-properties-window.c:
	(cancel_create_properties_window_callback): New function, used
	by timed-wait mechanism to give up on not-yet-appearing
	properties window.
	(remove_pending_file): New helper function, removes pending
	file from hashtable and stops timed-wait.
	(pending_file_succeeded): New helper function called when
	the wait for info is over and the window can be created.
	(create_properties_window_callback): call pending_file_succeeded
	before doing anything else.
	(directory_view_destroyed_callback): New function, used to
	cancel timed-wait if the directory view is destroyed before
	the properties window has appeared.
	(fm_properties_window_present): Create pending_files hashtable;
	do nothing if we're already waiting for a properties window
	for this file; add file to pending_files; wire up
	directory_view_destroyed_callback; start timed-wait before
	using call_when_ready to determine if file is a directory;
	use athena_g_hash_table_new_free_at_exit to help catch
	leaks.


	Added a couple more bonobo_ui_component_freeze/thaw pairs,
	though they have only a very small measured effect here.

	* src/file-manager/fm-icon-view.c: (update_layout_menus),
	(fm_icon_view_merge_menus): Add freeze/thaw pairs around
	multiple bonobo-ui operations.

2000-12-19  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 2233 (proper icon not selected switching views after
	rename) by re-sending selection when the selection items change
	since they might have changed names.
	
	* src/file-manager/fm-directory-view.c: (done_loading): Moved
	more of the done_loading code here for clarity.
	(compare_pointers), (sort_and_check_for_intersection): Added
	functions that quickly find if there's an intersection in two
	GLists of AthenaFile objects.
	(display_pending_files): Move some of the done_loading code into a
	new function, do it after processing file changes, and add code to
	send out the selection if a file change comes in for any items in
	the selection (in case the name changed).
	(display_selection_info_idle_callback),
	(update_menus_idle_callback), (display_pending_idle_callback):
	Make all of these more robust by keeping the AthenaView object
	in a local variable.
	(display_pending_timeout_callback): Do the "ref the AthenaView"
	thing in this function too.

	* check-POTFILES.pl: Added support for .xml and .cpp files and
	also updated special cases for directory environment variables.
	* check-THANKS.pl: Added a special case and fixed some things in
	the ChangeLog too to make this output fewer false positives.

2000-12-19  Mike Fleming  <mfleming@eazel.com>

	* components/services/athena-dependent-shared/shared-service-widgets.c:
	Added fixme

	* components/mozilla/main.c: (main):
	* components/services/summary/athena-view/main.c: (main):

	Cleaned up the ammonite/gconf initialization mess.  gconf should
	always be initialized before ammonite, and ammonite should always be
	initizalized if you're going to use it.

2000-12-19  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-art-extensions.c:
	* libathena-extensions/athena-art-extensions.h:
	* libathena-extensions/athena-gnome-extensions.c:
	* libathena-extensions/athena-gnome-extensions.h:
	* libathena-extensions/athena-icon-canvas-item.c:
	Move the libart specific extensions to their own place where I
	will soon add stuff.
	
2000-12-19  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	* libathena-extensions/athena-gdk-pixbuf-extensions.h:
	Remove athena_gdk_pixbuf_draw_text().  This function was meant
	to be used by embedded text.  Ever since we started using anti-
	aliased text via freetype, we dont need it anymore.

	This yanking manuever fixes Bug 2559, since the code relevant to
	that bug is now gone.

	* libathena-extensions/athena-icon-factory.c: (embed_text):
	Always use smooth fonts for embedded text.  Remove currently
	unused call to athena_gdk_pixbuf_draw_text().

	The issue of embedded always being anti aliased will continue to
	be tracked by bug 2783.
	
2000-12-18  Andy Hertzfeld  <andy@eazel.com>

	* icons/i-harddisk.png:
	aligned perspective with other images in the hardware view
	
	* icons/eazel/Back.png:
	* icons/eazel/Forward.png:
	* icons/eazel/Home.png:
	* icons/eazel/Refresh.png:
	* icons/eazel/Search.png:
	* icons/eazel/SearchWeb.png:
	* icons/eazel/Services.png:
	* icons/eazel/Stop.png:
	* icons/eazel/Up.png:
	new toolbar icons from Susan.  She's not quite finished with them
	yet, but these are a lot closer to the final ones, and I wanted to
	get them checked in before my vacation.
		
2000-12-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed an issue in sorting. When you reload a directory
	into music view, the last sort mode is applied to the
	newly loaded list.
	
	* components/music/athena-music-view.c:
	(athena_music_view_initialize_class),
	(athena_music_view_initialize), (athena_music_view_destroy),
	(sort_list), (click_column_callback), (athena_music_view_update):

2000-12-18  Andy Hertzfeld  <andy@eazel.com>

	* components/image-viewer/athena-image-view.c:
	(zoomable_zoom_to_fit_callback), (image_bigger_than_viewer),
	(scrolled_window_size_allocate_callback), (control_factory_common),
	(scrollable_control_factory):
	implemented initial "zoom-to-fit" if an image is bigger than the
	displayable area, as requested by Mike Boich.
	
2000-12-18  John Sullivan  <sullivan@eazel.com>

	reviewed by: Rebecca Shulman <rebecka@eazel.com>

	Fixed Athena half of bug 2109 (Images (and any other
	files) with "execute" bit set will try to be executed
	instead of viewed when activated). This change requires
	a recent GNOME-VFS change to compile.

	* src/file-manager/fm-directory-view.c: (file_is_launchable):
	Test for launchability now includes asking GNOME_VFS whether
	this mime type is conceivably executable.
	
	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_get_short_list_methods_for_file): Changed
	"vfs-method" to "vfs_method" to match change in GNOME-VFS.

2000-12-18  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>
	(Robey also looked at the install part a bit)

	Fix bug 5212 (File leaks when you start and immediately quit
	Athena).
	
	* src/file-manager/fm-directory-view.c: (queue_pending_files):
	Remove incorrect athena_file_list_ref that created a
	AthenaFile leak.

	Fix bug 5180 (Defined messages won't end up in translations) by
	making sure we don't ever use "_()" inside a #define.

	* libathena-extensions/athena-file-operations.c:
	* libathena-extensions/athena-global-preferences.c:
	* libathena-extensions/athena-icon-canvas-item.c:
	* libathena-extensions/athena-icon-factory.c:
	* athena-installer/src/installer.c:
	* athena-installer/src/package-tree.c:
	* src/file-manager/fm-desktop-icon-view.c:
	* src/athena-location-bar.c:
	Changed all localizable strings in #defines to instead use global
	(const) variables. We still have the defines, though, since we
	can't call gettext in a global-initialization.
	
2000-12-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5136, Exit Music View with a 2nd open Music View window -> crash
	
	The bug was caused by a runaway timer callback.  The callback is now
	properly destroyed when the component is destroyed.
	
	* components/music/athena-music-view.c:
	(athena_music_view_destroy), (play_status_display),
	(play_current_file), (play_button_callback):

2000-12-18  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-core-utils.c:
	(trilobite_get_popt_context), (trilobite_init), (trilobite_main),
	(trilobite_main_quit):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h:

	Clean up trilobite_init to not use or require X anymore (yay!).
	Add a trilobite_main and trilobite_main_quit to mirror the GTK
	versions (but without polling for X events).  Add a way for
	services to retreive their popt context for command-line argument
	processing. 

	* components/services/install/command-line/eazel-alt-install-corba.c:
	(done), (main):
	* components/services/install/server/main.c:
	(trilobite_service_factory_destroy), (main):
	* components/services/time/service/main.c:
	(trilobite_service_factory_destroy), (main):
	* components/services/trilobite/sample/service/main.c:
	(trilobite_service_factory_destroy), (main):

	Make the command-line utilities use trilobite_main() and
	trilobite_main_quit() instead of the GTK variants.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(generate_xml_package_list), (osd_parse_dependency):

	Stop filling in the soft_depends field from XML.  (The old code
	that uses soft_depends doesn't expect it to be filled in and will
	get confused, and this field is going away shortly anyway.)
	
	* components/services/install/athena-view/main.c: (main):
	* components/services/time/athena-view/main.c: (main):

	Don't make the athena-views use trilobite_* functions (that
	would be bad), but clean them up to look similar to each other so
	it's easy to see how to copy them and make new trilobites.
	
2000-12-18  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: updated version of bonobo
	for no good reason, change pw2 because I never
	understood it and changed /rpm3/ to rpm*
	because on rpm4 systems it didn't generate the 
	right files.

2000-12-18  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(athena_background_draw_to_pixbuf):
	* libathena-extensions/athena-background.h:
	Add a new function to draw backgrounds into GdkPixbufs.  Its a
	simple wrapper around the draw_to_canvas() function.

	Also, small tweaking of the prototypes to match "the style."
	
	* libathena-extensions/athena-buffered-widget.c:
	(create_background_pixbuf_from_ancestor):
	Draw directly into the pixbuf by using
	athena_background_draw_to_pixbuf function instead of drawing to
	a Pixmap and capturing the bits.
	
2000-12-18  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 4037 (Error dialog every time on launch when
	permissions are set strangely)

	Fixed bug 1115 (Need better name for "User Directory" 
	and "User Data Directory")

	* libathena-extensions/athena-file-utilities.c:
	(athena_get_user_main_directory): Removed g_warning when
	Athena fails to create ~/Athena directory, improved
	FIXME comments.
	(athena_get_user_directory), (athena_get_desktop_directory):
	Added FIXME comments.
	
	* src/athena-application.c:
	(check_required_directories): Renamed from athena_application_
	check_user_directories; now returns FALSE if any required
	directories were not created. Reworded error dialog to mention
	directories by path rather than using confusing invented symbolic
	names, and to tell the user to address the problem by creating
	specified directories or setting permissions such that Athena
	can create specified directories. (It used to say "restart 
	Athena", which was pretty much guaranteed to have no effect.)
	(athena_application_startup): Now returns if 
	check_required_directories fails. The user has to address the
	problem described in the error message before Athena will
	launch.

2000-12-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed an unused variable error.
	
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link),
	(place_home_directory):

2000-12-18  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c: (athena_emblem_dialog_new),
	(emblem_dialog_clicked):
	fixed bug 4164, "Add New Emblem" file entry can be typed in, but is
	ignored.  Fixed by reworking logic to read the path from it, instead
	of relying on activate to set it up.
	
2000-12-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2494, Error ignored when making icon directory for link file
	
	We now check the GnomeVFSResult. If it does != GNOME_VFS_OK, NULL
	is returned. The callers of this function can properly handle a NULL
	result.
	
	* libathena-extensions/athena-link.c: (make_local_path):

2000-12-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2526, Error case ignored when creating desktop link file
	
	I remvoed the error check in the three cases th ebug referenced.
	If an error occurs there is not much we can do. We could tell
	the user something, but the notification would be vague.  If a
	link is not created, there is no destructive side effect.
	
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link),
	(volume_unmounted_callback), (place_home_directory):

2000-12-18  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c: (set_up_category_width):
	fixed bug 5230, shrinking the width of Backgrounds window
	causes floating point exception, by pinning the number of
	columns at 1.
	
	* icons/Makefile.am:
	* icons/default.xml:
	* icons/eazel/eazel.xml:
	* icons/vector/vector.xml:
	* icons/zoom_body.png:
	* icons/eazel/zoom_body.png:
	new zoom control image from Susan

2000-12-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2472, text_height and text_width shouldn't be
	left alone when renaming.
	
	Preserve the text_width and text_height when renaming.
	Don't reset the values, just block the draw when the
	renaming widget is visibile.
	
	* libathena-extensions/athena-icon-canvas-item.c:
	(draw_label_text_aa):

2000-12-17  Ali Abdin  <aliabdin@aucegypt.edu>
        
        Fix bug #4379 (problem with variablelist's)

        Partial fix for bug #5118 (acronym (and other tags) do not appear
        in table of contents) - Implemented for: ACRONYM, FUNCTION

        Both of these are based on patches thanks to jfleck@inkstain.net

        Also added experimental ScrollKeeper support to the sidebar (as
        contributed by Mark Murnane from Sun). This is experimental, and
        disabled by default.

        * components/help/converters/gnome-db2html2/gdb3html.h:
        * components/help/converters/gnome-db2html2/sect-elements.[ch]:
        * components/help/converters/gnome-db2html2/toc-elements.c:
        (sect_varlistentry_start_element),
        (sect_varlistentry_end_element):
        new functions for VARLISTENTRY support
        (sect_listitem_start_element),
        (sect_listitem_end_element):
        Only print <LI> for itemizedlist and orderlist (for the varlist we
        print it out during the varlistentry)
        
        Makre sure we print out </LI>'s too, and remove the <P> cruft.

        * components/help/converters/gnome-db2html2/toc-elements.c:
        (toc_tag_characters):
        New function. This will be used to print tags within the title. e.g.
        <title><acronym>ASCII</acronym></title> should print out ASCII.

        * components/help/hyperbola-filefmt.c:
        * components/help/hyperbola-nav-tree.c:
        Added a patch contributes by Mark Murnane <Mark.Murnane@ireland.sun.com>
        that integrates experimental ScrollKeeper support for Hyperbola (the
        Help Sidebar). This is disabled by default. You should #define
        ENABLE_SCROLLKEEPER_SUPPORT to be able to use it.

        * components/help/ScrollKeeper-TODO:
        New file contributed by Sun.

2000-12-17  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c:
	(athena_property_browser_initialize_class),
	(athena_property_browser_get_category_width),
	(set_up_category_width), (update_category_width),
	(athena_property_browser_update_contents),
	(athena_property_browser_set_path),
	(athena_property_browser_size_allocate):
	
	fixed bug 3310, contents of property browser should relayout
	to fit the window, by calculating the number of columns
	from the window width, and overriding size_allocate to
	relayout if necessary when the size changes. 

2000-12-17  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3890, Resort columns while MP3 plays,
	active song changes.
	
	* components/music/athena-music-view.c:
	(athena_music_view_initialize), (selection_callback),
	(compare_song_numbers), (compare_song_titles),
	(compare_song_artists), (compare_song_times), (compare_song_years),
	(compare_song_bitrates), (click_column_callback),
	(play_current_file), (athena_music_view_update):
	Change the way the list is sorted. Use column sorting functions
	that are set when the column button is clicked.  Don't reload list
	to resort. Make sure current selection index is updated
	when the list is resorted.

2000-12-15  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar.c:
	(athena_sidebar_active_panel_matches_id), (toggle_sidebar_panel),
	(athena_sidebar_add_panel_items),
	(athena_sidebar_remove_panel),
	(athena_sidebar_deactivate_panel):

	fixed bug 5198, removing the displayed sidebar panel messes up
	others, by closing the active panel before removing if it's the
	one to be removed.
	
	also fixed bug 1840 with this change, tab gets left behind when
	sidebar panel dies, by handling the case when we can't find the
	notebook page better.
	
2000-12-15  Gene Z. Ragan  <gzr@eazel.com>

	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link):
	Test and see how users respond to a more lenient mount policy.
	We now will mount a lot of things. Just curious.

2000-12-15  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 2400, LABEL=/ lines in /etc/fstab (used in Red Hat Beta 7)
	prevents trash from working

	Fixed bug 4586, Athena does not properly detect zip drives as removable
	media
	
	Rearchitected the way the volume monitor works. It now examines /proc/mounts
	to determine what file systems are mounted. This solves several problems such
	as the use of LABEL and auto in fstab. By using /proc/mounts we do not have to
	worry about permissions and disk access.
	
	* libathena-extensions/athena-volume-monitor.c:
	* libathena-extensions/athena-volume-monitor.h:
	(athena_volume_monitor_initialize),
	(athena_volume_monitor_destroy), (floppy_sort),
	(athena_volume_monitor_get_removable_volumes),
	(athena_volume_monitor_get_volume_name),
	(mount_volume_get_cdrom_name), (mount_volume_activate_cdrom),
	(mount_volume_activate_floppy), (mount_volume_activate_ext2),
	(mount_volume_activate_msdos), (mount_volume_activate_generic),
	(mount_volume_get_name), (mount_volume_activate), (eject_cdrom),
	(free_mount_list), (create_differed_list),
	(get_current_mount_list), (verify_current_mount_state),
	(mount_volumes_check_status), (mount_volume_floppy_add),
	(mount_volume_ext2_add), (mount_volume_udf_add),
	(mount_volume_vfat_add), (mount_volume_msdos_add),
	(cdrom_ioctl_get_info), (mount_volume_iso9660_add),
	(mount_volume_proc_add), (find_volumes),
	(athena_volume_monitor_each_volume),
	(athena_volume_monitor_each_mounted_volume),
	(athena_volume_monitor_volume_is_mounted),
	(athena_volume_monitor_mount_unmount_removable), (copy_volume),
	(athena_volume_monitor_free_volume), (get_msdos_volume_name),
	(get_floppy_volume_name), (mount_volume_add_filesystem):
	
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link),
	(volume_unmounted_callback), (update_disks_menu):

2000-12-15  John Sullivan  <sullivan@eazel.com>

	reviewed by: nobody, but Darin knew exactly what I was
	doing for these two small changes so that sorta counts.

	Fixed two problems found while investigating bug 4810
	(typing "gzip:" in location bar crashes), though I
	ended up fixing the bug entirely in gnome-vfs.

	* libathena-extensions/athena-directory-async.c:
	(get_info_callback): Don't call athena_directory_remove_file
	on self-owned files.
	
	* src/athena-window-manage-views.c: (handle_unreadable_location):
	Don't call a file "unreadable" if it doesn't exist. Let the rest
	of the error machinery handle it instead.

2000-12-15  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-canvas-item.c:
	(hit_test_pixbuf):
	liberalized the alpha threshold for hit-testing, so
	semi-transparent areas hit test positively if they have
	any opacity at all.
	
2000-12-15  Robin * Slomkowski  <rslomkow@eazel.com>

	* components/services/install/lib/Makefile.am: added
		eazel-package-system-rpm3-private.h to EXTRA_DISTS

2000-12-15  Michael Engber  <engber@eazel.com>

	* src/athena-zoom-control.c: (draw_number),
	(draw_pixbuf_with_prelight), (athena_zoom_control_draw),
	(athena_zoom_control_expose),
	(athena_zoom_control_unload_images),
	(athena_zoom_control_load_images):
	Fixed performance of zoom control drawing by elimitating
	continual calls to gdk_fontset_load - bug 3317. Also fixed
	a falure to unref the number strip image.

2000-12-15  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>
	
	Fixed bug 2464 ("open each item in a new window" sometimes 
	reuses an existing window)

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_register): Changed preferences text to
	say "separate window" rather than "new window"


	Fixed bug 2752 (double-clicking Help item causes "sidebar view
	failed" message)
	
	Fixed bug 5040 (only one dead view name gets saved for a window)

	This was a tangled mess of issues, including: (1) the dialog
	code was incorrectly guessing "sidebar panel" when a content
	view failed in some cases (fixed); (2) view frame lifetime
	issues found while working on (1) (fixed); (3) the state machine
	can fail if asked to load the same location twice very quickly
	(written up as bug 5197); (4) the Help sidebar panel asks to
	load the same location multiple times on a double-click (fixed);
	(5) Mozilla sometimes fails to load just after it has quit
	(written up as bug 5199).

	* components/help/hyperbola-nav-tree.c:
	(hyperbola_navigation_tree_new): Connect to destroy signal of 
	ctree widget.
	(set_pending_location): New helper function to remember the
	location for which this component just initiated a load.
	(hyperbola_navigation_tree_load_location): Set pending location
	to NULL now that there's a new real location.
	(hyperbola_navigation_tree_select_row): Don't try to start a
	new load of the pending location; set the pending location when
	we do start a new load.
	(hyperbola_navigation_tree_destroy): free pending location.
	
	* src/athena-view-frame.c:
	(athena_view_frame_initialize_class),
	(athena_view_frame_destroy), (athena_view_frame_finalize):
	Don't destroy details fields until finalize, so view_frame objects
	with extra refs can survive between destroy & finalize.
	
	* src/athena-window-manage-views.c: 
	(view_frame_info_new), (view_frame_info_free): New helper
	functions for dealing with the label & sidebar-panel-ness
	of a view frame.
	(set_view_frame_info): New helper function for storing
	the label & sidebar-panel-ness of a view frame in object
	data in the view frame.
	(view_frame_is_sidebar_panel), (view_frame_get_label):
	New helper functions for retrieving info stored in object
	data in the view frame.
	(report_content_view_failure_to_user_internal),
	(report_current_content_view_failure_to_user),
	(report_nascent_content_view_failure_to_user),
	(report_sidebar_panel_failure_to_user): Reworked the functions
	that put up the "view failed" dialog to take a AthenaViewFrame
	and to distinguish the existing-content-view from content-view-
	that's-being-created cases.
	(disconnect_view_and_destroy), (disconnect_destroy_unref_view): 
	New helper functions for cleanly forgetting about a view.
	(handle_view_failure): Use object data to distinguish content views
	from sidebar panels so we'll always get the right failure dialog.
	(update_state), (change_state): Get rid of dead_view_name mechanism;
	the name is now stored in the view frame in all cases.
	(load_content_view), (free_location_change), 
	(athena_window_begin_location_change),
	(athena_window_set_sidebar_panels): Jigger around the reffing &
	sinking of AthenaViewFrames to fix leaks and uncancelled-callback
	issues.
	
	* src/athena-window-private.h: remove obsolete dead_view_name
	field.
	* src/athena-window.c: (athena_window_destroy):
	Don't free now-non-existent dead_view_name field.

2000-12-15  Darin Adler  <darin@eazel.com>
	
	reviewed by: Gene Ragan <gzr@eazel.com>

	Fix bug 5176 (Theme descriptions not translated).

	Fix bug 5187 (Real name in file ownership doesn't take GECOS data
	into account).
	
	* src/athena-theme-selector.c: (make_theme_description): Get the
	theme description (which I also moved to the theme node from its
	own description node) by using
	athena_xml_get_property_translated which handles using the
	gettext database to translate the property if the XML file has it
	with a _ prefix.

	* icons/ardmore/ardmore.xml:
	* icons/arlo/arlo.xml:
	* icons/default.xml:
	* icons/gnome/gnome.xml:
	* icons/vector/vector.xml:
	Moved description to be a property of the theme node and use the
	name that indicates it needs to be localized.

	* po/POTFILES.in: Add all of the theme .xml files which now
	potentially have localizable theme descriptions in them.
	
	* libathena-extensions/athena-file.c: (get_real_name): Add
	code to compute the real name from the GECOS info, by stripping
	anything after the "," and substituting the login name,
	capitalized, for any occurences of "&".
	(get_user_and_real_name_from_id): Use get_real_name instead of
	going for the pw_gecos field directly.
	(athena_get_user_names): Use get_real_name instead of
	going for the pw_gecos field directly.
	
	* libathena-extensions/athena-string.h:
	* libathena-extensions/athena-string.c:
	(athena_str_strip_substring_and_after),
	(athena_str_replace_substring), (athena_self_check_string):
	Add two new string utility functions and self-checks for them.
	These were both needed for the GECOS change.
	
	* src/athena-property-browser.c: Tweak formatting.

2000-12-15  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* components/html/gnome-dialogs.c: (get_progress),
	(glibwww_prompt), (glibwww_prompt_password),
	(glibwww_prompt_username_and_password):
	* components/music/configure.c: (mpg123_configure):
	* components/music/fileinfo.c: (mpg123_file_info_box):
	* components/music/athena-music-view.c: (image_button_callback):
	* helper-utilities/error-dialog/athena-error-dialog.c:
	(show_message_box):
	* libathena-extensions/athena-file-operations-progress.c:
	(athena_file_operations_progress_new):
	* libathena-extensions/athena-global-preferences.c:
	(athena_global_preferences_set_dialog_title):
	* libathena-extensions/athena-program-chooser.c:
	(run_program_configurator_callback),
	(athena_program_chooser_new):
	* libathena-extensions/athena-stock-dialogs.c:
	(timed_wait_callback), (athena_simple_dialog),
	(show_message_box):
	* src/file-manager/fm-icon-text-window.c:
	(create_icon_text_window):
	* src/file-manager/fm-properties-window.c:
	(create_properties_window), (select_image_button_callback):
	* src/athena-about.c: (athena_about_initialize):
	* src/athena-bookmarks-window.c: (create_bookmarks_window):
	* src/athena-first-time-druid.c:
	(athena_first_time_druid_show):
	* src/athena-link-set-window.c:
	(athena_link_set_configure_window):
	* src/athena-property-browser.c:
	(athena_property_browser_initialize),
	(athena_emblem_dialog_new), (add_new_pattern):
	* src/athena-shell.c: (display_caveat):
	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize),
	(add_new_theme_button_callback):

	Added calls to gtk_window_set_wmclass with suitable instance
	names and `Athena' class name

2000-12-15  Andy Hertzfeld  <andy@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-icon-canvas-item.c:
	(athena_icon_canvas_item_initialize),
	(invalidate_text_dimensions), (athena_icon_canvas_item_set_arg),
	(measure_label_text):
	fixed performance bottleneck where we measure the label text too
	many times by making it use values cached in the item details.
	Added code to invalidate them at the appropriate times, and
	made measure_label_text short-circuit if they're valid.
	
2000-12-15  J Shane Culpepper  <pepper@eazel.com>

        reviewed by: Darin Adler <darin@eazel.com>

        * components/services/install/lib/Makefile.am:
        * components/services/install/lib/eazel-inventory-utils.c:
        (init_package_system), (get_package_list), (add_package_info),
        (str_has_prefix), (eazel_inventory_gconf_done), (check_gconf_init),
        (get_digest_from_gconf), (update_gconf_inventory_digest),
        (eazel_gather_inventory):
        * components/services/install/lib/eazel-inventory-utils.h:

        Removing hardcoded rpm calls and now using the eazel package
        system lib.  Added digest testing to know when the inventory
        xml has changed.

2000-12-15  Darin Adler  <darin@eazel.com>

	* components/services/install/lib/eazel-install-xml-package-list.h:
	* components/services/install/athena-view/athena-service-install.c:
	* athena-installer/src/Makefile.am:
	Got rid of lingering references to helixcode-utils.* that Robey
	apparently missed when he removed those files. This should fix
	clean builds and Tinderbox.

	* components/services/trilobite/libtrilobite/Makefile.am: Removed
	duplicate mention of file.
	
	* src/athena-view-frame.c: Formatting tweak.

2000-12-15  Maciej Stachowiak  <mjs@eazel.com>

	* components/rpmview/athena-rpm-view-install.c
	(athena_rpm_view_install_package_callback,
	athena_rpm_view_uninstall_package_callback): Remove check for
	Red Hat to match Robey's earlier changes and fix the build.

2000-12-15  Robey Pointer  <robey@eazel.com>

	* athena-installer/src/Makefile:
	* athena-installer/src/callbacks.c: (ask_to_delete_rpms),
	(ask_are_you_sure):
	* athena-installer/src/gtk-hackery.c: (log_debug), (gtk_box_nth),
	(gnome_reply_callback):
	* athena-installer/src/installer.c:
	(get_detailed_errors_foreach):
	* athena-installer/src/installer.h:
	* athena-installer/src/main.c:

	Factor more stuff out into GTK hackery.  Fix headers to sync up
	with the better libtrilobite layout and to follow the moving
	target that is libeazelinstall.
	
	* athena-installer/src/package-tree.c:
	(package_customizer_finalize), (package_customizer_unref),
	(package_customizer_class_initialize),
	(package_customizer_initialize), (package_customizer_new),
	(package_customizer_get_type), (package_info_compare),
	(package_customizer_find_package), (popup_package_dialog),
	(package_customizer_recompute_bongs), (package_toggled),
	(package_customizer_fill), (normalize_labels),
	(package_customizer_set_package_list),
	(package_customizer_get_widget), (jump_to_package_tree_page):
	* athena-installer/src/package-tree.h:

	Make the package tree into a proper GTK object.

2000-12-15  Robey Pointer  <robey@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (main):

	Remove check for redhat.
	
	* components/services/install/lib/eazel-install-corba-callback.c:
	* components/services/install/lib/eazel-install-metadata.c:
	* components/services/install/lib/eazel-install-object.c:
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (parse_category), (osd_parse_provides),
	(osd_parse_implementation), (osd_parse_softpkg),
	(eazel_install_packagelist_parse):
	* components/services/install/lib/eazel-softcat.c:
	* components/services/install/server/main.c: (main):
	* components/services/summary/lib/eazel-summary-shared.c:
	(parse_a_service), (parse_a_eazel_news_item),
	(parse_a_update_news_item):
	* components/services/time/service/trilobite-eazel-time-service.c:
	(trilobite_eazel_time_service_initialize_load_config):
	* components/services/trilobite/libtrilobite/Makefile.am:
	* components/services/trilobite/libtrilobite/helixcode-utils.c:
	* components/services/trilobite/libtrilobite/helixcode-utils.h:
	* components/services/trilobite/libtrilobite/libtrilobite.h:
	* components/services/trilobite/libtrilobite/makefile.staticlib.in:
	* components/services/trilobite/libtrilobite/trilobite-core-messagi
	ng.c: (trilobite_add_log), (trilobite_close_log),
	(trilobite_debug), (trilobite_set_debug_mode),
	(trilobite_set_log_handler):
	* components/services/trilobite/libtrilobite/trilobite-core-messagi
	ng.h:
	* components/services/trilobite/libtrilobite/trilobite-core-network
	.c: (trilobite_xml_get_string), (trilobite_open_uri),
	(trilobite_fetch_uri), (trilobite_fetch_uri_to_file):
	* components/services/trilobite/libtrilobite/trilobite-core-network
	.h:
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_init), (trilobite_setenv):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h
	:
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	* components/services/trilobite/libtrilobite/trilobite-service-priv
	ate.h:
	* components/services/trilobite/sample/command-line/main.c: (main):
	* components/services/trilobite/sample/service/main.c: (main):

	Clean up libtrilobite: move network and XML related funcs into
	-network.c and logging stuff into -messaging.c, where they were
	intended to be all along I guess.  Fix header include lines from
	other files to match the new locations.  Ditch the archaic
	helixcode stuff.
	
	* components/services/install/lib/makefile.staticlib.in:

	Fix staticlibs to add new trilobite files and to follow the MD5
	funcs to their new home.
	
2000-12-15  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-canvas-item.c:
	(draw_or_measure_label_text), (draw_or_measure_label_text_aa):
	fixed problem with selection causing relayout, by always allocating
	the space for highlighting.  Also, tightened up the size of the
	highlighted area.
	
2000-12-14  Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-icon-canvas-item.c:
	(draw_or_measure_label_text), (draw_or_measure_label_text_aa):
	Some #defines to help me profile draw_measure_label_text.
	Off in the build.

2000-12-14  Maciej Stachowiak  <mjs@eazel.com>

	sort of reviewed by: Mathieu Lacage  <mathieu@eazel.com>

	* src/athena-window-manage-views.c
	(viewed_file_changed_callback): If the file we are viewing got
	renamed, update the window's concept of it's location, the up
	button sensitivity, the navigation bar location and the
	title. This fixes bug 807 (File name in sidebar doesn't update
	when file is renamed).

	* libathena-extensions/athena-directory-async.c
	(get_info_callback): Make sure not to free an already NULL file
	info. This pathological case was being tirggered sometime when
	doing a Refresh on a viewed location that got renamed.

2000-12-14  Arlo Rose  <arlo@eazel.com>

	* icons/eazel/eazel.xml:
	* icons/eazel/sidebar_tab_pieces/*:
	Changed the sidebar to reflect the solid blue Susan and Andy wanted.

2000-12-14  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar-title.c: (update_icon):
	made the sidebar get the right icon for the hardware
	view by special-casing it like we do for services and man.
	As part of this, I made the sidebar work properly with
	.svg icons by calling the icon factory to load the icon.
	
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_pixbuf_from_name):
	added a convenience routine to fetch icons by name.
	* libathena-extensions/athena-icon-factory.h:
	definition for the convenience routine.
	
2000-12-14  Robey Pointer  <robey@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_provides), (osd_parse_dependency),
	(osd_parse_file_list), (osd_parse_implementation):

	Parse package dependency info from softcat and put them in the new
	'depends' list in the package.  (This will replace the old
	soft_depends and hard_depends fields.)  Incorporate new fields
	supplied by the internal triggerfish.
	
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedependency_new), (packagedependency_copy),
	(packagedependency_destroy), (packagedata_new),
	(packagedata_deplist_copy), (packagedata_copy),
	(packagedata_fill_in_missing), (packagedata_destroy),
	(packagedata_status_str_to_enum), (dump_package_list),
	(dump_package_deplist), (packagedata_dump_int):
	* components/services/install/lib/eazel-package-system-types.h:

	Add new 'depends' field and PackageDependency struct.

	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_initialize), (sense_flags_to_softcat_flags),
	(eazel_softcat_convert_sense_flags),
	(eazel_softcat_sense_flags_to_string):
	* components/services/install/lib/eazel-softcat.h:

	Add functions to convert to/from softcat sense flags, and a
	convenience function for converting them into a human-friendly
	string like ">=".

2000-12-14  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-corba-callback.c:
	(eazel_install_callback_create_corba_object),
	(eazel_install_callback_initialize):
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba.c:
	(eazel_install_create_corba_object):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize), (eazel_install_unref),
	(eazel_install_set_arg), (eazel_install_initialize):
	* components/services/install/lib/eazel-install-problem.c:
	* components/services/install/lib/eazel-install-problem.h:
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_create_dbs),
	(eazel_package_system_rpm3_open_dbs),
	(eazel_package_system_rpm3_initialize):
	* components/services/install/lib/eazel-package-system-rpm3.h:
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_initialize):
	* components/services/install/lib/eazel-package-system-rpm4.h:
	* components/services/install/lib/eazel-package-system-skeleton.c:
	(eazel_package_system_skeleton_load_package),
	(eazel_package_system_skeleton_query),
	(eazel_package_system_skeleton_install),
	(eazel_package_system_skeleton_uninstall),
	(eazel_package_system_skeleton_verify),
	(eazel_package_system_skeleton_initialize):
	* components/services/install/lib/eazel-package-system-skeleton.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_initialize):
	* components/services/install/lib/eazel-package-system.h:

	Change all IS_EAZEL* macros to EAZEL_IS*, to match convention.

2000-12-14  Darin Adler  <darin@eazel.com>

	* components/image-viewer/athena-image-view.c:
	(bonobo_object_factory): Remove unnecessary return_if_fail
	that was referring to a field now renamed in Bonobo.

2000-12-14  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 2807 (support metadata removal for cases where we
	move/delete files) by implementing metadata removal.

	Fix bug 2199 (Saved icon positions ruin desktop layout features)
	by testing and fixing other bugs now that metadata removal is
	implemented.

	Fix bug 5164 (exception trying to drag file) by fixing a few
	placeholders in XML files that were still transparent and should
	not be.

	Fix bug where we don't reveal the New Folder icon (reintroduced by
	my changes yesterday) by computing the icon position in a way that
	works even before the canvas item is updated.

	* libathena-extensions/athena-directory-metafile.c:
	(get_file_node): Small change (not used for now) that might
	help unify the "before metafile is read" case with the code
	after the metafile is read.
	(athena_directory_rename_file_metadata): Remove the old
	file metadata before renaming the new data. Also change code
	to avoid looking up things in the hash table twice.
	(athena_directory_copy_file_metadata): Updated and added
	FIXME comments.
	(athena_directory_remove_file_metadata): Add code to
	remove metadata, similar to the existing rename code.
	
	* libathena-extensions/athena-directory.c:
	(athena_directory_schedule_metadata_copy),
	(athena_directory_schedule_metadata_move),
	(athena_directory_schedule_metadata_remove): Fix code that was
	using file names instead of relative URIs (essentially escaped
	file names). This code was missed when we made the
	switchover. Without this, changes to files with spaces in their
	names didn't update metadata properly.
	
	* libathena-extensions/athena-file-operations.c:
	(build_error_string): Added blank line between the intro sentence
	and the rest of the error message.
	(handle_xfer_overwrite): Added blank line between the intro
	sentence and the rest of the error message.
	(sync_xfer_callback): Fix metadata code to remove the metadata
	when creating a new file, just as it copies metadata when copying
	a file. This change helps the New Folder case, but requires a fix
	in gnome-vfs to set the top level boolean for the New Folder case.
	(handle_new_folder_vfs_error): Added blank line between the intro
	sentence and the rest of the error message.
	(athena_self_check_file_operations): Changed the self-check to
	use the standard way of testing functions that return text instead
	of rolling its own.
	
	* libathena-extensions/athena-gnome-extensions.h:
	* libathena-extensions/athena-gnome-extensions.c:
	(athena_gnome_canvas_item_get_canvas_bounds): Added a function
	that's like athena_gnome_canvas_item_get_current_canvas_bounds
	but is accurate even before the icon is updated.
	
	* libathena-extensions/athena-icon-container.c: (reveal_icon):
	Use athena_gnome_canvas_item_get_canvas_bounds instead of
	athena_gnome_canvas_item_get_current_canvas_bounds. Fixes the
	bug I reintroduced where New Folder icons would not be revealed.
	
	* libathena-extensions/athena-xml-extensions.h:
	* libathena-extensions/athena-xml-extensions.c:
	(athena_xml_remove_node): Add a remove-node function. This is
	needed because gnome-xml doesn't have xmlRemoveNode
	implemented. This implementation is not quite complete, but
	probably good enough for our purposes. A complete implementation
	might have to have some handling for removing the root node and
	perhaps some stuff to remove unused namespaces. Maybe this can be
	rolled into gnome-xml.
	
	* src/file-manager/athena-directory-view-ui.xml:
	* src/athena-shell-ui.xml:
	Added some more delimit="none" entries to make it so that the
	actual placeholder definitions are not "transparent".
	
	* libathena-extensions/athena-glib-extensions.c
	(athena_self_check_glib_extensions): Marked some strings that
	are part of a test translatable since the result might be
	different in some locales. Translating the strings to the right
	result makes "make check" work properly in that locale.

2000-12-14  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-first-time-druid.c:
	(make_hbox_user_level_radio_button), (set_up_user_level_page),
	(set_up_update_page):
	fixed bug 2912, better wording in the first time wizard, by revising
	the text.  Also, improvement the vertical alignment on the
	user level selection page.
	
2000-12-14  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/rpmview/athena-rpm-verify-window.c:
	(athena_rpm_verify_window_set_progress):
	* components/rpmview/athena-rpm-view-private.h:
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize), (verify_failed_signal),
	(athena_rpm_view_verify_files):
	Fixed 5169 and 5170 (install and verify didn't work).

2000-12-14  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar.c: (athena_sidebar_initialize_class),
	(athena_sidebar_press_event), (athena_sidebar_release_event):
	at Arlo's request, made the sidebar tabs activate on button release
	instead of button press.
	
2000-12-14  Martin Norbäck  <d95mback@dtek.chalmers.se>

	reviewed by: Darin Adler <darin@eazel.com>

	* po/POTFILES.in, src/athena-complex-search-bar.c:
	Marked strings for translation and adding file to POTFILES.in

2000-12-14  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_download_packages),
	Set toplevel to TRUE even if not downloading, fixes 5196.
	(eazel_install_do_transaction_all_files_check):
	Only do interpackage file check in packages.size() > 1
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize), (eazel_install_set_debug):
	Set debug in packagesystem to FAIL, not VERBOSE. _set_debug raises
	it to verbose.

2000-12-14  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Major boost in tree view performance, and startup/new window
	performance when tree view is on. This fixes bugs 4922 (Opening
	new windows is really slow when the tree view is enabled), 5149
	(http://bugzilla.eazel.com/show_bug.cgi?id=5149) and 3936
	(http://bugzilla.eazel.com/show_bug.cgi?id=3936).
	
	* components/tree/athena-tree-change-queue.c,
	components/tree/athena-tree-change-queue.h: New files that
	implement a change queue, so the tree view can defer processing
	changes until idle time but still handle them in order.
	* components/tree/Makefile.am: Add to build.

	* components/tree/athena-tree-view.c:
	(athena_tree_view_initialize): Initialize change queue.
	(athena_tree_view_enqueue_change),
	(athena_tree_view_model_node_added_callback,
	athena_tree_view_model_node_changed_callback,
	athena_tree_view_model_node_removed_callback,
	athena_tree_view_model_done_loading_callback): Do no real work,
	just enqueue the changes and schedule the idle callback.
	(reload_model_node, reload_model_node_recursive): Don't actually
	update all nodes, just enqueue changes and schedule idle
	callbacks.
	(schedule_pending_idle_callback): Helper function to schedule an
	idle callback to process the change queue.
	(dequeue_pending_idle_callback): Process the head of the change
	queue, and unschedule self when done (currently it will process at
	most 100 changes at one go). Keep the tree frozen while doing the
	changes, to minimize redraws.
	(athena_tree_view_insert_model_node): Moved call to
	notify_node_seen here from
	athena_tree_view_model_node_added_callback.
	(athena_tree_view_destroy): free change queue, dnd data.

	* components/tree/athena-tree-view-dnd.c: Prune includes.
	(athena_tree_view_free_dnd): New function so
	athena-tree-view.c destroy function does not need to know
	internal details of tree view.
	* components/tree/athena-tree-node.h: Removed prototypes of
	nonexistent functions.
	* components/tree/athena-tree-view.h,
	components/tree/athena-tree-view-private.h,
	components/tree/athena-tree-view-dnd.h: Include necessary
	headers, to make these standalone, and prune unneeded headers.

2000-12-14  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_update_icon):
	fixed bug 4219, using an image to represent itself bad when image is
	too small, by scaling up the image to a minimum size if necessary.
	
2000-12-13  Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(build_error_string):
	Translated error messages to English (with John's help).

2000-12-13  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	This should fix 4891 and 4892 & 4454.
	
	* components/services/install/command-line/eazel-test-packsys.c:
	(test_query), (progress_signal), (main):
	Also does a test on QUERY_FLAG_REQUIRES, by checking if more then
	10 packages require glibc.
	Fixed the wrong order of arguments for progress_signal.
	main can now take a --debug=<int> which sets the debug level in
	the EazelPackageSystem.
	
	* components/services/install/lib/eazel-package-system-rpm3.h:
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_get_and_set_string_tag),
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(eazel_package_system_rpm3_get_db),
	(eazel_package_system_rpm3_query_impl),
	(eazel_package_system_rpm3_query_substr),
	(eazel_package_system_rpm3_query_foreach),
	(eazel_package_system_rpm3_query_requires),
	(eazel_package_system_rpm3_query),
	(eazel_package_system_rpm3_class_initialize),
	(eazel_package_system_rpm3_initialize),
	(eazel_package_system_rpm3_new):
	Mindnumbing amounts of boilerplate code to make query_foreach and
	query_impl virtual functions which the rpm4 class can override. I
	weep for gnome and it's C usage of OO and long for the good ole
	days of C++.
	Also made the loops more unreadable but safer (I hope).
	
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_query_impl),
	(eazel_package_system_rpm4_query_substr),
	(eazel_package_system_rpm4_query_foreach),
	(eazel_package_system_rpm4_class_initialize),
	(eazel_package_system_rpm4_initialize):	
	The final juju to implement the EazelPackageSystemRpm4 class. I
	will not bore you with more details.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_query):
	assert that the key is non-null.

2000-12-13  Maciej Stachowiak  <mjs@eazel.com>

	* components/loser/content/.cvsignore,
	components/loser/sidebar/.cvsignore,
	components/mozilla/.cvsignore, components/sample/.cvsignore,
	libathena/.cvsignore, src/.cvsignore,
	src/file-manager/.cvsignore: Add -ui.xml.h generated files to
	.cvsignore.

2000-12-13  Maciej Stachowiak  <mjs@eazel.com>

	* components/services/docs/directories: New file documenting the
	directory layout of components/services.
	
	* components/services/inventory/.cvsignore,
	components/services/inventory/Makefile.am,
	components/services/inventory/command-line/README,
	components/services/inventory/lib/.cvsignore,
	components/services/inventory/lib/Makefile.am,
	components/services/inventory/lib/eazel-inventory-shared.c,
	components/services/inventory/lib/eazel-inventory-shared.h,
	components/services/inventory/athena-view/.cvsignore,
	components/services/inventory/athena-view/Makefile.am,
	components/services/inventory/athena-view/main.c,
	components/services/inventory/athena-view/athena-inventory-view.c,
	components/services/inventory/athena-view/athena-inventory-view.h,
	components/services/inventory/athena-view/athena-inventory-view.oafinfo:
	Remove old dead inventory code.

	* components/services/login/command-line/README: Remove last file
	in otherwise-empty directory.
	* components/services/summary/command-line/README: Ditto.
	* cut-n-paste-code/widgets/gtkclist/.cvsignore: Ditto.

2000-12-13  Andy Hertzfeld  <andy@eazel.com>

	* icons/Makefile.am:
	* icons/i-music-12.png:
	* icons/i-music-12-aa.png:
	* icons/i-music-24.png:
	* icons/i-music-24-aa.png:
	* icons/i-music-36.png:
	* icons/i-music-36-aa.png:
	fixed bug 3502, music icon doesn't scale well, by adding
	pre-scaled icons from Susan.
	
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_name_for_regular_file):
	removed evil special-case of text files; now it uses
	whatever is defined in the mime-type database.
	
2000-12-13  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* src/file-manager/fm-properties-window.c:
	(select_image_button_callback):
	* src/athena-property-browser.c: (add_new_pattern):
	* src/athena-theme-selector.c: (add_new_theme_button_callback):

	Added calls to gtk_window_set_transient_for for file selectors

2000-12-13  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-md5-tools.c:

	Fixing improper include.

2000-12-13  J Shane Culpepper  <pepper@eazel.com>

	* components/services/install/lib/Makefile.am:
	* components/services/install/lib/eazel-install-logic.c:
	* components/services/install/lib/eazel-install-md5.c:
	* components/services/install/lib/eazel-install-md5.h:
	* components/services/install/lib/eazel-install-rpm-glue.c:
	* components/services/install/lib/eazel-inventory-utils.c:
	(add_package_info), (read_proc_info), (add_info), (add_io_info),
	(add_hardware_info), (eazel_create_configuration_metafile),
	(str_has_prefix):
	* components/services/install/lib/eazel-inventory-utils.h:
	* components/services/trilobite/libtrilobite/Makefile.am:
	* components/services/trilobite/libtrilobite/trilobite-inventory-ut
	ils.c:
	* components/services/trilobite/libtrilobite/trilobite-inventory-ut
	ils.h:
	* components/services/trilobite/libtrilobite/trilobite-md5-tools.c:
	(_byte_reverse), (md5_init), (md5_update), (md5_final),
	(md5_transform), (md5_get_digest), (md5_get_digest_from_file),
	(md5_get_digest_from_md5_string), (md5_get_string_from_md5_digest),
	(main):
	* components/services/trilobite/libtrilobite/trilobite-md5-tools.h:

	More inventory gymnastics.  Moving the md5 utils to libtrilobite where
	they belong and moving the rpm specific inventory code into libeps.
	Still not hooked up to the build until I remove the hardcoded rpm
	stuff.
	

2000-12-13  Darin Adler  <darin@eazel.com>

	reviewed by: Rebecca Shulman <rebecka@eazel.com>

	Fixed bug 2155 (type-selected icon is not successfully scrolled
	into view). The code was using the wrong coordinate system.
	
	* libathena-extensions/athena-icon-container.c: (reveal_icon):
	Do the icon revealing with the
	athena_gnome_canvas_item_get_current_canvas_bounds instead of
	icon_get_bounding_box. The old code used item coordinates instead
	of canvas coordinates.
	(match_best_name): Added (guchar) casts to make tolower work
	right, since it takes int parameters, not char.
	(select_matching_name): Added (guchar) casts to make tolower work
	right, since it takes int parameters, not char.
	(undo_stretching): Broke out this function -- work was in-line in
	key_press_event before.
	(handle_typeahead): Renamed, added (guchar) casts to make isprint
	work right, since it takes int parameters, not char.
	(key_press_event): Use undo_stretching helper function.
	(athena_icon_container_set_label_font_for_zoom_level): Remove
	redundant NULL check.
	(athena_icon_container_set_smooth_label_font): Ref new
	font before unref'ing the old one in case they are the same.
	(athena_icon_container_set_single_click_mode) Remove redundant
	NULL check.
	(athena_icon_container_get_is_fixed_size): Remove redundant
	NULL check.
	(athena_icon_container_set_is_fixed_size): Remove redundant
	NULL check.
	(check_compute_stretch), (athena_self_check_icon_container):
	Renamed.

	* libathena-extensions/athena-string.c:
	(athena_istr_has_prefix), (athena_istr_has_suffix),
	(athena_str_capitalize): Added (guchar) casts to make tolower
	and toupper work right, since it they take int parameters, not
	char. Removed unnecessary checks of isupper before calling tolower
	and islower before calling toupper. We did the research a while
	back and discovered that broken platforms like that where toupper
	can munge non-lower-case-letter characters don't really exist in
	practice any more.

	* libathena-extensions/athena-file.c: (update_link),
	(update_info_internal): Added FIXMEs to remind me to come back
	here when I go fix bug 2044.
	
	* libathena-extensions/athena-gnome-extensions.c:
	(athena_gnome_canvas_draw_pixbuf_helper),
	(athena_gnome_canvas_draw_pixbuf_helper_alpha): Tweak
	formatting.

2000-12-13  Martin Norbäck  <d95mback@dtek.chalmers.se>

	reviewed by: Darin Adler <darin@eazel.com>

	* components/music/athena-music-view.c:
	(athena_music_view_initialize):
	
	Added localisation of the clist titles.
	
2000-12-13  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com> (the patch;
	Eli reviewed the wording change since he spotted the
	problem)
	
	Fixed bug 3378 ("inadequate permissions" message when the
	permissions were in fact adequate)

	* libathena-extensions/athena-file.c:
	(athena_file_denies_access_permission):
	Check for supplemental group permissions also. Thanks to
	Martin Norback <d95mback@dtek.chalmers.se> for submitting
	this patch.

	* src/athena-shell-ui.xml: Reworded the tip for the
	"Backgrounds and Emblems" menu item to not mention the
	phrase "Property Browser"

2000-12-13  Robey Pointer  <robey@eazel.com>

	* athena.spec.in:

	Fix some of the RPM descriptions and summaries so they're not
	quite so wrong or vague.

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize):

	Don't try to open a user-specific rpmdb in slim mode.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_load_implementation):
	* components/services/install/lib/eazel-package-system.h:

	Allow direct linking with a package system in slim mode (so that
	the bootstrap installer can be built linked statically against the
	rpm3 package system).
	
	* components/services/install/lib/makefile.staticlib.in:

	Include different parts of the package system in the slim
	version.  Eventually we're going to have to make this a little
	more flexible to allow for building an rpm3 vs. rpm4 slim library.
	
	* athena-installer/src/Makefile.am:
	* athena-installer/src/gtk-hackery.c:
	* athena-installer/src/package-tree.c:
	* athena-installer/src/installer.h:
	* athena-installer/src/installer.c: (create_install_page),
	(add_bullet_point_to_vbox), (jump_to_error_page),
	(insert_info_page), (create_finish_page_good), (create_window),
	(eazel_install_preflight), (eazel_installer_add_category),
	(more_check_system), (draw_splash_text), (find_old_tmpdir),
	(eazel_installer_initialize):
	* athena-installer/src/link.sh:
	
	Move all GTK hackery into its own file (there are getting to be a
	lot of these, sadly).  Fix the installer to use the new package
	system for now, though it will need to continue to change.  Add a
	new page for customizing the package tree, and temporarily make it
	mandatory.

2000-12-13  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	* src/athena-profiler.c (dump_dialog_new): Replace call to the
	obsolete `athena_gtk_extensions_set_up_close_accelerator' with a
	call to `athena_gtk_window_set_up_close_accelerator', so the
	profile build works.

2000-12-13  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar-title.c:
	(athena_sidebar_title_background_is_default),
	(athena_sidebar_title_select_text_color):
	gave Arlo the ability to control the sidebar text color for his new
	sidebar by specifying the colors in the theme file.
	* icons/eazel/eazel.xml:
	specified the sidebar title text colors for the eazel theme
	
	* src/athena-theme-selector.c: (make_theme_description):
	fixed memory leak.
	
2000-12-13  Josh Barrow  <josh@eazel.com>

	* icons/eazel/eazel.xml:
	Make it actually use them again.  A bit ago, Arlo (without a 
	ChangeLog entry) checked in his new tabs, and accedently 
	checked in the old eazel.xml file.

2000-12-13  Josh Barrow  <josh@eazel.com>

	reviewed by: <mjs@eazel.com>

	* athena.spec.in:

	Update for Eazel theme sidebar pieces

2000-12-12  Pavel Cisler <pavel@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>
 
	* libathena-extensions/athena-gdk-extensions.c:
	(athena_gdk_window_bring_to_front):
	Fix 5153: Make the call also handle showing iconified
	windows.
	
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_window_present):
	Remove a FIXME.

2000-12-13  Josh Barrow  <josh@eazel.com>

	* icons/eazel/sidebar_tab_pieces/.cvsignore:
	 
	Make it be nick when you update.

2000-12-13  Josh Barrow  <josh@eazel.com>

	* configure.in:
	* icons/eazel/Makefile.am:
	* icons/eazel/sidebar_tab_pieces/Makefile.am:

	Make everything work nicely.  

2000-12-12  Arlo Rose  <arlo@eazel.com>

	* icons/eazel/eazel.xml:
	* icons/eazel/sidebar_tab_pieces/Makefile.am:
	* icons/eazel/sidebar_tab_pieces/middle-normal-normal.png:
	* icons/eazel/sidebar_tab_pieces/middle-normal-prelight.png:
	* icons/eazel/sidebar_tab_pieces/fill-active-prelight.png:
	* icons/eazel/sidebar_tab_pieces/middle-prelight-normal.png:
	* icons/eazel/sidebar_tab_pieces/fill-active.png:
	* icons/eazel/sidebar_tab_pieces/right-bumper-prelight.png:
	* icons/eazel/sidebar_tab_pieces/fill-empty-space.png:
	* icons/eazel/sidebar_tab_pieces/right-bumper.png:
	* icons/eazel/sidebar_tab_pieces/fill-prelight.png:
	* icons/eazel/sidebar_tab_pieces/right-empty-space.png:
	* icons/eazel/sidebar_tab_pieces/fill.png:
	* icons/eazel/sidebar_tab_pieces/right-top-active-prelight.png:
	* icons/eazel/sidebar_tab_pieces/left-bumper-active-prelight.png:
	* icons/eazel/sidebar_tab_pieces/right-top-active.png:
	* icons/eazel/sidebar_tab_pieces/left-bumper-active.png:
	* icons/eazel/sidebar_tab_pieces/right-top-prelight.png:
	* icons/eazel/sidebar_tab_pieces/left-bumper-prelight.png:
	* icons/eazel/sidebar_tab_pieces/right-top.png:
	* icons/eazel/sidebar_tab_pieces/left-bumper.png:
	Added pieces for the Eazel sidebar tabs.

2000-12-12  Eskil Olsen  <eskil@eazel.com>

	reviewed by: My imaginary friend Oskar.

	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_create_dbs),
	(rpm_packagedata_fill_from_file),
	(eazel_package_system_rpm3_query_impl),
	(eazel_package_system_rpm3_query_substr),
	(eazel_package_system_rpm3_query),
	(eazel_package_system_rpm3_initialize),
	(eazel_package_system_rpm3_new):

	GtkObject is soo lame, whoever likes this, should surely be struck
	down with OO book.
	
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_query_impl),
	(eazel_package_system_rpm4_query_foreach),
	(eazel_package_system_rpm4_new):
	Implemented more rpm4 query stuff.

2000-12-12  Gene Z. Ragan  <gzr@eazel.com>

	Fixed silly bug involving the new Sound Busy dialog.
	It now uses the proper routines to check the status of the
	sound hardware.
	
	* components/music/mpg123.c: (mpg123_stop), (mpg123_seek):
	* components/music/athena-music-view.c: (play_current_file),
	(go_to_next_track), (go_to_previous_track):

2000-12-12 Arlo Rose <arlo@eazel.com>

	* icons/eazel/eazel.xml:
	* icons/eazel/side_bar_image.png:
	* icons/eazel/MakeFile.am:
	Added new sidebar background to Eazel theme.
	Tab will show up later.

	* icons/text-selection-frame.png:
	Fixed corner radius in the selection.
	The incorrect radius was due to a change in the way 
	the image was being rendered.

2000-12-12  Pavel Cisler <pavel@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed 4954 Athena crashes attempting to empty a .Trash
	containing undeletable files
	
	* libathena-extensions/athena-file-operations.c:
	(build_error_string), (handle_xfer_vfs_error)
	Reworked the error message building logic. Split up
	the routine into a part that decides what the interesting
	input for building the error message is and a part that
	actually builds the error message. Fixed a number
	of cases where a wrong error message would be used. The
	actual bug in the bug report was one of the cases -- an assert
	catching a case that was not handled properly.
	
	Fixed:
	part of -- 638 When a new volume gets mounted, integrate its Trash
	directory.
	part of -- 4143 Files dragged to trash icon on desktop seem to
	vanish,
	part of -- 4963 Files dragged to Trash from floppy don't appear
	in Trash,

	* libathena-extensions/athena-trash-monitor.c:
	* libathena-extensions/athena-trash-monitor.h:
	(add_one_volume_trash),
	(athena_trash_monitor_get_trash_directories):
	Added a new call that returns a list of all the Trash directories
	on all the mouted volumes.  

	* libathena-extensions/athena-trash-directory.c: (add_volume):	
	Got rid of get_volume_vfs_uri_if_writable.
	Used the new athena_volume_monitor_should_integrate_trash instead
	to pick the volumes that can support trash.
	
	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_should_integrate_trash),
	(athena_volume_monitor_get_volume_mount_uri):
	* libathena-extensions/athena-volume-monitor.h:
	Add new helper calls used by the routine that collects all the
	trash uris from all mouted volumes.	
	
	* libathena-extensions/athena-file-operations.c:
	(do_empty_trash):
	Pass in a list of Trash directories instead of just the
	single trash in the user's home directory. 

	Fixed:
	2443 Trash is only found on EXT2 volumes
	2444 Trash on read-only volumes is not displayed
	remaining part of -- 4143 Files dragged to trash icon on desktop
	seem to vanish,
	remaining part of -- 4963 Files dragged to Trash from floppy
	don't appear in Trash,

	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_should_integrate_trash):
	Removed the old logic from get_volume_vfs_uri_if_writable
	that only displayed trash from writable ext2 volumes.
	Enumerated all the file system types that we know can
	support trash.
	
2000-12-12  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpm_packagedata_fill_from_rpm_header),
	(rpm_packagedata_fill_from_file), (rpm_packagedata_new_from_file),
	(eazel_package_system_rpm3_load_package),
	(eazel_package_system_rpm3_query_impl),
	(eazel_package_system_rpm3_query_substr),
	(eazel_package_system_rpm3_query_requires),
	(eazel_package_system_rpm3_query):
	* components/services/install/lib/eazel-package-system-skeleton.c:
	(eazel_package_system_skeleton_query):
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_new):
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_load_package), (eazel_package_system_query):
	* components/services/install/lib/eazel-package-system.h:
	unsigned long to int replacement on various types.

2000-12-12  Arik Devens  <arik@gnome.org>

	reviewed by: Darin Adler  <darin@eazel.com>
	
	Fixed bug 5047 ("Using spaces in the location bar label for
	alignment is fragile and not necessarily internationalizable") by
	adding code to usize and align the label widget to be both the
	right size and proper alignment no matter what language we are in.
	
	* src/athena-location-bar.c: Added #defines for Location: and Go
	To: so they only need to be translated once.
	(style_set_handler): New function to set the label's usize to the
	larger of the two strings plus padding so that it doesn't resize.
	(athena_location_bar_initialize): Added gtk_misc_set_alignment
	to the label widget (probably don't need it but it can't hurt) and
	also hooked up the style_set_handler to the label widget.
	(athena_location_bar_update_label): Removed comments about
	fixing bug 5047.

2000-12-12  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 1948 ("Open in New Window" menu item reuses existing
	window if it exists) by separating the explicit "open in new
	window" feature (always gives a new window) from the "open all
	items in new windows" preference (reuses window if one with the
	right location already exists).

	* libathena/athena-view-component.idl: Added new
	open_location_prefer_existing_window call. Renamed open_location
	to open_location_in_this_window and open_location_in_new_window to
	open_location_force_new_window for clarity.
	
	* libathena/athena-view.h:
	* libathena/athena-view.c:
	(athena_view_open_location_in_this_window),
	(athena_view_open_location_prefer_existing_window),
	(athena_view_open_location_force_new_window):
	* src/athena-view-frame-corba.c:
	(impl_Athena_ViewFrame_open_location_in_this_window),
	(impl_Athena_ViewFrame_open_location_prefer_existing_window),
	(impl_Athena_ViewFrame_open_location_force_new_window):
	* src/athena-view-frame-private.h:
	* src/athena-view-frame.c:
	(athena_view_frame_initialize_class),
	(athena_view_frame_open_location_in_this_window),
	(athena_view_frame_open_location_prefer_existing_window),
	(athena_view_frame_open_location_force_new_window):
	* src/athena-view-frame.h:
	Add new call, rename old ones.
	
	* src/file-manager/fm-directory-view.c: (open_callback): Pass parameter
	to tell the open code to respect the "use new windows" preference.
	(open_location): Take new WindowChoice parameter to respect preference
	as appropriate.
	(switch_location_and_view): Tell the code to respect the preference in
	this case (opening from Open With).
	(show_trash_callback): Use code that respects the preference instead of
	always opening in this case.
	(open_one_in_new_window): Always force a new window (used by Open
	in New Window command).
	(activate_callback): Pass through new WindowChoice instead of boolean.
	(fm_directory_view_activate_file): Pass through new WindowChoice
	instead of boolean.,
	(fm_directory_view_activate_files): Respect the user preference if
	opening only one file, do the "use existing window or make new one"
	mode if opening more than one.
	
	* src/athena-window-manage-views.c: (handle_unreadable_location):
	Move check for empty location string in here.
	(open_location): Moved the code for reusing existing windows out
	of here. Also changed code structure to avoid redoing the
	handle_unreadable_location check.
	(open_location_in_this_window_callback): Renamed.
	(open_location_prefer_existing_window_callback): Here's where
	the code for reusing existing windows went. New callback for the
	new call/signal.
	(open_location_force_new_window_callback): Renamed.
	
	* src/file-manager/fm-search-list-view.c:
	(reveal_selected_items_callback): Change to use
	athena_view_open_location_force_new_window by its new name.
	
	* src/athena-window-manage-views.h: Got rid of
	athena_window_open_location_in_new_window, which was public and
	unused.

	* components/adapter/athena-adapter.c:
	(athena_adapter_open_location_callback):
	* components/help/hyperbola-nav-index.c:
	(hyperbola_navigation_index_select_row):
	* components/help/hyperbola-nav-search.c:
	(hyperbola_navigation_search_select_row):
	* components/help/hyperbola-nav-tree.c:
	(hyperbola_navigation_tree_select_row):
	* components/history/athena-history-view.c:
	(history_button_release):
	* components/mozilla/athena-mozilla-content-view.c:
	(mozilla_open_uri_callback), (mozilla_dom_mouse_click_callback):
	* components/rpmview/athena-rpm-view.c: (go_to_button_callback):
	* components/services/login/athena-view/athena-change-password-view.c:
	(run_away_timer), (authn_failed), (maintenance_button_cb):
	* components/services/summary/athena-view/athena-summary-callbacks.c:
	(logged_in_callback), (logged_out_callback),
	(preferences_button_cb), (forgot_password_button_cb),
	(register_button_cb):
	* components/services/summary/athena-view/athena-summary-dialogs.c:
	(error_dialog_cancel_cb):
	* components/services/summary/athena-view/athena-summary-footer.c:
	(footer_item_clicked_callback):
	* components/services/summary/athena-view/athena-summary-view.c:
	(goto_service_cb), (goto_update_cb):
	* components/text/athena-text-view.c: (handle_service_menu_item):
	* components/tree/athena-tree-view.c: (tree_select_row_callback):
	Change to use new athena_view_open_location_in_this_window
	name. It's better because it's more explicit, but also, it's the
	new name!
	
	* libathena-extensions/athena-gdk-extensions.c:
	(athena_gdk_window_bring_to_front): Fixed indentation.
	
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_window_present): Put in a new implementation that
	uses athena_gdk_window_bring_to_front instead of the old one
	that did a hide followed by a show. Corrected an assert that
	should have been a return_if_fail.
	
2000-12-12  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 2327 (Alt-key combinations to show menus work on
	Desktop, but shouldn't)

	Had to abandon the old-Bonobo approach for this and make a
	new-Bonobo approach.

	* src/file-manager/athena-desktop-icon-view-ui.xml:
	Redefine all top-level menus' labels to be "" so there won't
	be any underline accelerator
	
	* src/athena-desktop-window.c: (athena_desktop_window_new):
	* src/athena-window-menus.c: 
	(remove_underline_accelerator_from_menu_title),
	(athena_window_disable_keyboard_navigation_for_menus):
	* src/athena-window.h: Remove the old now-useless trick to
	do this.

2000-12-12  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4145, Music view fails if sound device in use
	Fixed bug, 4903, slider state bleeds between music views
	
	Changed the way that the view stects availability of sound
	hardware.  We now use a more just in time approach. If the
	sound hardware is unavailable, a dialog is displayed with
	a warning and some info about the problem. The downside
	to this is that the controls always appear active.  I think
	this is a good tradeoff. It avoids having the controls inactive
	when the sound hardware is available, as in the case of bug
	4145.
	
	* components/music/athena-music-view.c:
	(athena_music_view_initialize), (get_song_text),
	(play_current_file), (add_play_controls):

2000-12-12  Michael Engber  <engber@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/athena-window-menus.c:
	(athena_window_bookmarks_preference_changed_callback),
	(athena_window_initialize_bookmarks_menu):
	* src/athena-window-private.h:
	* src/athena-window.c: (athena_window_destroy):
	Added a preference remove callback - which fixes bug 5147.

2000-12-12  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed a couple of places that were causing zillions of failed 
	assertions about hash tables on boot.
	
	* libathena-extensions/athena-directory-metafile.c:
	(create_metafile_root): Use athena_directory_set_metafile_contents
	instead of setting field directly.
	(get_file_node): Don't futz with hashtable if its NULL.

2000-12-12  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	While investigating bug 5147, which I couldn't reproduce, I found
	and fixed a crashing bug with similar steps.

	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_destroy): remove preferences callback for
	home_uri_changed, so we won't crash trying to execute it after the
	desktop view has been destroyed.

	Fixed bug 4226 (Non-standard text field auto-selection behavior
	wreaks havoc with finely tuned middle-click paste feature)

	The problem here was that I had done some automatic selection 
	changing on focus-in and focus-out a long time ago in an attempt
	to make the behavior more usable for real copy/paste and tabbing.
	Unfortunately my attempt to improve the default behavior ran afoul
	of the hellish X middle-click-to-paste-selected-text feature that
	is a staple of every poor X window user's life. For now, I just took
	out my non-standard behaviors as they aren't clearly an overall
	improvement and I hadn't even tried to deploy them across Athena,
	much less across GTK.
	
	* src/file-manager/fm-properties-window.c: 
	(name_field_focus_in): Removed this function, which used to select
	all the text in the field.
	(name_field_focus_out): No longer deselects contents.
	(create_basic_page): Don't connect to focus-in signal.
	
	* src/athena-bookmarks-window.c:
	(on_text_field_focus_in_event): Removed this function, which used to
	select all the text in the field.
	(on_text_field_focus_out_event): No longer deselects contents.
	(create_bookmarks_window): Don't connect to focus-in signal.

2000-12-12  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-factory.c: (cache_icon_new),
	(load_icon_for_scaling), (scale_icon), (get_icon_from_cache),
	(athena_icon_factory_get_pixbuf_for_icon),
	(athena_icon_factory_get_pixbuf_for_file):

	fixed bug 4212, emblem doesn't show up when the image is a JPEG
	file, by adding ".jpg" to extensions checked in the icon factory.
	
	Fixed bug 3208, generic icon shows up for deleted emblems, by adding
	a "wants_default" parameter to the icon factory get_pixbuf_for_icon
	call.  If "wants_default" is false, it returns NULL instead of the
	generic icon.  Emblem callers pass FALSE so they don't get pixmaps
	for deleted emblems.
	
	* libathena-extensions/athena-bookmark.c:
	(athena_bookmark_get_pixbuf):
	added boolean parameter to get_pixbuf_for_icon call
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_update_icon):
	added boolean parameter to get_pixbuf_for_icon call
	* libathena-extensions/athena-icon-factory.h:
	added "wants_default" boolean to get_pixbuf_for_icon definition
	* src/file-manager/fm-list-view.c:
	(fm_list_view_get_emblem_pixbufs_for_file):
	added boolean parameter to get_pixbuf_for_icon call
	* src/file-manager/fm-properties-window.c:
	(create_image_widget_for_emblem):
	added boolean parameter to get_pixbuf_for_icon call
	* src/athena-sidebar-title.c: (update_emblems):
	added boolean parameter to get_pixbuf_for_icon call
	
2000-12-12  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 650 (moving a large number of files is extremely slow)
	by using a hash table to find metafile nodes given a file name.
	Fixed bug 3410 (sorting not locale-sensitive) by making
	athena_strcoll suitable for wider use and using it a lot more.

	* libathena-extensions/athena-directory-private.h: Add a
	new hash table for locating metafile nodes by file name.
	
	* libathena-extensions/athena-directory-metafile.h: Add
	athena_directory_set_metafile_contents call so the metafile
	code will have a crack at the metafile contents right when
	they are first read in.
	
	* libathena-extensions/athena-directory-metafile.c:
	(get_file_node): Locate the file node using the hash table,
	and create a hash table entry when making a new file node.
	(destroy_xml_string_key), (athena_directory_metafile_destroy):
	Destroy the hash table when the directory is destroyed.
	(athena_directory_rename_file_metadata): Remove the old hash
	table entry and make a new one when the node's name is changed.
	(athena_directory_set_metafile_contents): Create the hash
	table and populate it when the metafile is read in.
	
	* libathena-extensions/athena-string.h:
	* libathena-extensions/athena-string.c: (athena_strcoll):
	Treat a locale that can't be fetched by setlocale the same as
	locale "C" and "POSIX", fall back on strcmp if strcoll says two
	strings are equal, so that only identical strings get a 0.
	(athena_strcmp_compare_func): New name for athena_str_compare.
	(athena_strcoll_compare_func): New function.
	(athena_strcasecmp_compare_func): New name for athena_istr_compare.
	
	* libathena-extensions/athena-glib-extensions.h:
	* libathena-extensions/athena-glib-extensions.c:
	(athena_g_str_list_copy): Removed an unnecessary check for NULL.
	(athena_g_str_list_alphabetize): Replaced the old sort calls
	with this single call. It sorts in a locale-sensitive way, using
	athena_strcoll.
	
	* libathena-extensions/athena-file.c: (compare_by_name),
	(compare_by_directory_name), (compare_by_emblems),
	(compare_by_type), (athena_file_compare_name): Use
	athena_strcoll instead of athena_strcmp_case_breaks_ties so we
	use local sorting conventions in locales other than "C" and
	"POSIX".
	(athena_get_user_names), (athena_get_group_names_including):
	(sort_keyword_list_and_remove_duplicates): Use the new
	athena_g_str_list_alphabetize to sort by locale-specific
	conventions.
	
	* libathena-extensions/athena-icon-container.c:
	(compare_icons_by_name): Use athena_strcoll instead of
	athena_strcmp_case_breaks_ties so we use local sorting
	conventions in locales other than "C" and "POSIX".
	
	* src/file-manager/fm-properties-window.c: (get_property_names):
	Use the new athena_g_str_list_alphabetize
	* src/athena-window-manage-views.c: (change_selection): Use the
	new athena_g_str_list_alphabetize
	* src/athena-window.c: (load_view_as_menu_callback): Use the new
	athena_g_str_list_alphabetize

	* libathena-extensions/athena-directory-async.c:
	(metafile_read_done_callback),
	(athena_directory_set_up_request): Use athena_str_compare
	under its new name, athena_strcmp_compare_func.
	
	* components/services/install/command-line/.cvsignore: Added
	eazel-test-types, a new generated file.
	
	* libathena-extensions/athena-string-list.c:
	(athena_string_list_new): Use athena_str_compare and
	athena_istr_compare under their new names,
	athena_strcmp_compare_func and athena_strcasecmp_compare_func.

	* libathena-extensions/athena-xml-extensions.c:
	(athena_xml_get_child_by_name): Fixed indenting.
	
2000-12-12  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4901, Music view displays "()" when MP3 lacks
	Year tag
	
	* components/music/athena-music-view.c: (get_song_text),
	(read_id_tag):
	Don't display Year parentheses if year tad is absent or empty
	
	* components/music/mpg123.c: (mpg123_id3v1_to_id3v2):
	* components/music/mpg123.h:
	More cleanup to support ID3v2 tags. This fixes breakage
	in displaying ID3v1 track numbers.

2000-12-12  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Improve New Window performance when the tree view is enabled, to
	partially address bug 4922 (Opening new windows is really slow
	when the tree view is enabled). This affects only the New Window
	case, not the initial window. Here's some timings before and after
	on my laptop with a bunch of stuff expanded (times in seconds):

	                          First window    New window
	Tree View Off                  8              5
	w/ Tree Before My Change      16              37
	w/ Tree After My Change       16	      20

	I made this change by altering tree view semantics slightly. The
	tree view used to do a force reload any time it expanded a
	directory. Now it does a normal load the first time any given
	directory is expanded (as at startup, or when you first expand the
	node), but a force reload on subsequent collapse and
	expansion. This is more in line with the way the rest of Athena
	works.
	
	* components/tree/athena-tree-expansion-state.h,
	components/tree/athena-tree-expansion-state.c:
	(athena_tree_expansion_state_was_ever_expanded): New function to
	see if a node was ever expanded. Being initially expanded does not
	count; only being expanded through an API call to
	`athena_tree_expansion_state_expand_node' does.
	(athena_tree_expansion_state_load_foreach_callback,
	athena_tree_expansion_state_initialize,
	athena_tree_expansion_state_destroy,
	athena_tree_expansion_state_expand_node_internal,
	athena_tree_expansion_state_expand_node): Adjusted to track
	"was_ever_expanded" property right.

	* components/tree/athena-tree-model.h,
	components/tree/athena-tree-model.c
	(athena_tree_model_monitor_node): Add force_reload parameter.
	(athena_tree_model_node_begin_monitoring_no_connect): New helper
	function.
	(athena_tree_model_node_begin_monitoring,
	athena_tree_model_node_end_monitoring): Slightly adjusted helper
	functions.

	* components/tree/athena-tree-view.c:
	(filtering_changed_callback): Do a reload of the whole tree, but
	not a force reload.
	(expand_uri_sequence_and_select_end): Simplify logic a bit.
	(expand_node_for_file): Force reload only if this node has been
	expanded before.
	(reload_model_node, reload_model_node_recursive,
	reload_whole_tree): Make force reload an option.

2000-12-12  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fix an infinite loop problem that my last change caused:
	
	* libathena-extensions/athena-directory-async.c:
	(activation_uri_read_done): Remove setting of
	activation_uri_is_up_to_date to TRUE
	(activation_uri_done): and move it here, because this function
	gets called directly for files that are not athena or gmc links,
	as well as being called from activation_uri_done.

	* components/services/install/command-line/.cvsignore: Add
	eazel-softcat

2000-12-11  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/Makefile.am:
	Stupid stupid stupid mistake in the conditionals.

2000-12-11  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-directory-view.c: (activate_callback):
	fixed bug 2390, uri-activating security hole, by following
	Frank's recommendation, which is to not allow any parameters
	to the launch command, which is enforced by using execlp
	instead of system.
	
2000-12-11  Eskil Heyn Olsen  <eskil@eazel.com>

	Not reviewed, I have no buddies...
	
	* components/services/install/lib/Makefile.am:
	* configure.in:
	automake conditionals are a complete joke.

2000-12-11  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_query):
	Fixed the types, now back to automakes lack of conditionals...

2000-12-11  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/Makefile.am:
	automake conditionals are figments of your imagination.
	
	* configure.in:
	More rpmcheck voodoo, might even make this compile on rh62 agains.

2000-12-11  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fix bug 4919 (Tree view crashes when you expand and collapse the
	root node). I did this by changing the design of file attribute
	forgetting, which I implemented recently - now when you forget an
	attribute, it is merely marked out of date, not thrown away; the
	old value is still available until the fresh value is actually
	loaded. This fixes other potential UI problems with the old
	approach but I am not sure if bugs were filed for those.

	* libathena-extensions/athena-file-private.h: Added new
	is_up_to_date booleans, converted all booleans and the
	RequestStatus enum to bitfields. This saved 200-300k or so for me
	on runs of Athena with the tree view on and expanded a lot.

	* libathena-extensions/athena-file.h,
	libathena-extensions/athena-file.c:
	(athena_file_invalidate_attributes_internal,
	athena_file_invalidate_attributes,
	athena_file_invalidate_all_attributes): Renamed to match new
	semantics.
	(update_info_internal): Mark file info up to date.
	(invalidate_directory_count), (invalidate_deep_counts),
	(invalidate_mime_list), (invalidate_top_left_text),
	(invalidate_file_info), (invalidate_activation_uri): renamed from
	forget_*, and changed to only mark the attributes invalid, not
	actually throw them out.

	* libathena-extensions/athena-directory-async.c:
	(lacks_directory_count, lacks_top_left, lacks_info,
	lacks_mime_list, lacks_activation_uri): Check _is_up_to_date bit
	for relevant attribute, not got_ or _failed bits. If the info is
	out of date, we want to retry eve if we already got it or it
	already failed.
	(directory_count_callback, mime_list_callback,
	top_left_read_callback, get_info_callback,
	activation_uri_read_done): Mark corresponding attributes up to
	date.
	(dequeue_pending_idle_callback): Mark directory_count and
	mime_list up to date if appropriate.
	(file_info_start): Mark file info up to date on invalid URI error.
	(athena_directory_invalidate_counts): Mark directory count and
	mime list out of date, but do not forget them.

	(athena_directory_invalidate_file_attributes): Renamed.
	(athena_directory_force_reload): Deal with rename.
	(cancel_loading_attributes,
	athena_directory_cancel_loading_file_attributes): Replace forget
	with invalidate in some comments.

	* libathena-extensions/athena-link.c
	(forget_file_activation_uri): Handle function renames.
	* src/athena-window-manage-views.c
	(athena_window_begin_location_change): Likewise

2000-12-11  Eskil Olsen  <eskil@eazel.com>
	
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(make_rpm_argument_list), (eazel_package_system_rpm3_create_dbs),
	(rpm_open_db), (eazel_package_system_rpm3_open_dbs),
	(eazel_package_system_rpm3_close_dbs),
	(eazel_package_system_rpm3_free_dbs),
	(eazel_package_system_rpm3_query_impl),
	(eazel_package_system_rpm3_query_substr),
	(eazel_package_system_rpm3_query_requires),
	(eazel_package_system_rpm3_query),
	(eazel_package_system_rpm3_finalize),
	(eazel_package_system_rpm3_initialize),
	(eazel_package_system_rpm3_new):
	Created a private part for EazelPackageSystemRpm3

	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_do_rpm_dependency_check):
	Fondle the private parts of EazelPackageSystemRpm3 (eew, 
	can't wait to get rid of this code).
	
	* components/services/install/lib/eazel-package-system-rpm4.h:
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_query_foreach),
	(eazel_package_system_rpm4_finalize),
	(eazel_package_system_rpm4_initialize),
	(eazel_package_system_rpm4_new),
	(eazel_package_system_implementation):
	Began hacking on the missing RPM4 pieces.

2000-12-11  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4900, Athena doesn't support ID3 v2.x tags
	
	* components/music/mpg123.c:
	* components/music/mpg123.h:
	* components/music/athena-music-view.c: (read_id_tag):
	Add support for both v1 and v2 ID3 tags.

2000-12-11  Eskil Heyn Olsen  <eskil@eazel.com>

	* README:
	Blabla about rpm 4 on redhat 7.0
	
	* configure.in:	
	* athena.spec.in:
	configure now carves the rpm version found into the spec file as a
	requirement.

2000-12-11  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/main.c: (main):
	* src/athena-window-service-ui.c: (goto_online_storage),
	(goto_software_catalog):

	bugzilla.eazel.com 5035

	removed ammonite_shutdown call, ammonite_init is now resiliant
	to multiple calls and registers an atexit function.	

2000-12-11  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 3818, Sorting of album is case insensitive

	* libathena-extensions/athena-string.c:
	* libathena-extensions/athena-string.h:
	(athena_strcmp_case_breaks_ties), (athena_strcoll):
	New function that wraps strcoll. It checks the locale and if it is
	specific, uses strcoll. If the locale is generic "C" or "POSIX",
	sorting is done using athena_strcmp_case_breaks_ties.
	

	Fixed bug 5126, Press "Pause" and "Play", music view returns
	to start of track.

	* components/music/athena-music-view.c: (selection_callback),
	(value_changed_callback), (sort_by_title), (sort_by_artist),
	(sort_by_year), (play_button_callback), (pause_button_callback),
	(get_player_state):
	Some state machine logic cleanup to fix bug 5216.

2000-12-11  John Sullivan  <sullivan@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 4820 (default Athena window too narrow; web
	pages look bad)

	* src/athena-window-private.h: Changed
	ATHENA_WINDOW_DEFAULT_WIDTH from 700 to 800. Read the
	bug report for some of the rationale discussion.

2000-12-11  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(athena_background_set_image_placement_no_emit),
	(athena_background_set_image_placement),
	(athena_background_receive_dropped_background_image):
	* libathena-extensions/athena-directory-background.c:
	(athena_file_background_get_default_settings),
	(athena_file_background_write_desktop_settings):
	Fixed dragging a new background image onto the dekstop
	so that it; writes out the new color (white) instead of
	leaving the old, wrong, color setting; sets the image
	placement to tiled, since all Athena images are
	currently meant to be tiled. Bugs 3477 & 3022.

2000-12-11  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: A donkey with a rather large shrubbery

	* components/rpmview/Makefile.am:
	* components/rpmview/athena-rpm-verify-window.c:
	(athena_rpm_verify_window_update_message):
	* components/services/install/command-line/Makefile.am:
	* components/services/install/command-line/eazel-test-packsys.c:
	(main):
	* components/services/install/lib/Makefile.am:
	* components/services/install/lib/eazel-install-rpm-glue.c:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpm_create_db), (eazel_package_system_rpm3_query):
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_finalize),
	(eazel_package_system_rpm4_new):
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_list_prune):
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_load_implementation):
	* components/services/install/athena-view/Makefile.am:
	* components/services/install/server/Makefile.am:
	Muy untested RedHat 7.0/RPM4 related stuff. Let's watcht the build
	blow up.
	
	* acconfig.h:
	HAVE_RPM_x0 for different rpm.s
	
	* configure.in:
	More weird rpm checks
	
	* athena.spec.in
	No more libeazelsoftcat

2000-12-11  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 5112 (Segfault on startup using non C locale). The error
	was caused by localized text making it through bonobo to
	gnome-xml, which only happened because we were using an incorrect
	attribute name.

	* libathena-extensions/athena-bonobo-extensions.c:
	* libathena-extensions/athena-bonobo-extensions.h:
	Removed athena_bonobo_set_description because there is no
	attribute named "description" any more. It's now "tip".
	
	* src/file-manager/fm-directory-view.c: (real_update_menus):
	Use set_tip instead of set_description.

	Another cut at the placeholder changes. I caught one problem and
	John caught some others when he reviewed my last check-in.
	
	* src/file-manager/athena-directory-view-ui.xml:
	* src/file-manager/athena-icon-view-ui.xml:
	* src/athena-service-ui.xml:
	Removed some "delimit" and added others. Only the file that
	actually defines a placeholder should use a delimit, and you must
	always use a delimit when defining the placeholder.

2000-12-11  J Shane Culpepper  <pepper@eazel.com>

	reviewed by: <eskil@eazel.com>

	* components/services/install/lib/Makefile.am:

	Minor Makefile fix for Eskil.

2000-12-11  Darin Adler  <darin@eazel.com>

	* src/file-manager/athena-directory-view-ui.xml:
	* src/file-manager/athena-icon-view-ui.xml:
	* src/athena-service-ui.xml:
	* src/athena-shell-ui.xml:
	Changed all placeholders that are not supposed to be "transparent"
	to use an explict 'delimit="none"' to make it clear to the bonobo
	merging code that they are not transparent. This subtle rule about
	the 2 different kinds of placeholder resulted in a number of bugs
	that were then "fixed" by a Bonobo change that was then rolled out.

2000-12-11  John Sullivan  <sullivan@eazel.com>

	* icons/arlo/arlo.xml: I broke the Arlo theme with my earlier
	checkin by changing references to ./backgrounds to ./patterns;
	this changes them back. ./backgrounds is a directory inside the
	Arlo theme folder, whose name has not been changed.

2000-12-11  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3767, Click through MP3s, multiple MP3s often selected
	Fixed bug 2263, Scroll in music view, text redrawn on top
	of self
	
	Both of these bugs are caused by a bug in GtkCList.  There
	is a case where the gcs are set to invalid. I work around
	this by queueing redraws when a new item is selected and
	when the adjustment is changed during scrolling.
	
	* components/music/athena-music-view.c:
	(athena_music_view_initialize), (selection_callback),
	(value_changed_callback):

2000-12-11  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Terminology change -- the window & menu item formerly known
	as "Customization" are now known as "Backgrounds and Emblems";
	the swatches of image formerly known as "backgrounds" are
	now known as "patterns".

	After 1.0 if this window acquires more varied content we will
	have to redo the menu item & window label, though we will
	continue to distinguish between "backgrounds" and "patterns", 
	since "backgrounds" encompasses colors as well as images.

	Note that this change will only appear in full (and your
	"Backgrounds and Emblems" window work in full) after you've
	deleted your ~/.athena directory and let Athena make you
	a new one.

	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(file_opened_callback): Set vfs_handle to NULL on failure.
	(load_done): Don't try to close pixbuf loader if it's NULL.
	These two bugs were flushed out by a temporary state on my
	machine where the theme was using a non-existent file for
	its background image.

	* data/backgrounds/Makefile.am: removed this file, as well as
	all the image files in this directory.

	* data/patterns/.cvsignore:
	* data/patterns/Makefile.am: New files, copied from data/backgrounds.
	Also copied over all image files from data/backgrounds, which is now
	obsolete.
	
	* data/Makefile.am: Changed "backgrounds" subdir to "patterns"

	* configure.in: changed data/backgrounds/Makefile to
	data/patterns/Makefile
	
	* athena.spec.in: Changed regular expressions with "backgrounds"
	to use "patterns"

	* data/browser.xml: Changed "background" to "pattern" in the
	terminology in this file, which gets installed into ~/.athena.
	You have to remove your ~/.athena to get a fresh one of these;
	without doing so the "Backgrounds and Emblems" window will be
	confused (won't crash, will use wrong terminology and sometimes
	have blank content).

	* icons/ardmore/ardmore.xml:
	* icons/arlo/arlo.xml:
	* icons/default.xml:
	* icons/eazel/eazel.xml:
	* icons/gnome/gnome.xml:
	* icons/vector/vector.xml:
	* icons/villanova/villanova.xml: Changed "backgrounds" directory
	references to "patterns"
	
	* libathena-extensions/athena-customization-data.h:
	* libathena-extensions/athena-customization-data.c:
	(athena_customization_data_new),
	(athena_customization_data_get_next_element_for_display),
	(athena_customization_data_destroy),
	(athena_customization_make_pattern_chit): Change "background" to
	"pattern" in many places, including one public function name.

	* src/athena-property-browser.c:
	(athena_property_browser_initialize),
	(athena_property_browser_drag_data_get), (make_drag_image),
	(make_color_drag_image), (remove_pattern), (remove_emblem),
	(athena_property_browser_remove_element),
	(add_pattern_to_browser), (add_new_pattern),
	(add_new_button_callback), (element_clicked_callback),
	(make_properties_from_directories), (add_reset_property),
	(athena_property_browser_update_contents),
	(athena_property_browser_set_category): Change "background" to
	"pattern" in many places. Also change window title from
	"Customization Options" to "Backgrounds and Emblems".
	
	* src/athena-shell-ui.xml: Change "Customization..." to 
	"Backgrounds and Emblems...".
	
	* test/test-athena-background.c: (main):
	* test/test-athena-font.c: (create_named_background):
	* test/test-athena-label.c:
	(widget_set_athena_background_image): Changed test code that was
	using sample images from backgrounds directory to look in patterns
	directory instead.

2000-12-11  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2242, fstat /etc/mtab to check if needs
	to reread (for speed)
	
	I now use a read of /proc/mounts. This is not only faster, but
	it avoids a read to disk thus saving power for portable users.
	
	* libathena-extensions/athena-volume-monitor.c: (find_volumes):

2000-12-11  Ramiro Estrugo  <ramiro@eazel.com>

	* README:
	Move us to use gconf from a stable branch (gconf-1-0).
	
2000-12-10  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/rpmview/Makefile.am:
	* components/rpmview/athena-rpm-verify-window.c:
	(athena_rpm_verify_window_initialize),
	(athena_rpm_verify_window_set_message),
	(athena_rpm_verify_window_update_message),
	(athena_rpm_verify_window_set_progress),
	(athena_rpm_verify_window_set_error_mode):
	* components/rpmview/athena-rpm-verify-window.h:
	* components/rpmview/athena-rpm-view-install.c:
	(athena_rpm_view_install_package_callback),
	(athena_rpm_view_uninstall_package_callback):
	* components/rpmview/athena-rpm-view-private.h:
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize), (athena_rpm_view_destroy),
	(add_to_clist), (athena_rpm_view_update_from_uri),
	(verify_failed_signal), (verify_progress_signal),
	(athena_rpm_view_verify_files),
	(athena_rpm_view_verify_package_callback):
	Fixed bug 5119, update rpmview to use EazelPackageSystem. I 
	still need to hook up the continue signal from the verifywindow,
	this is opened as bug 5123.
	
	* components/services/install/command-line/Makefile.am:
	* components/services/install/command-line/eazel-alt-install-corba.
	c:
	include eazel-package-system-types instead of
	eazel-install-types.h
	
	* components/services/install/command-line/eazel-test-packsys.c:
	(progress_signal), (failed_signal), (test_verify), (main):
	Implemented the test for verfiy.
	
	* components/services/install/lib/Makefile.am:
	Mangled to fix 5121.
	
	* components/services/install/lib/eazel-softcat.h:
	* components/services/install/lib/eazel-install-tests.h:
	* components/services/install/lib/eazel-install-xml-package-list.h:
	* components/services/install/lib/eazel-install-protocols.h:
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-query.h:
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/eazel-install-metadata.h:
	* components/services/install/lib/eazel-install-object.c:
	* components/services/install/lib/eazel-install-problem.h:
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba-types.h:
	include eazel-package-system-types instead of
	eazel-install-types.h

	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_download_packages),
	(eazel_install_check_for_file_conflicts),
	(eazel_install_start_signal), (eazel_install_end_signal),
	(eazel_install_progress_signal),
	(eazel_install_check_existing_packages),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse),
	(eazel_uninstall_check_for_install):
	Fixed signals and use FILL_NO_DIRS_IN_PROVIDES

	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_fetch_remote_file), (eazel_install_fetch_package):
	Use FILL_NO_DIRS_IN_PROVIDES
	
	* components/services/install/lib/eazel-install-rpm-glue.h:
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_do_rpm_dependency_check):
	include eazel-package-system-types instead of
	eazel-install-types.h
	Also open/close the db when doing the rpmdepCheck call.
	
	* components/services/install/lib/eazel-install-types.c:
	* components/services/install/lib/eazel-install-types.h:
	Removed
	
	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_load_implementation),
	(eazel_package_system_verify),
	(eazel_package_system_emit_progress):
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(monitor_rpm_process_pipe), (eazel_package_system_rpm3_create_dbs),
	(eazel_package_system_rpm3_open_dbs),
	(eazel_package_system_rpm3_close_dbs),
	(eazel_package_system_rpm3_free_dbs),
	(rpm_packagedata_fill_from_rpm_header),
	(rpm_packagedata_fill_from_file), (rpm_packagedata_new_from_file),
	(eazel_package_system_rpm3_load_package),
	(eazel_package_system_rpm3_query_impl),
	(eazel_package_system_rpm3_query_substr),
	(eazel_package_system_rpm3_query), (check_if_all_packages_seen),
	(eazel_package_system_rpm3_install_uninstall),
	(eazel_package_system_rpm3_verify_impl),
	(get_num_of_files_in_packages), (eazel_package_system_rpm3_verify),
	(eazel_package_system_rpm3_finalize),
	(eazel_package_system_rpm3_new),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_query),
	(eazel_package_system_rpm4_finalize),
	(eazel_package_system_rpm4_class_initialize),
	(eazel_package_system_rpm4_initialize),
	(eazel_package_system_rpm4_get_type),
	(eazel_package_system_rpm4_new),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-rpm4.h:
	* components/services/install/lib/eazel-package-system-skeleton.c:
	(eazel_package_system_skeleton_verify):
	Shuffled the order of the info longs and the package in the
	progress signal. 
	Implemented verify in rpm3 (fixes bug 5120)
	First pieces of code for the rpm4 module.
	Unfortunately, since rpmview now also has a eazelpackagesystem
	object, I ran into the problem of database locking. The rpmview
	would have a read-only version of all the db files, thereby
	failing in install because trilobite-eazel-install-service spawned
	a rpm that could not get exclusive lock. To fix this, I now have
	the db closed at all times, but open/close it everytime I do
	something. Unfortunately for the queryloops in
	eazel-install-logic, this means opening/closing on every
	query. Optionally, I should consider exposing
	eazel_package_system_open/close_dbs, so the caller can do it. But
	that makes the api a bit more cumbersome.
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(eazel_install_protocol_as_string), (categorydata_new),
	(categorydata_list_copy), (categorydata_copy),
	(categorydata_destroy_foreach), (categorydata_destroy),
	(categorydata_list_destroy), (packagedata_new),
	(packagedata_list_copy), (packagedata_copy),
	(packagedata_fill_in_missing), (packagedata_destroy),
	(packagedata_remove_soft_dep), (rpmfilename_from_packagedata),
	(rpmname_from_packagedata), (packagedata_get_readable_name),
	(packagedata_get_name), (packagedata_hash_equal),
	(packagedata_status_enum_to_str), (packagedata_status_str_to_enum),
	(packagedata_modstatus_enum_to_str),
	(packagedata_modstatus_str_to_enum), (packagedata_add_pack_to),
	(packagedata_add_pack_to_breaks),
	(packagedata_add_pack_to_soft_depends),
	(packagedata_add_pack_to_hard_depends),
	(packagedata_add_pack_to_modifies), (packagedata_list_prune),
	(packagerequirement_new),
	(eazel_install_package_provides_basename_compare),
	(eazel_install_package_provides_compare),
	(eazel_install_package_name_compare),
	(eazel_install_package_compare),
	(eazel_install_requirement_dep_compare),
	(eazel_install_requirement_dep_name_compare),
	(eazel_install_package_version_compare),
	(eazel_install_package_other_version_compare),
	(eazel_install_package_matches_versioning),
	(eazel_install_gtk_marshal_NONE__POINTER_INT_INT_INT_INT_INT_INT),
	(gstr_indent), (dump_package_list), (packagedata_dump_int),
	(packagedata_dump):
	Renamed eazel-install-types to eazel-package-system-types

	* components/services/install/athena-view/Makefile.am:
	Fixed linking after fix to 5121.

	* components/services/install/athena-view/athena-service-instal
	l-view.h:
	include eazel-package-system-types instead of
	eazel-install-types.h

	* components/services/install/server/Makefile.am:
	Fixed linking after fix to 5121.
	
	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (eazel_helper_start):
	Don't mention the info msg's from userhelper. 
	
	* po/POTFILES.in:
	Renamed eazel-install-types to eazel-package-system-types.

2000-12-10  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/Makefile.am:
	* components/services/summary/athena-view/athena-summary-callba
	cks.c: (service_tab_selected_callback),
	(updates_tab_selected_callback):
	* components/services/summary/athena-view/athena-summary-callba
	cks.h:
	* components/services/summary/athena-view/athena-summary-footer
	.c: (footer_item_clicked_callback):
	* components/services/summary/athena-view/athena-summary-footer
	.h:
	* components/services/summary/athena-view/athena-summary-view.c
	:

	More minor cleaning to make the summary view more managable.

2000-12-09  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-properties-window.c: (create_basic_page),
	(create_properties_window), (ensure_uri_is_image),
	(set_custom_image), (select_image_button_callback),
	(remove_image_button_callback):
	fixed bug 2167, no way to add custom icons for files without a viewer,
	by adding buttons for adding and removing custom icons to the
	properties window.
	
2000-12-09  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/Makefile.am:
	* components/services/summary/athena-view/athena-summary-callba
	cks.c: (authn_cb_succeeded), (authn_cb_failed), (login_button_cb),
	(logout_button_cb), (logged_in_callback), (logged_out_callback),
	(preferences_button_cb), (forgot_password_button_cb),
	(register_button_cb):
	* components/services/summary/athena-view/athena-summary-callba
	cks.h:
	* components/services/summary/athena-view/athena-summary-dialog
	s.c: (generate_error_dialog), (generate_login_dialog),
	(widget_set_athena_background_color), (error_dialog_cancel_cb),
	(get_window_from_summary_view), (set_dialog_parent),
	(name_or_password_field_activated):
	* components/services/summary/athena-view/athena-summary-dialog
	s.h:
	* components/services/summary/athena-view/athena-summary-menu-i
	tems.c: (update_menu_items), (merge_bonobo_menu_items),
	(bonobo_register_callback), (bonobo_login_callback),
	(bonobo_logout_callback), (bonobo_preferences_callback):
	* components/services/summary/athena-view/athena-summary-menu-i
	tems.h:
	* components/services/summary/athena-view/athena-summary-view-p
	rivate.h:
	* components/services/summary/athena-view/athena-summary-view.c
	: (updates_tab_selected_callback):

	Breaking the summary view up into separate files.  It was getting
	way to monolithic.  Still needs more cleanup from the rewrite before
	pr2 but much more managable now.  Getting it ready for inventory
	additions.

2000-12-08  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5102, Changing to or from Music View advances song in
	second window.

	* components/music/athena-music-view.c: (stop_playing_file):
	Only stop playback if playback is occurring. Otherwise
	esd get's confused and temporarily halts playback causeing
	the status callback to advnace the song counter in any music
	view that is playing.
	
2000-12-08  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar-title.c: (update_emblems):
	fixed crash at launch revealed by recent changes by not trying to
	update the emblems in the sidebar if we don't have a
	file object yet.
	
2000-12-08  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 5029 (File count in sidebar might not match displayed
	search results list due to filtering)

	* libathena-extensions/athena-search-uri.h:
	* libathena-extensions/athena-search-uri.c:
	(athena_get_target_uri_from_search_result_name):
	New function to extract the sooper-secretly encoded
	actual search result URI from the search result "file name".

	* libathena-extensions/athena-directory-async.c:
	(should_display_file_name): New helper function that users
	user preferences to determine whether a file should be
	displayed, based only on its name.
	(filter_search_uri): New filter function used on search
	results
	(get_file_count_filter) New function, result depends on
	whether directory is a search directory.
	(start_monitoring_file_list): Use get_file_count_filter.

	* src/file-manager/fm-search-list-view.c: (real_add_file):
	Use athena_get_target_uri_from_search_result_name instead
	of spreading out the sooper secret knowledge.
	

	Fixed bug 5014 (Control-w should close the properties dialog)

	I made Control-w close a bunch o' windows without menus.

	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-extensions.c:
	(handle_standard_close_accelerator): New helper function,
	closes the window if the key was the close accelerator.
	(athena_gtk_window_event_is_close_accelerator): New public
	function, checks whether a key event is the close accelerator.
	(athena_gtk_window_set_up_close_accelerator): New public
	function, one-stop shopping for most clients that want to
	have Control-w close a window.

	* libathena-extensions/athena-preferences-dialog.c:
	(athena_preferences_dialog_construct):
	* src/file-manager/fm-icon-text-window.c:
	(create_icon_text_window):
	* src/athena-about.c: (athena_about_initialize):
	* src/athena-profiler.c: (dump_dialog_new):
	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize):
	* src/file-manager/fm-properties-window.c:
	(fm_properties_window_initialize):
	Simple cases, just use athena_gtk_window_set_up_close_accelerator 
	so Control-w closes window.
	
	* src/athena-bookmarks-window.c: 
	(save_geometry_and_hide): New helper function, saves geometry
	before hiding window.
	(on_window_delete_event): Call save_geometry_and_hide; move
	other code into hide event handler since it should happen on
	every hide.
	(restore_geometry): Idle function to restore geometry after
	window is hidden (sounds strange, but that's the way it works).
	(on_window_hide_event): Do the every-hide work formerly done
	in delete_event handler; call restore_geometry at idle time
	because it must be called after window is hidden to work right.
	(on_window_destroy_event): remove idle handler in this case
	(only happens when Athena is exiting).
	(handle_close_accelerator), (set_up_close_accelerator):
	Similar to athena_gtk_window_ versions of these functions,
	but also handle saving the geometry before hiding.
	(create_bookmarks_window): Call set_up_close_accelerator;
	wire up "hide" and "destroy" events.
	
	* src/athena-property-browser.c:
	(athena_property_browser_delete_event_callback),
	(athena_property_browser_hide_callback): Move code that
	should run on "hide" from "delete_event" handler to "hide"
	handler; this didn't matter before when clicking was the only
	way to close the window.
	(athena_property_browser_initialize): Wire up "hide" handler;
	call athena_gtk_window_set_up_close_accelerator.

2000-12-08  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fixed 5074: Should give a NULL description in cases where the mime
	type isn't known.

	* libathena-extensions/athena-file.c: (get_description):
	It is now an error for a MIME type to ever be NULL. Added an assert,
	removed a special case code for handling directories even when
	we do not know the mime type.
	
	Fixed 5073: old code to give type "program" for some files (unkown
	MIME type) is not triggering any more.

	* libathena-extensions/athena-file.c: (get_description):
	Changed the check that looked for an empty MIME string to a
	compare for a MIME type of "application/octet-stream".
	
	Fixed 5021: Create Link in View as List -> Athena Crashes.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_create_links_for_files):
	This was just a broken assert that didn't cover the case of an
	empty drop point list.

	* libathena-extensions/athena-file.c:
	(athena_file_get_mime_type):	
	* libathena-extensions/athena-mime-actions.c:
	(is_known_mime_type):
	Use a symbolic name for "application/octet-stream".

2000-12-08  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 2244 (trash window sidebar should have trash icon).

	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_name_for_directory): Added code to
	give the trash its own icon.
	(athena_icon_factory_get_icon_for_file): Rearranged to simplify
	it a bit.
	
	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-trash-monitor.h:
	* libathena-extensions/athena-trash-monitor.c:
	Moved trash monitor to here.
	(athena_trash_files_changed_callback): Do athena_file_changed
	on the trash AthenaFile object when the state changes from full
	to empty or from empty to full.
	
	* src/file-manager/Makefile.am:
	* src/file-manager/athena-trash-monitor.h:
	* src/file-manager/athena-trash-monitor.c:
	Moved trash monitor from here.

	* src/file-manager/fm-desktop-icon-view.c:
	* src/file-manager/fm-directory-view.c:
	Changed includes to include trash monitor from new location.

	* libathena-extensions/athena-directory-metafile.c:
	(get_metadata_string_from_metafile),
	(get_metadata_list_from_metafile),
	(set_metadata_string_in_metafile), (set_metadata_list_in_metafile):
	Remove some dead code left over from handling of directory metadata.
	We don't have directory metadata any more, only file metadata.

2000-12-08  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_register):
	* src/file-manager/fm-desktop-icon-view.c: (real_merge_menus):
	* src/file-manager/athena-desktop-icon-view-ui.xml:
	* src/athena-application.c: (athena_application_startup),
	(desktop_changed_callback):
	* src/athena-application.h:
	* src/athena-main.c: (main):
	Remove command line args --start-desktop & --stop-desktop and the
	"Quit Athena Desktop" item from the desktop right click menu.
	Add the command line arg: --no-default-window. Default for the
	show desktop pref is now ON.

2000-12-08  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_initialize): Added FIXME about hard-coded
	font and size.
	(athena_icon_container_start_renaming_selected_item): Fix bug
	5078 by removing useless empty signal handlers.
	(end_renaming_mode): Fix bug 5079 by merging the remaining code
	from the old hide_rename_widget in after deleting some of it.
	This is more parallel with the start renaming function.
	* libathena-extensions/athena-icon-private.h: Removed the
	unused rename_editable field.
	
	* libathena-extensions/athena-icon-text-item.c:
	(iti_stop_editing): Now that the strange "persistent" editable is
	no longer used, restore the code used to destroy the editable when
	not editing. This also fixes a storage leak.
	(athena_icon_text_item_get_text): Change return type to const
	char * to make it clear it's not free-able.
	(athena_icon_text_item_get_renaming_editable): Change the
	return type to GtkEditable *.
	* libathena-extensions/athena-icon-text-item.h: Change
	return types of get_text and get_renaming_editable.
	
	* src/file-manager/fm-directory-view.c: (queue_pending_files),
	(filtering_changed_callback): Added FIXMEs about special cases
	for the desktop.
	* src/file-manager/fm-icon-view.c: (fm_icon_view_begin_loading):
	Improved wording of a comment.

2000-12-08  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c:
	(athena_property_browser_update_contents):
	fixed bug 5045, browser assumes categories end in 's', by removing
	the offending code, which wasn't used anyway.  fixed bug 5046,
	shouldn't upper-case category names, by casing out instead.
	
2000-12-08  Darin Adler  <darin@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libathena-extensions/athena-undo-signal-handlers.c:
	(editable_key_press_event): Fixed bugs 5090 and 5091. The fix is
	not even compiled right now, but it was better to improve the code
	now -- we'll test when we enable it some day.

2000-12-07  Maciej Stachowiak  <mjs@eazel.com>

	* components/services/startup/athena-view/.cvsignore: Remove
	file from this otherwise empty directory.

2000-12-07  Rebecca Schulman  <rebecka@eazel.com>
        Bug numbers for the FIXMEs in libathena-extensions.
	
	* libathena-extensions/athena-customization-data.c:
	(format_name_for_display):
	* libathena-extensions/athena-directory-async.c:
	(dequeue_pending_idle_callback), (cancel_loading_attributes),
	(athena_directory_cancel_loading_file_attributes):
	* libathena-extensions/athena-directory.c:
	(athena_directory_handle_directory_moved),
	(athena_directory_notify_files_moved),
	(athena_self_check_directory):
	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_canonical),
	(pthread_athena_read_file_thread_entry),
	(pthread_athena_read_file_async), (athena_read_file_cancel),
	(athena_self_check_file_utilities):
	* libathena-extensions/athena-file.c: (get_description),
	(athena_file_forget_attributes_internal):
	* libathena-extensions/athena-gdk-extensions.c:
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_start_renaming_selected_item):
	* libathena-extensions/athena-icon-dnd.c:
	(receive_dropped_uri_list):
	* libathena-extensions/athena-icon-factory.c:
	* libathena-extensions/athena-label.c:
	(athena_label_size_allocate), (label_recompute_line_geometries):
	* libathena-extensions/athena-merged-directory.c:
	(athena_merged_directory_add_real_directory):
	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_get_default_application_for_file_internal):
	* libathena-extensions/athena-scalable-font.c:
	(athena_text_layout_paint):
	* libathena-extensions/athena-search-uri.c:
	(athena_self_check_search_uri):
	* libathena-extensions/athena-string.c:
	* libathena-extensions/athena-undo-signal-handlers.c:
	(editable_key_press_event), (athena_undo_editable_set_undo_key):

2000-12-07  Rebecca Schulman  <rebecka@eazel.com>
	Added bug numbers to FIXMEs for the src 
	subdirectory.  If I can stomach it,
	I'll try and do a few more today.

	* src/file-manager/fm-directory-view.c: (duplicate_callback),
	(check_for_directory_hard_limit), (load_directory):
	* src/file-manager/fm-icon-view.c: (fm_icon_view_begin_loading):
	* src/file-manager/fm-search-list-view.c: (load_error_callback),
	(real_adding_file):
	* src/athena-about.c: (athena_about_draw_info):
	* src/athena-first-time-druid.c: (druid_cancel),
	(druid_finished), (make_anti_aliased_label),
	(make_hbox_user_level_radio_button), (set_up_user_level_page),
	(next_update_page_callback), (initiate_file_download):
	* src/athena-link-set-window.c: (get_link_set_names):
	* src/athena-location-bar.c:
	(athena_location_bar_update_label):
	* src/athena-property-browser.c:
	(athena_property_browser_initialize), (add_reset_property),
	(make_properties_from_xml_node),
	(athena_property_browser_update_contents):
	* src/athena-sidebar-title.c:
	(athena_sidebar_title_background), (update_icon):
	* src/athena-view-frame.c:
	(athena_view_frame_set_to_component):
	* src/athena-window-manage-views.c:
	(window_set_title_with_timestamp), (viewed_file_changed_callback),
	(load_content_view), (change_state):
	* src/athena-window-service-ui.c: (goto_online_storage),
	(goto_software_catalog):
	* src/athena-window-toolbars.c: (set_up_throbber_frame_type):
	* src/athena-window.c: (athena_window_realize):
	* test/test-athena-font.c:

2000-12-07  Andy Hertzfeld  <andy@eazel.com>

	* athena.spec.in:
	added athena-text-view files to spec file
	
	* src/athena-window-toolbars.c: (theme_changed_callback):
	fixed bug 4982, throbber mispositioned when theme changes,
	by toggling the toolbar's visibility when the theme changes
	
2000-12-07  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 2230 (Search can find hidden files, which the user
	can't otherwise see)

	Unfortunately this fix leaves behind a related but harder-
	to-fix bug, bug 5029. I'll fix that separately.

	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_should_show_file): New function, intended
	for subclasses, returns whether a single file should be
	displayed or not, based on user's filter preferences.

	* src/file-manager/fm-search-list-view.c: 
	(real_add_file): Use should_show_file to filter out files
	that don't match preferences. The normal directory-view
	mechanism doesn't work in this case due to the way
	the search view uses "fake" uris to pass around the
	search results.

2000-12-07  Rebecca Schulman  <rebecka@eazel.com>
	Hopefully will improve performance for
	menu merging in a case where it is poor.
	(bug 5020)  Completely fixing the bug will
	involve some design changes in the way the
	clipboard works, though.

	reviewed by: John Sullivan <sullivan@eazel.com>
	(the additional bonobo freezes and thaws)

	* libathena/athena-clipboard.c:
	(merge_in_clipboard_menu_items), (merge_out_clipboard_menu_items):
	Add freezes and thaws in hopes of improving performance here
	* src/athena-window-menus.c: (athena_window_initialize_menus):
	Ditto

	* components/tree/athena-tree-view-dnd.c:
	(athena_tree_view_get_drop_action):
	* libathena-extensions/athena-user-level-manager.h:
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link):
	* src/athena-switchable-search-bar.c:
	(athena_switchable_search_bar_set_mode):
	* src/athena-window-toolbars.c: (theme_changed_callback):
	Removed fixme comments in cases where the fixme has been
	fixed.

2000-12-07  Gene Z. Ragan  <gzr@eazel.com>

	Enabled the jump to next feature. This should be the last missing
	feature enabled that was lost during the brain salad surgery.

	* components/music/athena-music-view.c: (get_player_state):

2000-12-07  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-search-uri.c: (parse_uri): Removed
	the *_suffix code. The change log said this would require data structure
	chagnges, but it didn't. Just deleting the code.
	(athena_self_check_search_uri): Fix test cases that were causing
	"make check" and Tinderbox to fail, added FIXMES.

2000-12-07  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: OK this time I really will remove athena-mpg123

2000-12-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4996, Repeatedly pressing pause "Pause" crashes music view

	* components/music/mpg123.c: (mpg123_pause):
	* components/music/mpg123.h:
	* components/music/athena-music-view.c: (go_to_previous_track),
	(play_button_callback), (pause_button_callback):
	Fixed pause and added some logic to avoid redundant calls.

2000-12-07 Rebecca Schulman  <rebecka@eazel.com>
	Changes to fix bugs 2341, to match the sidebar
	to Arlo's design for search results, and 3488
	that the human readable description of search
	results ends in a period.

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libathena-extensions/athena-search-uri.c:
	(get_nth_criterion_suffix):
	Remove "." from this function.  Eventually,
	this function should be deprecated, but it will
	require some data structure changes, so I left a
	FIXME and an associated bug 5019.
	* src/file-manager/fm-search-list-view.c: (load_location_callback):
	Set the search results title to be "Search Results" instead of
	the human readable description
	* src/athena-sidebar-title.c: (file_is_search),
	(update_more_info):
	Special case search uri's for the "more_info" part
	of the sidebar to be in accordance with Arlo's design.
	This is an annoying way of doing things, but until
	a better framework is in place, John Sullivan and 
	I agreed this was ok to do for now.

2000-12-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4679, Double clicking on an MP3 in music view should play it

	* components/music/athena-music-view.c: (selection_callback):
	Check for double click and play if one is detected.

2000-12-07  Gene Z. Ragan  <gzr@eazel.com>

	Some clean up and another attempt to fix tinderbox.
	
	* components/music/Makefile.am:
	* components/music/esd-audio.c: (esdout_close):
	* components/music/athena-music-view.c: (selection_callback),
	(play_button_callback):

2000-12-07  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 3926 (summary view uses non-standard anti-aliased
	text in error dialogs)

	Fixed unreported bug where closing the summary view error
	dialog with close box would leave user at gray screen.

	* components/services/summary/athena-view/athena-summary-view.c:
	(get_window_from_summary_view): Split this out from set_dialog_parent
	so I could also use it in a different context.
	(set_dialog_parent): Now calls get_window_from_summary_view.
	(generate_error_dialog): Now just calls athena_error_dialog instead
	of doing a bunch of custom code to set up an anti-aliased text error
	dialog. After we get the anti-aliased text preference to work on
	AthenaLabel, we can consider changing athena_error_dialog and
	friends to use it everywhere, but it doesn't make sense for error 
	dialogs	only in this one place to look different from all others.
	Also, connected error_dialog_cancel_cb to the "destroy" signal
	instead of just to the OK button, so that closing the dialog with
	the close box will have the same effect as the OK button.

2000-12-07  Andy Hertzfeld  <andy@eazel.com>

	* components/text/athena-text-view.c:
	(athena_text_view_initialize), (add_one_service),
	(update_service_menu_items), (merge_bonobo_menu_items):
	fixed problem with "command/verb separation", and added support
	for the clipboard to the text view.

	* athena-clean.sh:
	added athena-text-view to athena-clean.sh
	
	* data/emblems/Makefile.am:
	* data/emblems/danger.png:
	* icons/Makefile.am:
	* icons/emblem-danger.svg:
	added danger emblem from Susan
	
	* icons/i-executable.png:
	* icons/i-executable-aa.png:	
	fixed bug 4691, executable icon looks like KDE icon, by using
	a new icon from Susan
	
	* src/file-manager/fm-icon-view.c:
	(icon_container_preview_callback):
	fixed bug 4926, Athena tries to preview realaudio files but
	can't, by special casing the realaudio mime type.  Also, cleaned
	things up a little by removing redundant is_local call.
	
2000-12-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 954, Plays two MP3s at once instead of one at a time

	This was caused by playback not being stopped when a new uri
	was being loaded. We now stop playback when a new uri is loaded.

	* components/music/athena-music-view.c:
	(athena_music_view_update), (athena_music_view_load_uri):

2000-12-07  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 3245 (When an empty folder is visited, the throbbing
	never stops), bug 2540 (Hook up done_loading signal in
	AthenaMergedDirectory?), and bug 3067 (throbber doesn't start
	again if you do a new "underway" call after load is complete).

	* src/file-manager/fm-directory-view.c: (queue_pending_files):
	Get rid of code that uses athena_directory_are_all_files_seen
	to notice we are done loading.
	(done_loading_callback): Use done_loading signal to notice we
	are done loading.
	(finish_loading_uri): Connect to the done_loading signal.
	(disconnect_model_handlers): Disconnect from the done_loading
	signal.
	
	* libathena-extensions/athena-merged-directory.c:
	(done_loading_callback),
	(athena_merged_directory_add_real_directory),
	(athena_merged_directory_remove_real_directory): Add code to
	track all the trash directories and emit done_loading signals
	once all of them are done loading.
	
	* src/athena-window-manage-views.c: (change_state): Turn the
	stop and the throbber back on when a view re-marks itself
	underway.
	
	* libathena-extensions/athena-drag.c:
	(athena_drag_file_receive_dropped_keyword): Fix storage leak by
	doing a free_deep on the list of keywords.
	
	* libathena-extensions/athena-file-operations.h:
	* libathena-extensions/athena-file-operations.c:
	Get rid of excess includes.
	
	* libathena-extensions/athena-icon-dnd.c: Get rid of unused
	ERASE_KEYWORD constant.
	
	* src/athena-window.c: (athena_window_constructed): Fix a
	typo in a comment.

2000-12-07  Gene Z. Ragan  <gzr@eazel.com>

	Add header files to Makefile.am to make tinderbox happy.

	* components/music/Makefile.am:
	* components/music/mp3head.h:
	Put a header guard define in file.

2000-12-07  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/helper/README:
	Update the eazel-helper README to be more current than July.  Tell
	readers about the softlinks and tell them that eazel-hacking does
	this for you now.

2000-12-06  Mike Fleming  <mfleming@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(handle_new_folder_vfs_error), (new_folder_xfer_callback),
	(athena_file_operations_new_folder):

	bugzilla.eazel.com 3940
	"DAV: Creating folder in read-only directory does not produce error feedback"

	Added an error dialog for the case where gnome-vfs-xfer reports an
	error during directory creation.  This case is only commonly
	encountered in remote filesystems where Athena can't check
	permissions before operations.  (Similar behaviour to 3940 applied
	to FTP as well).

2000-12-06  Gene Z. Ragan  <gzr@eazel.com>

	Changes in the music view to use a threaded file reader
	and threaded audio output mechanism.  Modified the xmms
	engine to be used as the mp3 engine that the view uses.
	Removed the use of stored proc IDs as the mechanism to 
	determine if the view is currently in the process of
	playing a file.
	
	* components/music/Makefile.am:
	* components/music/common.c: (fullread), (stream_init),
	(stream_rewind), (mpg123_stream_close), (stream_head_read),
	(stream_head_shift), (stream_mpg123_read_frame_body),
	(stream_back_bytes), (mpg123_stream_jump_to_frame),
	(mpg123_stream_jump_to_byte),
	(mpg123_stream_check_for_xing_header), (stream_init),
	(mpg123_stream_close), (stream_head_read), (stream_head_shift),
	(stream_mpg123_read_frame_body), (mpg123_stream_jump_to_frame),
	(mpg123_stream_jump_to_byte),
	(mpg123_stream_check_for_xing_header), (get_fileinfo),
	(mpg123_read_frame_init), (read_id3v2_tag), (mpg123_head_check),
	(mpg123_read_frame), (mpg123_decode_header), (mpg123_open_stream),
	(mpg123_set_pointer), (mpg123_compute_bpf),
	(mpg123_calc_numframes):
	* components/music/configure.c: (mpg123_configurewin_ok),
	(auto_select_cb), (use_3dnow_cb), (use_fpu_cb), (proxy_use_cb),
	(proxy_auth_use_cb), (streaming_save_dirbrowser_cb),
	(streaming_save_browse_cb), (streaming_save_use_cb),
	(title_id3_use_cb), (configure_destroy), (mpg123_configure):
	* components/music/dct64.c: (mpg123_dct64):
	* components/music/dct64_i386.c: (mpg123_dct64_1), (mpg123_dct64):
	* components/music/decode_2to1.c: (mpg123_synth_2to1_8bit),
	(mpg123_synth_2to1_8bit_mono),
	(mpg123_synth_2to1_8bit_mono2stereo), (mpg123_synth_2to1_mono),
	(mpg123_synth_2to1_mono2stereo), (mpg123_synth_2to1):
	* components/music/decode_4to1.c: (mpg123_synth_4to1_8bit),
	(mpg123_synth_4to1_8bit_mono),
	(mpg123_synth_4to1_8bit_mono2stereo), (mpg123_synth_4to1_mono),
	(mpg123_synth_4to1_mono2stereo), (mpg123_synth_4to1):
	* components/music/decode_i386.c: (mpg123_synth_1to1_8bit),
	(mpg123_synth_1to1_8bit_mono),
	(mpg123_synth_1to1_8bit_mono2stereo), (mpg123_synth_1to1_mono),
	(mpg123_synth_1to1_mono2stereo), (mpg123_synth_1to1):
	* components/music/decode_ntom.c: (mpg123_synth_ntom_set_step),
	(mpg123_synth_ntom_8bit), (mpg123_synth_ntom_8bit_mono),
	(mpg123_synth_ntom_8bit_mono2stereo), (mpg123_synth_ntom_mono),
	(mpg123_synth_ntom_mono2stereo), (mpg123_synth_ntom):
	* components/music/dxhead.c: (ExtractI4), (mpg123_get_xing_header),
	(mpg123_seek_point):
	* components/music/dxhead.h:
	* components/music/esd-audio.c: (esdout_init), (get_latency),
	(esd_stou8), (esd_utos16sw), (esd_utos16), (esd_16sw),
	(esdout_setup_format), (esdout_get_written_time),
	(esdout_get_output_time), (esdout_used), (esdout_playing),
	(esdout_free), (esdout_write_audio), (esdout_write),
	(esdout_close), (esdout_flush), (esdout_pause), (esdout_loop),
	(esdout_set_audio_params), (esdout_open):
	* components/music/esd-audio.h:
	* components/music/esd-mixer.c: (esdout_get_volume),
	(esdout_set_volume):
	* components/music/fileinfo.c: (set_entry_tag), (get_entry_tag),
	(find_genre_id), (genre_comp_func), (save_cb), (label_set_text),
	(remove_id3_cb), (set_mpeg_level_label), (channel_mode_name),
	(file_info_http), (mpg123_file_info_box):
	* components/music/getbits.c: (check_buffer_range),
	(mpg123_backbits), (mpg123_getbitoffset), (mpg123_getbyte),
	(mpg123_getbits), (mpg123_getbits_fast), (mpg123_get1bit):
	* components/music/getbits.h:
	* components/music/huffman.h:
	* components/music/id3.c: (id3_seek_mem), (id3_read_mem),
	(id3_seek_fd), (id3_read_fd), (id3_seek_fp), (id3_read_fp),
	(id3_open_mem), (id3_open_fd), (id3_open_fp), (id3_close),
	(id3_tell), (id3_alter_file), (safe_write), (id3_write_tag):
	* components/music/id3.h:
	* components/music/id3_frame.c: (id3_read_frame), (id3_get_frame),
	(id3_decompress_frame), (id3_delete_frame), (id3_add_frame):
	* components/music/id3_frame_content.c: (id3_get_content):
	* components/music/id3_frame_text.c: (id3_get_encoding),
	(id3_set_encoding), (id3_get_text), (id3_get_text_desc),
	(id3_get_text_number), (id3_set_text), (id3_set_text_number):
	* components/music/id3_frame_url.c: (id3_get_url),
	(id3_get_url_desc):
	* components/music/id3_header.h:
	* components/music/id3_tag.c: (id3_init_tag), (id3_read_tag):
	* components/music/l2tables.h:
	* components/music/layer1.c: (I_step_one), (I_step_two),
	(mpg123_do_layer1):
	* components/music/layer2.c: (mpg123_init_layer2), (II_step_one),
	(II_step_two), (II_select_table), (mpg123_do_layer2):
	* components/music/layer3.c: (mpg123_init_layer3),
	(III_get_side_info), (III_get_scale_factors_1),
	(III_get_scale_factors_2), (III_dequantize_sample), (III_i_stereo),
	(III_antialias), (dct36), (dct12), (III_hybrid),
	(mpg123_do_layer3):
	* components/music/mpg123.c: (mpg123_compute_tpf),
	(set_mpg123_synth_functions), (mpg123_init), (convert_to_header),
	(play_frame), (get_id3_genre), (mpg123_strip_spaces), (extname),
	(eval_id3_format), (mpg123_id3v1_to_id3v2),
	(mpg123_format_song_title), (mpg123_get_id3v2), (get_song_title),
	(get_song_time), (get_song_info), (decode_loop),
	(mpg123_play_file), (mpg123_stop), (mpg123_seek), (mpg123_pause),
	(get_time):
	* components/music/mpg123.h:
	* components/music/mpg123_handler.c:
	* components/music/mpg123_handler.h:
	* components/music/athena-music-view.c:
	(athena_music_view_initialize), (athena_music_view_destroy),
	(selection_callback), (update_play_controls_status),
	(play_status_display), (play_current_file), (stop_if_playing),
	(go_to_next_track), (go_to_previous_track), (play_button_callback),
	(stop_button_callback), (pause_button_callback),
	(slider_moved_callback), (slider_release_callback),
	(add_play_controls), (athena_music_view_update),
	(athena_music_view_drag_data_received), (start_playing_file),
	(stop_playing_file), (get_player_state), (set_player_state):
	* components/music/tabinit.c: (mpg123_make_decode_tables),
	(mpg123_make_conv16to8_table):

2000-12-06  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 4992 ("New folder" menu item enable state doesn't follow
	permissions), bug 4965 (Dragging multiple items to location bar
	crashes Athena), and bug 4995 (Rename a file to bad name ->
	error cites wrong filename).

	Fixed a bug jsh spotted where we were doing the mod. time checks
	wrong in the icon factory for thumbnails.

	Did some wording fixes after menthos pointed out some problems.

	* libathena-extensions/athena-icon-factory.c:
	(get_cache_time): Split out this function to get the mtime of a
	file so we can check when it changed.
	(load_specific_icon): Get the time when loading an icon.
	(scale_icon): Copy the time when making a scaled icon from an
	existing icon.
	(remove_icons_if_file_changed): New renamed function uses
	get_cache_time to check if the icon needs recomputing because of a
	change in the underlying file.
	(get_icon_from_cache): Call the new remove_icons_if_file_changed.
	(load_icon_with_embedded_text): Copy the time when making an icon
	with text from an existing icon.
	
	* libathena-extensions/athena-file-attributes.h: Added
	ATTRIBUTE_CAPABILITIES (and sorted in alphabetical order).
	* libathena-extensions/athena-directory-async.c:
	(athena_directory_set_up_request): Changed the name of this,
	made it public, and added ATTRIBUTE_CAPABILITIES as another
	way to ask for the file info.
	(cancel_loading_attributes),
	(athena_directory_cancel_loading_file_attributes): Set up a
	request and use it to decide what to cancel.
	* libathena-extensions/athena-directory-private.h: Moved the
	request structure and call into here so it can be used by
	AthenaFile and AthenaDirectory both.
	* libathena-extensions/athena-file.c:
	(athena_file_forget_attributes_internal): Set up a request and
	use it to decide what to forget.
	(athena_file_forget_all_attributes): Add ATTRIBUTE_CAPABILITIES
	to the set of things in "all".
	
	* src/file-manager/fm-directory-view.c:
	(check_for_directory_hard_limit): Added a FIXME and made some
	minor wording improvements.
	(file_changed_callback): Helper to schedule a menu update when
	the directory's AthenaFile reports a change.
	(load_directory): Add monitoring of the directory's "capabilities"
	since they affect whether "New Folder" is allowed. Fixes 4992.
	(disconnect_handler): Helper for the two functions below.
	(disconnect_directory_handler): Disconnect a AthenaDirectory
	handler.
	(disconnect_directory_as_file_handler): Disconnect a AthenaFile
	handler.
	(disconnect_model_handlers): Add code to stop monitoring the
	directory's "capabilities".
	
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file): Got rid of some unneeded "\n"
	characters. Improved the error message in the "/"-forbidden case
	with a specific special case message and the proper file name (was
	using the old file name, not the new one). Fixes 4995.
	(fm_rename_file): Added quotes to message.
	
	* src/athena-location-bar.h: Removed unused fields.
	* src/athena-location-bar.c: (athena_location_bar_get_window):
	Find the window by looking for an ancestor instead of trying to
	use gtk_object_get_data (on data no one was setting any
	more!). Fixes 4965.
	(athena_location_bar_initialize): Got rid of redundant
	initialization to NULL.
	(athena_location_bar_set_location): Got rid of gratuitous check
	before calling g_free.
	(athena_location_bar_update_label): Added a localization-related
	FIXME here.
	
	* libathena-extensions/athena-file-operations.c:
	(handle_xfer_vfs_error): Corrected the "it's" to "its" even though
	I know that John and Pavel were writing an improved version of the
	entire message.

	* libathena-extensions/athena-search-uri.c:
	(get_translated_criterion), (athena_self_check_search_uri): Say
	"folder" instead of "directory".
	* src/athena-search-bar-criterion.c: Say "folder" instead of
	"directory".
	* src/athena-theme-selector.c: (add_theme_to_icons): Say
	"folder" instead of "directory". Other minor wording improvements.
	(make_theme_description): Minor wording improvement.
	
	* src/athena-window-manage-views.c:
	(window_set_title_with_timestamp): Added a FIXME.

2000-12-06  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Addressed bug 4208 (Opening new window is slow)

	Pavel identified the 2nd biggest performance bottleneck in
	opening a new window (1st being tree view) as the code that
	sets up the bookmark menus. I found some good speedups; time
	to profile again.

	* libathena-extensions/athena-bookmark.c:
	(bookmark_file_changed_callback): athena_uris_match returns
	a gboolean, not a strcmp-style int. Doh! Sense of test was
	reversed, causing many unnecessary rebuild-bookmarks-menus.
	
	* src/athena-window-menus.c: 
	(append_static_bookmarks), (refresh_bookmarks_menu): Wrapped
	some Bonobo-ui-manipulating code with freeze/thaw; this speeds
	up rebuild-bookmarks_menu by an order of magnitude or so.

	Fixed bug 4334: (Icon name being edited can get separated
	from icon on restore-original-size)

	* libathena-extensions/athena-icon_container.c:
	(athena_icon_container_move_icon): End renaming mode
	if icon being renamed is moved.

2000-12-06  Rebecca Schulman  <rebecka@eazel.com>

	* libathena-extensions/athena-search-uri.c:
	Remove a comment about a FIXME that is fixed.

2000-12-06  Michael Engber  <engber@eazel.com>

	* src/athena-sidebar-title.c: (appearance_changed_callback),
	(realize_callback), (athena_sidebar_title_initialize),
	(athena_sidebar_title_background),
	(athena_sidebar_title_select_text_color):
	Hookup sidebar_title to their background's appearance_changed
	signals so that the text can adjust color to match the
	background being light or dark - bug 4991.

2000-12-06  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/Makefile.am:
	* components/services/trilobite/libtrilobite/libtrilobite.h:

	Backing out rpm evil until the abstractions can be fixed correctly.

2000-12-06  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-inventory-ut
	ils.c: (add_info), (str_has_prefix):

	One more quick fix for the build.  Didn't want to make trilobite
	depend on libathena-extensions.

2000-12-06  Rebecca Schulman  <rebecka@eazel.com>
	This should complete the rest of the work for bug 3920,
	by added a message in the status bar about what 
	search results will appear (only those files indexed as 
	of the last index time) 

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* src/file-manager/fm-search-list-view.c: (load_location_callback):
	Add a status message
	
	* src/file-manager/athena-indexing-info.c:
	* src/file-manager/athena-indexing-info.h:
	(athena_indexing_info_get_last_index_time),
	(show_reindex_request_information):
	Changed get_last_index_time to 
	athena_indexing_info_get_last_index_time
	to share the code with the search list view

	* src/athena-window.c:
	Upped the status bar timeout for 5 seconds to 10.

2000-12-06  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/Makefile.am:

	Fixing the build.  Adding the temporary dep to rpmlib.

2000-12-06  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/Makefile.am:
	* components/services/trilobite/libtrilobite/libtrilobite.h:
	* components/services/trilobite/libtrilobite/trilobite-inventory-ut
	ils.c: (add_package_info), (read_proc_info), (add_info),
	(add_io_info), (add_hardware_info),
	(trilobite_synchronize_configuration_metafile),
	(trilobite_update_configuration_metafile),
	(trilobite_create_configuration_metafile):
	* components/services/trilobite/libtrilobite/trilobite-inventory-ut
	ils.h:

	Adding basic inventory collection funtions to trilobite.  Still needs
	the rpm abstraction in order to work on RH7.

2000-12-06  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 4994 (Back and Forward tool bar buttons don't respect
	"no label" gnomecc option)

	* src/athena-window-toolbars.c: (set_up_special_bonobo_button):
	Set initial labels-or-not state based on global preference. This
	is an imperfect solution because it only partially matches the
	logic used by the Bonobo standard button mechanism, but the
	remaining symptoms are very minor (see bug 5005).

2000-12-06  Eskil Heyn Olsen  <eskil@eazel.com>

	* athena.spec.in:
	Added the new libs to the spec, so tinderbox can build again.

2000-12-06 John Fleck <jfleck@inkstain.net>

	reviewed by  Ali Abdin  <aliabdin@aucegypt.edu>
	* components/help/converters/gnome-db2html2/sect-preparse.c:
	fixing memory leak

2000-12-06  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-query.c:
	killed
	
	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (trilobite_root_helper_run_program):
	Replaced the g_assert with g_warning and a continue;

	* po/POTFILES.in:
	Updated for all the new stuff in eazel-install

2000-12-06 Eskil Heyn Olsen  <eskil@eazel.com>

	* components/rpmview/Makefile.am:
	Needs to link with eazelpackagesystem now.
	
	* components/services/install/command-line/Makefile.am:
	Build eazel-test-types.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_download_progress_signal),
	(eazel_install_progress_signal), (something_failed), (dep_check):
	Nicer output.
	
	* components/services/install/command-line/eazel-test-packsys.c:
	(test_package_load), (main):
	Moved the packagelist_prun test into eazel-test-types. Also
	relaxed the test of uninstall (doesn't require progress signals
	now).
	
	* components/services/install/command-line/eazel-test-types.c:
	(make_package), (test_packagelist_prune),
	(test_eazel_install_package_matches_versioning), (main):
	Test packagedatalist_prune and the new ugly func for testing
	version-minor match.
	
	* components/services/install/lib/Makefile.am:
	Do compile eazel-install-query.c anymore.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(packagedata_new_from_rpm_conflict),
	(packagedata_new_from_rpm_conflict_reversed),
	(eazel_install_do_rpm_dependency_check):
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize), (eazel_install_set_arg),
	(eazel_install_class_initialize), (eazel_install_initialize),
	(eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_query_package_system),
	(eazel_install_get_size_increasement),
	(eazel_install_emit_preflight_check):
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-logic.c:
	(install_packages), (eazel_install_download_packages),
	(eazel_install_check_for_file_conflicts),
	(eazel_install_do_install_packages), (uninstall_all_packages),
	(uninstall_packages), (get_total_size_of_packages),
	(eazel_install_start_signal), (eazel_install_end_signal),
	(eazel_install_progress_signal), (eazel_install_failed_signal),
	(eazel_install_start_transaction),
	(eazel_install_check_existing_packages),
	(eazel_install_fetch_dependencies),
	(eazel_install_do_dependency_check),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse),
	(eazel_uninstall_check_for_install):
	Fixes bug 4936, use EazelPackageSystem in EazelInstall.

	* components/services/install/lib/eazel-install-problem.c:
	(problem_step_foreach_remove),
	(eazel_install_problem_tree_to_case),
	(eazel_install_problem_handle_cases):
	Slammed some ifdef EIP_DEBUG around some debug.
	
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-types.c:
	(eazel_install_package_matches_versioning):
	New funky match function. Since I needed the same check two
	places, I moved it into a generel function.
	Also cut out all the rpmload code.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(monitor_rpm_process_pipe), (rpm_packagedata_fill_from_rpm_header),
	(eazel_package_system_rpm3_load_package),
	(eazel_package_system_rpm3_query_impl),
	(eazel_package_system_rpm3_query_requires),
	(eazel_package_system_rpm3_query_foreach),
	(monitor_subcommand_pipe), (eazel_package_system_rpm3_execute),
	(check_if_all_packages_seen),
	(eazel_package_system_rpm3_install_uninstall):
	Fixed 4914. And also added the use of the packages_seen in
	piggyback.
	
	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_is_installed),
	(eazel_package_system_emit_start),
	(eazel_package_system_emit_progress),
	(eazel_package_system_emit_failed),
	(eazel_package_system_emit_end):
	Added const to all the signal emitters.
	Added the is_installed call.
	
	* components/services/install/athena-view/Makefile.am:
	Link against eazelpackagesystem
	
	* components/services/install/server/Makefile.am:
	Link against eazelpackagesystem

	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.h:
	Added a documentational comment.
	
	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (trilobite_root_helper_run_program):
	Added an api g_assert that I ran into (no element in args may be null).

2000-12-06  Ramiro Estrugo  <ramiro@eazel.com>

	* src/file-manager/fm-search-list-view.c: (load_error_callback):
	Remove the extra not needed ", NULL" from this g_strdup_printf call.
	
2000-12-06  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-softcat.c:
	(gnome_vfs_escape_string):

	Fixed a dumb url-quoting error that resulted in "hilarious"
	quoting flubs.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_done):

	Never return to the summary-view page after completion now: let
	the user do their own navigation.
	
	* athena-installer/src/callbacks.c: (log_debug),
	(reply_callback), (ask_to_delete_rpms), (ask_are_you_sure),
	(druid_cancel), (begin_install), (druid_finish):
	* athena-installer/src/installer.c: (start_over),
	(insert_info_page), (get_detailed_errors_foreach),
	(get_detailed_errors), (install_failed), (uninstall_failed),
	(download_failed), (eazel_installer_post_install),
	(draw_splash_text), (eazel_installer_set_default_texts),
	(eazel_installer_initialize):

	Ask if the user wants to delete the RPMs after a successful
	install, and ask for verification when they hit the "cancel"
	button.  Eliminate a redundant cancel callback that caused double
	vision.  Restore the error dialog's AWOL title (?).  Turn off that
	damn checkbox for now (can turn it on later if anyone makes an
	installer PR2.1).

John Fleck <jfleck@inkstain.net>

	reviewed by: Ali Abdin <ailabdin@aucegypt.edu>
	
	* components/help/converters/gnome-db2html2/gdb3html.h,
	  sect-preparse.c, toc-elements.c: completes support for
          glossaries in the Gnome help system. Fixes bug #2349

2000-12-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 3355 (No "New Window" menu item in right-click menu)

	* src/athena-shell-ui.xml: Added "New Window" to
	right-click context menu (that appears in directory views)

2000-12-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 4986 (Open in <n> new windows disabled) 

	* src/file-manager/fm-directory-view.c: (real_update_menus):
	An == should have been a !=

	Fixed bug 3510 (The Back and Forward right-click menus are
	missing)

	* src/athena-shell-ui.xml: Replaced toolitem nodes for
	"Back" and "Forward" with control nodes for their wrappers.
	Have to do a lot of stuff manually for non-standard Bonobo
	buttons.
	
	* src/athena-window-private.h: Store back_button_item and
	forward_button_item in details.
	
	* src/athena-window-toolbars.c: 
	Removed #ifdef UIH brackets around right-click menu code.
	(get_back_button), (get_forward_button): Helper functions to
	get the GtkButton widgets from the stored BonoboUIToolbarButtonItems.
	(back_or_forward_button_pressed_callback): Renamed from ..._clicked_...,
	since it's a handler for button_press_event. Compare for Back or
	Forward button a newfangled way.
	(back_or_forward_button_clicked_callback): New function, callback
	from button's "clicked" handler now that Bonobo doesn't handle this
	for us.
	(get_file_name_from_icon_name): New function extracted from
	set_up_button; gets the full file path from the leaf icon "name".
	(set_up_standard_bonobo_button): Renamed from "set_up_button",
	now calls get_file_name_from_icon_name.
	(get_pixbuf_for_xml_node): New function, calls Bonobo utility code
	to get the pixbuf from an xml button node.
	(set_up_special_bonobo_button): New function, parallel to
	set_up_standard_bonobo_button but handles the case where you have
	a BonoboUIToolbarButtonItem in hand.
	(set_up_toolbar_images): Call set_up_special_bonobo_button for the
	Back and Forward items; put the bonobo freeze/thaw here instead of
	where it was before in set_up_button.
	(set_widget_for_bonobo_control): New function, extracted from 
	athena_window_initialize_toolbars, handles attaching a widget to
	a Bonobo control defined in the XML file.
	(set_up_back_or_forward_tool_bar_item): New function, creates
	widget, wraps it in control, and wires up signal handlers.
	(athena_window_initialize_toolbars): Call set_up_toolbar_images
	only after Back/Forward buttons are created; create Back/Forward
	buttons and use new helper functions.
	
	* src/athena-window.c: 
	(athena_window_allow_back), (athena_window_allow_forward):
	Set sensitivity of Back/Forward buttons explicitly.

2000-12-05  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize):

	Re-order softcat init so it's initialized before pieces of it are
	set.
	
	* components/services/install/lib/eazel-softcat.c:
	(gnome_vfs_escape_string):

	Fix the stub escape_string (for the gnome-vfs-less bootstrap
	installer) to actually compile and work.

	* athena-installer/src/Makefile:

	(innocent whistle)
	
	* athena-installer/src/installer.c: (create_what_to_do_page),
	(eazel_installer_add_category), (eazel_installer_initialize),
	(eazel_installer_new):

	Fix label names to match (and avoid assertion).

2000-12-05  Michael Engber  <engber@eazel.com>

	* src/athena-window.c: (athena_window_constructed),
	(update_sidebar_panels_from_preferences):
	Keep the desktop from creating sidebar panels (it still
	has the sidebar) - bug 2603.

2000-12-05  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* src/file-manager/fm-search-list-view.c: (load_error_callback):
	Added an error callback for search uris that produce error
	GNOME_VFS_ERROR_TOO_BIG, which happens when a search matches
	every criterion in the database.
	* src/athena-search-bar-criterion.c: (get_owner_location_for):
	Fixed an "is not" in a search uri that should have been "is_not"
	so that searches did not produce an error.

2000-12-05  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/Makefile.am:
	* components/services/trilobite/libtrilobite/libtrilobite.h:
	* components/services/trilobite/libtrilobite/trilobite-core-metadat
	a-manager.c:
	* components/services/trilobite/libtrilobite/trilobite-core-metadat
	a-manager.h:
	* components/services/trilobite/libtrilobite/trilobite-core-package
	-manager.c:
	* components/services/trilobite/libtrilobite/trilobite-core-package
	-manager.h:
	* components/services/trilobite/libtrilobite/trilobite-core-securit
	y-manager.c:
	* components/services/trilobite/libtrilobite/trilobite-core-securit
	y-manager.h:
	* components/services/trilobite/libtrilobite/trilobite-core-tests.c
	:
	* components/services/trilobite/libtrilobite/trilobite-core-tests.h
	:

	Removing some empty file templates from libtrilobite.

2000-12-05  Pavel Cisler <pavel@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(handle_xfer_vfs_error):
	Second part of fix 4894 "Dragging /proc from the tree view to
	/home causes a file not found".	
	Part of fix to 3232 "Error message when copying rwx file from
	r-x folder to rwx folder".	
	Part of fix to 3237 "No error occurs if move file to folder w/o
	write access".
	Part of fix to 3748 "misleading file operation error dialog"
	Added logic that distinguishes between read and write phases
	of a file move properly and gives the right error.
	Split up the "no permissions" and "read only" cases and gave them
	distinct errors.
	Added a specific case for a move from a directory that is not writable.

2000-12-05  John Sullivan  <sullivan@eazel.com>f

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 3586 (Athena tool bar doesn't respect
	"no labels" setting in gnomecc)

	I fixed the Bonobo part of this bug earlier; this is the
	little leftover Athena-specific part.

	* src/athena-shell-ui.xml: Remove 'look="both"' from
	tool bar definition. This was formerly needed due to
	Bonobo behavior where you would get icons-only without this,
	but now this prevents the preference from kicking in.
	* src/athena-window-toolbars.c: 
	(allocate_throbber): Use small throbber if gnome preference is 
	for unlabelled tool bar buttons. This makes the throbber 
	appearance fit in well when tool bar labels are off.
	(theme_changed_callback): Remove hide/show toolbar and replace
	it with FIXME about how the throbber doesn't reposition
	correctly when theme changes. The hide/show was a hack that
	worked in the old Bonobo but doesn't in the new one.

	* src/athena-desktop-window.c: (realize):
	Removed some leftover #ifdef UIH code that was functionally
	replaced a while back.

2000-12-04  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	(init_default_transfer_configuration),
	(eazel_install_configure_softcat), (transferoptions_destroy):
	* components/services/install/lib/eazel-install-metadata.h:
	
	Remove softcat fields from the TransferOptions struct and move
	them into EazelSoftCat's config.  Read ESC's config from the
	install/server/ gconf items.

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize), (eazel_install_initialize),
	(eazel_install_new_with_config), (eazel_install_get_server),
	(eazel_install_get_server_port), (eazel_install_get_username),
	(eazel_install_get_eazel_auth), (eazel_install_get_cgi_path),
	(eazel_install_set_server), (eazel_install_set_server_port),
	(eazel_install_set_username), (eazel_install_set_eazel_auth),
	(eazel_install_set_cgi_path):
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-types.h:

	Put a SoftCat into the Install object, and map the set/get
	functions for old TransferOptions fields to SoftCat fields.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_xfer_callback), (eazel_install_fetch_package):

	Remove some sarcasm (I'm over it).  Remove traces of the "old"
	(fake) CGI code.  Remove the evil softcat hack and make it use the
	softcat object now.
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_unref), (eazel_softcat_set_server),
	(eazel_softcat_set_server_host), (eazel_softcat_set_server_port),
	(eazel_softcat_get_server_host), (eazel_softcat_get_server_port),
	(eazel_softcat_set_authn), (eazel_softcat_set_authn_flag),
	(eazel_softcat_set_username):
	* components/services/install/lib/eazel-softcat.h:

	Let a SoftCat be unref'd (cough cough).  Add some more field
	set/get functions for the Install object.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_solve_cases),
	(athena_service_install_done),
	(athena_service_install_failed):
	* components/services/install/athena-view/athena-service-instal
	l-view.h:

	Remove some cruft and fix the "already installed" case so that it
	doesn't drop windows everywhere and vanish abruptly, leaving a
	dangling eazel-install service running in the background.
	
2000-12-04  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/athena-tree-view.c
	(expand_uri_sequence_and_select_end): Fix build lossage from last
	commit.

2000-12-04  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: John Sullivan  <sullivan@eazel.com>

	* components/tree/athena-tree-view.c
	(expand_uri_sequence_and_select_end): Changed control flow a bit
	to avoid possibly dereferencing a NULL view_node pointer. This can
	happen when launching athena with the tree view and the desktop
	both enabled. Thanks to John Sullivan for locating the bug,
	finding the likely cause in the debugger, and helping me simplify
	the control flow of this function.

2000-12-04  Darin Adler  <darin@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libathena-extensions/Makefile.am: Add ESD flags and library
	since we are now using it. Without this change, I couldn't link.

	* libathena-extensions/athena-icon-container.c:
	(redo_layout_internal), (redo_layout_callback),
	(unschedule_redo_layout), (schedule_redo_layout), (relayout): Get
	rid of some circular logic in relayout (now called redo_layout)
	and made nice calls to cleanly schedule the idle function to redo
	layout.
	(size_allocate): Make sure we redo layout if this is the first
	allocate, since we have inhibited them up to this point.
	(athena_icon_container_initialize): Get rid of unnecessary
	initialization of things that are already 0, NULL, FALSE.
	(finish_adding_new_icons): Remove unnecessary check for NULL.
	(athena_icon_container_add): Use the new schedule_redo_layout.
	(athena_icon_container_remove): Use schedule_redo_layout instead
	of redoing the layout right away, since this can be called for
	many icons at a time and we want to bunch up the layout work.
	(athena_icon_container_request_update): Schedule a redo_layout
	any time an icon changes. We could get fancy and detect changes
	that are substantive if this does too much extra layout work.
	(athena_icon_container_set_zoom_level): Removed extraneous
	direct call to redo_layout after the request_update_all call.

	* src/athena-window.c: (menu_bar_no_resize_hack_class_free),
	(menu_bar_no_resize_hack): Tweak function name and formatting.
	(athena_window_constructed): Do a little bit less sidebar setup
	when making a desktop window.

	* libathena-extensions/athena-sound.c: Tweak (has nice side
	effect of forcing recompile).

2000-12-04  Robey Pointer  <robey@eazel.com>

	* components/services/install/command-line/eazel-test-softcat.c:
	(main):

	Add -V (version), --gt (greater-than), and -C (check for new
	version) options to eazel-softcat.  (The -C/--gt options won't work
	until the softcat java-side supports it.)
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_initialize), (eazel_softcat_set_retry),
	(eazel_softcat_get_info), (eazel_softcat_available_update):
	* components/services/install/lib/eazel-softcat.h:

	Finish softcat API (check for new version of a package).

2000-12-04  Maciej Stachowiak  <mjs@eazel.com>

	* README: Updated ORBit version.

2000-12-04  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(athena_background_ensure_gradient_buffered):
	Changed the semantics of multi-point gradients
	so that percentages are postions (rather than
	widths) - bug 4759

2000-12-04  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(athena_file_operations_copy_move):
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_move_copy_items):
	* src/file-manager/fm-list-view.c: (fm_list_receive_dropped_icons):
	Fixed 4949:
	Fix a crash when copying from an icon view to a list view -
	my last fix to set icon positions properly during duplicate was sloppy
	and broke this.
	The change needed to add one more place that use an empty GArray instead
	of a NULL.
	Properly handle the case of an empty GArray in
	athena_file_operations_copy_move.

2000-12-04  Maciej Stachowiak  <mjs@eazel.com>

	* README: Update OAF branch info.

2000-12-04  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background-canvas-group.c:
	(athena_background_canvas_group_initialize_class),
	(athena_background_canvas_group_update),
	(athena_background_canvas_group_draw),
	(athena_background_canvas_group_render):
	Code formatting changes.
	
	* libathena-extensions/athena-background.c:
	(athena_background_initialize_class),
	(athena_background_set_combine_mode),
	(athena_background_ensure_image_scaled),
	(athena_background_load_image_callback),
	(athena_background_start_loading_image),
	(athena_background_set_image_uri_helper),
	(athena_background_set_image_uri),
	(set_image_and_color_image_loading_done_callback),
	(athena_background_set_image_uri_and_color),
	(athena_background_reset):
	* libathena-extensions/athena-directory-background.c:
	(background_changed_callback), (saved_settings_changed_callback),
	(background_reset_callback):
	* src/athena-sidebar-tabs.c: (draw_one_tab_plain):
	* src/athena-sidebar.c: (receive_dropped_color),
	(background_settings_changed_callback),
	(background_reset_callback), (athena_sidebar_update_appearance),
	(background_metadata_changed_callback), (athena_sidebar_set_uri):
	Fixed various issues with dropping colors on the sidebare.
	Osetensibly, the problem was with dropping white - bug 4880.

2000-12-04  Gene Z. Ragan  <gzr@eazel.com>

	Fixed broken build.
	
	* components/help/converters/gnome-db2html2/sect-preparse.c:
	(sect_preparse_figure_start_element),
	(sect_preparse_acronym_characters), (gloss_term_append):
	File had typos, missing and extra punctuation. The code did not
	even compile. Now it does.

2000-12-04  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-db2html2/sect-preparse.c:
        * components/help/converters/gnome-db2html2/gdb3html.h:
        (sect_preparse_glossterm_characters),
        (sect_preparse_acronym_characters),
        (sect_preparse_glossterm_start_element),
        (sect_preparse_glossterm_end_element),
        (gloss_term_append):
        Changed around the glossary a bit (partial fix for a bug). Leaks some
        memory though.

2000-12-04  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 645, athena_file_rename should handle path separators sensibly
	
	* libathena-extensions/athena-file.c: 
	(athena_file_rename):
	Check for the presence of the "/" path separator charcter. If one
	exists, return an error.
	
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file):
	Add a case to report an error if an illegal name has been specified
	for the file to renamed to.

2000-12-04  John Sullivan  <sullivan@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4931 ("Can't display files of this type"
	message is inaccurate in some cases)

	* src/athena-window-manage-views.c:
	(athena_window_end_location_change_callback):
	Reworded the error message when there's no viewer for a
	file to not mention the file type, since the file type
	might not have anything to do with why no viewer could be
	found. For example, clicking on a remote RPM was getting a
	message implying that Athena had no viewer capable of
	displaying RPM files in general, whereas in fact it has a
	viewer that can display RPM files, but only if local. This
	is the simplest way to address this problem; see bugs
	4932 and 4933 for better but harder-to-implement solutions.

2000-12-04  Pavel Cisler <pavel@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* src/file-manager/fm-directory-view.c: (create_link_callback),
	(offset_drop_points), (fm_directory_view_create_links_for_files):
	Fixed 4946 - Create link consistently crashes Athena.
	Fixed it by implementing the proper positioning code for creating
	symbolic links from a context menu, copying the logic from the
	"Duplicate selection" code path.

2000-12-03  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-softcat.c:	
	(eazel_softcat_initialize):
	Default some of the private attributes to sane values.

2000-12-02  Robert Brady  <robert@suse.co.uk>

	* configure.in (ALL_LINGUAS): Add ta (Tamil).

2000-12-01  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c: (category_clicked_callback):
	fixed bug 4937, changing pane in remove mode crashes Athena,
	by exiting remove mode when switching categories.
	
2000-12-01  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-window-toolbars.c: (theme_changed_callback):
	fixed bug where throbber was mispositioned after theme changes by
	forcing a toolbar resize when the theme changes.
	
	* icons/eazel/i-directory.xml:
	tweaked folder emblem positions
	
2000-12-01  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/athena-tree-view.c
	(athena_tree_view_insert_model_node): Fix bug 4930 (Tree sidebar
	panel doesn't expand remembered directories until second window is
	opened) by making sure to expand directories that should be
	expanded when initially inserting nodes, not just updating.

2000-12-01  Eskil Heyn Olsen  <eskil@eazel.com>

	Migrated more code into eazel-package-system and finished
	eazel-package-system-rpm3 (except for verify). This fixes 4858,
	4851.
	
	* components/services/install/command-line/eazel-test-packsys.c:
	(test_packagelist_prune), (test_package_load), (get_password_dude),
	(init_package_system), (test_matches_query), (get_package_list),
	(start_signal), (end_signal), (progress_signal), (is_installed),
	(test_install), (test_uninstall), (test_verify), (main):D
	All the code for the packagesytem test programs. It does test-
	queries, install and uninstall.
	
	* components/services/install/lib/Makefile.am:
	Moved softcat .h's files into
	includedir/libtrilobite/eazel/package-sytem/
	
	* components/services/install/lib/eazel-install-corba-callback.c:
	(eazel_install_callback_initialize):
	Fixed the IDL rename, which broke the eazelinstall init.
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_start_transaction):
	Some comments about codepieces that needs removal.
	
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_get_readable_name), (packagedata_get_name):
	Changed get_readable's names output for rpmid's.
	Added a function that returns name-version-release names.
	
	* components/services/install/lib/eazel-package-system-rpm3.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(make_rpm_argument_list), (destroy_string_list),
	(rpm_make_names_to_package_hash), (clear_name_to_package),
	(get_total_size_of_packages), (monitor_rpm_process_pipe),
	(rpm_create_db), (rpm_create_dbs), (rpm_open_db), (rpm_open_dbs),
	(rpm_close_db), (rpm_close_dbs), (rpm_free_db), (rpm_free_dbs),
	(rpm_packagedata_fill_from_rpm_header),
	(rpm_packagedata_fill_from_file), (rpm_packagedata_new_from_file),
	(eazel_package_system_rpm3_load_package),
	(eazel_package_system_rpm3_query_impl),
	(eazel_package_system_rpm3_query_substr),
	(eazel_package_system_rpm3_query_foreach),
	(eazel_package_system_rpm3_query), (display_arguments),
	(monitor_subcommand_pipe), (eazel_package_system_rpm3_execute),
	(eazel_package_system_rpm3_install_uninstall),
	(eazel_package_system_rpm3_install),
	(eazel_package_system_rpm3_uninstall),
	(eazel_package_system_rpm3_verify),
	(eazel_package_system_rpm3_finalize),
	(eazel_package_system_rpm3_initialize),
	(eazel_package_system_rpm3_new),
	(eazel_package_system_implementation):
	Finished the rpm3 library.

	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_load_implementation),
	(eazel_package_system_load_package), (eazel_package_system_query),
	(eazel_package_system_install), (eazel_package_system_uninstall),
	(eazel_package_system_verify), (eazel_package_system_emit_start),
	(eazel_package_system_emit_progress),
	(eazel_package_system_emit_failed),
	(eazel_package_system_get_debug), (eazel_package_system_set_debug),
	(eazel_package_system_class_initialize),
	(eazel_package_system_initialize),
	(eazel_package_system_marshal_BOOL__ENUM_POINTER_POINTER),
	(eazel_package_system_marshal_BOOL__ENUM_POINTER):
	Fixed the usual signal bloopers, added the arguments to _new that
	lets the system get it's dbpaths/root sets, fixed other small bugs.

	* components/services/install/lib/eazel-package-system-skeleton.h:
	* components/services/install/lib/eazel-package-system-skeleton.c:
	(eazel_package_system_skeleton_query),
	(eazel_package_system_skeleton_install),
	(eazel_package_system_skeleton_uninstall),
	(eazel_package_system_skeleton_verify),
	(eazel_package_system_skeleton_new),
	(eazel_package_system_implementation):
	Updated the skeleton library.

2000-12-01  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: added libeazelsoftcat libs

2000-12-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Worked around without fixing cause of bug 2151 (crash in
	Undo manager on quit). We can defer fixing the bug properly
	until we have Undo working again.

	* libathena-extensions/athena-undo-signal-handlers.c:
	(athena_undo_editable_set_undo_key): Added FIXMEs with bug
	number 3515 ("Undo doesn't work").
	* src/athena-shell-ui.xml: Added FIXME with bug number 3515.

	* src/file-manager/fm-properties-window.c: (create_basic_page),
	(create_properties_window_callback): #ifdeffed out undo code
	and added FIXME with bug number 2151.

2000-12-01  Pavel Cisler <pavel@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(progress_dialog_set_to_from_item_text), (handle_xfer_ok),
	(handle_xfer_vfs_error), (handle_xfer_overwrite), (get_link_name),
	(athena_file_operations_copy_move),
	(athena_file_operations_new_folder),
	(athena_file_operations_move_to_trash),
	(athena_file_operations_delete), (do_empty_trash):
	
	Fixed 3392 - Messages in athena-file-operations hard to localize.

	Replaced all the cases that did "clever" string composition from
	parts depending on the specific file operation with full texts of
	the respective error alerts and progress dialog label texts and
	titles.
	Changed action_verb to action_label.
	Got rid of progress_dialog_set_files_done_text because the the
	"Files copied:" etc. label is no longer composed.
	Added switch statements in handle_xfer_vfs_error that choose the
	right error text based on the xfer operation kind.
	
	Fixed 3139 - Add comments to all the localizable strings to make them
	easier to localize. 
	
	* libathena-extensions/athena-file-operations.c:
	(icon_position_iterator_new),
	* libathena-extensions/athena-file-operations.h:
	(athena_file_operations_copy_move),
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_get_icon_locations),
	(athena_icon_container_get_selected_icon_locations):
	* libathena-extensions/athena-icon-container.h:
	* libathena-extensions/athena-icon-dnd.c:
	(handle_nonlocal_move), (athena_icon_container_find_drop_target):
	* libathena-extensions/athena-icon-private.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize_class), (duplicate_callback),
	(fm_directory_view_create_links_for_files), (offset_drop_points),
	(fm_directory_view_duplicate_selection),
	(fm_directory_get_selected_icon_locations),
	(fm_directory_view_move_copy_items):
	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_get_selected_icon_locations),
	(fm_icon_view_set_selection), (fm_icon_view_initialize_class),
	(icon_view_move_copy_items):
	* src/file-manager/fm-list-view.c: (fm_list_view_initialize_class),
	(fm_list_view_get_selected_icon_locations),
	(fm_list_view_sort_items):

	Fixed 2817 - when you duplicate a file, it doesn't end up in the correct
	position.

	Redid the icon position array to use GArray instead of a simple vector of
	GdkPoints. GArray contains the count of all the contained points
	which is now needed.
	Added new calls to get the icon locations of selected icons and
	of a list of AthenaIcon objects.
	Passed the list of icon locations to the duplicate method.
	Added a default signal handler that returns the list of
	icon locations of selected icons.
	Added code to fm_directory_view_duplicate_selection that
	offsets the new duplicates to the left and bottom of the
	original item.
	

2000-12-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fixed bug 4911 (Crash emptying trash while displaying
	properties window for trashed file)

	This crawled out of the woodwork recently, and required
	several small fixes here and there to solve it nicely,
	including making FMPropertiesWindow a subclass --
	formerly it was just a GtkWindow with a bunch of wired-up
	widgets.

	* libathena-extensions/athena-file.c:
	(athena_file_get_directory_item_count),
	(athena_file_get_deep_counts): Allow non-directory items
	(files marked gone don't count as directories). Fill in
	return values in all cases, even return_if_fail cases.
	
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file): Specific error message for
	the case where the file being renamed no longer exists. I
	ran into this partway through my changes, tested this fix,
	then changed the caller to not hit this case.
	
	* src/file-manager/fm-properties-window.h:
	Standard header stuff now that FMPropertiesWindow is a class
	and not just some grouped functions.
	* src/file-manager/fm-properties-window.c:
	(fm_properties_window_initialize_class),
	(fm_properties_window_initialize): Standard functions needed
	for class.
	(name_field_done_editing): Don't try to rename file that's gone.
	(create_group_menu_item), (create_owner_menu_item): 
	Added some parameter checking.
	(synch_groups_menu), (synch_owner_menu): Check for NULL result
	from athena_file_get_string_attribute before making a menu
	item from it (GTK is unhappy with using NULL for a label).
	(directory_contents_value_field_update): Soften assert to make
	it not fire when file is gone.
	(update_permissions_check_button_state): Bail out if file is gone.
	(create_properties_window): Create an FMPropertiesWindow instead
	of a GtkWindow; set up its Details.
	(create_properties_window_callback): Removed signal handler for
	"destroy" now that there's a default handler for this class.
	(forget_properties_window): Removed function, guts now in 
	real_destroy.
	(real_shutdown): Disconnect file-changed signal here. This is the
	core fix of the infinite loop reported in bug 4911.
	(real_destroy): Do the stuff formerly done in 
	forget_properties_window here.

2000-12-01  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-window.c: (athena_window_destroy):
	fixed bug 4921, crash when changing sidebar panels preferences
	after opening new window, by fixing the call to remove the
	preferences callback to have the right callback data.
	
2000-12-01 John Fleck <jfleck@inkstain.net>

	* athena/components/help/converters/gnome-db2html2/gdb3html.h,
	sect-elements.c, sect-preparse.c,toc-elements.c: add support for
	<example> tag, fixing bug #4378
	
2000-12-01  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	* components/tree/athena-tree-view.c:
	(expand_uri_sequence_and_select_end): Avoid forcing a reload of a
	node while trying to find a location to select unless we get
	stuck; and even then, do only a shallow force reload, not a deep
	force reload. This fixes bug 4890 (Tree view makes normal
	navigation very slow if a large directory is expanded).
	(reload_model_node_recursive): Renamed from `reload_model_node' to
	make clear that it will also reload all expanded subnodes.
	(reload_model_node): Non-recursive version of
	`reload_model_node_recursive'.
	(reload_whole_tree, expand_node_for_file): Use
	`reload_model_node_recursive' instead of the new non-recursive
	version.
	(athena_tree_view_remove_model_node,
	(athena_tree_view_update_model_node): Added ifdef'd-out
	debugging text for future use.
	
2000-11-30  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>
	
	* components/tree/athena-tree-model.c (report_node_changed):
	Don't do anything if we don't know the file type yet, since this
	may cause directories to mistakenly lose their children. This
	fixes bug 4912 (Athena crashes in tree code when multiple
	windows are open).

	* components/tree/athena-tree-view-private.h: Remove unused
	file_to_hack_node_map field from details struct.

2000-11-30  Robey Pointer  <robey@eazel.com>

	* components/rpmview/Makefile.am:
	* components/services/install/command-line/Makefile.am:
	* components/services/install/athena-view/Makefile.am:
	* components/services/install/server/Makefile.am:

	Everyone that uses libeazelinstall now needs to use
	libeazelsoftcat too.  This doesn't make much sense for the rpm
	view, but we've shelved that issue for later.
	
	* components/services/install/command-line/eazel-test-softcat.c:
	(main):

	New test program (eazel-softcat) to perform primitive softcat
	queries and check the results.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):

	Removed get_search_url_for_package and get_url_for_package: they
	now belong to libesc.
	
	* components/services/install/lib/eazel-install-types.c:
	(eazel_install_protocol_as_string), (packagedata_new),
	(packagedata_copy), (packagedata_fill_in_missing),
	(packagedata_destroy), (gstr_indent), (dump_package_list),
	(packagedata_dump_int), (packagedata_dump):
	* components/services/install/lib/eazel-install-types.h:

	Add "features" field which is a GList<char *> of features this
	package resolves for its parent.  Moved fill_in_missing here since
	it's PackageData-centric.  Added debugging function for dumping a
	PackageData into a human-readable string.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_list), (osd_parse_dependency),
	(osd_parse_implementation), (osd_parse_softpkg),
	(eazel_install_packagelist_parse):
	* components/services/install/lib/eazel-install-xml-package-list.h:

	Parse the "provides" list from softcat: this will change once
	softcat finishes revising their XML format, but we need something
	to work with for now.  Pull out other values like the Eazel id,
	and tie "abstract" to summary instead of description.  Fix the OSD
	parser so that we can distinguish an error return from an empty
	package list.
	
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_initialize), (eazel_softcat_new),
	(eazel_softcat_set_server), (eazel_softcat_get_server),
	(eazel_softcat_set_cgi_path), (eazel_softcat_get_cgi_path),
	(eazel_softcat_set_authn), (eazel_softcat_get_authn),
	(eazel_softcat_set_retry), (eazel_softcat_error_string),
	(sense_flags_to_softcat_flags), (gnome_vfs_escape_string),
	(add_to_url), (verify_softcat_fields),
	(get_search_url_for_package), (eazel_softcat_get_info):
	* components/services/install/lib/eazel-softcat.h:

	Actually implement a good chunk of the softcat library.
	
	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.c: (trilobite_get_distribution_enum),
	(trilobite_get_distribution_arch):
	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.h:

	Move architecture detection here.
	
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_fetch_uri), (trilobite_init),
	(trilobite_set_debug_mode), (trilobite_set_log_handler):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h
	:

	Split out log handling so that test programs can trap trilobite
	log entries.
	
2000-11-30  Rebecca Schulman  <rebecka@eazel.com>
	Fixed bug 3750, to make cut/copy/paste work
	in the complex search bar

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* src/athena-complex-search-bar.h:
	* src/athena-complex-search-bar.c:
	(athena_complex_search_bar_new),
	Set up the first criterion after we create 
	the bar.
	(athena_complex_search_bar_set_up_enclosed_entry_for_clipboard):
	add a second procedure that new criteria with entries call
	when they are added.
	* src/athena-search-bar-criterion.c:
	(athena_search_bar_criterion_new_with_type):
	set an entry up for the clipboard, if one exists.

2000-11-30  Mike Fleming  <mfleming@eazel.com>

	reviewed by: ramiro@eazel.com

	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize),
	(mozilla_net_state_callback), (mozilla_net_stop_callback),
	(mozilla_progress_callback):

	fix bugzilla.eazel.com 4113: 
	Some web pages never finish loading (throbber spins)

	Instead of replying on "max_progress == cur_progress"
	doing mozilla_progress_callback, stop throbber on a "net_stop"
	signal.  Galeon uses "net_stop" for this functionality as well.

2000-11-30  Darin Adler  <darin@eazel.com>

	Ran check-headers-in-Makefile since we had some problems
	with that lately. I guess the Tinderbox is the new way to
	catch these problems but I couldn't resist fixing them
	the old way too.

	* check-headers-in-Makefile.pl: Added some more special cases
	in here to make it work better.

	* components/services/install/athena-view/Makefile.am:
	Marked the unused files in here as "noinst_HEADERS" as a hack
	to make the script happy. We should delete the files at some
	point if we decide we aren't ever using them.

	* components/loser/content/.cvsignore:
	* components/loser/sidebar/.cvsignore:
	* components/mozilla/.cvsignore:
	* components/sample/.cvsignore:
	* components/services/install/command-line/.cvsignore:
	* libathena/.cvsignore:
	* src/.cvsignore:
	* src/file-manager/.cvsignore:
	Removed all the .xml.h files because they aren't put in these
	directories any more so they don't need to be ignored. If you
	have the files still and the cvs warnings bother you, you can
	delete them.

2000-11-30  Andy Hertzfeld  <andy@eazel.com>

	* components/image-viewer/athena-image-view.c:
	(zoomable_zoom_in_callback):
	fixed bug in image viewer where zooming in skipped a level if you
	were zoomed to fit. Fixed by only incrementing the index if we're
	already at the current level.
	
2000-11-30  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4879, "unknown sort mode" warning upon sorting
	by "Time" column.

	The problem was caused by the sort mode enumeration being
	out of sync with the number of columns.  As a result
	most sorts were being done incorrectly with the wrong
	sort function. A new SORT_BY_YEAR entry was added to
	the sort enumeration to fix the problem.
	
	* components/music/athena-music-view.c: 
	(sort_song_list):
	Add SORT_BY_YEAR case to switch statement.

	(sort_by_year):
	New sort function to sort by year.

2000-11-30  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3891, Repeatedly clicking the "Play" button
	crashes Athena.
	
	* components/music/athena-music-view.c: 
	(play_button_callback): Don't start playback machinery
	if a file is already playing.

	* components/music/mpg123_handler.c: (start_playing_file):
	Add check for playback before starting playback of another
	file.
	
2000-11-30  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3888, Deleting an MP3 file while in use -> Athena crashes

	Added a check for the existence of a file before beginning playback.
	If the file is no longer available, remove the file form the 
	song list and attempt to play the next file in the song list.

	* components/music/athena-music-view.c:
	(athena_music_view_initialize), (play_current_file):

2000-11-30  John Sullivan  <sullivan@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	Fixed bug 4899 (Bookmark for nonexistent file can cause
	infinite loop at startup)

	Changed AthenaBookmark's internal logic so that it doesn't
	keep around a file object for known non-existent URIs. The
	trick is to get it to notice when the URI is no longer non-existent
	and get a fresh file object then. This is done imperfectly, but
	the new symptom is very minor and deferrable (wrote it up as bug 4906).

	* libathena-extensions/athena-bookmark.c:
	(athena_bookmark_connect_file): Don't get a new AthenaFile
	object if we know the URI doesn't exist; instead just set the
	missing-bookmark icon. Also made it safe to call this routine
	when there's already a file object in hand (just bails out early).
	(athena_bookmark_get_icon), (athena_bookmark_get_uri): 
	Call athena_bookmark_connect_file so that it will connect to a 
	now-existing file if possible (and thus	get the right icon).
	Since callers that try to activate the bookmark will call get_uri,
	one way to kick a reincarnated bookmark's icon into appearing is
	to select it in a menu.
	(athena_bookmark_get_pixbuf): Call athena_bookmark_get_icon to
	benefit from its connect_file logic.


	Fixed bug 3847 (Icon in properties window flashes while 
	folder count increments)

	* libathena-extensions/athena-image.c:
	(athena_image_set_pixbuf): Don't call gtk_widget_queue_resize if
	the pixbuf hasn't changed.


	Fixed bug 1454 (Properties dialog needs mucho tweaking)

	Mostly this was changes to match Arlo's design that he gave me
	ages ago. I also fixed a few other problems.

	* libathena-extensions/athena-file.c:
	(athena_file_get_date_as_string): Change format of date
	strings from "<date> <time>" to "<date> at <time>" to match
	Arlo's design.
	* src/file-manager/fm-properties-window.c: 
	(attach_label): Now handles requests for a bold font.
	(attach_value_label): Renamed from attach_left_aligned_label, use bold 
	font here.
	(attach_value_field),(attach_directory_contents_value_field):
	updated for name change.
	(attach_right_aligned_label): Removed, guts moved to caller.
	(attach_title_field): Use bold font here.
	(attach_option_menu): New helper function to share code between
	attach_group_menu and attach_owner_menu; now uses gtk_alignment
	to make the menu be minimally-sized and left-aligned.
	(attach_group_menu), (attach_owner_menu): Use attach_option_menu.
	(attach_separator): New helper function to install a separator
	across both columns of a properties window table.
	(create_basic_page): Use gtk_alignment to make the icon right-aligned;
	make the blank row above date rows be standard height.
	(create_emblems_page): Changed layout so name appears below emblem
	rather than to its right; this matches Customize window and allows
	the Properties window to be a smaller width, which looks much better
	for the other panes. Also, the emblems are now layed out lrtb instead of
	tblr.
	(add_permissions_column_label): Make these labels bold.
	(add_special_execution_flags): Attach a separator.
	(get_adjusted_permissions_row): Helper function to account for the "special
	flags" rows, which are not always displayed.
	(create_permissions_page): Deploy get_adjusted_permissions_row wherever a
	raw row number was used; insert separators.
	(create_properties_window): Allow window to be stretched, since the emblems
	don't all fit at initial window height (so user can stretch rather than
	scrolling if desired).

2000-11-30  Rebecca Schulman  <rebecka@eazel.com>
	Fix for bug 2438, that we need to handle bad user
	input when searching by size.  

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/athena-complex-search-bar.c: (criteria_invalid):
	Add a check in here for size criteria specifically,
	that declares the criteria invalid if there is a
	non-integer value in the entry.

2000-11-30  Andy Hertzfeld  <andy@eazel.com>

	* components/text/athena-text-view.c: (add_one_service),
	(add_services_to_menu), (update_service_menu_items):
	only disable selection dependent services when there's no selection.
	
2000-11-30  Andy Hertzfeld  <andy@eazel.com>

	* components/text/services/Makefile.am:
	* components/text/services/english_to_french.xml:
	added sample document-oriented text view service.
	
2000-11-29  Gene Z. Ragan  <gzr@eazel.com>

	Fixed part of bug 2171. Garbage was appearing in the song
	duration text field. This was cause by not reading in the 
	MP3 header data. In most cases this is due to the presence 
	of an ID3v2 at the start off the file.  We check for this and
	hop over it if such data is present.
	
	* components/music/mp3head.c: (get_bitrate), (get_samprate),
	(get_stereo), (compare), (sync_scan), (sync_test), (find_sync),
	(get_header_info), (get_header_info_extended):
	Some addition header handling functions for better diagnostics.
	
	* components/music/mp3head.h:
	Added function prototypes and ID3v2 header structure.
	
	* components/music/athena-music-view.c: 
	(fetch_song_info),
	(athena_music_view_update):

2000-11-30  Andy Hertzfeld  <andy@eazel.com>

	* components/text/athena-text-view.c:
	(athena_text_view_initialize), (add_one_service),
	(athena_text_view_build_service_menu),
	(update_service_menu_items):
	made the service menu items be enabled and disabled appropriately
	based on whether there's a selection or not, by attaching to the
	button_release_event and key_press_event of the text object
	
2000-11-29  Eskil Heyn Olsen  <eskil@eazel.com>

	* athena.spec.in:
	One more fix, forgot a */ level.

2000-11-29  Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/athena-directory-async.c
	(athena_directory_forget_file_attributes): Fix build problem.

2000-11-29  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/Makefile.am:
	Fixed noinst blunders.

2000-11-29  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bugs 4385 (Athena doesn't gracefully handle deleting
	in-use image file), 3240 (reloading a directory doesn't update
	directory counts of the entries) and 4683 (embedded text on icon
	isn't updated when text changes) by implementing forgetting of
	file attributes and using it when appropriate.

	Also fixed various other bugs caught by testing of these fixes or
	reading the code.

	* libathena-extensions/athena-file.c: 
	(athena_file_forget_attributes): New function that makes the
	file forget the specified attributes, including cancelling
	possible in-progress I/O for them, and kicking off new I/O if
	anyone is monitoring any of the attributes or has a pending
	call_when_ready.
	(athena_file_forget_attributes_internal): Forget all attributes
	of this file, *not* including cancelling in-progress I/O, or
	kicking off new I/O. This is for the benefit of AthenaDirectory
	being able to forget the attributes of all files it is monitoring
	at one go.
	(athena_file_forget_all_attributes): Forget all attributes of
	this file, including cancelling in-progress I/O, and kicking off
	new I/O.
	(forget_directory_count, forget_deep_counts, forget_mime_list,
	forget_top_left_text, forget_file_info, forget_activation_uri):
	Helper functions to forget individual attributes.
	(athena_file_forget_activation_uri): Removed as obsolete.
	(destroy): use `athena_g_list_free_deep' to free the mime list.

	* libathena-extensions/athena-directory-notify.h: Remove
	prototype for `athena_file_forget_activation_uri'.

	* libathena-extensions/athena-file-private.h: Prototype
	`athena_file_forget_attributes_internal'.

	* libathena-extensions/athena-file.h:
	`athena_file_forget_attributes' and
	`athena_file_forget_all_attributes'.

	* libathena-extensions/athena-link.c
	(athena_link_local_set_link_uri): Use
	`athena_file_forget_attributes', not
	`athena_file_forget_activation_uri' to ensure reload of the
	activation URI.
	(forget_file_activation_uri): Helper function for the above.
		
	* libathena-extensions/athena-directory-async.c
	(athena_directory_cancel_loading_file_attributes): Function to
	cancel in-progress I/O for a given set of attributes but only if
	it is in progress for the specified file. This function is used to
	implement part of `athena_file_forget_attributes'.
	(cancel_directory_count_for_file, cancel_deep_counts_for_file,
	cancel_mime_list_for_file, cancel_top_left_text_for_file,
	cancel_file_info_for_file, cancel_activation_uri_for_file): Helper
	functions for the above.
	(athena_directory_force_reload): Add a `file_attributes'
	argument and make sure to forget the specified
	attributes. Forgetting the attributes fixes bugs 3240 and 4683.
	(athena_directory_forget_file_attributes): Function to forget
	the specified attributes for all files. It makes sure to only
	cancel and kick off new I/O once.
	(cancel_loading_attributes): helper function for the above that
	cancels in-progress loads for the specified attributes, regardless
	of for what file.
	(request_is_satisfied): The request is not satisfied if the
	request calls for top left text and the file lacks it.	
	(top_left_read_callback): Set 1got_top_left_text' field of the
	AthenaFile to TRUE. This problem was masked by the problem with
	`request_is_satisfied' fixed above.
	(set_up_request_by_file_attributes): Make sure to request the
	file_info as well if top left text is requested, since
	applicability of top left text depends on the mime type.
	(get_info_callback): Mark the file gone if we get
	GNOME_VFS_ERROR_NOT_FOUND; we can only get this error for files
	gnome-vfs should know about but that do not exist. This is needed
	to detect files that are removed on a reload.

	* libathena-extensions/athena-directory-private.h: Update
	prototype for `athena_directory_force_reload'; Prototype
	`athena_directory_cancel_loading_file_attributes'

	* libathena-extensions/athena-vfs-directory.c
	(vfs_file_monitor_add): Pass the file attributes to
	`athena_directory_force_reload' since it now wants them.

	* src/athena-window-manage-views.c
	(viewed_file_changed_callback): Cancel location change before
	closing the window, since detecting the file is gone is now likely
	to happen in the middle of an in-progress reload, and we get
	crashes if this is not done.	
	(athena_window_begin_location_change): If we're doing a reload,
	forget all file attributes of the AthenaFile for the currently
	viewed location. This is to make sure we detect if the file is
	gone, and also update the sidebar panel icon and other info
	appropriately. This fixes bug 4385.

2000-11-29  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/Makefile.am:
	* components/services/install/command-line/eazel-test-packsys.c:
	(make_package), (test_packagelist_prune), (test_package_load),
	(init_package_system), (test_matches_query), (main):
	Some code to test some of the packagesystem functions
	
	* components/services/install/lib/Makefile.am:
	build the skeleton and rpm3 package system

	* components/services/install/lib/eazel-install-corba-callback.c:
	(eazel_install_callback_simple_query):
	Fixed indentation
	
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_set_arg), (eazel_install_class_initialize),
	(eazel_install_initialize):
	added ssl_rename and ignore_file_conflicts to the gtkarg sytem.
	Added some comments reg. bug 4851

	* components/services/install/lib/eazel-install-problem.c:
	(find_dominant_problems):
	Null input if empty
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_start_transaction_make_rpm_argument_list):
	Fixed a uninstall bug in the rpm arg building.
	
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_list_prune):
	Implemented a function to prune a list of packagedata objects from
	another list.
	
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(get_and_set_string_tag), (rpm_packagedata_fill_from_rpm_header),
	(rpm_packagedata_fill_from_file), (rpm_packagedata_new_from_file),
	(eazel_package_system_rpm3_load_package),
	(eazel_package_system_rpm3_query_impl),
	(eazel_package_system_rpm3_query_substr),
	(eazel_package_system_rpm3_query_foreach),
	(eazel_package_system_rpm3_query),
	(eazel_package_system_rpm3_install),
	(eazel_package_system_rpm3_uninstall),
	(eazel_package_system_rpm3_verify),
	(eazel_package_system_rpm3_open_roots),
	(eazel_package_system_rpm3_finalize),
	(eazel_package_system_rpm3_class_initialize),
	(eazel_package_system_rpm3_initialize),
	(eazel_package_system_rpm3_get_type),
	(eazel_package_system_rpm3_new),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-rpm3.h:
	* components/services/install/lib/eazel-package-system-skeleton.c:
	(eazel_package_system_skeleton_load_package),
	(eazel_package_system_skeleton_query),
	(eazel_package_system_skeleton_install),
	(eazel_package_system_skeleton_uninstall),
	(eazel_package_system_skeleton_verify),
	(eazel_package_system_skeleton_finalize),
	(eazel_package_system_skeleton_class_initialize),
	(eazel_package_system_skeleton_initialize),
	(eazel_package_system_skeleton_get_type),
	(eazel_package_system_skeleton_new),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-skeleton.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_suggest_id),
	(eazel_package_system_load_implementation),
	(eazel_package_system_load_package), (eazel_package_system_query),
	(eazel_package_system_install), (eazel_package_system_uninstall),
	(eazel_package_system_verify), (eazel_package_system_emit_start),
	(eazel_package_system_emit_progress),
	(eazel_package_system_emit_failed),
	(eazel_package_system_emit_end),
	(eazel_package_system_class_initialize),
	(eazel_package_system_initialize), (eazel_package_system_new_real),
	(eazel_package_system_new_with_id), (eazel_package_system_new),
	(eazel_package_system_marshal_BOOL__POINTER_ENUM_POINTER_POINTER),
	(eazel_package_system_marshal_BOOL__POINTER_ENUM_POINTER):
	* components/services/install/lib/eazel-package-system.h:
	working on 4850, 4851, 4852 and 4858.
	
	* components/services/trilobite/libtrilobite/libtrilobite.h:
	
	* athena-installer/src/callbacks.c: (begin_install):
	* athena-installer/src/installer.c: (skip_over_remove_problems),
	(jump_to_retry_page), (install_done), (go_live),
	(eazel_installer_add_category), (eazel_installer_do_install),
	(eazel_installer_post_install), (draw_splash_text),
	(eazel_installer_set_default_texts), (eazel_installer_initialize):
	* athena-installer/src/installer.h:
	The last of the pr2.1 stuff.
	
	* athena.spec.in:
	devel package includes libtrilobite/eazel/*

2000-11-29  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed some problems with callbacks that are left around after
	the object is destroyed.

	* src/athena-window-manage-views.h:
	* src/athena-window-manage-views.c:
	(viewed_file_changed_callback): Changed to be a normal callback,
	not a "connect_object" callback, and simplified the logic.
	(cancel_viewed_file_changed_callback): Added a function to cancel
	the callback, which is needed both when the window is destroyed
	and when the viewed file changes.
	(update_for_new_location): Cancel the old callback before setting
	up the new one so we don't leave behind callbacks for old locations.
	Also use the new athena_window_set_viewed_file function so the
	callbacks set up in athena-window.c can be managed properly.
	(free_location_change): Moved part of
	athena_window_free_load_info in here. This function frees all
	the stuff that's used in the location change process; shared by
	destroy and "cancel" code. Also fixed a bug where it wouldn't free
	the "error_views".
	(cancel_location_change): Moved the rest of
	athena_window_free_load_info in here and made this use the new
	function.
	(disconnect_view): Made this private now that the code to
	disconnect the views is inside this file.
	(disconnect_view_callback),
	(athena_window_manage_views_destroy): Moved the code to clean up
	from athena-window.c in here. Added cleanup for the location
	change fields and for the viewd_file_changed callback.
	
	* src/athena-window.c: 
	(athena_window_destroy): Call a new function to do the
	athena-window-manage-views.c part of the destroy and moved some
	code in there. Cancel the view-as callback too.
	(create_view_as_menu_item),
	(replace_special_current_view_in_view_as_menu),
	(athena_window_synch_view_as_menu): Renamed. The words "view as
	menu" are clearer than "content view menu".
	(chose_component_callback): Got rid of code that tries to handle
	bad values for callback data. The callback must be cancelled,
	because you can't call ATHENA_IS_WINDOW on a freed window and
	expect it to behave predictably.
	(cancel_chose_component_callback): Function to cancel the callback,
	called at both destroy time and before adding a new one.
	(view_menu_choose_view_callback): Cancel the old callback before
	adding a new one.
	(view_menu_vfs_method_callback): Simplify logic a bit.
	(load_view_as_menu_callback): Renamed.
	(cancel_view_as_callback): Function to cancel the callback, called
	at both destroy time and before adding a new one.
	(athena_window_load_view_as_menu): Cancel the old callback before
	adding a new one. Also renamed.
	(athena_window_set_viewed_file): A new function that cancels the
	callbacks on the file object before switching to a new one.
	
	* libathena-extensions/athena-program-choosing.c:
	(athena_cancel_choose_component_for_file): Implemented missing
	cancel function, needed by new window code.
	
	* src/athena-window-private.h:
	* src/athena-window-menus.c:
	(bookmarks_menu_add_bookmark_callback),
	(add_bookmark_for_current_location): Made the function local to
	this file since it's both defined and used here.

	* libathena-extensions/athena-glib-extensions.c:
	* libathena-extensions/athena-volume-monitor.c:
	* libathena/athena-undo-transaction.c:
	* libathena/athena-view.c:
	* librsvg/rsvg.c:
	Added missing "static" to make some local non-"athena_"-prefixed
	globals be internal instead of external.
	
	* src/athena-sidebar.c: Formatting tweaks, added FIXME.

2000-11-29  Ramiro Estrugo  <ramiro@eazel.com>

	* athena.spec.in:
	* README:
	Add esound dependency.  We've used esound to do sound previews and 
	in the Music View, but the the dependency was never reflected in
	the spec file or documentation.
	
2000-11-29  Andy Hertzfeld  <andy@eazel.com>

	* components/text/athena-text-view.c:
	(athena_text_view_load_uri), (text_view_load_location_callback),
	(handle_service_menu_item), (service_menu_item_parameters_new),
	(service_menu_item_parameters_free), (add_one_service):
	added the ability for a text view service to operate on the entire
	document and return a mapped version, which replaces the original.

	* components/text/services/google.xml:
	* components/text/services/webster.xml:
	marked the existing services, which operate on the selection, as such
	
2000-11-28  Andy Hertzfeld  <andy@eazel.com>

	implementated data-driven framework for text view services. The text
	view dynamically builds the services menu by iterating a directory
	looking for xml files.  Added service definition files for two sample
	services.  It only supports passing the selection to the service;
	passing the entire document is coming soon.
		
	* components/text/Makefile.am:
	include the services directory in the build

	* configure.in:
	* components/text/services/.cvsignore:
	* components/text/services/Makefile.am:
	build stuff for services directory

	* components/text/services/google.xml:
	* components/text/services/webster.xml:
	definition files for our twp sample services
			
	* components/text/athena-text-view-ui.xml:
	removed hardwired service menu items
	
	* components/text/athena-text-view.c: (handle_service_menu_item),
	(service_menu_item_parameters_new),
	(service_menu_item_parameters_free), (add_one_service),
	(add_services_to_menu), (athena_text_view_build_service_menu),
	(merge_bonobo_menu_items):
	implemented framework to dynamically load service definitions and
	execute them when their menu item is selected.
	
2000-11-28  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_log):

	Only log debug messages if debug flag is set.
	
	* athena-installer/src/installer.c: (start_logging):
	* athena-installer/src/main.c: (main):

	Add --spam/-x flag to the installer to cause debug logging to go
	to stderr in addition to the logfile.  Make --debug/-d flag not do
	that spamming anymore, and make it turn off debugging logs when
	this flag isn't used.

2000-11-28  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-user-level-manager.c:
	* libathena-extensions/athena-user-level-manager.h:
	Got rid of _get_num_user_levels call.

2000-11-28  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-view-identifier.h: Remove
	HAVE_POPT_H define since the bug in OAF that we were working
	around has been fixed.
	
	* components/music/athena-music-view.c: Remove unneeded
	includes.
	
	* components/rpmview/athena-rpm-view.c: Remove unused
	#define and FIXME for bug already fixed.
	* components/tree/athena-tree-view.c:
	(athena_tree_view_destroy): Remove FIXME for bug already fixed.
	* libathena-extensions/athena-global-preferences.c: Remove
	FIXME for bug already fixed.
	* libathena-extensions/athena-user-level-manager.c: Remove
	FIXME for bug already fixed.
	* src/file-manager/fm-list-view.c: (fm_list_get_default_action):
	Remove FIXME for bug already fixed.
	* src/athena-property-browser.c: (add_background_to_browser):
	Remove FIXME for bug already fixed.
	* src/athena-window.h: Remove FIXME for bug already fixed.
	
	* tools/README: Remove file now that people have had a chance to
	find the tools in their new location, so the directory will go
	away.

2000-11-28  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 4257 (right click on background in icon or list
	view doesn't leave context menus up)

	This was a problem with athena_pop_up_context_menu. It
	wasn't passing the event time, which caused GTK to think
	that the button-release was for a later button press, and
	consequently to close the context menu. It appears that the
	root cause may be a gtk menu handling bug, but this checkin
	fixes the problem as far as Athena is concerned.

	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_pop_up_context_menu): Now takes event as a
	parameter, and passes event->time through to gtk_menu_popup.
	Passes 0 for button if event is a button release, to work with
	subtle logic in gtk popup menu-handling.

	* libathena-extensions/athena-icon-container.h:
	* libathena-extensions/athena-icon-container.c:
	Add event parameters to context-click signal handlers.
	(athena_icon_container_initialize_class): Change signal
	marshal and signature.
	(context_menu_parameters_new), (context_menu_parameters_free):
	New helper functions to manage callback data when delaying
	the appearance of a context menu.
	(button_press_event), (button_release_event),
	(show_context_menu_callback): Pass event when emitting signal.
	(handle_icon_button_press): Pass event as well as container
	to idle callback.
	
	* libathena-extensions/athena-list.h:
	* libathena-extensions/athena-list.c:
	Add event parameters to context-click signal handlers.
	(athena_list_initialize_class): Change signal marshal and
	signature.
	(context_menu_parameters_new), (context_menu_parameters_free):
	New helper functions to manage callback data when delaying
	the appearance of a context menu.
	(athena_list_button_press), (athena_list_button_release),
	(show_context_menu_callback): Pass event when emitting signal
	or setting up idle callback.
	
	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_pop_up_selection_context_menu),
	(fm_directory_view_pop_up_background_context_menu):
	Take event parameter and pass it to
	athena_pop_up_context_menu.
	
	* src/file-manager/fm-icon-view.c:
	(icon_container_context_click_selection_callback),
	(icon_container_context_click_background_callback):
	Add event parameter to match signal change, and pass
	event when calling fm_directory_view_pop_up_xxx
	
	* src/file-manager/fm-list-view.c:
	(context_click_selection_callback),
	(context_click_background_callback):
	Add event parameter to match signal change, and pass
	event when calling fm_directory_view_pop_up_xxx
	
	* src/athena-window-toolbars.c:
	(back_or_forward_button_clicked_callback):
	Pass event for context menu on Back and Forward
	buttons (this code is still #ifdeffed out from Bonobo
	switchover, awaiting fix for bug 3510).

	* src/athena-sidebar.c: (athena_sidebar_press_event):
	Pass event for context menu in sidebar.

	* src/athena-zoom-control.c:
	(athena_zoom_control_button_press_event):
	Pass event for context menu in zoom control.

2000-11-28  Arlo Rose  <arlo@eazel.com>

	* /icons/loading.png:
	* /icons/eazel/fossil.png:
	* /icons/villanova/villanova_green.png:
	Fixed the white point problem on a few PNG files.
	I don't think this got them all.

2000-11-28  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/Makefile.am:

	The real fix has now been found for tinderbox breakage.

2000-11-28  Rebecca Schulman  <rebecka@eazel.com>
	Fixes for bugs 2376, 4553, and 3799
	This should make the complex search bar usable
	and visible.

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* configure.in:
	* libathena-extensions/Makefile.am:
	* cut-n-paste-code/widgets/Makefile.am:
	* cut-n-paste-code/widgets/gimphwrapbox/.cvsignore:
	* cut-n-paste-code/widgets/gimphwrapbox/Makefile.am:
	* cut-n-paste-code/widgets/gimphwrapbox/gtkhwrapbox.c:
	(gtk_hwrap_box_get_type), (gtk_hwrap_box_class_init),
	(gtk_hwrap_box_init), (gtk_hwrap_box_new), (get_child_requisition),
	(_gtk_hwrap_box_size_request), (get_layout_size),
	(gtk_hwrap_box_size_request), (reverse_list_row_children),
	(layout_row), (layout_rows), (gtk_hwrap_box_size_allocate):
	* cut-n-paste-code/widgets/gimphwrapbox/gtkhwrapbox.h:
	* cut-n-paste-code/widgets/gimphwrapbox/gtkwrapbox.c:
	(gtk_wrap_box_get_type), (gtk_wrap_box_class_init),
	(gtk_wrap_box_init), (gtk_wrap_box_set_arg),
	(gtk_wrap_box_get_arg), (gtk_wrap_box_set_child_arg),
	(gtk_wrap_box_get_child_arg), (gtk_wrap_box_child_type),
	(gtk_wrap_box_set_homogeneous), (gtk_wrap_box_set_hspacing),
	(gtk_wrap_box_set_vspacing), (gtk_wrap_box_set_justify),
	(gtk_wrap_box_set_line_justify), (gtk_wrap_box_set_aspect_ratio),
	(gtk_wrap_box_pack), (gtk_wrap_box_reorder_child),
	(gtk_wrap_box_query_child_packing),
	(gtk_wrap_box_query_child_forced_break),
	(gtk_wrap_box_set_child_packing),
	(gtk_wrap_box_set_child_forced_break),
	(gtk_wrap_box_query_line_lengths), (gtk_wrap_box_map),
	(gtk_wrap_box_unmap), (gtk_wrap_box_draw), (gtk_wrap_box_expose),
	(gtk_wrap_box_add), (gtk_wrap_box_remove), (gtk_wrap_box_forall):
	* cut-n-paste-code/widgets/gimphwrapbox/gtkwrapbox.h:
	Copied and pasted the wrapping hbox from the Gimp.
	I made a few modifications, including some resizing requests,
	when the chosen size is not the right one for the actual 
	space available.  Sizing wrapping boxes is a tricky problem
	with gtk, because they have nonstandard sizing requests
	(they can request x or y or z) and my solution is probably
	not optimal, since some of the sizing adjustments are visible
	on screen.  However, a better fix is a lot more time consuming,
	and should probably wait for past 1.0.
	

	* src/athena-complex-search-bar.c:
	(search_bar_criterion_type_changed_callback),
	(queue_search_bar_resize_callback),
	(athena_complex_search_bar_initialize_class),
	(athena_complex_search_bar_initialize), (real_activate),
	(athena_complex_search_bar_queue_resize),
	(attach_criterion_to_search_bar),
	(unattach_criterion_from_search_bar),
	(load_find_them_pixmap_widget), (more_options_callback),
	(fewer_options_callback), (update_options_buttons_state):
	* src/athena-complex-search-bar.h:
	Changed the criteria layout to be in a vbox instead of a table,
	so that we can insert wrapping hboxes.  Added a new function
	that will effectively resize the complex search bar, and we call
	it at appropriate points. Switched the packing order of the
	buttons, since the wrap box has only one packing function, and it is
	a pack_start, rather than a pack_end function
	
	* src/athena-search-bar-criterion-private.h:
	* src/athena-search-bar-criterion.c: (queue_bar_resize_callback),
	(athena_search_bar_criterion_new_from_values),
	(athena_search_bar_criterion_show),
	(athena_search_bar_criterion_hide),
	(athena_search_bar_criterion_update_valid_criteria_choices),
	(hide_date_widget), (show_date_widget), (make_emblem_value_menu):
	Put the criteria into wrapping boxes as part of their creation, and 
	trigger a resize of the complex search bar when the wrapping box 
	complains about its allocated size.
	

2000-11-28  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(fill_canvas_from_gradient_buffer),
	(fill_drawable_from_gradient_buffer),
	(update_drawable_with_pixbuf), (draw_pixbuf_tiled):
	
	Update bug number in FIXME. Fixing some tabbing.

2000-11-28  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/Makefile.am:

	One more try...

2000-11-28  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/Makefile.am:

	Another stab at fixing tinderbox.

2000-11-28  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/Makefile.am:

	Fixing tinderbox build breakage from my last checkin.

2000-11-28  Andy Hertzfeld  <andy@eazel.com>

	fixed bugs 4864, 4865, 4866 abd 4868, involving adding and removing
	items from the property browser, by rewording error messages and
	tweaking some logic.

	* src/athena-property-browser.c: (add_color_to_browser),
	(is_reserved_keyword), (emblem_dialog_clicked), (add_new_emblem),
	(make_properties_from_directories),
	(make_properties_from_xml_node):

2000-11-28  J Shane Culpepper  <pepper@eazel.com>

	* components/services/trilobite/libtrilobite/Makefile.am:

	Fix for bug #3110. Make sure the private headers do not
	get installed.

2000-11-28  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-entry.c:
	(athena_entry_initialize):
	Set cursor_obscured flag to false and update event mask
	to allow pointer moved events.
	
	(athena_entry_motion_notify):
	Display the cursor if it was previouslly hidden.

	(obscure_cursor):
	New function that hides the cursor when the user begins typing.

	(athena_entry_key_press):
	Call obscure_cursor function.
	
	* libathena-extensions/athena-entry.h:
	Added cursor_obscured flag to entry class.
	
	* libathena-extensions/athena-gdk-extensions.c:	
	* libathena-extensions/athena-gdk-extensions.h:
	(athena_gdk_window_set_invisible_cursor):
	New function to hide the cursor of the widget passed in.
	
2000-11-27  Maciej Stachowiak  <mjs@eazel.com>

	* components/text/Makefile.am: Added definition of NULL to shut up
	tinderbox.

2000-11-27  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fixed bugs 3608 (Tree view disclosure triangle behavior on empty
	folders is confusing) and 4368 (Tree View gets confused by
	renaming file in closed folder).
	
	* libathena-extensions/athena-ctree.h: Reindented.

	* libathena-extensions/athena-ctree.c:
	(athena_ctree_realize, athena_ctree_unrealize,
	athena_ctree_button_press, athena_ctree_draw_expander,
	draw_row, athena_ctree_unlink, change_focus_row_expansion,
	athena_ctree_last, athena_ctree_find_node_ptr,
	athena_ctree_find_all_by_row_data): Made AthenaCTree handle
	all expansion and expander-related stuff based on whether the
	node's is_leaf field is set, not based on whether it actually has
	children. This way, by setting is_leaf to FALSE, you can make a
	node with no children expandable.

	* components/tree/athena-tree-view.c:
	(athena_tree_view_insert_model_node, forget_view_node,
	athena_tree_view_update_model_node,
	athena_tree_view_model_done_loading_callback,
	athena_tree_view_initialize, athena_tree_view_destroy),
	expand_node_for_file, insert_hack_node, remove_hack_node,
	freeze_if_have_hack_node): When inserting or updating nodes, set
	is_leaf to FALSE if the node represents a directory, otherwise
	TRUE. Remove all code relating to hack node handling. Combined
	with the change above, this makes normal directories expand
	normally, and prevents directories from collapsing when files
	inside them are renamed.	

2000-11-27  Andy Hertzfeld  <andy@eazel.com>

	* components/music/athena-music-view.c:
	(athena_music_view_initialize):
	fixed bug 4420, non-portable use of string macro, by using the N_
	macro as Darin suggested.
	
	Also, fixed up some glitches in the ChangeLog from previous
	check-ins.
	
2000-11-27  Mathieu Lacage  <mathieu@eazel.com>

	Might fix tinderbox.
	* components/text/Makefile.am:

2000-11-27  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* libathena-extensions/athena-file.c:
	(athena_file_contains_text):
	Fixed bugzilla 4756 - binary files previewed on icons.
	Turned out to be easy - the athena_file_contains_text was 
	over-optimistic. Changed it to only mark for preview actual text files 
	(files with the "text" MIME supertype).

2000-11-27  Andy Hertzfeld  <andy@eazel.com>

	added a new text view component with zooming, settable fonts and
	text-oriented services. The services are currently hardwired but there
	will be a framework soon.  You may have to delete your
	/gnome/share/oaf/text-plain.oafinfo to see it in action.
	
	* configure.in:	
	* components/Makefile.am:
	* components/text/.cvsignore:
	* components/text/Makefile.am:
	build stuff for the new text view
	
	* components/text/main.c: (text_view_object_destroyed),
	(text_view_make_object), (main):
	factory object for the text view
	
	* components/text/athena-text-view-ui.xml:
	xml file defining the menus for the text view

	* components/text/athena-text-view.oafinfo:
	oaf definitions for the text view
	
	* components/text/athena-text-view.h:
	interface file for the text view
	
	* components/text/athena-text-view.c:
	(athena_text_view_initialize_class),
	(athena_text_view_initialize), (detach_file),
	(athena_text_view_destroy),
	(athena_text_view_get_athena_view),
	(athena_text_view_update), (athena_text_view_load_uri),
	(text_view_load_location_callback),
	(athena_text_view_update_font), (get_selected_text),
	(text_view_search_callback), (text_view_lookup_callback),
	(athena_text_view_set_font), (handle_ui_event),
	(merge_bonobo_menu_items), (athena_text_view_zoom_to_level),
	(athena_text_view_bump_zoom_level), (zoomable_zoom_in_callback),
	(zoomable_zoom_out_callback), (zoom_index_from_float),
	(zoomable_set_zoom_level_callback),
	(zoomable_zoom_to_fit_callback):
	implementation for the text view
		
	* libathena-extensions/athena-icon-container.c:
	(lay_down_icons_horizontal):
	fixed bug 3485, icon layout not using all of the available space, by tweaking the
	code to not require the extra space between the columns
	
2000-11-27  Darin Adler  <darin@eazel.com>

	* athena.spec.in: Removed a file that's no longer present.
	This is another crack at fixing the Tinderbox.

	* components/services/install/lib/.cvsignore: Ignore the
	new .la file too.

2000-11-27  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: added check for esd via m4 macro.

2000-11-27  Gene Z. Ragan  <gzr@eazel.com>

	buddy: Pavel Cisler <pavel@eazel.com>

	We now use the "noauto" flag in the fstab entry for the device
	to determine if the volume is removable. This is still imperfect,
	but much better than the enumerated case that was being used before.
	
	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_volume_is_removable),
	(athena_volume_monitor_get_removable_volumes),
	(mnttab_add_mount_volume), (mntent_add_mount_volume):

	* libathena-extensions/athena-volume-monitor.h:
	Added is_removable field to AthenaVolume struct.
	
2000-11-27  Darin Adler  <darin@eazel.com>

	* components/services/install/lib/Makefile.am:
	Makefile listed ".o" files instead of sources, making srcdir ==
	builddir builds not compile anything! Fixed so the files are
	compiled even when srcdir == builddir; this makes us all see the
	errors we were previously seeing only on the Tinderbox.
	
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_class_initialize):
	* components/services/install/lib/eazel-softcat.h:
	Tweaked and disabled enough code so it builds now. This fixes the
	Tinderbox build.

2000-11-27  Andy Hertzfeld  <andy@eazel.com>

	* icons/Makefile.am:
	* icons/eazel/i-directory-*:
	* icons/emblem-changed.gif:
	* icons/emblem-encrypted.gif:
	* icons/emblem-remote.gif:
	
	removed some ancient, unused emblem images, and added updated
	folder icons in eazel theme from Susan.
		
2000-11-27  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-icon-container.c:
	(hide_rename_widget):
	* libathena-extensions/athena-icon-dnd.c:
	(create_selection_shadow):
	Remove two different FIXMEs about using gtk_object_destroy instead
	of gtk_object_unref. It turns out that for widgets, destroy is the
	right way to let go.

2000-11-27  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-directory-view.c: (real_update_menus):
	fixed bug where the "Reset Background" command in the icon view
	was not being disabled when the background was the default.
	
2000-11-27  Rebecca Schulman <rebecka@eazel.com>
	(committed under eli@eazel.com)

	* components/services/install/lib/eazel-softcat.h:
	Added a couple of missing semicolons, which hopefully will
	make tinderbox happy.

2000-11-27 John Fleck <jfleck@inkstain.net>

	* components/help/converters/gnome-db2html2/sect-elements.c
	add line to sect_author_characters to print out contents of author
	tag; fixing bug #4801
	
	elements in body of doc

2000-11-26  Maciej Stachowiak  <mjs@eazel.com>

	Some build fixes to make tinderbox happy.

	* components/services/install/lib/eazel-package-system-private.h:
	Add return types (randomly guessed `void') to function pointer
	members of structs.

	* components/services/install/lib/eazel-package-system.h: Don't
	include the private header in the public header. Add some
	semicolons after some typedefs. Add a missing comma in an enum
	declaration. Add prototype for `eazel_package_system_unref'.

	* components/services/install/lib/Makefile.am: Comment out
	libeazelpackagesystem.la from the build, since even after these
	changes it won't compile.

2000-11-25  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-db2html2/sect-preparse.c:
        (sect_preparse_sect_start_element):
        Allow navigation links at the end of the glossary (this makes sure
        </BODY> and </HTML> tags are added)

2000-11-24  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/help-method.c:
        (old_help_file): Removed
        (find_help_file): Change this code to make it more consistant and
        clear. I think it also made it go from O(n^2) to O(n) for the case
        of HTML files (even though in practice this may not mean much since n
        is small). Anyway, this is a better fix for bug #4724

2000-11-23  Ali Abdin  <aliabdin@aucegypt.edu>

	Preliminary glossary supports.
	Fix bug #2399, #4702, #4724. Partial fix for #4724
	(a few of the above are thanks to patches/mails from
	jfleck@inkstain.net)
	Some other misc. bug-fixing.
	Cleaned up some code.
	Preliminary glossary support (thanks to a patch by
	jfleck@inkstain.net)
	
	* components/help/help-method.c:
	(file_in_info_path):
	Fix a typo preventing it from searching /usr/gnome/info
	Add in support for /usr/share/info directory for Debian (hopefully
	this fixes bug #4414)
	(transform_file),
	(find_help_file): Move the searching for HTML files into the
	find_help_file function to make things consistant. Fixes bug #4724

	* components/help/converters/gnome-db2html2/gdb3html.c:
	(init_entities): Conver entities to use a table, and add support for
	iso-latin characters (for i18n purposes).
	(parse_file): set version to XML_DEFAULT_VERSION, fixes bug #2399
	#if 0'd out a useless call to a function
	(xml_parse_file): #if 0'd out this function since we no longer use it
	
	* components/help/converters/gnome-db2html2/sect-elements.c:
	(sect_figure_start_element): 
	Increment the figure count as soon as we enter (instead of when we
	leave) (should fix #4702)

	* components/help/converters/gnome-db2html2/gdb3html.[ch]:
	* components/help/converters/gnome-db2html2/sect-elements.[ch]:
	* components/help/converters/gnome-db2html2/sect-preparse.c,
	* components/help/converters/gnome-db2html2/toc-elements.c:
	(glossentry_stack_add), (glossary_start_element),
	(sect_glossseealso_start_element),
	(sect_glosssee_start_element),
	(sect_preparse_glossary_start_element),
	(sect_preparse_glossterm_characters),
	(toc_glossdiv_start_element), (toc_glossdiv_end_element)
	(toc_glossentry_start_element), (toc_glossentry_end_element),
	(toc_glossterm_start_element), (toc_glossterm_end_element):
	New functions for glossary support

	(sect_title_start_element), (sect_title_end_element),
	(sect_title_characters),
	(toc_author_start_element), (toc_author_characters)
	(toc_title_start_element), (toc_title_end_element),
	(toc_title_characters):
	Modified functions for glossary support
	
	(sect_preparse_set_doctype):
	Add support for glossary, and fix a bug (we should set to BOOK_DOC and
	ARTICLE_DOC instead of just BOOK or ARTICLE!!!)

2000-11-22  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/Makefile.am:
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_finalize), (eazel_package_system_unref),
	(eazel_package_system_class_initialize),
	(eazel_package_system_initialize), (eazel_package_system_get_type),
	(eazel_package_system_new):
	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_finalize), (eazel_softcat_unref),
	(eazel_softcat_class_initialize), (eazel_softcat_initialize),
	(eazel_softcat_get_type), (eazel_softcat_new):
	* components/services/install/lib/eazel-softcat.h:
	The first parts of the upcoming big rewrite of libeazelinstall.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_install_packages):
	Always set_uninstall(FALSE) in install.
	
	* components/services/install/lib/eazel-install-problem.c:
	(eazel_install_problem_case_to_string),
	(eazel_install_problem_handle_cases):
	Removed debug output and moved the translation comments back to
	right before the i18n strings.
	Also copy the install_categories and uninstall_categories, to not
	corrupt the callers category lists.
	
	* athena-installer/src/Makefile:
	Yes.
	* athena-installer/src/installer.c: (start_over),
	(start_over_callback_druid), (dont_start_over_callback),
	(create_what_to_do_page), (jump_to_retry_page),
	(eazel_installer_do_install), (eazel_installer_setup_texts):
	Fixing 4841
	* athena-installer/src/installer.h:
	Removed some old cruft.

2000-11-22  Andy Hertzfeld  <andy@eazel.com>

`	* libathena-extensions/athena-image.h:
	added athena_image_new_from_file convenience routine
	* libathena-extensions/athena-image.c:
	(athena_image_new_from_file):
	implemented athena_image_new_from_file to make it easy to
	convert code that used gnome_pixmap_new_from_file to use
	anti-aliased images
	
	* components/hardware/athena-hardware-view.c: (setup_form_title),
	(setup_overview_form):
	converted the hardware view to use anti-aliased images
	
2000-11-22  Michael K. Fleming  <mfleming@eazel.com>

	* src/athena-first-time-druid.c: (set_http_proxy):

	Set the newly specified "/system/gnome-vfs/use-http-proxy" flag 
	when setting an http proxy

2000-11-22  Robey Pointer  <robey@eazel.com>

	* athena-installer/src/installer.c: (start_over_button),
	(jump_to_retry_page):

	Change ignore button callback to match what GTK expects.

2000-11-22  Michael Engber  <engber@eazel.com>

	* src/athena-application.c: (athena_application_startup):
	Always open a window in response to typing athena
	at the cmd line. Used to not open a window if you typed
	athena --start-desktop. Bug 4720

2000-11-22  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(athena_background_load_image_callback),
	(athena_background_set_image_uri_and_color),
	(athena_background_reset):
	* src/athena-sidebar.c: (setting_change_metadata_callback),
	(background_settings_changed_callback):
	Fixed problem dropping images onto sidebar - bug 4822

2000-11-22  Ramiro Estrugo  <ramiro@eazel.com>

	* configure.in:
	Build the mozilla component without rtti and without exceptions.
	This causes problems on some g++ compilers.
	
2000-11-22  Rebecca Schulman  <rebecka@eazel.com>
	Fixed bug 3919, that the numeric date field still
	showed when "day is yesterday" was chosen

	* src/athena-search-bar-criterion.c:
	(athena_search_bar_criterion_new_from_values),
	(athena_search_uri_get_first_criterion),
	(modified_relation_should_show_value), (hide_date_widget),
	(show_date_widget):
	Added callbacks to correctly show and hide the date 
	widget.

2000-11-21  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-problem.c:
	(eazel_install_problem_case_to_string),
	(eazel_install_problem_case_foreach_to_string),
	(eazel_install_problem_case_foreach_to_package_names),
	(eazel_install_problem_cases_to_package_names),
	(eazel_install_problem_find_dominant_problem_type):
	* components/services/install/lib/eazel-install-problem.h:

	Add hack to let us ask for only the package names of items in the
	problem list (and only those that need to be uninstalled).  This
	lets us build up a special bullet list for the "update not found"
	installer panel.
	
	* athena-installer/src/callbacks.c: (begin_install),
	(prep_retry):
	* athena-installer/src/installer.c: (remove_problems_timer),
	(jump_to_retry_page), (toggle_button_lock),
	(toggle_button_toggled), (eazel_installer_set_default_texts):

	Fix up the "update not found" panel to match a reasonable UI, and
	fix some bugs that caused it to go straight into another
	(extremely confusing) panel that suggested you ignore "all
	problems" and then listed no problems.

	* athena-installer/src/Makefile.am:
	* athena-installer/src/support.c:
	* athena-installer/src/support.h:

	Remove the unused support.c from the Makefile, and mark the files
	as unused so that a more adventurous soul can cvs remove them soon.

2000-11-21  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixes for bugs 690 and 733, to make the clipboard
	work for file editing in place, and make sensitivity
	work. Paste doesn't work correctly still, and a bug
	is filed for this issue.  

	* libathena-extensions/athena-entry.h:
	* libathena-extensions/athena-entry.c:
	(athena_entry_initialize_class), (athena_entry_key_press),
	(athena_entry_motion_notify), (athena_entry_set_text),
	(athena_entry_set_selection), (athena_entry_insert_text),
	(athena_entry_delete_text):
	Added a new signal to athena entry, called "selection_changed"
	that is fired whenever the region selected in an editiable widget
	is changed.  This is used to determine how to set clipboard sensitivity
	correctly.

	* libathena-extensions/athena-icon-container.h:
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_initialize_class),
	(athena_icon_container_start_renaming_selected_item),
	(hide_rename_widget):
	Add a new signal "renaming_icon", which tells the icon view
	to set up clipboard capabilities for the new editable widget
	
	* libathena-extensions/athena-icon-private.h:
	* libathena-extensions/athena-icon-text-item.h:
	* libathena-extensions/athena-icon-text-item.c:
	(iti_stop_editing), (iti_entry_text_changed_by_clipboard),
	(iti_start_editing), (iti_destroy), (iti_start_selecting),
	(iti_stop_selecting), (iti_event),
	(athena_icon_text_item_get_renaming_editable):

	Sad hacks that I had to add on top of this already scary file so
	that the editable, which is in its own offscreen window somewhere,
	communicates to the clipboard what is actually going on when text
	is entered and selections are changed.  This includes adding a
	new signal when text is changed, to make sure the entry knows about
	it, firing an initial grab focus for the widget so that the widget
	turns on, passing on more of the events of the canvas
	widget, including motion notifies and focus events, and 
	keeping a persistent copy of the last renaming entry in the icon
	container so that pastes for that widget will still work.

	* libathena/athena-clipboard.h:
	* libathena/athena-clipboard.c: (set_menu_item_sensitive),
	(set_paste_sensitive_if_clipboard_contains_data),
	(set_clipboard_menu_items_sensitive),
	(set_clipboard_menu_items_insensitive),
	(clipboard_items_are_merged_in),
	(set_clipboard_items_are_merged_in),
	(merge_in_clipboard_menu_items), (merge_out_clipboard_menu_items),
	(focus_changed_callback), (grab_focus_callback),
	(selection_changed_callback),
	(initialize_clipboard_component_with_callback_data),
	(athena_clipboard_set_up_editable),
	(widget_was_set_up_with_selection_sensitivity),
	(first_focus_callback),
	(athena_clipboard_set_up_editable_in_control):
	Reorganized some of the code, and also added new callbacks
	to deal with sensitivity changes.  
	
	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_get_bonobo_control):
	Add a new function that the icon view uses to
	pass the bonobo control for clipboard set up
	
	* src/file-manager/fm-icon-view.c: (renaming_icon_callback),
	(create_icon_container):
	Set up clipboard capabilities when the renaming widget is 
	created.
	
	* src/athena-location-bar.c: (athena_location_bar_new):
	* components/notes/athena-notes.c: (make_notes_view):	
	* src/athena-simple-search-bar.c:
	(athena_simple_search_bar_new):
	Changed calls to clipboard set up routines to include
	the new shares_selection_changes parameter. Widgets that
	use the "selection_changed" signal (AthenaEntries) 
	say "TRUE" here, otherwise selection doesn't work quite 
	right, and FALSE is used instead.

	* src/athena-search-bar-criterion.c: (get_size_location_for):
	Deal with the case when a user has entered a non-numeric size
	in a smart way, by using athena_str_to_int.  This is related
	to bug 2438, but is not a complete fix.

2000-11-21  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Mathieu Lacage  <mathieu@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(handle_xfer_vfs_error):
	Fixed 4486 and 3748. Made the file copy operation error dialog
	have a non-misleading title if the title actually shows up (it
	is not supposed to but it may due to window manager theme bugs).
	Made the error text for copying into non-writeable dialogs more 
	accurate.
	
2000-11-21  Robey Pointer  <robey@eazel.com>

	* athena-installer/src/*.xpm:

	removed obsolete XPM files

2000-11-21  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-info2html2/main.c:
        (main):
        Check /usr/share/info by default for info files too (Debian uses
        this). This partially fixes bug #4414

        * components/help/converters/gnome-db2html2/sect-preparse.c:
        (sect_preparse_sect_start_element):
        Apply a slightly modified patch by John Fleck to handle navigation
        links with regards to the appendix (Fixes bug #4792)

2000-11-21  Andy Hertzfeld  <andy@eazel.com>

	* components/music/athena-music-view.c: (fetch_song_info):
	fixed bug 4815, bitrate and time not displayed for certain mp3s. It turns
	out that some encoders reserve a lot of space for id3v2 tags at the
	beginning of the file, so we weren't looking deep enough into the file.
	Fixed by changing the size of the header buffer from 1K to 8K.
	
2000-11-21  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	Fixed bugzilla 855 - Renaming a file with thumbnails does not affect the
	thumbnails and 4654 - Old thumbnails cause problems with renaming.

	* libathena-extensions/athena-directory-metafile.c:
	(athena_directory_rename_file_metadata),
	(athena_directory_remove_file_metadata):
	Finish the metafile rename and metafile remove operation by
	updating thumbnail files correspondingly, if they exist.
	
	* libathena-extensions/athena-directory.c:
	* libathena-extensions/athena-directory.h:
	(athena_directory_get_file_uri):
	Added a convenience routine.

	* libathena-extensions/athena-thumbnails.c: (vfs_file_exists):
	Tweaked to use the right GnomeVFS call.
	
	* libathena-extensions/athena-thumbnails.h:
	* libathena-extensions/athena-thumbnails.c:
	(athena_update_thumbnail_file_renamed_one),
	(athena_update_thumbnail_file_renamed),
	(athena_remove_thumbnail_for_file_one),
	(athena_remove_thumbnail_for_file):
	Look for an existing thumbnail for a file, if present, rename or
	remove it respectively to update it to the new state.

	* libathena-extensions/athena-thumbnails.c:
	(make_thumbnail_path), (athena_get_thumbnail_uri), 
	(check_for_thumbnails), (make_thumbnails):
	Added a create_parents_if_needed parameter used by the new thumbnail
	updating calls.
		
2000-11-21  Robey Pointer  <robey@eazel.com>

	* athena-installer/src/installer.c: (early_log_catcher),
	(catch_early_logs), (start_logging), (eazel_installer_initialize):

	Stop spamming the console with crap before logging starts.

2000-11-20  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bugs 2943 (Dragging icons between windows or to the desktop
	triggers scrolling), 4786 (Need to remove tree view auto-expand
	feature for 1.0) and 4476 (weird horizontal autoscroll
	behavior). Auto-scroll now has a consistent 750 ms startup delay,
	and the tree auto-expand is off.

	* libathena-extensions/athena-drag.h,
	libathena-extensions/athena-drag.c:
	(athena_drag_autoscroll_in_scroll_region,
	athena_drag_autoscroll_start, athena_drag_autoscroll_stop):
	New convenience functions that factor out common code formerly in
	the tree, list and icon view DnD code. This fixes the mistakes
	common to all three of those views, where the auto-scroll initial
	delay was measured from the start of dragging overall, not from
	entering the scroll region.

	* libathena-extensions/athena-icon-private.h,
	libathena-extensions/athena-icon-dnd.c
	(auto_scroll_timeout_callback, set_up_auto_scroll_if_needed,
	stop_auto_scroll): Use the above calls. Also, correct a `<'
	vs. `>' mistake that made the auto-scroll delay never take effect.
	
	* libathena-extensions/athena-list.c
	(auto_scroll_timeout_callback, athena_list_start_auto_scroll,
	athena_list_stop_auto_scroll): Use the above calls. Also,
	correct a `<' vs. `>' mistake that made the auto-scroll delay
	never take effect.

	* components/tree/athena-tree-view-dnd.c:
	(athena_tree_view_drag_leave, athena_tree_view_drag_motion,
	collapse_time_callback, athena_tree_view_expand_node,
	athena_tree_view_is_tree_node_expanded, athena_dump_info
	expand_hack_unref, expand_hack_new, expand_time_callback,
	athena_tree_view_expand_maybe_later): Remove bunches of code to
	disable auto-expand.

	(ready_to_start_scrolling, auto_scroll_timeout_callback),
	(athena_tree_view_start_auto_scroll),
	(athena_tree_view_stop_auto_scroll),
	(athena_tree_view_drag_destroy): Use new common auto-scroll
	code. I also made it possible to add an extra auto-scroll delay
	for horizontal auto-scroll, but now that the startup delay has
	been fixed, it seems almost impossible to trigger horizontal
	auto-scroll accidentally, so I consider 4476 fixed.
	
	* components/adapter/bonobo-stream-vfs.c: (vfs_get_info,
	vfs_set_info, vfs_write, vfs_read, vfs_copy_to, vfs_destroy,
	bonobo_stream_vfs_open): Added FIXME bug numbers.
	* components/adapter/athena-adapter-control-embed-strategy.c:
	(activate_uri_callback): Added FIXME bug numbers.
	* components/adapter/athena-adapter.c: (athena_adapter_new):
	Added FIXME bug numbers.

2000-11-20  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: reduced versions of glib
	and gtk to released ones.

2000-11-20  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: updated some versions of libs to
	check for

2000-11-20  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_do_file_conflict_check):
	Removed some debug spam
	
	* athena-installer/src/Makefile:
	yes.
	
	* athena-installer/src/callbacks.c: (begin_install):
	* athena-installer/src/installer.c: (skip_over_remove_problems),
	(jump_to_retry_page), (create_initial_force_remove_category),
	(get_detailed_errors_foreach), (get_detailed_errors),
	(eazel_install_preflight), (eazel_installer_post_install),
	(eazel_installer_set_default_texts), (eazel_installer_setup_texts),
	(eazel_install_get_depends), (eazel_installer_initialize):
	* athena-installer/src/installer.h:
	* athena-installer/src/main.c: (main):
	Added my fix for 4706.

2000-11-20  Robey Pointer  <robey@eazel.com>

	* components/rpmview/athena-rpm-view-install.c:
	(athena_rpm_view_install_package_callback),
	(athena_rpm_view_uninstall_package_callback):
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line):
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(lots)
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba-types.c:
	(lots)
	* components/services/install/lib/eazel-install-corba-types.h:
	* components/services/install/lib/eazel-install-corba.c:
	(lots)
	* components/services/install/lib/eazel-install-object.c:
	(lots)
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_destroy),
	(athena_service_install_done),
	(athena_service_install_view_update_from_uri),
	(service_install_stop_loading_callback):
	
	The great renaming: moved Trilobite/Eazel/Install stuff into
	GNOME/Trilobite/Eazel/(etc).
	
	* components/services/install/lib/eazel-install-problem.c:
	(eazel_install_problem_handle_cases):

	Renaming, and initialize some vars to avoid warnings.
	
	* athena-installer/src/main.c: (check_disk_space), (main):

	Add a command-line option for ignoring the disk-space check.
	Check /usr instead of /.

2000-11-20  Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 2893 (changing the selection in a view does not make the
	tree view scroll to the correct selectin even while it does has
	the correct selection.)

	* components/tree/athena-tree-view-private.h: Added
	got_first_size_allocate boolean to details struct.
	* components/tree/athena-tree-view.c:
	(athena_tree_view_initialize): Connect to the size_allocate
	handler.
	(ctree_show_node): Convenience function for scrolling a
	AthenaCTree to show a particular node.
	(ctree_get_first_selected_node): Convenience function to get the
	selected node.
	(tree_select_row_callback): Scroll to the selected node.
	(size_allocate_callback): Scroll to the selected node, if any, on
	the first size_allocate only.

2000-11-18 John Fleck <jfleck@inkstain.net>

	components/help/converters/gnome-db2html2/gdb3html.c:
	changing output of &percnt; entity to &#37; so Mozilla will 
	recognize it

2000-11-17  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (something_failed), (install_failed), (uninstall_failed),
	(delete_files):
	Updated the cli tool's use of the problem-handler
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	Added a flag to ignore file conflicts
	
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install__set_ignore_file_conflicts),
	(impl_Eazel_Install__get_ignore_file_conflicts),
	(eazel_install_get_epv):
	Code to set the ignore file conflicts flag.
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_do_transaction_all_files_check),
	(eazel_install_prune_packages_helper),
	(eazel_install_fetch_dependencies),
	(eazel_install_do_file_conflict_check), (eazel_uninstall_globber):
	Code to use the ignore file conflicts flag
	
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize), (eazel_install_install_packages):
	Changed some 0x%xs to %p and added the nessecary things for the
	extra ignore_file_conflicts flags.
	
	* components/services/install/lib/eazel-install-problem.h: *
	components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach),
	(get_detailed_uninstall_messages_foreach), (compare_problem_case),
	(add_case), (add_cannot_solve_case),
	(add_continue_with_force_case), (add_force_install_both_case),
	(add_force_remove_case), (add_remove_case), (add_update_case),
	(add_cascade_remove), (get_detailed_cases_foreach),
	(get_detailed_uninstall_cases_foreach),
	(eazel_install_problem_case_to_string),
	(eazel_install_problem_case_foreach_destroy),
	(eazel_install_problem_case_new),
	(eazel_install_problem_tree_to_case),
	(eazel_install_problem_tree_to_string),
	(build_categories_from_problem_list),
	(eazel_install_problem_use_set),
	(eazel_install_problem_step_problem),
	(eazel_install_problem_handle_cases): loads of code, so for a
	given set of problems, you can get the dominant type, and step
	forward to the next way of solving the problem. Also fixed the
	problem about updates not including the previous sets of pacakges.
	Also added some new cases.

	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_add_to_rpm_set),
	Commented out robeys flailing, which caused some erratic crashes
	because of a NULL packsys struct.
	(eazel_install_start_transaction_make_rpm_argument_list),
	Add --force on ignore_file_conflicts
	(eazel_install_do_rpm_dependency_check):
	%x to %p
	
	* components/services/install/lib/eazel-install-types.c:
	(categorydata_new), (categorydata_destroy_foreach),
	(packagedata_new), (packagedata_destroy):
	%x to %p
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_done),
	(athena_service_install_failed):
	Updated to the new signatures of the problem handler functions.
	
	* athena-installer/src/callbacks.c: (begin_install):
	* athena-installer/src/installer.c: (jump_to_retry_page),
	(collect_failure_info), (install_failed), (uninstall_failed),
	(eazel_installer_setup_texts), (eazel_install_get_depends),
	(eazel_installer_initialize):
	Partial fix for 4706, I just want to commit before I slaughter it
	completely.
	
	* athena-installer/src/prescript:
	Fixed 4763 by changing the wording.

2000-11-17  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(athena_background_ensure_gradient_buffered):
	* libathena-extensions/athena-background.c:
	(athena_background_ensure_gradient_buffered):
	Damn gradients! Fixed round off error which could
	result in a one pixel error. (bug 4759)

2000-11-17  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(athena_background_ensure_gradient_buffered):
	Fixed bug occuring when percentages of multi-point
	add up to >100% (bug 4759)

2000-11-17  Mathieu Lacage  <mathieu@eazel.com>

	reviewed by: Sullivan

	update athena to the latest gnome-vfs mime/type icon handling.
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_name_for_regular_file): use
	gnome_vfs_mime_get_icon instead of the raw get_value call.
	(get_themed_icon_file_path): if cannot find the pixmap through
	the standard theme code, fallback on gnome-vfs to find the icon.
	(get_icon_file_path): beautification.
	(athena_scalable_icon_new_from_text_pieces): idem.

2000-11-17  John Sullivan  <sullivan@eazel.com>

	reviewed by: Mathieu Lacage  <mathieu@eazel.com>

	Fixed bug 4484 (leading whitespace in location bar produces
	errors)
	Fixed bug 4039 (Pasting URL with trailing carriage return fails, 
	but needn't)

	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_from_input): Strip leading and trailing white
	space before any further processing; also now handles NULL with
	return_val_if_fail.
	(athena_self_check_file_utilities): Added new self-check tests
	for white space stripping, and a couple of others.

2000-11-17  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background.c:
	(athena_background_ensure_gradient_buffered):
	Fixed off by one error in gradient calculation (bug 4759)

2000-11-17  John Sullivan  <sullivan@eazel.com>

	Fixed bug with "Disks" submenu in desktop context menu where
	the volume-mounting behavior would sometimes run when the
	context menu appeared.

	* libathena-extensions/athena-volume-monitor.h:
	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_mount_unmount_removable):
	Added boolean parameter to specify whether to mount or
	unmount; previously it always toggled the current state.

	* src/file-manager/fm-desktop-icon-view.c: 
	(mount_parameters_new),	(mount_parameters_free),
	(mount_parameters_free_wrapper): New little helper functions
	for dealing with the parameters to the mount_or_unmount callback.
	(mount_or_unmount_removable_volume): Now specifies whether to
	mount or unmount based on command state, rather than always
	toggling; also updates the menu state after the mount/unmount.
	(update_disks_menu): Pass view as well as mount_path for
	callback data, using mount_parameters_new & _free.

2000-11-16  Pavel Cisler <pavel@eazel.com>

	reviewed by: Mathieu Lacage  <mathieu@eazel.com>

	* libathena-extensions/athena-file-operations-progress.c:
	(delete_event_callback),
	(athena_file_operations_progress_initialize),
	(athena_file_operations_progress_initialize_class):
	Fix 3094: Closing file progress dialog using the close box 
	crashes.
	The progress dialog shouldn't really have a close box, it only
	shows up in broken window manager themes that don't respect the
	window manager hints. Made it so that clicking the close box
	does nothing instead of crashing.
	
	* libathena-extensions/athena-file-operations.c:
	(fit_rect_on_screen), (center_dialog_over_rect),
	(center_dialog_over_window), (create_xfer_dialog):
	Fix 3092: File operation progress dialog not placed well.
	Made it center over the window that is the target of the
	copy/move operation. I couldn't really do it by setting the window
	as the dialog's parent because you need to be able to close
	the window without the dialog closing. Instead, added explicit
	centering code.
	
	* libathena-extensions/athena-file-operations.c:
	(progress_dialog_set_to_from_item_text):
	Fix 4080: Copy dialog shows to and from as the same location.
	Stupid typo.

2000-11-16  Rebecca Schulman  <rebecka@eazel.com>

	* libathena-extensions/athena-search-uri.c:
	(athena_self_check_search_uri):
	Fixed the tests to go along with my changes

2000-11-16  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Final changes to kill off the legendary bug 3579
	(Convert directory view context menus to use Bonobo)

	* libathena/athena-bonobo-ui.h:
	#define for zoom items placeholder in popup. Remove
	#defines for popup-specific zooming commands, since now
	we don't need distinct popup-specific ones.

	* libathena-extensions/athena-bonobo-extensions.h:
	* libathena-extensions/athena-bonobo-extensions.c:
	(athena_bonobo_set_label_for_menu_item_and_command):
	Moved this here and commented; it had been a private 
	function in fm-directory-view.c.
	
	* src/file-manager/fm-directory-view.c: 
	(real_merge_menus): Just hide the placeholder for the zoom items,
	which is now sufficient due to a Bonobo fix Darin made.
	(real_update_menus): Update for API name change.
	(set_label_for_menu_and_command): Moved this to another file
	and renamed it.
	* src/file-manager/fm-icon-view.c: 
	(fm_icon_view_update_menus): Update the dynamic menu items
	in-line here, as was done with fm-directory-view.c in an earlier
	checkin.
	(compute_menu_item_info), (update_one_menu_item): Removed these
	obsolete functions.
	* src/athena-shell-ui.xml: Eliminated special pop-up versions of
	zoom commands. They existed only to allow hiding without affecting
	the menu-bar versions, but now that placeholders can be hidden
	these aren't necessary.
	* src/athena-window-menus.c: (athena_window_initialize_menus):
	Removed verb installation for pop-up versions of zoom commands.

2000-11-16  Rebecca Schulman  <rebecka@eazel.com>

	* check-FIXME.pl:
	Make below change work for modules containing the
	'-' character (like, say, gnome-vfs)

2000-11-16  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/Makefile.am:
	* components/services/Makefile.am:
	* configure.in:
	Fix for (4741), building with services on non-rpm machines.

2000-11-16  Rebecca Schulman  <rebecka@eazel.com>

        reviewed by: Darin Adler <darin@eazel.com>
	(Patch for check-FIXME.pl; later I added
	additional check for "This is not a fixme bug")
	
	* check-FIXME.pl:
	Add the functionality that it also checks for bugs marked
	with "fixme" in the bugzilla database for a product, and
	notifies you if the bug has no fixme comment in the source.
	This is not a perfect operation, so you can explicitly
	include the comment "This is not a fixme bug" and the 
	script will ignore it.  
	* libathena-extensions/athena-search-uri.c:
	Fixed some wording so that the text is not hard to 
	understand if we are creating an english equivalent for
	several criteria.

2000-11-16  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Reimplemented code that updates menu items' labels and
	sensitivity in a much more straightforward way, made
	possible by the elimination of gtk context menus.

	* src/file-manager/fm-directory-view.c:
	(reset_bonobo_open_with_menu): set sensitivity in here
	instead of in a separate call. Also set sensitivity of
	"Open With" title in context menu, which was previously
	always sensitive. However, it is still always sensitive
	due to a Bonobo bug.
	(set_label_for_menu_and_command): Helper function that
	handles stripping the underscore for the command's label.
	(real_update_menus): Now all the dynamic menu items are
	updated in here, which removes a lot of string compares,
	unnecessary label-setting, and other extra code.

	(compute_menu_item_info), (update_one_menu_item),
	(reset_bonobo_trash_delete_menu): Removed functions;
	they are merged into real_update_menus now.

2000-11-16  John Sullivan  <sullivan@eazel.com>

	* components/adapter/athena-zoomable-proxy.c:
	(athena_zoomable_proxy_get):
	Fixed uninitialized variable warning that was
	breaking the build (Darin told me the fix).

2000-10-22  Martin Baulig  <baulig@suse.de>

	reviewed by: Darin Adler  <darin@eazel.com>
	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Use the new Bonobo::Zoomable interface instead of Athena::Zoomable.

	* libathena/athena-zoomable.[ch]: Removed.
	* src/athena-zoomable-frame-corba.c: Removed.

	* libathena/athena-view-component.idl
	(ZoomLevels, ZoomLevelList, Zoomable, ZoomableFrame): Removed.

	* src/athena-view-frame-private.h
	(impl_Athena_ZoomableFrame_vepv, impl_Athena_ZoomableFrame__create):
	Removed external declarations.

	* src/athena-view-frame.h: include <bonobo/bonobo-zoomable-frame.h>.
	(AthenaViewFrame): Removed the `zoomable' field and changed the
	type of the `zoomable_frame' field from BonoboObject into
	BonoboZoomableFrame.
	(AthenaViewFrameClass): Added `zoom_parameters_changed' signal.

	* src/athena-view-frame.c (athena_view_frame_destroy_client):
	Don't release `view->zoomable' and set `view->history_frame' and
	`view->zoomable_frame' to NULL, not to CORBA_OBJECT_NIL.
	(athena_view_frame_initialize_class): Added ZOOM_PARAMETERS_CHANGED
	signal.
	(zoom_level_changed_callback): New static callback function; this emits
	the ZOOM_LEVEL_CHANGED signal on the AthenaViewFrame.
	(zoom_parameters_changed_callback): New static callback function; this
	emits the ZOOM_PARAMETERS_CHANGED signal on the AthenaViewFrame.
	(athena_view_frame_set_to_component): QI the adapted component for
	"IDL:Bonobo/Zoomable:1.0" and - if it was found - create the
	BonoboZoomableFrame, bind it to the BonoboZoomable and connect the
	"zoom_level_changed" and the "zoom_parameters_changed" signals.
	(athena_view_frame_is_zoomable): Return `view->zoomable_frame != NULL'.
	(athena_view_frame_get_zoom_level): Check whether view->zoomable_frame
	is not NULL and call bonobo_zoomable_frame_get_zoom_level().
	(athena_view_frame_set_zoom_level): Check whether view->zoomable_frame
	is not NULL and call bonobo_zoomable_frame_set_zoom_level().
	(athena_view_frame_get_min_zoom_level): Check whether
	view->zoomable_frame is not NULL and call
	bonobo_zoomable_frame_get_min_zoom_level().
	(athena_view_frame_get_max_zoom_level): Check whether
	view->zoomable_frame is not NULL and call
	bonobo_zoomable_frame_get_max_zoom_level().
	(athena_view_frame_get_has_min_zoom_level): New function.
	Check whether view->zoomable_frame is not NULL and call
	bonobo_zoomable_frame_has_min_zoom_level().
	(athena_view_frame_get_has_max_zoom_level): New function.
	Check whether view->zoomable_frame is not NULL and call
	bonobo_zoomable_frame_has_max_zoom_level().
	(athena_view_frame_get_is_continuous): New function.
	Check whether view->zoomable_frame is not NULL and call
	bonobo_zoomable_frame_is_continuous().
	(athena_view_frame_get_preferred_zoom_levels): If
	view->zoomable_frame is NULL, return NULL. Otherwise
	bonobo_zoomable_frame_get_preferred_zoom_levels() returns GList *
	of floats which we can just return.
	(athena_view_frame_zoom_in): If view->zoomable_frame is not NULL,
	call bonobo_zoomable_frame_zoom_in().
	(athena_view_frame_zoom_out): If view->zoomable_frame is not NULL,
	call bonobo_zoomable_frame_zoom_out().
	(athena_view_frame_zoom_to_fit):  If view->zoomable_frame is not
	NULL, call bonobo_zoomable_frame_zoom_out().
	(athena_view_frame_zoom_level_changed): Removed.

	* src/athena-zoom-control.c (AthenaZoomControlDetails): Added
	`has_min_zoom_level' and `has_max_zoom_level'.
	(draw_zoom_control_image): Call athena_zoom_control_can_zoom_in/out()
	to find out whether we can zoom.
	(zoom_menu_callback): Likewise.
	(athena_zoom_control_button_press_event): Likewise.
	(create_zoom_menu_item): Changed the type of the `zoom_level' argument
	from double to float.
	(athena_zoom_control_set_min_zoom_level): Removed.
	(athena_zoom_control_set_max_zoom_level): Removed.
	(athena_zoom_control_set_preferred_zoom_levels): Removed.
	(athena_zoom_control_set_parameters): New function.
	(athena_zoom_control_has_min_zoom_level): New function.
	(athena_zoom_control_has_max_zoom_level): New function.
	(athena_zoom_control_can_zoom_in): New function.
	(athena_zoom_control_can_zoom_out): New function.
	
	* src/file-manager/fm-directory-view.c: #include
	<bonobo/bonobo-zoomable.h> instead of
	<libathena/libathena-zoomable.h>.
	(FMDirectoryViewDetails): Changed the type of `zoomable' to
	BonoboZoomable.
	(fm_directory_view_preferred_zoom_levels): Made this an array of float,
	not double.
	(fm_directory_view_initialize): Create a new BonoboZoomable object here.
	(zoomable_zoom_in_callback): The first argument is now a BonoboZoomable.
	(zoomable_zoom_out_callback): The first argument is now a BonoboZoomable.
	(athena_zoom_level_from_double): Renamed into
	athena_zoom_level_from_float().
	(zoomable_set_zoom_level_callback): The first argument is now a
	BonoboZoomable and the second one a float.
	(zoomable_zoom_to_fit_callback): The first argument is now a
	BonoboZoomable.
	(fm_directory_view_set_zoom_level): Call
	bonobo_zoomable_report_zoom_level_changed()
	instead of using athena_zoomable_set_zoom_level().

	* src/athena-window-manage-views.c:
	(zoom_level_changed_callback): Don't call
	athena_zoom_control_set_min_zoom_level(),
	athena_zoom_control_set_max_zoom_level() and
	athena_zoom_control_set_preferred_zoom_levels() here.
	Use athena_zoom_control_can_zoom_in/out() to find out whether we
	can zoom in the calls to athena_bonobo_set_sensitive().
	, (zoom_parameters_changed_callback): New callback function.
	Call athena_zoom_control_set_parameters() and - if the zoom_level
	is not 0.0 - zoom_level_changed_callback().

	* components/adapter/athena-zoomable-proxy.[ch]: New files.

	* components/adapter/Makefile.am (athena_adapter_SOURCES):
	Added athena-zoomable-proxy.c and athena-zoomable-proxy.h.

	* components/adapter/athena-adapter-embed-strategy.c
	(AthenaAdapterEmbedStrategyClass): Added new virtual signal
	`get_zoomable' which must be overridden.
	(athena_adapter_embed_strategy_initialize_class): Assign it here.
	(athena_adapter_embed_strategy_get_zoomable): New static function;
	call the virtual `get_zoomable' in the derived class.

	* components/adapter/athena-adapter-control-embed-strategy.c:
	(athena_adapter_control_embed_strategy_initialize_class):
	Assign athena_adapter_control_embed_strategy_get_zoomable() as
	handler of the `get_zoomable' signal.
	(athena_adapter_control_embed_strategy_new): QI the Control for
	"IDL:Bonobo/Zoomable:1.0" and pass it to athena_zoomable_proxy_get()
	if found and store the return value in strategy->details->zoomable.
	(athena_adapter_control_embed_strategy_get_zoomable): New static
	function; return strategy->details->zoomable which is set in
	athena_adapter_control_embed_strategy_new().

	* components/adapter/athena-adapter-embeddable-embed-strategy.c:
	(athena_adapter_embeddable_embed_strategy_initialize_class):
	Assign athena_adapter_embeddable_embed_strategy_get_zoomable() as
	handler of the `get_zoomable' signal.
	(athena_adapter_embeddable_embed_strategy_new): QI the View for
	"IDL:Bonobo/Zoomable:1.0" and pass it to athena_zoomable_proxy_get()
	if found and store the return value in strategy->details->zoomable.
	(athena_adapter_embeddable_embed_strategy_get_zoomable): New static
	function; return strategy->details->zoomable which is set in
	athena_adapter_embeddable_embed_strategy_new().

	* components/adapter/athena-adapter.c: (athena_adapter_new):
	Call athena_adapter_embed_strategy_get_zoomable(embed_strategy) and
	bonobo_add_interface() it to the control if found.

	* components/image-viewer/athena-image-view.c: Rewrote the Athena
	image viewer to be a BonoboControl, to add zoomable support to it and
	to merge back everything from bonobo-image-generic into it.

2000-11-16  Ramiro Estrugo  <ramiro@eazel.com>

	* components/help/converters/gnome-info2html2/main.c: (main):
	Fix uninitialized variable.

	* components/services/vault/command-line/main.c:
	Include stlib.h needed for exit().

	* libathena-extensions/athena-directory-async.c:
	(call_ready_callbacks):
	Fix uninitialized variable.
	
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(athena_gdk_pixbuf_draw_text):
	Workaround int vs uint casting issues with new gcc compiler.

	* libathena-extensions/athena-mime-actions.c:
	(extract_prefix_add_suffix):
	Workaround int vs uint casting issues with new gcc compiler.

2000-11-16  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* src/file-manager/fm-desktop-icon-view.c: (real_update_menus):
	* src/file-manager/fm-directory-view.c: (real_update_menus):
	* src/file-manager/fm-icon-view.c: (fm_icon_view_update_menus):
	Bracketed menu-updating code with bonobo_ui_component_freeze/thaw.
	This speeds up fm_directory_view_update_menus by about 50%, and
	it's called a zillion times so that can't hurt.

2000-11-16  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* src/file-manager/fm-directory-view.c: (open_callback),
	(open_in_new_window_callback), (other_application_callback),
	(other_viewer_callback), (trash_callback), (duplicate_callback),
	(create_link_callback), (new_folder_callback),
	(open_properties_window_callback), (reset_background_callback),
	(remove_custom_icons_callback), (real_merge_menus):
	* src/file-manager/fm-icon-view.c: (show_stretch_handles_callback),
	(unstretch_icons_callback), (clean_up_callback),
	(rename_icon_callback), (customize_icon_text_callback),
	(fm_icon_view_merge_menus):
	* src/file-manager/fm-search-list-view.c: (real_merge_menus),
	(reveal_selected_items_callback):

	Removed all function casts that were allowing us to use a single
	callback for both Bonobo-style and gtk-style menus; converted
	all the functions to take Bonobo-style parameters.

2000-11-16  Martin Baulig  <martin@home-of-linux.org>

	* libathena-adapter/athena-adapter-factory.idl:
	Use `ATHENA_ADAPTER_FACTORY_IDL' instead of
	`NAUTUILUS_ADAPTER_FACTORY_IDL' in the #ifdef/#define
	which protects against multiple inclusion of this file.

2000-11-16  John Sullivan  <sullivan@eazel.com>

	Removed a ton of code that was used only for the gtk
	context menus, which are gone now that we're using
	Bonobo for context menus. There's still some reworking
	of code formerly shared by gtk & Bonobo menus to do, but
	I'll do that in a separate pass.

	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize_class): Removed signal definitions
	and function assignments for create_selection_context_menu_items
	and create_background_context_menu_items.

	(compute_menu_item_info): Do special_link_in_selection tests here;
	previously they were done only for the gtk context menus (so for
	the past day we've had an as-yet-unnoticed bug where certain
	context menu items on the desktop were sensitive but shouldn't
	have been).
	(fm_directory_view_pop_up_selection_context_menu),
	(fm_directory_view_pop_up_background_context_menu):
	Removed the iffed-out case that used the gtk context menus.

	(zoom_in_callback), (zoom_out_callback), (zoom_default_callback),
	(finish_inserting_menu_item), (finish_appending_menu_item),
	(set_menu_item_path), (append_gtk_menu_item),
	(append_selection_menu_subtree),
	(fm_directory_view_insert_context_menu_item),
	(fm_directory_view_append_context_menu_item),
	(create_background_context_menu_items),
	(real_create_background_context_menu_items),
	(launch_application_from_menu_item), (view_uri_from_menu_item),
	(add_application_to_gtk_menu), (add_component_to_gtk_menu),
	(create_open_with_gtk_menu), 
	(real_create_selection_context_menu_items),
	(create_selection_context_menu),
	(fm_directory_view_create_background_context_menu_items),
	(create_background_context_menu), (menu_item_matches_path),
	(fm_directory_view_get_context_menu_index): 
	Removed obsolete functions.

	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_initialize_class): Removed obsolete
	virtual function overrides.
	(real_update_menus): Removed debugging spam I had accidentally
	left in.

	(new_terminal_menu_item_callback),
	(reset_desktop_background_menu_item_callback),
	(change_desktop_background_menu_item_callback),
	(quit_athena_desktop_menu_item_callback),
	(empty_trash_menu_item_callback),
	(fm_desktop_icon_view_create_selection_context_menu_items),
	(fm_desktop_icon_view_create_background_context_menu_items),
	(mount_unmount_removable): Removed obsolete functions.
	
	* src/file-manager/fm-icon-view.c: 
	(special_link_in_selection): Just moved this function up.
	(compute_menu_item_info): Check special_link_in_function for
	rename menu item; formerly this only happened for the gtk
	context	menu.
	(fm_icon_view_initialize_class): Removed obsolete virtual 
	function overrides.

	(gtk_tighter_layout_callback), (gtk_sort_reversed_callback),
	(context_menu_layout_radio_item_callback),
	(append_one_context_menu_layout_item),
	(insert_one_context_menu_item), (append_one_context_menu_item),
	(append_one_toggle_context_menu_item),
	(fm_icon_view_create_selection_context_menu_items),
	(fm_icon_view_create_background_context_menu_items):
	Removed obsolete functions.
	
	* src/file-manager/fm-search-list-view.c:
	(fm_search_list_view_initialize_class): Removed obsolete
	virtual function override.

	(real_create_selection_context_menu_items): 
	Removed obsolete function.

2000-11-16  John Sullivan  <sullivan@eazel.com>

	* libathena-extensions/athena-file-utilities.h:
	Added #define ATHENA_TRASH_URI "trash:"
	
	* libathena-extensions/athena-directory.c:
	(athena_self_check_directory):
	* libathena-extensions/athena-drag.c:
	(athena_drag_default_drop_action_for_icons):
	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_canonical),
	(athena_self_check_file_utilities):
	* libathena-extensions/athena-file.c:
	(athena_self_check_file):
	* src/file-manager/fm-desktop-icon-view.c:
	(find_and_rename_trash_link), (create_or_rename_trash):
	* src/file-manager/fm-directory-view.c: (show_trash_callback):
	* src/file-manager/athena-trash-monitor.c:
	(athena_trash_monitor_initialize):
	Used ATHENA_TRASH_URI wherever "trash:" was used before.

2000-11-16  Szabolcs BAN <shooby@gnome.hu>

	* configure.in, po/hu.po: Hungarian language support.

2000-11-15  John Fleck <jfleck@inkstain.net>
	* components/help/converters/gnome-db2html2/gdb3html.c:
	changed init entities function to use
	XML_INTERNAL_PREDEFINED_ENTITY to get mdash and hellip working
	
2000-11-15  Pavel Cisler <pavel@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-gdk-extensions.c:
	* libathena-extensions/athena-gdk-extensions.h:
	* libathena-extensions/athena-file-operations-progress.c:
	(set_text_unescaped_trimmed):
	(athena_string_ellipsize_start):
	Turn an existing truncation routine to a public one, giving it 
	a better name.
	Get rid of a questionable optimization (bugzilla 2555).

	* libathena-extensions/athena-gdk-extensions.c:
	(athena_self_check_ellipsize_start),
	(athena_self_check_gdk_extensions):
	Added tests for the elipsize routine.

	* libathena-extensions/athena-file-operations.c:
	* libathena-extensions/athena-file-operations.h:
	(get_label_font), (athena_format_name_for_display),
	(athena_convert_to_formatted_name_for_display),
	(handle_xfer_vfs_error), (handle_xfer_overwrite),
	(athena_file_operations_move_to_trash):
	Fix 826: File operation alerts should truncate file names.
	Add a convenience call to unescape and truncate a file name,
	use it the places that format warning and error dialog strings.
	Add some missing quotes in some of the error strings.
	
	* libathena-extensions/athena-file-operations.c:
	(parent_for_error_dialog):
	Work on fixing 3093 - file operation error dialogs show up in the
	wrong place.
	Make the error dialogs use the progress dialog as their parent window,
	if available, if not, revert to using the original view as a parent.

	* libathena-extensions/athena-string.c:
	Added a comment pointing people to the new ellipsize routines.

2000-11-15  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 1420, panel splitter drag outline edges are indistinct.

	(athena_horizontal_splitter_motion):
	New method overide to handle drawing splitter during drag.
	
	(athena_horizontal_splitter_button_release):
	Add additonal code from parent class and don't call
	parent class function at function exit.
	
	* libathena-extensions/athena-horizontal-splitter.c:
	(athena_horizontal_splitter_initialize_class):
	Overide motion method.
	
	(splitter_xor_line):
	Draw splitter outline as two distinct edges.
	
2000-11-15  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-directory-background.c:
	(athena_file_background_event_filter):
	fixed some comments

	* libathena-extensions/athena-gtk-extensions.c:
	(container_foreach_deep_callback),
	(athena_gtk_container_foreach_deep):
	* libathena-extensions/athena-gtk-extensions.h:
	added athena_gtk_container_foreach_deep

	* src/athena-window.c: (menu_bar_no_resize_hack_size_allocate),
	(menu_bar_no_resize_hack_menu_bar_finder),
	(menu_bar_no_resize_hack_atexit), (menu_bar_no_resize_hack),
	(athena_window_constructed):
	added hack to prevent criticals when using the desktop
	bug 4345

2000-11-15  John Sullivan  <sullivan@eazel.com>

	* po/POTFILES.in: Added src/file-manager/fm-desktop-icon-view-ui.xml

2000-11-15  John Sullivan  <sullivan@eazel.com>

	Fixed a couple of cases where context menus appeared on
	the desktop that should have been hidden. This leaves
	behind a new (Bonobo) bug where there are two adjacent 
	separators in the desktop background context menu, which
	I will write up.

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* libathena/athena-bonobo-ui.h:
	Add popup zooming commands here that need to be manipulated
	by directory view.
	* src/file-manager/fm-directory-view.c: (real_merge_menus):
	Hide the zooming items in the popup if the directory view
	does not support zooming (e.g., desktop)
	* src/file-manager/fm-icon-view.c: (fm_icon_view_merge_menus):
	Hide the Lay Out submenu in the popup if the icon view
	does not support auto-layout (e.g., desktop)
	* src/athena-shell-ui.xml: Make zooming items in popup use
	different commands than zooming items in normal menu, so they
	can be hidden independently.
	* src/athena-window-menus.c: (athena_window_initialize_menus):
	Attach callbacks to new popup zooming items.

2000-11-15  Gene Z. Ragan  <gzr@eazel.com>	

	Fixed bug 4717, Athena draw desktop icons overlapping.

	The problem was caused by the icon container responding to
	an idle function that lays out icons that had been
	newly added.  This is a problem if the callback is called
	from an idle after the icon container has been created, but
	before a size has been allocated. A newly intialized GtkWidget
	has a default allocation of 0, 0, 1, 1 which is too small
	for the layout algorithm to work properly.  A flag was added
	that is set to TRUE when the size_allocate function is called.
	
	* src/athena-desktop-window.c: (athena_desktop_window_new):
	Set has_been_allocated to FALSE initially.
	
	* libathena-extensions/athena-icon-container.c:
	(size_allocate), (athena_icon_container_initialize),
	(athena_icon_container_add):
	Checj status of has_been_allocated flag before adding
	and laying out new icons.
	
	* libathena-extensions/athena-icon-private.h:
	Added has_been_allocated flag that is set to TRUE
	when size_allocated is first called.

	Work in progress on allowing desktop links to be renamed.
	
	* src/file-manager/fm-desktop-icon-view.c:
	(find_and_update_home_link):
	Allow renaming of home links.
	
	* src/file-manager/fm-icon-view.c: 
	(special_link_in_selection):
	Removed home link from special link types.
	
	* libathena-extensions/athena-file.c:
	(athena_file_can_rename):
	Allow renaming of home link types.

2000-11-15  Rebecca Schulman  <rebecka@eazel.com>
	This change is the first part of the fix for bug 3920.
	The fix will allow athena to tell a user that the
	search they have requested is newer than their index.
	This involved communicating errors that occurred while
	opening and reading the directory outside of the
	directory model to a view, which can react in a useful
	way.

	Reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-directory-async.c:
	(directory_load_done):
	If the directory load did not complete successfully,
	emit an error signal

	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory.h:
	* libathena-extensions/athena-directory.c:
	(athena_directory_initialize_class),
	(athena_directory_emit_load_error):
	Add the load error signal, and a cover function to 
	emit the signal

	* src/file-manager/fm-directory-view.h:	
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize_class), (load_error_callback),
	(finish_loading_uri), (disconnect_model_handlers):
	Also add a load_error signal to the fm directory view class,
	so that subclasses can get information about errors particular
	to a type of directory, (in this case the search list view)
	and react correctly.

	* src/file-manager/fm-search-list-view.c: (load_error_callback),
	(fm_search_list_view_initialize):
	Handle the load error SERVICE_OBSOLETE, by displaying a dialog
	that tells the user that their index is too old for their
	search to work correctly, and gives them an option to reindex
	
	* src/file-manager/athena-indexing-info.c:
	(athena_indexing_info_request_reindex):
	* src/file-manager/athena-indexing-info.h:
	Add a cover function to medusa's request reindex function
	that the search list view calls.

2000-11-15  John Sullivan  <sullivan@eazel.com>

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_pop_up_selection_context_menu),
	(fm_directory_view_pop_up_background_context_menu):
	Oops, I accidentally checked in the Bonobo context
	menus enabled. They are now disabled again.

2000-11-15  Darin Adler  <darin@eazel.com>

	* components/adapter/athena-adapter.oafinfo:
	* components/hardware/athena-hardware-view.oafinfo:
	* components/help/help-contents.oafinfo:
	* components/help/help-factory.oafinfo:
	* components/history/athena-history-view.oafinfo:
	* components/html/ntl-web-browser.oafinfo:
	* components/image-viewer/athena-image-view.oafinfo:
	* components/loser/content/athena-content-loser.oafinfo:
	* components/loser/sidebar/athena-sidebar-loser.oafinfo:
	* components/mozilla/athena-mozilla-content-view.oafinfo:
	* components/music/athena-music-view.oafinfo:
	* components/notes/athena-notes.oafinfo:
	* components/rpmview/athena-rpm-view.oafinfo:
	* components/sample/athena-sample-content-view.oafinfo:
	* components/services/install/athena-view/athena-service-install-view.oafinfo:
	* components/services/install/server/trilobite-eazel-install-service.oafinfo:
	* components/services/inventory/athena-view/athena-inventory-view.oafinfo:
	* components/services/login/athena-view/athena-change-password-view.oafinfo:
	* components/services/summary/athena-view/athena-summary-view.oafinfo:
	* components/services/time/athena-view/trilobite-eazel-time-view. oafinfo:
	* components/services/time/service/trilobite-eazel-time-service.oafinfo:
	* components/services/trilobite/sample/athena-view/athena-sample-service-view.oafinfo:
	* components/services/trilobite/sample/service/trilobite-eazel-sample-service.oafinfo:
	* components/shell/shell.oafinfo:
	* components/websearch/ntl-web-search.oafinfo:
	* src/athena.oafinfo:

	Changed all references to GNOME/GenericFactory to refer to
	GNOME/ObjectFactory instead.

2000-11-15  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	More work towards using Bonobo for context menus. All
	context menu items should now appear and be correctly 
	hooked up. The Bonobo context menus are still not quite
	enabled, awaiting a couple of Bonobo fixes.

	Redid the API for creating dynamic sets of Bonobo 
	menu items (as used by bookmarks, application & viewer
	lists), and added support for lists of toggle items
	(needed for Disks submenu in desktop context menu).

	Also, added "Show Trash" menu item in File menu, just above
	Empty Trash, after discussing with Andy and Arlo.

	* libathena-extensions/athena-bonobo-extensions.h:
	* libathena-extensions/athena-bonobo-extensions.c:
	(get_numbered_menu_item_name): New helper function, returns
	generated menu item name given parent path and index.
	(athena_bonobo_get_numbered_menu_item_command): New
	function, returns generated command name given parent path
	and index. 
	(athena_bonobo_get_numbered_menu_item_path): New function,
	returns generated menu item path given parent path and index.
	(add_numbered_menu_item_internal): New helper function,
	creates menu item using these other new calls. Mostly extracted
	and rewritten from athena_bonobo_add_menu_item.
	(athena_bonobo_add_numbered_menu_item): Renamed from
	athena_bonobo_add_menu_item, and reimplemented to
	call add_numbered_menu_item_internal.
	(athena_bonobo_add_numbered_toggle_menu_item):
	New function, like _add_numbered_menu_item but creates a
	toggle menu item.
	(remove_commands): Renamed from remove_verbs; now handles ids
	as well as verbs.
	(athena_bonobo_remove_menu_items_and_commands):
	Renamed from ..._items_and_verbs; now handles ids as well as
	verbs.
	(athena_bonobo_get_menu_item_verb_name): Removed; replaced by
	_get_numbered_menu_item_command.
	
	* src/file-manager/athena-desktop-icon-view-ui.xml:
	New file, Bonobo-style version of desktop context menus.
	* src/file-manager/Makefile.am: Include new file in build.
	
	* src/file-manager/fm-desktop-icon-view.c:
	Add BonoboUIComponent to details struct.
	(fm_desktop_icon_view_destroy): Dispose of BonoboUIComponent.
	(fm_desktop_icon_view_initialize_class): wire up overrides for
	merge_menus and update_menus.
	(new_terminal_callback),
	(change_background_callback), (empty_trash_callback),
	(reset_background_callback), (quit_desktop_callback):
	New Bonobo-style menu callbacks.
	(empty_trash_menu_item_callback): Renamed so I could use the old
	simpler name for new Bonobo callback; this one will be deleted
	when the Bonobo conversion is completed.
	(fm_desktop_icon_view_create_selection_context_menu_items): Reflect
	name change.
	(mount_or_unmount_removable_volume): New Bonobo listener callback
	used by Disks items.
	(update_disks_menu): New function, recreates the Disks menu.
	(real_update_menus): New function, updates the dynamic desktop
	context menu items.
	(real_merge_menus): New function, wires up the BonoboUIComponent
	and verbs.
	
	* src/file-manager/fm-directory-view.c: 
	(fm_directory_view_pop_up_background_context_menu),
	(fm_directory_view_pop_up_selection_context_menu): Change TRUE
	to FALSE to enable the Bonobo context menus.
	(show_trash_callback): New function, navigates to "trash:"
	(add_open_with_program_menu_item), (reset_bonobo_open_with_menu):
	Reworked for new API.
	(real_merge_menus): Add verb for "Show Trash"
	
	* src/file-manager/athena-directory-view-ui.xml: Added 
	"Show Trash"; added placeholders in background popup used
	for desktop view.
	
	* src/athena-window-menus.c: 
	(append_bookmark_to_menu): Updated for new numbered_menu_item
	API; deleted unused parameter.
	(create_menu_item_from_node), (append_dynamic_bookmarks),
	(refresh_go_menu): Updated append_bookmark_to_menu callers for
	API changes.
	(athena_window_remove_bookmarks_menu_items),
	(athena_window_remove_go_menu_items): Updated for API name changes.

2000-11-15  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* src/athena-view-frame.c 
	(athena_view_frame_new): ref the ui_container
	
	(athena_view_frame_destroy_client): check if ui_container->win
	is NULL before trying to use it; unref the ui_container
	
	* components/adapter/bonobo-stream-vfs.c (vfs_copy_to): Fix a bug
	whereby the `copyTo' operation would not handle -1 as a request to
	copy the whole file properly.
	
2000-11-15  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by:  George Lebl  <jirka@5z.com>

	* components/loser/README: Added missing `crash' mode to docs.

	* src/athena-view-frame.c: (athena_view_frame_destroy_client,
	athena_view_frame_handle_client_destroy,
	athena_view_frame_handle_client_gone, check_if_view_is_gone):
	Added calls to `bonobo_window_deregister_dead_components' to clean
	up menus and toolbars from dead components, fixing Athena bug
	1740.

2000-11-15  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize), (eazel_install_log_to_stderr),
	(eazel_install_failed_because_of_disk_full):
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file):
	* components/services/install/lib/eazel-install-public.h:

	Re-shuffle logging stuff again to try to make sure that we log as
	little as possible until the log handler is set up.  Add a flag to
	the installer service that indicates if the installer ran out of
	disk space.  Then, you know, actually check the return codes of
	fwrite/fclose to see if they failed.
	
	* athena-installer/src/Makefile:

	More crap.
	
	* athena-installer/src/installer.c: (create_what_to_do_page),
	(create_install_page), (create_window), (get_detailed_errors),
	(download_failed), (eazel_install_preflight), (install_done),
	(eazel_installer_initialize):

	Re-shuffle some of the initialization to move as much as possible
	after the fetching of the text strings.  It isn't possible to
	cover 100% of the cases this way, so load the default text strings
	first, so we'll have text to display in early errors.  Fix a
	dyslexic typo that would occasionally cause an assertion to fail.
	Notice the new disk-full flag and give an appropriate error
	message.

	* athena-installer/src/main.c: (check_disk_space), (main):

	Check for disk space before starting, and refuse to even start
	unless there's N space in /tmp and M space in /.  For now, N = M =
	75 MB.

	* athena-installer/src/prescript:

	Apply kisza's patch (4729) to fix xhost parameters.

2000-11-14  Mathieu Lacage  <mathieu@eazel.com>

	Buddy: john harper.
	FIX bug 2946: no icon under cursor when dragging from 
	tree view.
	* components/tree/athena-tree-view-dnd.c:
	(athena_tree_view_drag_begin), call new function below
	(athena_tree_view_set_dnd_icon): sets the icon for the 
	just-started drag.

2000-11-14  Mathieu Lacage  <mathieu@eazel.com>

	* components/tree/athena-tree-view-dnd.c:
	(athena_tree_view_drag_motion),
	(athena_tree_view_motion_notify),
	(athena_tree_view_make_prelight_if_file_operation),
	(athena_tree_view_prelight_stop),
	(athena_tree_view_drag_destroy):
	make it use the new prelighting code. leave the old code around
	even though it does nothing. The new prelighting now flickers like
	hell but maciej says he wants to fix it.
	* libathena-extensions/athena-ctree.c: (athena_ctree_row_at),
	(get_cell_rectangle), (athena_ctree_set_prelight), (draw_row),
	(real_insert_row), (athena_ctree_node_nth),
	(athena_ctree_find): implement prelighting. copy/paste code from 
	the AthenaList code to do it.
	* libathena-extensions/athena-ctree.h: add signature for
	athena_ctree_set_prelight plus fields in AthenaCTreeRow.
	* libathena-extensions/athena-list.c:
	(athena_list_prelight_if_necessary): remove useless code.

2000-11-14  Eskil Heyn Olsen  <eskil@eazel.com>

	buddy: Ramiro Estrugo <ramiro@eazel.com>

	* configure.in:
	Fix to make --disable-eazel-services work, (4722), it no
	longer checks for rpm and ammonite, nor tries to build
	rpmview.

2000-11-14  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-db2html2/gdb3html.c:
        (init_entities),
        (gdb3html_internalSubset):
        New function and a workaround for the entity bug. Should now support
        &mdash;/&hellip;/&percent; - Fixes bug #2438.

        * components/help/help-method.c:
        (transform_file), (old_help_file),
        (find_help_file):
        Realized that that the gnome_help_file_path function checks for the
        existance of the file using g_file_exists. This spoiled things for the
        way we were trying to detect locale. Fixed it (Bug #4618).

        There is still a bug in this which I will tackle later. This'll do for
        now.

2000-11-14  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-directory-background.c:
	(athena_file_background_event_filter), (set_root_pixmap):
	Athena no longer responds to PropertyChange events on
	the root window that it originates (bug 3038)

	* libathena-extensions/athena-background.c:
	(update_drawable_with_pixbuf), (athena_background_draw),
	(athena_background_draw_to_drawable),
	(athena_background_draw_aa),
	(athena_background_draw_to_canvas),
	(athena_background_load_image_callback),
	(athena_background_start_loading_image),
	(athena_background_set_image_uri),
	(set_image_and_color_image_loading_done_callback),
	(athena_background_set_image_uri_and_color):
	athena_background_set_image_uri_and_color used to generate
	an extra SETTINGS_CHANGED + reformatted a bunch of code.

2000-11-14  Darin Adler  <darin@eazel.com>

	* src/athena-property-browser.c: Some small stuff that got
	left out of my last commit by accident.

2000-11-14  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/file-manager/fm-directory-view.c:
	(display_selection_info_idle_callback),
	(update_menus_idle_callback), (display_pending_idle_callback): Add
	code to ref the BonoboControl around all three of these idle
	functions to eliminate the problem where the directory view would
	get destroyed in the middle of an idle.
	
	* data/browser.xml:
	* data/linksets/apps.xml:
	* data/linksets/desktop.xml:
	* data/linksets/portals.xml:
	* data/linksets/search_engines.xml:
	* data/static_bookmarks.xml:
	Used "_" prefix on all localizable fields of XML files.
	
	* po/POTFILES.in: Add all these XML files that need translation.
	
	* libathena-extensions/athena-link-set.c:
	(athena_link_set_install), (athena_link_set_is_installed),
	(athena_link_set_remove): Fix storage leaks, also use
	athena_xml_get_property_translated to get the property for the
	"name" property so it can be translated if desired.
	
	* libathena-extensions/athena-xml-extensions.h:
	* libathena-extensions/athena-xml-extensions.c:
	(athena_xml_get_property_translated): Add a version of
	xmlGetProp that looks for an untranslated version of the property
	and runs it through gettext if there is not a pre-translated
	version present.  For strings downloaded from the service, for
	example, we'll probably use a pre-translated string, but for
	things in the Athena source tree we can use an untranslated
	string.
	
	* src/athena-bookmark-parsing.c:
	(athena_bookmark_new_from_node): Use
	athena_xml_get_property_translated to get the bookmark name so
	that static bookmarks can have names translated with gettext. New
	versions of the static bookmarks downloaded from the service can
	use either kind of name. And user-created bookmarks are not run
	through the gettext mechanism.
	
	* src/athena-window-menus.c: (create_menu_item_from_node): Use
	athena_xml_get_property_translated to get the folder names
	translated just as the bookmarks themselves.

	* src/athena-link-set-window.c: (get_link_set_names): Added a
	FIXME. The link set names should come from inside the XML, not
	from the file names.
	
	* src/athena-property-browser.c: (get_xml_path),
	(read_browser_xml), (write_browser_xml), (get_color_category):
	(remove_color), (add_color_to_file): Factor out some shared code.
	(add_reset_property): Make hard-wired font size with FIXME.
	(make_properties_from_xml_node): Fix storage leaks and get the
	name of the color using athena_xml_get_property_translated so
	the names can be translated.
	(set_up_category_width): Fix storage leaks
	(athena_property_browser_update_contents): Fix storage leaks and
	get the display name and description with
	athena_xml_get_property_translated so they can be translated.

	* check-THANKS.pl: Got rid of extra blank line at end.

	* libathena-extensions/athena-customization-data.c:
	(format_name_for_display): Add FIXME to bad-for-localization
	function that turns "_" into " " and capitalizes the first letter
	after each " ".
	
2000-11-14  Gene Z. Ragan  <gzr@eazel.com>

	Fixed a bug where changing the Athena theme would cause
	the history view to crash.  The problem was with an
	improperly defined signal handler.
	
	* components/history/athena-history-view.c:
	(history_view_update_icons), (do_destroy), (make_obj):

2000-11-14  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.c: (determine_turbolinux_version),
	(determine_mandrake_version), (trilobite_get_distribution_name):

	Add detection of version numbers for Mandrake, in the hopes that
	someday they'll be supported.
	
	* athena-installer/src/installer.c:
	(get_detailed_errors_foreach), (eazel_installer_post_install),
	(start_logging), (find_old_tmpdir), (eazel_installer_initialize):
	* athena-installer/src/main.c: (main):
	* athena-installer/src/prescript:

	Fix handling of /tmp directory and make it configurable on the
	command line.  Clarify the "your distribution not supported"
	message.  Clean up the prescript considerably, hopefully in the
	process fixing bugs with specifying what shell to use, what su to
	use, and allowing root to run the installer (worksforme).

2000-11-13  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 1633, History sidebar panel items all display generic 
	bookmark icon.
	
	* libathena/athena-view-component.idl:
	Added icon string element to History structure to hold
	an pifbuf converted to a XML string.

	* src/athena-window-manage-views.c: (get_history_list_callback):
	Get bookmark pixbuf, convert it to XML and copt the XML string into
	the CORBA structure that is added to the list to be returned.
	
	* components/history/athena-history-view.c: 
	(install_icon):
	Check and see if pixbuf is non-NULL. If it is, use it. Otherwise
	use the generic bookmark icon.
	
	(history_view_update_icons):
	Reload entire list to ensure that proper icons are used.
	
	(history_load_location):
	Call install_icon with new pixbuf parameter.	

2000-11-13  Eskil Heyn Olsen  <eskil@eazel.com>

	A lot of housecleaning, for which there were no bug reports...
	amongst this some of the leak fixing that libleakcheck pointed
	out.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (delete_files), (main):
	Pass the install categories to the problem handler
	Don't ask about delete iff --file was used
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_check_for_file_conflicts),
	Added a comment
	(eazel_install_do_transaction_save_report),
	Don't store the provides lists when storing the transaction
	(eazel_install_display_arguments),
	(eazel_install_start_transaction),
	Log rpm arguments again
	(eazel_install_add_to_extras_foreach),
	(eazel_install_check_existing_packages),
	(eazel_install_ensure_deps), (eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse),
	(eazel_uninstall_check_for_install):
	Leak fixing
	
	* components/services/install/lib/eazel-install-md5.c:
	(md5_get_digest_from_file):
	Close files after md5 check
	* components/services/install/lib/eazel-install-object.c:
	(xml_from_packagedata), (xml_from_packagedata_list),
	Packagedata to xml with provides lists
	(eazel_install_unref), 
	call gtk_object_unref i EAZEL_INSTALL_NO_CORBA
	(eazel_install_initialize),
	(eazel_install_fetch_remote_package_list), (eazel_install_log),
	(eazel_install_open_log), (eazel_install_alter_mode_on_temp),
	(eazel_install_delete_downloads), (eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_emit_install_progress),
	(eazel_install_emit_install_progress_default),
	(eazel_install_emit_download_progress),
	(eazel_install_emit_download_progress_default),
	(eazel_install_emit_preflight_check),
	(eazel_install_emit_preflight_check_default),
	(eazel_install_emit_download_failed),
	(eazel_install_emit_download_failed_default),
	(eazel_install_emit_md5_check_failed),
	(eazel_install_emit_md5_check_failed_default),
	(eazel_install_emit_install_failed),
	(eazel_install_emit_install_failed_default),
	(eazel_install_emit_uninstall_failed),
	(eazel_install_emit_uninstall_failed_default),
	(eazel_install_emit_dependency_check),
	(eazel_install_emit_dependency_check_default),
	(eazel_install_emit_done), (eazel_install_emit_done_default):
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-private.h:
	The rest is rename of a define in the .h file
	
	* components/services/install/lib/eazel-install-problem.h:
	* components/services/install/lib/eazel-install-problem.c:
	(eazel_install_problem_debug_attempts), (compare_problem_case),
	(add_case), (add_cannot_solve_case), (add_force_install_both_case),
	(add_force_remove_case), (eazel_install_problem_case_to_string),
	(eazel_install_problem_case_foreach_destroy),
	(finalize_attempts_hash_cleanup), (eazel_install_problem_finalize),
	(problem_step_foreach_remove), (eazel_install_problem_step),
	(eazel_install_problem_tree_to_case),
	(eazel_install_problem_find_dominant_problem_type),
	(find_dominant_problems), (build_categories_from_problem_list),
	(eazel_install_problem_handle_cases):
	Strewed debug output around.
	Added a CANNOT_SOLVE case.
	Fixed a memory corruption that occured when I freed handled
	problems
	Made the humanreadable strings i18n'ed, and added comments for the
	translators.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package), (get_search_url_for_package):
	Leak fixing.
	
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query), (eazel_install_simple_query):
	Added which root it's opening to the debug output, used to catch a
	bug in the installer.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_rpm_set_settings),
	(eazel_install_start_transaction_make_rpm_argument_list),
	(eazel_install_free_rpm_system),
	(eazel_install_prepare_rpm_system):
	Leak fixing and debug output changing...
	
	* components/services/install/lib/eazel-install-xml-package-list.h:
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (parse_category),
	(eazel_install_packagedata_to_xml),
	(eazel_install_packagelist_to_xml),
	(eazel_install_categorydata_to_xml), (osd_parse_implementation),
	(osd_parse_softpkg):
	Leak fixing, plus the ability to generate xml without PROVIDES.
	
	* components/services/install/lib/makefile.staticlib.in:
	Added eazel-install-problem, since the installer now uses it.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.h:
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_install_parse_uri),
	(athena_service_install_done),
	(athena_service_install_view_update_from_uri):
	Moved the category list into the details for the view, so when
	calling eazel-install-problem handler, I could pass the categories
	to install.
	
	* components/services/trilobite/helper/eazel-helper.security.in:
	Fixed so it should work with all usermode versions.
	
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h
	:
	* components/services/trilobite/libtrilobite/helixcode-utils.c:
	* components/services/trilobite/libtrilobite/helixcode-utils.h:
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_fetch_uri), (trilobite_fetch_uri_to_file),
	(trilobite_setenv):
	Leak fixing and debug output and s/glib types/c types/.
	
	* athena-installer/src/HACKING:
	Added a warning saying you have to be Eskil or Robey to make this
	compile.
	
	* athena-installer/src/Makefile:
	Yes.
	
	* athena-installer/src/callbacks.c: (begin_install):
	Hacked to use the eazel-install problem solver.
	
	* athena-installer/src/installer.h:
	* athena-installer/src/installer.c: (create_what_to_do_page),
	(create_install_page), (jump_to_error_page), (start_over),
	(dont_start_over_callback), (jump_to_retry_page),
	(create_finish_page_good), (eazel_install_progress),
	(eazel_download_progress), (create_initial_force_remove_category),
	(add_force_remove), (get_detailed_errors_foreach),
	(get_detailed_errors), (install_failed), (eazel_install_preflight),
	(install_done), (eazel_installer_add_category), (check_system),
	(more_check_system), (eazel_installer_do_install),
	(eazel_installer_post_install), (draw_splash_text),
	(eazel_installer_set_default_texts), (eazel_installer_setup_texts),
	(eazel_install_get_depends), (add_singular_package),
	(eazel_installer_initialize):
	Changed to use the eazel-install-problem handler.
	Most text strings are taken from a array, which is set in a
	function that can grab the strings from a server (partly fix for
	1094).
	Removed all the old problem handler code.

	* athena-installer/src/main.c: (main):
	Added a secret --package option that makes the installer ignore
	the server specified package and just download another. Good for
	debugging.

2000-11-13  Mathieu Lacage  <mathieu@eazel.com>

	Make maciej happy and split the dnd code in a new file.
	
	* components/tree/Makefile.am: add new files.
	* components/tree/athena-tree-view-dnd.c: new file for dnd code.
	(tree_view_realize_callback), (athena_tree_view_init_dnd),
	(athena_tree_view_drag_begin), (athena_tree_view_drag_end),
	(collapse_time_callback), (athena_tree_view_drag_leave),
	(athena_tree_view_drag_motion), (athena_tree_view_drag_drop),
	(athena_tree_view_drag_data_received),
	(athena_tree_view_drag_data_get),
	(athena_tree_view_button_press),
	(athena_tree_view_button_release),
	(athena_tree_view_motion_notify),
	(athena_tree_view_make_prelight_if_file_operation),
	(athena_tree_view_expand_node),
	(athena_tree_view_collapse_node),
	(athena_tree_view_is_tree_node_expanded),
	(athena_tree_view_expand_or_collapse_row),
	(athena_tree_view_move_copy_files),
	(athena_tree_view_find_drop_target),
	(athena_tree_view_is_tree_node_directory),
	(athena_tree_view_tree_node_at), (athena_tree_view_item_at),
	(athena_tree_view_get_drag_uri),
	(athena_tree_view_ensure_drag_data), (athena_dump_info),
	(expand_hack_unref), (expand_hack_new), (expand_time_callback),
	(athena_tree_view_expand_maybe_later),
	(auto_scroll_timeout_callback),
	(athena_tree_view_start_auto_scroll),
	(athena_tree_view_stop_auto_scroll),
	(athena_tree_view_real_scroll),
	(athena_tree_view_get_drop_action),
	(athena_tree_view_collapse_all),
	(athena_tree_view_receive_dropped_icons),
	(athena_tree_view_prelight_stop),
	(athena_tree_view_drag_destroy),
	(athena_tree_view_drag_destroy_real):
	* components/tree/athena-tree-view-dnd.h: header.
	* components/tree/athena-tree-view-private.h: shared stuff between
	TreeView and dnd code.
	
	* components/tree/athena-tree-view.c: remove all those functions.
	(athena_tree_view_insert_model_node), (forget_view_node),
	(athena_tree_view_remove_model_node),
	(athena_tree_view_update_model_node),
	(athena_tree_view_initialize),
	(athena_tree_view_model_node_to_view_node),
	(athena_tree_view_node_to_model_node),
	(athena_tree_view_node_to_file), (tree_expand_callback),
	(tree_collapse_callback), (tree_select_row_callback),
	(athena_tree_view_find_parent_node):
	* components/tree/athena-tree-view.h:

2000-11-13  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* configure.in:
	Enable the sign-compare and cast-align warnings.
	
	* components/help/converters/gnome-db2html2/gdb3html.c:
	(find_first_element):
	* components/help/hyperbola-filefmt.c: (fmt_free_tree_info):
	* components/help/hyperbola-nav-index.c:
	(hyperbola_navigation_index_update_clist), (despace),
	(end_element):
	* components/history/athena-history-view.c:
	(history_load_location):
	* components/mozilla/athena-mozilla-content-view.c:
	(string_list_get_index_of_string):
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_string_sequence_to_glist),
	(corba_packagedatastructlist_from_packagedata_list),
	(packagedata_list_from_corba_packagedatastructlist),
	(categorydata_list_from_corba_categorystructlist):
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query):
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_monitor_rpm_process_pipe):
	* components/services/install/lib/eazel-install-rpm-signature.c:
	(read_rpm_lead), (read_rpm_signature):
	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (trilobite_root_helper_run_program),
	(trilobite_root_helper_set_time):
	* cut-n-paste-code/widgets/athenaclist/athenaclist.c:
	(athena_clist_get_arg), (athena_clist_construct):
	* helper-utilities/authenticate/athena-authenticate.c: (main):
	* libathena-extensions/athena-background.c:
	(set_image_and_color_image_loading_done_callback):
	* libathena-extensions/athena-buffered-widget.c:
	(athena_gdk_pixbuf_tile_alpha):
	* libathena-extensions/athena-caption-table.c:
	(entry_activate):
	* libathena-extensions/athena-caption-table.h:
	* libathena-extensions/athena-ctree.c:
	(athena_ctree_node_nth), (athena_ctree_drag_motion):
	* libathena-extensions/athena-ctree.h:
	* libathena-extensions/athena-directory-async.c:
	(metafile_write):
	* libathena-extensions/athena-file-changes-queue.c:
	(athena_file_changes_consume_changes):
	* libathena-extensions/athena-file-operations-progress.c:
	(truncate_string_from_start):
	* libathena-extensions/athena-file-operations.c:
	(extract_string_until):
	* libathena-extensions/athena-file-utilities.c:
	(athena_read_entire_file):
	* libathena-extensions/athena-gdk-extensions.c:
	(athena_get_largest_fitting_font):
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_get_sidebar_panel_view_identifiers):
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_window_set_initial_geometry_from_string),
	(athena_gtk_menu_set_item_visibility):
	* libathena-extensions/athena-icon-canvas-item.c:
	(draw_or_measure_label_text), (draw_or_measure_label_text_aa):
	* libathena-extensions/athena-icon-container.c:
	(rubberband_timeout_callback), (destroy), (compute_stretch):
	* libathena-extensions/athena-icon-container.h:
	(athena_icon_container_find_drop_target):
	* libathena-extensions/athena-icon-factory.c:
	(check_recently_used_list), (get_themed_icon_file_path),
	(revise_scale_factors_if_too_big):
	* libathena-extensions/athena-icon-text-item.c:
	(recompute_bounding_box), (iti_draw), (iti_selection_motion):
	* libathena-extensions/athena-label.c:
	(athena_label_size_allocate), (label_recompute_line_geometries):
	* libathena-extensions/athena-list.c: (draw_cell),
	(athena_list_drag_data_received):
	* libathena-extensions/athena-mime-actions.c:
	(server_matches_content_requirements),
	(athena_do_component_query):
	* libathena-extensions/athena-password-dialog.c:
	(caption_table_activate_callback):
	* libathena-extensions/athena-preferences-item.c:
	(has_image_file):
	* libathena-extensions/athena-scalable-font.c:
	(file_as_string), (parse_font_description_file),
	(athena_text_layout_new):
	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-volume-monitor.c:
	(check_permissions):
	* libathena/athena-view.c:
	(athena_shallow_g_list_from_uri_list):
	* libathena/athena-zoomable.c:
	(athena_g_list_from_ZoomLevelList):
	* librsvg/rsvg-ft.c: (rsvg_ft_measure_or_render_string):
	* librsvg/rsvg.c: (rsvg_parse_transform):
	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_create_background_context_menu_items),
	(get_sort_criterion_by_metadata_text), (get_sort_criterion_by_id):
	* src/file-manager/fm-list-view.c: (select_row_common),
	(select_matching_name_callback), (select_previous_next_common),
	(fm_list_view_bump_zoom_level):
	* src/athena-search-bar-criterion.c:
	(athena_search_bar_criterion_update_valid_criteria_choices):
	* src/athena-shell.c: (corba_open_windows),
	(corba_open_default_window):
	* src/athena-sidebar.c: (athena_sidebar_add_panel_items):
	* src/athena-window-menus.c:
	(athena_window_disable_keyboard_navigation_for_menus):
	* src/athena-window.c: (athena_window_size_request):
	Fix all sign-compare violations.

2000-11-13  Mathieu Lacage  <mathieu@eazel.com>

	Buddy: pavel.
	Fix bug 2422 and 4382.
	
	* components/tree/athena-tree-view.c:
	(filtering_changed_callback), 
	(collapse_time_callback): added. collapses opened folders when
	you leave the tree view.
	(athena_tree_view_drag_leave): make it call tree_view_drag_destroy
	(athena_tree_view_drag_motion): cleanup, make it call
	tree_view_drag_destroy_real
	(athena_tree_view_drag_drop): spaces.
	(athena_tree_view_drag_data_received): cleanup: make it call
	tree_view_drag_destroy.
	(athena_dump_info): cleanup.
	(expand_time_callback): cleanup.
	(athena_tree_view_expand_maybe_later): cleanup
	(athena_tree_view_collapse_all): cleanup.
	(athena_tree_view_receive_dropped_icons): make it collapse
	correctly.
	(athena_tree_view_prelight_stop): new function: clears prelighting.
	(athena_tree_view_drag_destroy): new function: destroys when drag finished.
	(athena_tree_view_drag_destroy_real): new function: destroys when drag begins.
	* docs/dnd.txt: add some thoughts.
	* libathena-extensions/athena-drag.c: 
	(athena_drag_init): init new field.
	* libathena-extensions/athena-drag.h: add shared field to public structure.

2000-11-13  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4700, ejecting an audio cd kills Athena
	
	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_get_volume_name):
	Check for NULL string before using it.
	
	* src/file-manager/fm-desktop-icon-view.c:
	(volume_unmounted_callback):
	Don't bother emiting signal if volume was never mounted
	in the first place.

2000-11-13  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	More work towards using Bonobo for context menus. Also, found
	and fixed bug where "Open With" items weren't working from
	the File menu (though they were from the context menu).

	* src/file-manager/fm-directory-view.c:
	(add_open_with_program_menu_item): Determine verb name from item
	path, not item label. This was broken before, causing "Open With"
	items in the File menu not to work. Not sure why this ever worked,
	but I didn't spend too much time investigating its change history.
	(add_open_with_app_bonobo_menu_item), 
	(add_open_with_viewer_bonobo_menu_item): Removed these functions;
	they were adding an extra layer that ended up hurting rather than
	helping.
	(add_application_to_bonobo_menu),
	(add_component_to_bonobo_menu): consolidated with the removed
	functions; add item to context menu as well as normal menu.
	(reset_bonobo_open_with_menu): remove menu items and verbs from
	context menu as well as normal menu.

2000-11-13  Josh Barrow  <josh@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_register):
	Renamed "directory" to "folder"

2000-11-13  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: John Sullivan  <sullivan@eazel.com>

	* src/run-athena: Fixed bug 3248 (2nd copy of Athena faults)
	by removing the athena-clean.sh calls from run-athena (Ramiro
	claims it was fixed already, but there were race conditions, and
	these calls are masking bugs that we want to fix for release).

2000-11-13  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* components/adapter/athena-adapter-progressive-load-strategy.c:
	Increased chunk-size to 32k in an unsuccesful attempt to improve
	the situation with regards to fix bug 3256 (attempt to view huge
	text file is very slow). It did not help which leads me to believe
	the problem is with the way the text control handles progressive
	updates.

	Fix bug 2180 (switching from icon view to list view, the zoom
	control disappears and then reappears).
	
	* src/athena-window-manage-views.c (load_content_view,
	zoom_level_changed_callback): Don't show and hide the zoom control
	at various times. Instead, let
	`athena_window_set_content_view_widget' establish the right
	visibility state when we finally enable the widget. This way, the
	zoom control won't ever disappear and reappear when switching
	between two different zoomable views.
	* src/athena-window.c (athena_window_set_content_view_widget):
	Set the zoom control to the right visibility state when setting
	the new widget.

2000-11-13  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-theme-selector.c: (exit_remove_mode):
	fixed bug 3823, text in theme selector is wrong, by correcting
	a mis-set boolean.
	
2000-11-13  John Sullivan  <sullivan@eazel.com>

	More progress on using Bonobo for context menu items.
	Now the Bonobo context menu items get their labels
	updated to match the selection.

	* src/file-manager/fm-directory-view.c: 
	(compute_menu_item_info):
	Now has return parameters for the label with & without underscore,
	instead of a boolean parameter to choose between them.	
	(append_gtk_menu_item), (append_selection_menu_subtree):
	Update callers that only want the without-underscore version.	
	(update_one_menu_item): Set the label for the verb (no underscore)
	as well as the label for the menu item (include underscore).

	* src/file-manager/fm-icon-view.c: 
	(compute_menu_item_info):
	Now has return parameters for the label with & without underscore,
	instead of a boolean parameter to choose between them.
	(insert_one_context_menu_item),
	(fm_icon_view_create_background_context_menu_items):
	Update callers that only want the without-underscore version.
	(update_one_menu_item): Set the label for the verb (no underscore)
	as well as the label for the menu item (include underscore).

	* src/file-manager/fm-search-list-view.c:
	(compute_reveal_item_name_and_sensitivity):
	Now has return parameters for the label with & without underscore,
	instead of a boolean parameter to choose between them.
	(real_create_selection_context_menu_items): Update caller that
	only wants the without-underscore version.
	(update_reveal_item): Set the label for the verb (no underscore)
	as well as the label for the menu item (include underscore).
	
	* src/file-manager/athena-directory-view-ui.xml:
	Add some placeholders in the selection context menu so subclasses
	can place items correctly.
	* src/file-manager/athena-icon-view-ui.xml:
	Insert Rename, Stretch, and Unstretch into context menu.
	* src/file-manager/athena-search-list-view-ui.xml:
	Define commands for each verb. Move tips to commands.
	Insert Reveal into context menu.

2000-11-13  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 4703, add new background crashes when you pick trash.
	
	* src/athena-property-browser.c: (add_background_to_browser):
	fixed by removing a double-free in the case when the selected
	file is not an image.
	
2000-11-13  John Sullivan  <sullivan@eazel.com>

	More work towards converting directory view context menus
	to use Bonobo. Checking in so Darin can help me debug.
	The Bonobo context menus still aren't used unless you
	modify code.

	* src/file-manager/fm-directory-view.c: 
	(real_merge_menus): Add verb handler for "Reset Background"
	(fm_directory_view_pop_up_selection_context_menu): Add
	conditional to execute Bonobo version (if TRUE changed to FALSE).
	(fm_directory_view_pop_up_background_context_menu): formatting tweak.
	* src/file-manager/athena-directory-view-ui.xml:
	Added command definitions for all verbs. Moved labels from
	context items into commands. Moved tips into commands. Populated
	the background and selection popup menu definitions.
	* src/file-manager/athena-icon-view-ui.xml:
	Added command definitions for all verbs and ids. Defined labels
	for commands. Moved tips into commands. Partially populated the
	background popup menu definition.
	* src/athena-shell-ui.xml: Moved accelerators for Zoom commands
	to menu items, so they don't appear in context menus. Add labels
	for Zoom commands. Add degenerate background popup that defines
	the zoom items.

2000-11-13  Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/athena-program-choosing.c
	(athena_launch_application_from_command): Remove stray printf.

2000-11-13  Maciej Stachowiak  <mjs@eazel.com>

	* THANKS: Updated based on running check-THANKS.pl
	* AUTHORS, ChangeLog-200001018: Fixed some typos in
	people's email addresses.

2000-11-13  Maciej Stachowiak  <mjs@eazel.com>

	Fix bugs 3641 (text preview gets garbled when switching files in
	the middle of a load) and 3479 (Athena crashes if
	athena-adapter* missing).

	* components/adapter/athena-adapter-progressive-load-strategy.c
	(call_when_stopped, load_and_free_uri, declare_done_loading,
	stop_loading,
	athena_adapter_progressive_load_strategy_load_location): Make
	sure previous load is completely stopped before ever starting a
	new load.

	* components/adapter/athena-adapter.c:
	(athena_adapter_destroy, athena_adapter_new): Avoid reporting
	signals to the view frame while in the middle of destroying the
	adapter.
	* src/athena-component-adapter-factory.c
	(athena_component_adapter_factory_get): Return NULL when loading
	the adapter factory component fails.
	(athena_component_adapter_factory_initialize,
	component_adapter_factory_at_exit_destructor): Changes required by
	the above.
	* src/athena-view-frame.c
	(athena_view_frame_set_to_component): report failure if we can't
	load the adapter factory.
	* src/athena-window-manage-views.c
	(report_content_view_failure_to_user, load_content_view,
	handle_view_failure, athena_window_set_sidebar_panels): Do a
	somewhat better job of reporting view load failures.

2000-11-13  Maciej Stachowiak  <mjs@eazel.com>

	* components/tree/athena-tree-view.c
	(athena_tree_view_insert_model_node,
	athena_tree_view_update_model_node): Set both open and closed
	pixmaps, so open folders have a disttinct appearance in the tree,
	in addition to the disclosure triangles. This fixes bug 2421. This
	work was needed to fix bug 3279 (Icons in tree sidebar panel don't
	update when theme is changed), which was a side effect of not
	doing this.

2000-11-13  Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/athena-ctree.c (ctree_is_hot_spot):
	Expand margins around expander by 3 pixels on each side to make it
	easier to click the disclosure triangle (triangle will prelight
	when within range), to fix bug 4479


	Fix bugs 4497 (Add configuration option to show only folders in
	tree view) and 2419 (Tree view should track "show hidden files"
	preference):

	* components/tree/athena-tree-view.c:
	(athena_tree_view_should_skip_file,
	athena_tree_view_insert_model_node,
	athena_tree_view_remove_model_node,
	athena_tree_view_update_model_node): Handle possibly filtering
	out hidden files, backup files or non-directories.
	
	(filtering_changed_callback,
	athena_tree_view_initialize): Initialize from and watch
	filtering preferences, reload whole tree when prefs change.
	
	(athena_tree_view_destroy): Stop watching filtering prefs.

	(reload_model_node, reload_whole_tree, expand_node_for_file,
	athena_tree_view_receive_dropped_icons): Update code for
	reloading the tree on expand/collapse etc.

 	* components/tree/athena-tree-model.c
	(athena_tree_model_directory_files_added_callback): Check if we
	already have a node for each file before trying to create a new
	one. This was needed because otherwise chaning the preference
	settins mentioned above would result in crashes.

	* libathena-extensions/athena-file.h,
	libathena-extensions/athena-file.c:
	(athena_file_is_hidden_file, athena_file_is_backup_file,
	athena_file_should_show,
	filter_hidden_and_backup_partition_callback,
	athena_file_list_filter_hidden_and_backup): Move hidden file and
	backup file filtering logic here from fm-directory-view.c.

	* src/file-manager/fm-directory-view.c (queue_pending_files): Use
	`athena_file_list_filter_hidden_and_backup' to do filtering.
	
	* libathena-extensions/athena-global-preferences.h,
	libathena-extensions/athena-global-preferences.c
	(global_preferences_create_dialog, global_preferences_register):
	Add a new preference for showing only directories in the tree
	view.

	* libathena-extensions/athena-preferences-dialog.c: Make
	preferences dialog a bit bigger to accomodate the new setting.

2000-11-12  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 3210, trash image fails to appear when defined as
	emblem, by disallowing new emblems to be defined with the same
	name as intrinsic ones.  Also, disallowed adding an emblem with
	the same name as an existing one.

	* src/athena-property-browser.c:
	(athena_property_browser_destroy), (emblem_keyword_valid),
	(is_reserved_keyword), (emblem_dialog_clicked),
	(make_properties_from_directories):
	maintain a glist of emblem names, and check it when we're adding a
	new one to make sure it's not already on it.  Put up an error dialog
	if it already exists.
	
2000-11-12  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 3116, add preference for disabling sound preview
	
	* libathena-extensions/athena-global-preferences.h:
	defined sound preview preference
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_create_dialog), (global_preferences_register):
	registered sound preview preference and added to speed tradeoffs
	* src/file-manager/fm-icon-view.c: (should_preview_sound),
	(icon_container_preview_callback):
	only preview sounds if the preference is set
	
2000-11-12 John Fleck <jfleck@inkstain.net>

	* adding term tag support to gnome-db2html2 - fixing bug #4406
	
2000-11-12  Maciej Stachowiak  <mjs@eazel.com>

	Fixed bugs 4503 and 4584.
	
	* components/tree/athena-tree-view.c: Added
	`current_main_view_uri' field to details struct.
	(athena_tree_view_load_uri): Set `current_main_view_uri' field
	every time, whether or not we end up selecting it.
	(athena_tree_view_destroy): Free `current_main_view_uri' and
	`selected_uri' fields.
	(tree_select_row_callback): Only ignore the select if the selected
	row matches `current_main_view_uri', not just `selected_uri' to
	fix bug 4584 (Can not reselect the previous directory in the tree
	when I entered a "hidden" directory in the content view)

	(athena_tree_view_button_release): Only select the row on a
	release of button 1, otherwise ignore to fix bug 4503 ("Tree
	Sidebar panel treats right-clicks as left-clicks (should do
	nothing)")
 
	(tree_view_realize_callback): trivial formatting fix. 

2000-11-11  Maciej Stachowiak  <mjs@eazel.com>

	* components/help/hyperbola-nav-tree.c
	(hyperbola_navigation_tree_new): FIx bug 4352 and make the
	redundant "Document Tree" title go away.

2000-11-11  Maciej Stachowiak  <mjs@eazel.com>

	Fixed bugzilla.eazel.com bugs 4051 (applications which require
	terminals don't get them) and 4072 (mime types: command= string
	can't take args?).

	* libathena-extensions/athena-gnome-extensions.c
	(athena_gnome_terminal_shell_execute): Don't take the shell as
	an argument, just use "/bin/sh", there's no reason to use any
	other shell for the purpose of launching a terminal like this.

	(athena_gnome_open_terminal): Don't pass user shell to
	`athena_gnome_terminal_shell_execute'; handle `gnome-terminal'
	properly by passing it "-x" instead of incorrectly trying to quote
	the command.
	
	* libathena-extensions/athena-gnome-extensions.h: Fix minor
	typo.
	
	* libathena-extensions/athena-program-choosing.h,
	libathena-extensions/athena-program-choosing.c:
	(athena_launch_application_from_command): Add a use_termial
	argument and if passed, launch the program in a terminal; minor
	fixes to the way non-terminal-requiring programs are launched as
	well, including not quoting the command, so that it can include
	command line arguments (if the command name includes a space, it
	had better be quoted already).

	(athena_launch_application): Use the new `use_terminal' argument
	when calling `athena_launch_application_from_command'.
	
	* libathena-extensions/athena-program-chooser.c:
	(launch_mime_capplet): Use the new `use_terminal' argument
	when calling `athena_launch_application_from_command'.

	* src/file-manager/fm-desktop-icon-view.c
	(change_desktop_background_menu_item_callback): Use the new
	`use_terminal' argument when calling
	`athena_launch_application_from_command'.
	
	* src/file-manager/fm-directory-view.c (activate_callback): Use
	the new `use_terminal' argument when calling
	`athena_launch_application_from_command'. Also, shell-quote the
	command, since athena_application_launch_from_command won't do
	that for you any more.

2000-11-10  Maciej Stachowiak  <mjs@eazel.com>

	* icons/gnome/Makefile.am, icons/i-executable.png: Restored
	original icon to Gnome theme (Andy accidentally changed it while
	replacing the default theme's exectuable icon).

2000-11-10  Andy Hertzfeld  <andy@eazel.com>

	* icons/Makefile.am:
	* icons/i-executable-aa.png:
	* icons/i-executable.png:
	new executable icons from Susan
	
2000-11-10  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c:
	(athena_color_selection_dialog_new), (add_color_to_file),
	(add_color_to_browser), (show_color_selection_window),
	(add_new_color), (make_properties_from_xml_node):
	fixed bug 4197, colors can't be given a name, by adding a
	color selection window with a name entry, and using that
	to name the color.
	
	* icons/villanova/Makefile.am:
	* icons/villanova/i-directory-accept-*.png:
	fixed bug 4641, missing non-aa "folder-accept" image for the
	villanova theme, by adding new images from Susan.
	
	* icons/eazel/eazel.xml:
	* icons/villanova/villanova.xml:
	tweaked the selection box colors for the eazel and villanova
	themes according to Susan's specification.
	
2000-11-10  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3057, Icon renaming state can get broken by clicking 
	in location bar.
	
	* libathena-extensions/athena-icon-container.c:
	(handle_focus_out_event): 
	Signal handler that ends renaming mode when focus changes.
	(athena_icon_container_initialize):
	Connect "focus_out_event" to new signal handler above.
	
	* libathena-extensions/athena-icon-text-item.c: (layout_text),
	(iti_start_editing), (iti_draw), (iti_event),
	(athena_icon_text_item_select),
	(athena_icon_text_item_get_text),
	(athena_icon_text_item_start_editing),
	(athena_icon_text_item_stop_editing):
	Code style cleanups.

2000-11-10  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	I think 3320 is fixed (I definitely can't reproduce it) but this
	change should eliminate a few remaining possible causes.
	
	* components/tree/athena-tree-model.h,
	components/tree/athena-tree-model.c
	(athena_tree_model_get_node_from_file): New function that gets
	the node corresponding to a AthenaFile (to avoid possible
	problems with multiple AthenaFile objects for one URI).
	
	(athena_tree_model_get_node, report_node_changed,
	report_node_removed_internal,
	athena_tree_model_directory_files_changed_callback,
	athena_tree_model_directory_done_loading_callback): Use where
	possible.

	* components/tree/athena-tree-view.c: (reload_node_for_file,
	athena_tree_view_find_parent_node): Use
	`athena_tree_model_get_node_from_file'.

2000-11-09  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c:
	(athena_property_browser_drag_data_get):
	fix bug where newly added reset coupon in the colors section
	of the property browser wasn't working on the sidebar.  Fixed
	by making sure it issues a uri to a valid image in
	drag_data_get.
	
2000-11-09 Elliot Lee <sopwith@redhat.com>

	* configure.in: Fix freetype2 detection
	* Various makefiles: fix srcdir != builddir.

2000-11-09  Darin Adler  <darin@eazel.com>

	buddy: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-program-chooser.c:
	(repopuluate_program_list), (is_component_default_for_file),
	(program_file_pair_is_default_for_file),
	(program_file_pair_is_in_short_list_for_file),
	(add_to_short_list_for_file), (remove_from_short_list_for_file),
	(remove_default_for_item), (set_default_for_item):
	* libathena-extensions/athena-program-choosing.c:
	(athena_choose_component_for_file):

	Remove unnecessary calls to wait functions. There are still
	one or two cases of calls. Next step is to replace them.

2000-11-09  John Sullivan  <sullivan@eazel.com>

	The beginnings of converting directory view context menus
	to Bonobo. This doesn't work right yet; I'm checking in
	so Darin can help me debug (the new code is iffed out for
	now)

	* src/file-manager/fm-directory-view.c: (get_bonobo_window),
	(create_popup_menu), (real_merge_menus),
	(fm_directory_view_pop_up_background_context_menu):
	* src/file-manager/athena-directory-view-ui.xml:

2000-11-08  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-dnd.c:
	(athena_icon_container_find_drop_target),
	(athena_icon_container_get_drop_action):
	fixed bug 3215 and 3723, bad feedback during emblem dropping,
	by rejecting the drop if we're not over an icon.  Also, made it
	reject the drop for colors and backgrounds if we're not over
	the background.  I also fixed a memory leak in get_drop_action.
	
2000-11-08  Eskil Heyn Olsen  <eskil@eazel.com>

	* configure.in:
	if rpm version check fails, hint at user 
	to --disable-eazel-services

2000-11-08  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_check_for_file_conflicts),
	(eazel_uninstall_downward_traverse):
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query):
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_add_to_rpm_set):
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_new_from_rpm_header),
	(packagedata_fill_from_rpm_header), (packagedata_fill_from_file),
	(packagedata_destroy):
	* components/services/install/lib/eazel-install-types.h:
	* athena-installer/src/installer.c: (more_check_system):
	
	Backport the memory leak fixes from PR2.  Also clean up the use of
	'Header' structs from librpm since they turn out to be secret
	pointers, not structs.

2000-11-08  Darin Adler  <darin@eazel.com>

	buddy: Gene Ragan <gzr@eazel.com>

	* libathena-extensions/athena-file.c: (rename_callback): Since
	metadata for the directory itself is now stored under a fixed
	name, no need to rename the metadata for self-owned files any
	more.
	(get_item_count), (get_size), (compare_directories_by_count),
	(compare_files_by_size), (compare_by_size): Reimplement compares
	by size so they don't use gnome_vfs_file_info_compare -- this
	makes them work better for info == NULL cases.
	(get_date), (compare_by_modification_date): Reimplement compares
	by modification date so they don't use gnome_vfs_file_info_compare
	-- this makes them work better for info == NULL cases.
	(compare_by_name): Sort files that start with "." or "#" last.
	(compare_by_name_and_directory_name): Helper function so that we
	always sort by directory name when names are equal.
	(athena_file_compare_for_sort): Use the new functions above so
	we never have to use the gnome_vfs_file_info_compare function.
	Because of that, we won't have to keep file names around any more.
	This also simplified the logic -- I was able to remove all the
	special cases for info == NULL.
	(get_metadata_name): Function that returns "." for self-owned
	files so the metadata for the directory itself is stored somewhere
	that's not affected by renaming.
	(athena_file_get_metadata), (athena_file_get_metadata_list),
	(athena_file_set_metadata), (athena_file_set_metadata_list),
	(athena_file_get_boolean_metadata),
	(athena_file_get_integer_metadata),
	(athena_file_set_boolean_metadata),
	(athena_file_set_integer_metadata): Use the new
	get_metadata_name function.
	
	* src/file-manager/athena-directory-view-ui.xml: Changed an old
	<menuitem/> to <separator/>.

	* po/.cvsignore: Ignore the tmp directory, but no need to ignore
	the .headerlock file which is now obsolete.

	* README: Minor tweaks.
	* libathena-extensions/Makefile.am: Resorted lists.

2000-11-08  John Sullivan  <sullivan@eazel.com>

	buddy: Darin Adler <darin@eazel.com>

	Fixed bug 4485 (":" as location caused odd error messages)

	* libathena-extensions/athena-directory.c:
	(real_get_name_for_self_as_new_file): Now checks for
	initial-colon as well as missing-colon.
	
	* libathena-extensions/athena-file.c:
	(athena_self_check_file): Added a few self check tests
	for default file naming from bogus directories.

2000-11-08  Ali Abdin  <aliabdin@aucegypt.edu>

	* components/music/athena-music-view.c:
	(xpm_label_box),
	(xpm_dual_label_box):
	Re-write to use gdk-pixbuf. This eliminates a FIXME in there.

2000-11-08  Eskil Heyn Olsen  <eskil@eazel.com>

	* configure.in:
	Fixed bug 4643, check for rpm version 3.0.x

2000-11-08  John Sullivan  <sullivan@eazel.com>

	Fixed bug 4472 (web search uses wrong URI)

	* libathena-extensions/athena-global-preferences.c:
	Change the web search default URI per Laura.

2000-11-08  Mike Fleming  <mfleming@eazel.com>

	Fix relative URI bugs 4415, 4416, 4417.
	Do eazel-services untranslate for link messages

	* components/mozilla/athena-mozilla-content-view.c:
	(mozilla_link_message_callback),
	(remove_internal_relative_components),
	(make_full_uri_from_relative), (mozilla_dom_mouse_click_callback),
	(test_make_full_uri_from_relative):

2000-11-07  Josh Barrow  <josh@eazel.com>

	* icons/eazel/eazel.xml:
	Changed the selection box color to match the icons.

2000-11-07  Darin Adler  <darin@eazel.com>

	Worked on getting rid of wait_until_ready.
	
	* libathena-extensions/athena-directory.c: Got rid of include
	of athena-wait-until-ready.h.
	
	* libathena-extensions/athena-file.c: Got rid of
	athena_file_wait_until_ready.
	
	* libathena-extensions/athena-mime-actions.c:
	(wait_until_ready_callback),
	(athena_mime_actions_wait_for_full_file_attributes):
	Reimplemented so the wait is in here so we can get rid of
	athena_file_wait_until_ready.
	
	* libathena-extensions/athena-mime-actions.h: Moved
	athena_mime_actions_wait_for_full_file_attributes into
	athena-wait-until-ready.h.
	
	* libathena-extensions/athena-program-chooser.c: Added include
	of athena-wait-until-ready.h since this is one of the two files
	that still uses the thing.
	* libathena-extensions/athena-program-choosing.c: Added include
	of athena-wait-until-ready.h since this is one of the two files
	that still uses the thing.
	
	* libathena-extensions/athena-wait-until-ready.h: Removed
	nautilsu_file_wait_until_ready and added
	athena_mime_actions_wait_for_full_file_attributes.
	
	* src/file-manager/fm-directory-view.c:
	(switch_location_and_view): Get rid of code that waits for
	attributes, because the code guarantees they will already be read
	at this point.
	(fm_directory_view_destroy): Stop monitoring the file for the open
	with menu.
	(files_changed_callback): Update the menus whenever a file changes
	or our knowledge about it changes.
	(create_open_with_gtk_menu): Use the new monitor call to arrange
	to get the information about the single selected file that we
	need.
	(reset_bonobo_open_with_menu): Use the new monitor call to arrange
	to get the information about the single selected file that we
	need.
	(activate_callback): Remove the hack to work around the
	wait_until_ready calls. Also remove the wait_until_ready in here
	because we now request all the attributes we will be needing in
	the call_when_ready call (that already existed).
	(fm_directory_view_activate_file): Request all the attributes
	needed for determining MIME actions.
	(monitor_file_for_open_with): New function to monitor the stuff we
	need to know for the Open with menu.
	
	* test/test-athena-mime-actions-set.c: (ready_callback), (main):
	Use call_when_ready instead of wait_until_ready.
	
	* test/test-athena-mime-actions.c: (ready_callback), (main): Use
	call_when_ready instead of wait_until_ready.

	* po/ui-extract.pl: Checked in new version from Kenneth.
	* po/update.pl: Kenneth wanted me to update the license.
	
2000-11-07  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c: (emblem_keyword_valid),
	(emblem_dialog_clicked):
	fixed bugs 4168 and 4171, problems occur when slash and backslash
	are included in emblem names, by only allowing alphanumeric
	characters in emblem names and displaying an error dialog if
	that's not so.
	
2000-11-07  Andy Hertzfeld  <andy@eazel.com>

	* icons/villanova/villanova.xml:
	fixed the villanova theme to use the default document icons
	instead of the ones from the eazel theme, now that the eazel
	ones are different.
	
2000-11-07  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/main.c: (main):
	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_destroy),
	(mozilla_open_uri_callback), (eazel_services_scheme_translate),
	(mozilla_content_view_one_time_happenings):

	fix for bugzillea.eazel.com 4596: using services in two Embedded Mozilla
	windows crashes

2000-11-07  John Sullivan  <sullivan@eazel.com>

	Fixed bug 4489 (some menu items are missing status bar hints)

	* src/file-manager/fm-directory-view.c:
	(add_open_with_program_menu_item): New helper function to
	avoid code duplication; also handles setting tip.
	(add_open_with_app_bonobo_menu_item),
	(add_open_with_viewer_bonobo_menu_item): Use helper function
	and construct tips to pass in for apps & viewers in "Open
	With" submenu.
	* src/file-manager/athena-directory-view-ui.xml: Add a tip
	to "Open With" menu item itself.
	* src/athena-window-menus.c: (append_bookmark_to_menu):
	Tweaked wording of tip used for bookmarks.

2000-11-07  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-file-operations.h:
	* libathena-extensions/athena-file-operations.c:
	* src/athena-first-time-druid.h:
	Tweak to match Athena coding style.
	
	* src/athena-first-time-druid.c: (druid_cancel): Added FIXME
	about the way it quits Athena when you cancel.
	(druid_finished): Use #define constants instead of hard-coded
	URLs.
	(make_anti_aliased_label): Put FIXME where a font and size are
	hard-coded.
	(make_hbox_user_level_radio_button): Put FIXME where a font is
	hard-coded.
	(set_up_user_level_page): Put FIXME where a font size is
	hard-coded.
	(next_update_page_callback): Put FIXME where a comment mentions
	a "timer task" that does not exist.
	(athena_first_time_druid_show), (download_callback),
	(read_file_handle_cancel_cover), (initiate_file_download): Got rid
	of "cheap workaround" for when the druid goes away; instead, we
	cancel the I/O.
	
	Other tweaks to be at least in the vicinity of Athena coding
	style.

2000-11-07  Maciej Stachowiak  <mjs@eazel.com>

	* athena-installer/src/prescript: Make the installer run
	successfully when run as root instead of failing silently, as part
	of the fix to 4605. Sadly, when Eli tried installing as root with
	the modified installer it worked, but running Athena
	subsequently as root resulted in strange Athena behavior, so
	probably we can't call it closed.

2000-11-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_rpm_create_requirement),
	(eazel_install_do_rpm_dependency_check):
	* components/services/install/lib/eazel-install-types.c:
	(eazel_install_requirement_dep_name_compare):
	* components/services/install/lib/eazel-install-types.h:

	Backport bug 4594's fix to head: skip checking breakage on
	packages we're about to install/upgrade.
	
	* athena-installer/src/prescript:

	Revert Josh's well-meaning but incorrect patch to the spelling of
	Gnome in the Athena PR1 version test.

2000-11-07  Eskil Heyn Olsen  <eskil@eazel.com>

	* athena-installer/src/installer.c: (did_we_already_try),
	(add_update_package), (get_detailed_errors_foreach),
	(download_failed), (eazel_installer_do_install):
	Fixed some case where we 1) try and update a package 2) not on
	softcat 3) didn't offer to remove it...
	
2000-11-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_do_file_conflict_check):

	Backport Eskil's mushroom habit to the head.

2000-11-07  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-file-utilities.c:
	(athena_copy_uri_simple), (athena_unique_temporary_file_name):
	* libathena-extensions/athena-file-utilities.h:
	* src/athena-first-time-druid.c: (download_callback):
	Fix for 4585.  Crash saving updates.tgz file from server if it
	already exists.  The fix is to use a unique temporary file name
	and cleaning up after untar the update tarball.

2000-11-07  Mike Fleming  <mfleming@eazel.com>

	* src/athena-first-time-druid.c: (druid_finished),
	(download_callback):

	Ugly fix to 4568 -- If io completes after druid is finished,
	then unpack the file but don't try to update the (now non-existant)
	GUI components

2000-11-06  Maciej Stachowiak  <mjs@eazel.com>

	* src/athena-window-manage-views.c: (load_underway_callback,
	load_complete_callback): Replace FIXME 2460 with a comment
	explaining why current behavior is OK.

2000-11-06  Mike Fleming  <mfleming@eazel.com>

	* src/athena-first-time-druid.c: (druid_finished),
	(download_callback), (initiate_file_download), (set_http_proxy),
	(my_sigalrm_handler), (check_dns_resolution),
	(check_network_connectivity):

	Fix for bug 4549 Check for a potential DNS freeze case, and hang
	for only 15 seconds rather than 2+ mins in this case.

2000-11-06  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/docs/installer-rpm-cases:
	Beginning a document of rpm cases, tree structures and generel
	crack...
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_download_progress_signal),
	(eazel_install_progress_signal), (tree_helper), (install_failed):
	Nicer output, ability to disable pct output (--no-percent)
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_check_for_file_conflicts),
	(eazel_install_do_file_conflict_check):
	Fix for 4579
	
	* athena-installer/src/prescript:
	Removed the crack that starts the athena launcher applet.
	
2000-11-06  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_get_services_address):
	* libathena-extensions/athena-password-dialog.c:
	(athena_password_dialog_new),
	(athena_password_dialog_get_remember),
	(athena_password_dialog_set_remember),
	(athena_password_dialog_set_remember_label_text):

	Backport PR2 changes (fix NULL string check in trilobite, and
	finish Mathieu's patch to turn off the checkbox in the password
	dialog).

2000-11-06  Josh Barrow  <josh@eazel.com>

	* icons/eazel/theme_preview.png:
	Did a new theme preview for the revamped Eazel theme.

2000-11-06  Mathieu Lacage  <mathieu@eazel.com>

	* libathena-extensions/athena-bonobo-extensions.c:
	(oaf_activation_callback): small fix: replace NULL with 
	CORBA_OBJECT_NIL
	* test/Makefile.am: add new test.
	* test/test-athena-async-activation.{c|h}

2000-11-06  Andy Hertzfeld  <andy@eazel.com>

	* icons/eazel/Makefile.am:
	* icons/eazel/eazel.xml:
	* icons/eazel/i-regular.xml:
	* icons/eazel/i-regular-*.png:
	* icons/eazel/i-directory-*.png:
	* icons/eazel/fossil.png:
	
	at Susan's request, transformed the "eazel" theme into her "merion"
	theme.  We still need to update the theme preview icon to reflect
	the new look.
	
2000-11-06  John Sullivan  <sullivan@eazel.com>

	Fixed PR2 bug 4480 (Crash while navigating in Vault).
	Someone still needs to roll this back to the branch.
	Darin has volunteered to do this when he's back from
	lunch unless someone beats him to it. This fix is a
	workaround for the real problem, described in new bug
	4539.

	* src/file-manager/fm-directory-view.c:
	Added details->waiting_for_activation_count_hack.
	(create_open_with_gtk_menu), 
	(reset_bonobo_open_with_menu):
	Don't try to get full file attributes if we're still
	waiting for any pending activation.
	(schedule_update_menus): Added an assert while debugging
	that is useful enough to keep.
	(activate_callback): 
	decrement details->waiting_for_activation_count_hack.
	(fm_directory_view_activate_file):
	increment details->waiting_for_activation_count_hack.

2000-11-06  Mathieu Lacage  <mathieu@eazel.com>

	* user-guide/C/Makefile.am: fix make distcheck.

2000-11-06  Darin Adler  <darin@eazel.com>

	Fixed bug 4504 (select "view as others" leads to core dump).

	* libathena-extensions/athena-file.c:
	(athena_file_get_directory_item_mime_types):
	Change to return a copy of the MIME type list as designed.
	
	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_get_default_component_for_file_internal),
	(athena_mime_get_short_list_components_for_file):
	Change the callers that don't free the MIME type list so that they
	now do.

2000-11-06  Ramiro Estrugo  <ramiro@eazel.com>

	* athena-clean.sh:
	Fix for bug 4530.  Race condition in athena-clean.sh trying to
	kill its own grep processes.

2000-11-05  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-first-time-druid.c:
	(next_proxy_configuration_page_callback):
	Fix for bug 4488.  Proxy string is defaulting to ":".  Do some
	validation on the user input.  Only set the proxy if the proxy and
	port entry text fields are not blank.

2000-11-05  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_fetch_uri):
	* athena-installer/src/installer.c: (jump_to_retry_page),
	(eazel_install_get_depends):
	* athena-installer/src/main.c: (main):
	* athena-installer/src/prescript:
	* athena-installer/src/proxy.c: (load_nscp_proxy_settings),
	(load_galeon_proxy_settings), (attempt_http_proxy_autoconfigure):
	* athena-installer/src/proxy.h:

	Backported from the PR2 branch: Fix proxy autoconfiguration bugs,
	and use temporary filenames when downloading packages.  Use the
	better way of finding out the user's homedir.  Clean up the error
	message for a package with no update available.

2000-11-05  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 4475, add license to help menu
	
	* src/athena-shell-ui.xml:
	added menu item for "Athena License"
	* src/athena-window-menus.c:
	(help_menu_athena_license_callback),
	(athena_window_initialize_menus):
	added a bonobo verb and a handler to invoke the license document
	* user-guide/C/Makefile.am:
	added license.html
	* user-guide/C/html/.cvsignore:
	* user-guide/C/html/license.html:
	added license html file from Bud.
	
2000-11-05  Andy Hertzfeld  <andy@eazel.com>

	* components/music/athena-music-view.c: (play_status_display),
	(slider_moved_callback), (slider_release_callback):
	fixed bug 2407, divide by zero in the music view, which also got
	classified as PR2 bug 4513. I'm not sure this fixes the entire
	problem, since I wasn't able to manifest it in the first place,
	but Eli will confirm.

2000-11-04  Ramiro Estrugo  <ramiro@eazel.com>

	* src/run-athena:
	Fix a typo that was causing the script to always bail.
	
2000-11-04  Almer S. Tigelaar  <almer1@dds.nl>

	* configure.in: Add 'nl' to ALL_LINGUAS.

2000-11-03  Ramiro Estrugo  <ramiro@eazel.com>

	FIX from the pr2 branch.
	
	* helper-scripts/athena-verify-rpm.sh:
	Fix bug 4453.  Get right urls into "Athena RPM is damaged"
	dialog boxes.  Also change the dialogs slighty as specified by
	sullivan in bug 4366.
	
2000-11-03  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(add_to_url):
	Last fix broke the magic static link of the installer, this will
	fix.

2000-11-03  Darin Adler  <darin@eazel.com>

	Fixed bug 4483 (Crash while navigating in Vault).

	* src/athena-window.c: (athena_window_set_content_view_widget):
	Remove the idle with gtk_idle_remove, not gtk_timeout_remove.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_destroy): Removed the check since it was giving
	false alarms and not helping us for real.

2000-11-03  Darin Adler  <darin@eazel.com>

	* src/athena-shell.c: (display_caveat): Lets call the main
	branch "Athena", not "Athena Preview Release 2". Later we
	should change the caveat for cvs to be worded differently too.

	* src/athena-window.c: (athena_window_constructed),
	(athena_window_set_arg), (athena_window_get_arg),
	(athena_window_set_content_view_widget): Fixed spaces removed
	by the script (forgot to save this file before committing before).

2000-11-03  Ramiro Estrugo  <ramiro@eazel.com>

	* Makefile.am:
	* configure.in:
	* helper-scripts/.cvsignore:
	* helper-scripts/Makefile.am:
	* helper-scripts/athena-verify-rpm.sh:
	Add a place to put helper-scripts.
	
	* helper-utilities/error-dialog/Makefile.am:
	Dont link in with Athena libraries and dependencies.
	
	* helper-utilities/error-dialog/athena-error-dialog.c:
	(find_message_label), (find_message_label_callback),
	(show_message_box), (show_ok_box), (athena_error_dialog),
	(athena_yes_no_dialog), (main):
	Add support for specifying button labels on the command line.
	
	* src/run-athena:
	Call the athena rpm verification script and bail if it fails.
	
2000-11-03  Darin Adler  <darin@eazel.com>

	* README: Tell everyone that we are back on bonobo HEAD.
	* configure.in: Make sure Athena doesn't try to compile with the
	old bonobo.
	
	* components/adapter/athena-adapter-embed-strategy.c:
	(athena_adapter_embed_strategy_get):
	* components/adapter/athena-adapter-load-strategy.c:
	(athena_adapter_load_strategy_get):
	* components/adapter/athena-adapter-progressive-load-strategy.c:
	(athena_adapter_progressive_load_strategy_load_location):
	* components/history/athena-history-view.c:
	(history_view_frame_call_begin):
	* libathena/athena-undo.c: (set_up_bonobo_control):
	* libathena/athena-view.c: (view_frame_call_begin):
	* libathena/athena-zoomable.c:
	(athena_zoomable_ensure_zoomable_frame):
	Fix all the callers of query_interface in CORBA to call it
	queryInterface (I used the Bonobo script to do it).
	
	* src/athena-window.h:
	* src/athena-window.c: (athena_window_constructed),
	(athena_window_set_arg), (athena_window_get_arg),
	(athena_window_set_content_view_widget): Update for BonoboWin ->
	BonoboWindow change. Once again, the change was done by the Bonobo
	script (but I had to undo the spaces it ate after BONOBO_WIN).
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/time/idl/trilobite-eazel-time-service.idl:
	* components/services/trilobite/idl/trilobite-service.idl:
	* components/services/trilobite/sample/idl/sample-service.idl:
	* libathena-adapter/athena-adapter-factory.idl:
	* libathena/athena-distributed-undo.idl:
	* libathena/athena-view-component.idl:
	Since IDL dependencies don't work, I touched every IDL file to
	make the switchover smoother. This only works if people update
	before they try to build and fail, otherwise they need to do:
		find -name '*.xml' | xargs touch
	(Maciej and I want to add dependency support to orbit-idl to make
	this problem go away long term).
	
	* src/athena-desktop-window.c: (realize):
	The script updated this comment to, so I let it.
	
	* user-guide/C/Makefile.am: Took out the botched change I made to
	this file. Mathieu did the correct one.

2000-11-03  Mathieu Lacage  <mathieu@eazel.com>

	Hopefully, fix bug 4055 for true.
	* libathena-extensions/athena-list.c:
	(athena_list_drag_start), (athena_list_ensure_drag_data),
	(athena_list_drag_end), (athena_list_get_drop_action),
	(athena_list_drag_motion), (athena_list_drag_data_received):
	make it work with multiple successive drags by reinitializing a 
	number of variables used during drag.
	* src/file-manager/fm-list-view.c: (fm_list_receive_dropped_icons),
	(fm_list_get_default_action): make it react to drops in the blank
	area of a list view.

2000-11-03  Eskil Heyn Olsen  <eskil@eazel.com>

	Last commit was botched, here's the changelog
	
	* components/rpmview/athena-rpm-view-install.c:
	(athena_rpm_view_download_progress_signal),
	(athena_rpm_view_install_progress_signal),
	(athena_rpm_view_dependency_check),
	(athena_rpm_view_install_done),
	(athena_rpm_view_install_package_callback):
	Made a last minute fix to the delete file signal change in the
	rpmview. The rpmview still cannot get the spinner to spin when
	installing/uninstalling, but I'm not going to use time on that
	now.

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (install_failed):
	Fixed a typo and an error in the problem handler user
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_check_existing_packages):
	Added release numbers to debug output.
	* components/services/install/lib/eazel-install-problem.c:
	(eazel_install_problem_case_to_string):
	Changed case_to_string message to a more imperative format
	
	* components/services/install/lib/eazel-install-protocols.c:
	(add_to_url):
	Use gnome_vfs_escape_string instead of our own.
	
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_get_readable_name):
	Hack so it should also recognize EazelCandidate names
	
	* components/services/install/athena-view/athena-service-instal
	l-view.h:
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_install_parse_uri), (show_dialog_and_run_away),
	(athena_service_install_solve_cases),
	(athena_service_install_done), (dig_up_errors),
	(athena_service_install_failed):
	Fix for 4443

2000-11-03  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-canvas-item.c:
	(draw_outline_rectangle_aa), (draw_stretch_handles_aa),
	(draw_or_measure_label_text_aa), (draw_label_text_aa):
	fixed bug 4192, strange feedback while stretching icons, by using
	libart to draw the rectangle instead of the buggy custom graphics
	routine that we were using.
	
	* src/file-manager/fm-icon-view.c:
	(icon_container_preview_callback):
	fixed bug 4460, remote sound files displayed preview icon but
	didn't actually preview, by adding a check to make it display
	the icon for local files only
	
	* src/athena-window-menus.c: (file_menu_new_window_callback):
	fixed bug 4033, new window command should initially point to the
	home directory by calling athena_window_go_home instead of going
	to the uri of the current window.
	
2000-11-03  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic.c:
	(dump_one_package):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_set_arg), (eazel_install_initialize),
	(eazel_install_fetch_remote_package_list), (eazel_install_log),
	(eazel_install_set_log), (eazel_install_open_log),
	(eazel_install_log_to_stderr):
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_rpm_set_settings):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_add_log):

	Clean up debug mode (was missing some pieces) and set up the g_log
	handler to not work in corba mode (letting libtrilobite handle
	them in corba mode).  Make it start up as early as possible and
	let the service provide a file pointer for logging.

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form):

	Make the giant label a little bit more palatable to Arlo.
	
	* athena-installer/src/installer.c: (log_debug),
	(add_bullet_point_to_vbox), (strip_categories),
	(start_over_make_category_func), (start_over),
	(start_over_callback), (dont_start_over_callback),
	(start_over_timer), (jump_to_retry_page), (create_window),
	(eazel_install_progress), (eazel_download_progress),
	(add_force_packages), (add_force_remove), (add_update_package),
	(get_detailed_errors_foreach), (get_detailed_errors),
	(install_failed), (download_failed), (eazel_install_preflight),
	(eazel_install_dep_check), (install_done), (check_if_next_okay),
	(toggle_button_toggled), (eazel_installer_add_category),
	(check_system), (more_check_system), (eazel_installer_do_install),
	(draw_splash_text), (eazel_installer_finalize), (start_logging),
	(find_old_tmpdir), (eazel_installer_initialize):
	* athena-installer/src/installer.h:
	* athena-installer/src/link.sh:
	* athena-installer/src/main.c:
	* athena-installer/src/prescript:

	Use /tmp/eazel-install.log for logging (being very careful to make
	sure the file is not a booby trap) instead of spamming all over
	the terminal.  However, the --debug option will give you the
	terminal spam if you want it (in addition to the logfile).  Fix
	the annoying debug logs to use g_log so we can catch them.  Add a
	--batch option that causes the installer to skip all question
	screens.

2000-11-03  Mathieu Lacage  <mathieu@eazel.com>

	* user-guide/C/Makefile.am: fix pb with buildir != srcdir

2000-11-03  Darin Adler  <darin@eazel.com>

	* user-guide/C/Makefile.am: Add a missing file. Another cut at
	making "make distcheck" work.

2000-11-03  Darin Adler  <darin@eazel.com>

	* src/Makefile.am: Fixed a srcdir/builddir problem that prevents
	"make distcheck" from working. This is not necessarily the only
	"make distcheck" problem.

2000-11-02  Ramiro Estrugo  <ramiro@eazel.com>

	* configure.in:
	* helper-utilities/Makefile.am:
	* helper-utilities/error-dialog/.cvsignore:
	* helper-utilities/error-dialog/Makefile.am:
	* helper-utilities/error-dialog/athena-error-dialog.c: (main):
	* athena.spec.in:
	Add a error dialog helper utility that can be called from shell
	scripts to display errors to the user.

	* components/services/athena-dependent-shared/eazel-services-footer.c:
	Pavel made me do this at gun point.  Make the links activate on
	mouse up not down.
	
2000-11-02  Arlo Rose  <arlo@eazel.com>

	* src/athena-first-time-druid.c: (set_up_user_level_page),
	(set_up_service_signup_page), (athena_first_time_druid_show):
	Changed some wording so first time users won't be confused.

2000-11-02  Mathieu Lacage  <mathieu@eazel.com>

	Fix bug 4434 and bug 4430
	* libathena-extensions/athena-password-dialog.c:
	(athena_password_dialog_new): remove switch to remember 
	root password.
	* user-guide/C/sgml/chapter-1.sgml: remove mention of PDF.

2000-11-02  Ramiro Estrugo  <ramiro@eazel.com>

	* athena-installer/src/prescript:
	When we try to run the athena launcher, make sure we ignore the
	grep process while grepping for an already running launcher.
	
2000-11-02  Andy Hertzfeld  <andy@eazel.com>

	fixed problem where I accidentally changed the icons for disk
	drives that appear on the desktop when I only meant to change
	the hardware view.  Fixed by restoring the old icon, and using
	one with a different name in the hardware view.
	
	* components/hardware/athena-hardware-view.c:
	(setup_overview_form):
	use "i-harddrive.png" instead of "i-blockdev.png"
	
	* icons/Makefile.am:
	* icons/i-blockdev.png:
	* icons/i-harddrive.png:
	restored the old block device icon and added a new hard drive one.
	
2000-11-02  Ramiro Estrugo  <ramiro@eazel.com>

	* components/notes/athena-notes.c: (finish_loading_note),
	(notes_load_location), (make_notes_view):
	#if 0 out the undo code which is currently not working.  I filed a
	bug for this issue:  4436.
	
2000-11-02  Josh Barrow  <josh@eazel.com>

	* athena-installer/src/prescript:
	GNOME is an acronym, not a word.  Changed as such.

2000-11-02  Eskil Heyn Olsen  <eskil@eazel.com>

	* athena-installer/src/prescript:
	Fix for 4368, utterly untested though...
	
2000-11-02  Darin Adler  <darin@eazel.com>

	Fix crashing part of bug 4157 (Tree View crash involving directory
	rename/move).
	
	* components/tree/athena-tree-view.c: (forget_view_node),
	(forget_view_node_and_children),
	(athena_tree_view_remove_model_node): Add code to get rid of all
	the child nodes when a node is removed, not just the main node
	itself.

2000-11-02  Ramiro Estrugo  <ramiro@eazel.com>

	* athena-installer/src/prescript:
	Fix bug 4374.  Add Athena launcher to installer prescript.
	
2000-11-02  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/mozilla-events.cpp:
	* components/mozilla/mozilla-events.h:
	* components/mozilla/athena-mozilla-content-view.c:
	(mozilla_open_uri_callback), (mozilla_dom_mouse_click_callback):

	bugzilla.eazel.com 4156: Documents containing IFRAME's cause
	unexpected navigation.  This is a hack fix that checks to see if 
	a possible destination is the same as the URI of an IFRAME and, if
	they do, ditch the navigation

2000-11-02  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3613 (activating any file as root tries to
	execute it)

	* src/file-manager/fm-directory-view.c: (file_is_launchable):
	Need to check athena_file_is_executable as well as
	athena_file_can_execute.

2000-11-02  Maciej Stachowiak  <mjs@eazel.com>

	* components/music/Makefile.am: Install a athena-mpg123 symlink
	that points to the real mpg123 if it exists on the system.
	* components/music/mpg123_handler.c (start_playing_file): Run athena-mpg123
	* athena-clean.sh: Kill athena-mpg123
	* athena-spec.in: Install the athena-mpg123 symlink
	
2000-11-02  Maciej Stachowiak  <mjs@eazel.com>

	Believed fix to 4361 and possible progress on 4157.
	
	* components/tree/athena-tree-model.c:
	(athena_tree_model_node_has_monitor_clients,
	athena_tree_model_node_begin_monitoring,
	athena_tree_model_node_end_monitoring,
	athena_tree_model_monitor_node,
	athena_tree_model_stop_monitoring_node, report_node_changed):
	Various restructing.

	* components/tree/athena-tree-view.c: (insert_hack_node,
	remove_hack_node, freeze_if_have_hack_node,
	athena_tree_view_insert_model_node,
	athena_tree_view_remove_model_node,
	athena_tree_view_update_model_node, notify_node_seen,
	athena_tree_view_model_node_changed_callback,
	athena_tree_view_model_done_loading_callback,
	athena_tree_view_initialize, free_file_to_node_map_entry,
	free_file_to_hack_node_map_entry, athena_tree_view_destroy,
	file_to_view_node, model_node_to_view_node, view_node_to_file,
	expand_uri_sequence_and_select_end, reload_node_for_file,
	expand_node_for_file, tree_expand_callback,
	tree_collapse_callback, tree_select_row_callback,
	athena_tree_view_find_parent_node, athena_tree_view_item_at,
	athena_dump_info, athena_tree_view_collapse_all): Pass around
	and store AthenaFile objects rather than URIs, since nodes are
	tied to a AthenaFile (which can change URI if moved or renamed).

	* libathena-extensions/athena-directory-private.h,
	libathena-extensions/athena-directory.c
	(athena_directory_handle_directory_moved,
	athena_directory_notify_files_moved),
	libathena-extensions/athena-file.c (rename_callback): When a
	directory is moved or renamed, update the AthenaDirectory
	structure for it to have the correct new URI.

2000-11-02  Darin Adler  <darin@eazel.com>

	* README: Change to reflect the fact that we currently require
	bonobo and xpdf from a branch, not HEAD.

2000-11-02 John Fleck <jfleck@inkstain.net>
	* gnome-db2html2/sect-elements.c - render <variablelist> as a <UL>
	rather than <OL>

2000-11-02 John Fleck <jfleck@inkstain.net>
	* updating gnome-db2html2/toc-elements.c to improve help
	documentation table of contents display

2000-11-02  Rebecca Schulman  <rebecka@eazel.com>
	Clean up some of the "human" strings for search uris,
	mostly so the translation scheme doesn't fail and 
	leave a search uri sitting around

	* libathena-extensions/athena-search-uri.c:
	update structures to correspond to latest search uri
	spec
	* athena-clean.sh:
	removed mpg123 (it kept interrupting my cds) and 
	a duplicate summary view copy

2000-11-01  Andy Hertzfeld  <andy@eazel.com>

	* icons/villanova/Makefile.am:
	* icons/villanova/villanova.xml:
	* icons/villanova_green.png:
	Susan changed the background image for the icon view of
	the villanova theme
	
	* icons/i-blockdev.png:
	better hard disk for hardware view
	* components/hardware/athena-hardware-view.c:
	(setup_overview_form):
	improved layout of IDE items
		
2000-11-01  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_install_service_locate_menu_entries):
	Just to make sure, I don't think tinderbox got my change...

2000-11-01  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (delete_files), (done), (main):
	Now has a --batch command to it doens't need userinteraction
	--batch=yes|no to set the default answer to continue ?
	questions. Using --batch defaults the answer to delete to yes. Now
	delete works again (after Great Delete Change)
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_cases_foreach):
	Fixed potiental sigsegvs.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_install_service_locate_menu_entries):
	Fixed a compiler warning that broke build.

2000-11-01  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (main):
	Fixed 4331.
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_download_packages),
	Checked if a toplevel package is a source package
	(eazel_install_prune_packages_helper),
	(eazel_install_check_if_depends_on),
	(eazel_install_do_transaction_fill_hash),
	(eazel_install_prune_packages), 
	(eazel_install_ensure_deps),
	Commented out/changed some debug output
	(eazel_install_fetch_dependencies),
	Changed the debug output in case of circular dependency, also
	added a check for source packages.
	(eazel_install_start_transaction):
	Commented out the debug output of the rpm args
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach),
	Detect source package.
	(eazel_install_problem_tree_to_case):
	Removed debug output.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_initialize),
	(athena_service_install_installing),
	(athena_service_install_done),
	Improved the updating of athena from natilus, by actually
	offering to restart athena (and doing it if the user wants to)
	(athena_install_service_locate_menu_entries):
	If I can't figure out where the desktop files are, don't print
	"blabla is somewhere..."
	
	* athena.spec.in:
	Added usermode >= 1.35 for athena-trilobite
	
	* po/da.po:
	* po/no.po:
	Removed the fatal Control*t translation.
	
	* src/file-manager/fm-directory-view.c:
	(reset_bonobo_trash_delete_menu):
	Added a comment for the translation teams to not translate
	Control*t at this point.
	
	* src/athena-shell.c: (save_window_states):
	When saving windowstates, replace any window->location that starts
	with eazel-install: with eazel:, thereby preventing loops when
	eazel-install: views restart athena.

2000-11-01  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-first-time-druid.c: (initiate_file_download):
	fixed bug 1826 by pointing the update download uri to it's
	real location at services.eazel.com.
	
	* src/athena-window-manage-views.c: (just_one_window),
	(athena_window_end_location_change_callback):
	fixed bug 4351, athena quits after running the first time
	druid if services are inaccessible.  Fixed by making it
	not quit if there's a single window that fails, going to
	the home directory (if it's valid) instead.

	* icons/loading.png:
	a better version of the non-anti-aliased loading icon from Susan.
		
2000-11-01  Robey Pointer  <robey@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (set_dialog_parent):

	Fix corner case where dialog won't be parented if services are
	down.

2000-11-01  Darin Adler  <darin@eazel.com>

	* src/athena-window-service-ui.c: (goto_services_support):
	Remove FIXME for already-fixed bug.
	* src/run-athena: Add Debian-specific hack requested in
	bug report (bug 4353).

2000-11-01  Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/athena-mime-actions.h,
	libathena-extensions/athena-mime-actions.c:
	(athena_mime_actions_file_needs_full_file_attributes,
	server_has_content_requirements,
	server_matches_content_requirements): New functions.

	(athena_mime_get_all_components_for_file) Updated.

	* src/athena-applicable-views.h,
	src/athena-applicable-views.c: (got_file_info_callback_common,
	(got_full_file_info_callback, got_minimum_file_info_callback,
	athena_navigation_info_new, athena_navigation_info_cancel):
	Changed to possibly handle calling the callback twice so we can
	avoid having to load twice before showing a component at all.

	* src/athena-window-manage-views.c
	(athena_window_end_location_change_callback): If being called a
	preliminary time, ignore it for now.

2000-11-01  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-metadata.c:
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_update_from_uri):
	* components/services/login/athena-view/athena-change-password-
	view.c: (start_change_password):
	* components/services/trilobite/libtrilobite/libtrilobite.h:
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	* athena-installer/src/installer.c:
	
	Fix builtin uri's to point to a sane place by default.  Make the
	install view use your trilobite gconf config and not a made-up
	site (oops).  Remove leftover "eazel-auth:" uri.  Use good PR2
	defaults for the bootstrap installer.  Fix missing ellipses that
	were bothering Eli.

2000-11-01  Darin Adler  <darin@eazel.com>

	Fixed bug 4335 (music view does not work with Services:Vault)

	* components/music/athena-music-view.oafinfo:
	Added the requirement that the URL must be file scheme, since
	the music view doesn't know how to deal with MP3s that are not
	on the local hard disk.

2000-11-01  John Sullivan  <sullivan@eazel.com>

	Fixed bug 4343 (crash clicking "Back" deep in software catalog)

	This was an inaccurate assert. Other similar asserts had been
	fixed earlier, but this one and a parallel one in Forward got
	overlooked.

	* src/athena-window-manage-views.c:
	(check_bookmark_location_matches_uri): New helper function, uses
	uris_match.
	(check_last_bookmark_location_matches_window): Now calls the
	new function (which was extracted from this)
	(handle_go_back),
	(handle_go_forward): Use the new function to check that the bookmark
	has the right uri, instead of direct string compares.

2000-11-01  Mathieu Lacage  <mathieu@eazel.com>

	* athena.spec.in: adding fdl.
	* user-guide/C/Makefile.am: adding installation of fdl
	* user-guide/C/fdl.sgml: adding fdl

2000-11-01  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4337, Title for athena user manual is "GNOME Documemtation"
	
	* user-guide/C/sgml/athena.sgml:
	Added "Athena User Manual" as <title> tag.
	
2000-11-01  Darin Adler  <darin@eazel.com>

	Fix bug 4305 (Athena can't find myplay.com (default bookmark)
	URL). As Mike Fleming and Pavel suggested, changed AthenaFile to
	keep relative URIs around instead of file names. This may also fix
	two other Mozilla-component-related bugs, bug 3438 and 4220. I'll
	check that later.

	Also fix bugs 4128, 4311, and 4344, which are all about a hash
	table NULL critical assertion.

	* libathena-extensions/athena-directory-async.c:
	(dequeue_pending_idle_callback): Handle info in the order it gets
	queued. That requires a call to g_list_reverse since we add things
	with g_list_prepend. Check for NULL to handle case where the info
	is not part of a directory load. Use the new
	athena_directory_find_file_by_name to keep it clearly separate
	from code that would find files given relative URIs.
	
	* libathena-extensions/athena-directory-private.h: RIP
	athena_compare_file_with_name. We haven't used it since we've
	been using a hash table.
	
	* libathena-extensions/athena-directory.c:
	(add_to_hash_table): Put the relative URI in the hash table, not
	the name.
	(extract_from_hash_table): Look up in the hash table by relative
	URI, not name.
	(athena_directory_add_file), (athena_directory_remove_file):
	Assertions are based on the relative URI, not the name.
	(athena_directory_find_file_by_name): Turn the name into a
	relative URI and search for that.
	(athena_directory_find_file_by_relative_uri): Look up in the
	hash table by relative URI, not name.
	
	* libathena-extensions/athena-file-private.h: Replace the name
	field with a relative_uri field. There aren't always names for
	files.
	
	* libathena-extensions/athena-file.c:
	(athena_file_new_from_relative_uri): Mechanical changes to make
	it create a file given a directory and relative_uri. Uses the new
	update_info_and_name instead of the old athena_update_file_info
	(which no longer updates names).
	(athena_file_new_from_info). Use the new update_info_and_name
	instead of the old athena_update_file_info (which no longer
	updates names).
	(athena_file_get_internal): Call athena_uri_make_canonical on
	the URI before using it. This is needed now to make the escaping
	of characters in the relative URI uniform. Also made mechanical
	changes to deal with relative URIs instead of file names.
	(destroy): Always free the relative URI. We no longer share the
	name inside the file info, so the logic is now simpler.
	(athena_file_get_gnome_vfs_uri): Append the relative URI instead
	of appending a file name to make the full URI.
	(rename_callback): Use the new update_info_and_name instead of the
	old athena_update_file_info (which no longer updates
	names). Also call athena_find_file_by_name under its new name.
	(name_is): New helper function for checking the file name quickly
	without requiring a local variable.
	(athena_file_rename): Use name_is instead of strcmp since the
	name is no longer so readily available.
	(update_info_internal): Moved the guts of athena_file_update_info
	in here and made the name-updating part optional. Logic is a bit
	simpler since we don't share the name in the file info any more.
	(update_info_and_name), (athena_file_update_info): Covers that
	call the internal call with the "update_name" flag set.
	(athena_file_update_name): Use name_is and update_info_and_name.
	Also fix the info == NULL case to handle relative URIs, not names.
	(athena_file_compare_for_sort): Add a FIXME about using the name
	in the info when sorting. Also change the info == NULL case to get
	the names with athena_file_get_name.
	(athena_file_compare_name): Use athena_file_get_name to get
	the names to compare.
	(athena_file_get_metadata), (athena_file_get_metadata_list),
	(athena_file_set_metadata), (athena_file_set_metadata_list),
	(athena_file_get_boolean_metadata),
	(athena_file_get_integer_metadata),
	(athena_file_set_boolean_metadata),
	(athena_file_set_integer_metadata): Store metadata using the
	relative URI as the key instead of the name. This amounts to a
	minor metadata file format change.
	(athena_file_get_name): Create the name by unescaping the
	relative URI. If this fails, just return the relative URI
	itself. In some cases the URI instead of the name would represent
	a terrible error (but the unescaping will not fail in those
	cases), but in other cases we just need some kind of name.
	(athena_file_get_uri): Some broken code in here was just
	appending the name to the parent URI. Now it appends the relative
	URI so it's no longer broken.
	(get_description): Use the relative URI instead of the name in the
	warning message.
	(athena_file_mark_gone): Since we always keep the relative URI
	around now, can get rid of the logic that copies the name out of
	the file info for this case.
	(athena_file_dump): Since we already dump the URI, don't bother
	dumping the name any more.

2000-11-01  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-image.c: (render_buffer_pixbuf):
	Change '=+' to the more common '+=' when adding integers.
	
2000-11-01  John Fleck  <jfleck@inkstain.net>

	* change to sect-elements.c in gnome-db2html2 to change display of
	<note> elements

2000-11-01  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_register):
	Make smooth graphics mode be false by default as agreed for pr2.
	
2000-11-01  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/launcher/athena-launcher-applet.c: (image_enter_event),
	(window_set_cursor_for_state), (set_is_launching),
	(get_is_launching), (image_button_press_event),
	(image_button_release_event), (event_filter),
	(root_listen_for_property_changes), (main):
	Keep track of AthenaWindow realization events.  Do this by
	monitoring a property on the root window.  Use this flag in order
	to give the user feedback about the launching state of new
	Athena windows.  Fixes bug 4300.
	
	* src/athena-window.c: (athena_window_update_launcher),
	(athena_window_realize):
	Notify the launcher when a AthenaWindow get realized.
	
	* src/run-athena:
	If no arguments are given, then open a window pointed to the
	user's home directory.
	
2000-11-01  Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_canonical),
	(athena_self_check_file_utilities):
	Hook up new GnomeVFS "make canonical" calls to fix test cases
	Darin needed to work for the bug he is fixing.
	Switched the test cases to their intended values, now that they pass.
	Get rid of some crufty workarounds that weren't really needed
	after my previous fix to not add extra '//' to some URIs and
	removed the respective tests.

2000-11-01  Mathieu Lacage  <mathieu@eazel.com>

	This is completely useless but I needed a break from "usefull"
	bugs.
	* applets/launcher/athena-launcher-applet.c: (image_leave_event),
	(image_button_press_event), (image_button_release_event), (main):
	Add an event handler for release event to make sure we launch 
	athena only if you release the cursor without leaving the icon.
	Add an offset when you click to give the user feedback about what 
	he is doing.
	* libathena-extensions/athena-image.c: (render_buffer_pixbuf):
	Fix offset problem when drawing image: the offset was not taken
	into account in the calculation of the x and y coordinates.

2000-10-31  Robey Pointer  <robey@eazel.com>

	* athena-installer/src/Makefile:
	* athena-installer/src/main.c: (main):
	* athena-installer/src/proxy.c: (load_nscp_proxy_settings),
	(load_galeon_proxy_settings):
	* src/athena-first-time-druid.c: (load_nscp_proxy_settings),
	(load_galeon_proxy_settings), (attempt_http_proxy_autoconfigure):

	Fix installer version to follow the Makefile define.  Fix evil bug
	in detecting proxy servers that was freeing g_get_home_dir
	results.  Fixed it again in the first-time druid, and added Galeon
	support there.

2000-10-31  Robey Pointer  <robey@eazel.com>

	* athena-installer/src/Makefile:
	* src/athena-window-service-ui.c: (goto_services_support):

	Fix bootstrap installer for new Makefile config and fix typo in
	dropdown menus.

2000-10-31  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/launcher/Makefile.am:
	Add missing includes.
	
2000-10-31  Ramiro Estrugo  <ramiro@eazel.com>

	* Makefile.am:
	Add applets to SUBDIRS if needed.
	
	* applets/Makefile.am:
	Tiny bit of cleanup.

	* configure.in:
	Define HAVE_APPLETS only if the applets devel libs are found by
	gnome-config.
	
2000-10-31  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_load_uri),
	(mozilla_content_view_one_time_happenings):
	Remove a rogue printf.  Also fix a broken debug printf.
	
2000-10-31  Andy Hertzfeld  <andy@eazel.com>

	* icons/Makefile.am:
	* icons/loading.png:
	* icons/loading-aa.png:
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_for_file):
	added a new "loading thumbnail" icon from Susan
	
	* src/athena-property-browser.c:
	(athena_property_browser_delete_event_callback),
	(cancel_remove_mode), (add_new_button_callback),
	(done_button_callback):
	made the property browser reset remove mode when it's dismissed
	
2000-10-31  Mathieu Lacage  <mathieu@eazel.com>

	* athena.spec.in: add gnorba file in specfile.

2000-10-31  Mathieu Lacage  <mathieu@eazel.com>

	* applets/launcher/Makefile.am: add .gnorba file.
	* applets/launcher/athena-launcher-applet.c: (main): fix typo.
	* applets/launcher/athena-launcher-applet.gnorba: new gnorba file.

2000-10-31  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/launcher/.cvsignore:
	Use the right binary name.
	
2000-10-31  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_install_parse_uri),
	(athena_service_install_view_update_from_uri):

	Support [ username "@" ] in the eazel-install: URI so that a
	username can be specified (like anonymous) to libeazelinstall.

	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_init):

	Don't free the result of g_get_home_dir(), because it unleashes
	1000 demons.
	
	* athena-installer/src/installer.c: (create_what_to_do_page),
	(eazel_installer_add_category):

	Change the "what to install" header for the single-category case.

2000-10-31  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-file-utilities.c:
	(athena_self_check_file_utilities): Add the new self-checks that
	will help Pavel see the minimum I need in a URI canonifying
	function.

2000-10-31  Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_actions_check_if_minimum_attributes_ready),
	(athena_mime_actions_check_if_full_attributes_ready),
	(athena_mime_actions_get_minimum_file_attributes),
	(athena_mime_actions_get_full_file_attributes),
	(athena_mime_actions_wait_for_full_file_attributes),
	(athena_mime_get_default_action_type_for_file),
	(athena_mime_get_default_action_for_file),
	(athena_mime_get_default_application_for_file_internal),
	(athena_mime_get_default_application_for_file),
	(athena_mime_is_default_application_for_file_user_chosen),
	(athena_mime_get_default_component_sort_conditions),
	(athena_mime_get_default_component_for_file_internal),
	(athena_mime_get_short_list_applications_for_file),
	(athena_mime_get_short_list_components_for_file),
	(athena_mime_get_short_list_methods_for_file),
	(athena_mime_get_all_applications_for_file),
	(athena_mime_get_all_components_for_file),
	(athena_mime_set_default_application_for_file),
	(athena_mime_set_default_component_for_file),
	(athena_mime_set_short_list_applications_for_file),
	(athena_mime_set_short_list_components_for_file),
	(athena_mime_add_application_to_short_list_for_file),
	(athena_mime_remove_application_from_short_list_for_file),
	(athena_mime_add_component_to_short_list_for_file),
	(athena_mime_remove_component_from_short_list_for_file),
	(athena_mime_extend_all_applications_for_file),
	(athena_mime_remove_from_all_applications_for_file),
	(athena_do_component_query):
	* libathena-extensions/athena-mime-actions.h:
	* libathena-extensions/athena-program-chooser.c:
	(repopulate_program_list), (is_component_default_for_file),
	(program_file_pair_is_default_for_file),
	(program_file_pair_is_in_short_list_for_file),
	(add_to_short_list_for_file), (remove_from_short_list_for_file),
	(remove_default_for_item), (set_default_for_item):
	* libathena-extensions/athena-program-choosing.c:
	(any_programs_available_for_file):
	* libathena/athena-clipboard-ui.xml.h:
	* src/file-manager/fm-directory-view.c: (switch_location_and_view),
	(create_open_with_gtk_menu), (reset_bonobo_open_with_menu),
	(activate_callback):
	* src/file-manager/athena-directory-view-ui.xml.h:
	* src/file-manager/athena-icon-view-ui.xml.h:
	* src/file-manager/athena-search-list-view-ui.xml.h:
	* src/athena-applicable-views.c: (athena_navigation_info_new):
	* src/athena-shell-ui.xml.h:
	* src/athena-sidebar.c: (athena_sidebar_update_all),
	(athena_sidebar_set_uri):
	* src/athena-window.c: (athena_window_load_content_view_menu):
	* test/test-athena-mime-actions-set.c: (main):
	* test/test-athena-mime-actions.c: (main): Un-revert my changes
	from before, fixing the bugs in the process.

2000-10-31  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/launcher/Makefile.am:
	* applets/launcher/athena-icon-applet.c:
	* applets/launcher/athena-launcher-applet.c: (create_pixbufs),
	(applet_change_pixel_size), (image_enter_event),
	(image_leave_event), (get_root_window), (root_window_set_busy),
	(root_window_set_not_busy), (image_button_press_event), (main):
	* athena.spec.in:
	Rename the launcher applet from 'athena-icon-applet' to
	'athena-launcher-applet'.
	
2000-10-31  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(get_eazel_auth_path):
	Doh, copied the wrong variable.

2000-10-31  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/launcher/Makefile.am:
	* applets/launcher/athena-icon-applet.c: (get_root_window),
	(root_window_set_busy), (root_window_set_not_busy),
	(image_button_press_event), (main):
	Add code to execute athena.  Add first try at adding busy
	feedback while launching.

2000-10-31  Mathieu Lacage  <mathieu@eazel.com>

	fix bug 4015.
	* libathena-extensions/athena-global-preferences.c:
	add correct default here.
	* src/athena-window.c: (athena_window_go_web_search):
	remove bad default here. ramiro has a bug to do the correct
	fix post-pr2.

2000-10-31  Ramiro Estrugo  <ramiro@eazel.com>

	* src/run-athena:
	Remove a bunch of debug echo statements i left in by mistake.
	
2000-10-31  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package), (get_eazel_auth_path),
	(get_search_url_for_package):
	* components/services/install/lib/eazel-install-metadata.c:
	(init_default_transfer_configuration), (transferoptions_destroy):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize):
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line):
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install__set_username),
	(impl_Eazel_Install__get_username), (eazel_install_get_epv):
	Stuff to get/set a username for eazel-service:/ uris. Needed for
	4004 (The Bug Noone Knew What To Do With And Everyone Ignore)
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_download_packages),
	If a package fails, don't silently remove it, but set CANNOT_OPEN
	and prune it.
	(eazel_install_do_transaction_save_report),
	If no transaction dir is set, dont' try and store the report
	(eazel_install_check_existing_packages):
	Doh! All packages apparently ended at DOWNGRADES, yech.
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach):
	Sane message if file could not be found on server
	
2000-10-31  Maciej Stachowiak  <mjs@eazel.com>

	* src/athena-window-manage-views.c
	(athena_window_set_sidebar_panels): Call `update_view' on new
	sidebar panels that get activated, so they find out about the
	location and selection.

2000-10-31  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/Makefile.am:
	* applets/launcher/Makefile.am:
	* applets/launcher/athena-icon-applet.c: (create_pixbufs),
	(image_enter_event), (image_leave_event), (main):
	Make the applet use the athena launcher icon and prelight.
	
2000-10-31  Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(handle_xfer_vfs_error):
	Fix 4227 - Trying to copy an unreadable file gives a bogus
	error message.
	Added code that distinguishes between the read and write phases
	of a copy.

2000-10-31  John Sullivan  <sullivan@eazel.com>

Fixed bug 4334 (changing layout separataes icon from name)
Fixed bug 4332 (Right-click after New Folder separates icon from name)

	* libathena-extensions/athena-icon-container.c:
	(icon_set_position): end renaming mode before changing position
	of icon being renamed.
	(button_press_event): end renaming mode on any background
	context click.

2000-10-31  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	* athena-installer/src/installer.c: (eazel_install_dep_check),
	(install_done):
	* athena-installer/src/installer.h:

	Don't blame RPM if the real error is that services is down.

2000-10-31  Mathieu Lacage  <mathieu@eazel.com>

	* athena.spec.in: add applet to the spec file.
	* user-guide/C/sgml/chapter-1.sgml:
	* user-guide/C/sgml/chapter-2.sgml:
	* user-guide/C/sgml/chapter-3.sgml:
	* user-guide/C/sgml/athena.sgml:
	update the sgml files.

2000-10-31  Robin * Slomkowski  <rslomkow@eazel.com>

	* src/athena-window.c: set the url to fix 4015
	but it does not Athena attempts to connect to the
	wrong URL. http://www.eazel.com/websearch instead of
	http://services.eazel.com/websearch

2000-10-31  Mathieu Lacage  <mathieu@eazel.com>

	add new directories.
	* applets/.cvsignore:
	* applets/launcher/.cvsignore:	
	* applets/Makefile.am:
	* applets/launcher/Makefile.am:

	stupid applet which is used during installation
	to display a athena icon on the user's panel.
	* applets/launcher/athena-icon-applet.c:
	(applet_change_pixel_size), (main):

	add checks for the libapplet library.
	* configure.in:

2000-10-31  Ramiro Estrugo  <ramiro@eazel.com>

	* configure.in:
	Fix bug 3729.  Bump the version number to 0.5.0.
	
2000-10-31  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-db2html2/gdb3html.c:
        (parse_file): Try to correct a problem jfleck was having.

        * libathena-extensions/athena-file-utilities.c:
        (athena_uri_is_local_scheme): Add 'gnome-help' to the list

2000-10-31  Darin Adler  <darin@eazel.com>

	* athena.spec.in: Removed vendor again. Putting these in cvs
	is a bad idea. For more details see bug 3461.

2000-10-31  Darin Adler  <darin@eazel.com>

	* athena.spec.in: Add vendor.

2000-10-31  Darin Adler  <darin@eazel.com>

	Fixed bug 4242 (Tree view crash trying to navigate to parent uri
	(Up)) and bug 4297 (Opening a window twice causes Athena to
	crash).
	
	* components/tree/athena-tree-model.c:
	(athena_tree_model_destroy): Disconnect the root_node_changed
	signal.

2000-10-31  J Shane Culpepper  <pepper@eazel.com>

	* components/services/login/athena-view/athena-change-password-
	view.c: (generate_change_password_form):

	Fixing buttons in the change password view to not use athena_label
	and pointing to the right help place.

2000-10-31  Brian Frank  <bfrank@eazel.com>

	* data/static_bookmarks.xml
	Fixed capitalization problem of VMware name in bookmark list
	
2000-10-31  Mathieu Lacage  <mathieu@eazel.com>

	* configure.in: fix some configure magic for libfreetype2.

2000-10-31  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-first-time-druid.c: (druid_finished):
	changed the services uris that are hard-coded into the wizard to
	ones specified by Laura; they are not in place yet but she
	assures me that they will be soon.
	
2000-10-31  Darin Adler  <darin@eazel.com>

	Fixed bug 4144 (Extra Services menu items installed by Summary
	view never go away). The problem was actually with the factory
	code from the sample. I had fixed it a while back, but not before
	people cloned the broken sample code.
	
	* components/adapter/athena-adapter-factory-server.c:
	(impl_Athena_ComponentAdapterFactory_create_adapter):
	* components/hardware/main.c: (hardware_view_make_object):
	* components/music/main.c: (music_view_make_object):
	* components/rpmview/main.c: (rpm_view_make_object):
	* components/services/install/athena-view/main.c:
	(service_install_make_object):
	* components/services/inventory/athena-view/main.c:
	(inventory_make_object):
	* components/services/login/athena-view/main.c:
	(change_password_make_object):
	* components/services/summary/athena-view/main.c:
	(summary_make_object):
	* components/tree/libmain.c: (tree_shlib_make_object):
	* components/tree/main.c: (tree_exe_make_object):
	Connect the destroy handler to the AthenaView object rather than
	to the widget. If you connect to the widget, the handler gets
	called too early and the control doesn't get properly destroyed,
	leaving the UI component behind, and causing the bug.

	* components/adapter/main.c: (adapter_factory_make_object): Got
	rid of incorrect comment.
	
2000-10-31  J Shane Culpepper  <pepper@eazel.com>
	
	Fixing one more.

2000-10-31  J Shane Culpepper  <pepper@eazel.com>

	* libathena-extensions/athena-mime-actions.h:
	* src/athena-applicable-views.c:
	(athena_navigation_info_get_location),
	(athena_navigation_info_get_initial_content_id):

	missed a file

2000-10-31  J Shane Culpepper  <pepper@eazel.com>

	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_actions_check_if_required_attributes_ready),
	(athena_mime_actions_get_required_file_attributes),
	(athena_mime_actions_wait_for_required_file_attributes),
	(athena_mime_get_default_action_type_for_file),
	(athena_mime_get_default_action_for_file),
	(athena_mime_get_default_application_for_file_internal),
	(athena_mime_get_default_application_for_file),
	(athena_mime_is_default_application_for_file_user_chosen),
	(athena_mime_get_default_component_for_file_internal),
	(athena_mime_get_short_list_applications_for_file),
	(athena_mime_get_short_list_components_for_file),
	(athena_mime_get_short_list_methods_for_file),
	(athena_mime_get_all_applications_for_file),
	(athena_mime_get_all_components_for_file),
	(athena_mime_set_default_application_for_file),
	(athena_mime_set_default_component_for_file),
	(athena_mime_set_short_list_applications_for_file),
	(athena_mime_set_short_list_components_for_file),
	(athena_mime_add_application_to_short_list_for_file),
	(athena_mime_remove_application_from_short_list_for_file),
	(athena_mime_add_component_to_short_list_for_file),
	(athena_mime_remove_component_from_short_list_for_file),
	(athena_mime_extend_all_applications_for_file),
	(athena_mime_remove_from_all_applications_for_file),
	(athena_do_component_query):
	* libathena-extensions/athena-program-chooser.c:
	(repopulate_program_list), (is_component_default_for_file),
	(program_file_pair_is_default_for_file),
	(program_file_pair_is_in_short_list_for_file),
	(add_to_short_list_for_file), (remove_from_short_list_for_file),
	(remove_default_for_item), (set_default_for_item):
	* libathena-extensions/athena-program-choosing.c:
	(any_programs_available_for_file):
	* src/file-manager/fm-directory-view.c: (switch_location_and_view),
	(create_open_with_gtk_menu), (reset_bonobo_open_with_menu),
	(activate_callback):
	* src/athena-window.c: (athena_window_load_content_view_menu):
	* test/test-athena-mime-actions-set.c: (main):
	* test/test-athena-mime-actions.c: (main):

	backing out changes that caused a serious regression in services.

2000-10-31  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/rpmview/athena-rpm-view-install.c:
	(athena_rpm_view_install_package_callback):
	Hopefully fixed the completely fatal tmp_dir bug in the 
	package view.

	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_pre_install_packages):
	Ifdeffed some borked code

	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach):
	If no messages generated on modification status. Potientially
	completely incorrect unless I check prev_pack->status first.

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (dig_up_errors), (athena_service_install_failed):
	Use eazel-install-problem to generate error messages

	* athena.spec.in:
	Woops, eazel/throbber is not there..

2000-10-30  Eskil Heyn Olsen  <eskil@eazel.com>

	* athena.spec.in:
	Added some of the themes stuff to %files.

2000-10-30  Andy Hertzfeld  <andy@eazel.com>

	made thumbnailing work remotely for all images, by treating
	small remote files like large ones and keeping a local thumbnail
	for them.
	
	* libathena-extensions/athena-icon-factory-private.h:
	moved SELF_THUMBNAIL_SIZE_THRESHOLD constant into private,
	so it could be shared with athena-thumbnails.
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_for_file):
	if a file is remote, make a thumbnail even if it's smaller
	than the size threshold.
	* libathena-extensions/athena-thumbnails.c: (make_thumbnails):
	don't use a frame for files smaller than the size threshold.
	
2000-10-30  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic.c:
	(dump_one_package):
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_copy):

	Show provides-list when dumping packages for debug.  Copy
	provides-list when doing a deep copy of the package data.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_category):

	Clean up leading/trailing linefeeds on category descriptions.
	
	* components/services/install/server/main.c: (main):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_add_log), (trilobite_init),
	(trilobite_set_debug_mode):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h
	:

	Use ~/.athena/trilobite-install.log for logging install debug
	messages, and not a file in /tmp.  Timestamp those logs.
	
	* athena-installer/src/installer.c: (create_install_page),
	(eazel_download_progress), (get_required_name),
	(get_detailed_errors_foreach), (install_done),
	(eazel_installer_add_category), (find_old_tmpdir),
	(eazel_installer_initialize):

	Make category list display slightly differently when there's only
	one category (which is how PR2 will be): avoid showing the
	checkbox, etc.  If there's a suitable /tmp directory leftover from
	a previous install attempt, reuse it instead of creating a new
	one.

	* athena-installer/src/link.sh:

	Fix missing quotes in XFree checking.
	
2000-10-30  Eskil Heyn Olsen  <eskil@eazel.com>

	* athena-installer/src/Makefile:
	* athena-installer/src/link.sh:
	link.sh does vague attempt at checking XFree version. Partial fix
	for 4159.

2000-10-30  Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_actions_check_if_minimum_attributes_ready),
	(athena_mime_actions_check_if_full_attributes_ready),
	(athena_mime_actions_get_minimum_file_attributes),
	(athena_mime_actions_get_full_file_attributes),
	(athena_mime_actions_wait_for_full_file_attributes),
	(athena_mime_get_default_action_type_for_file),
	(athena_mime_get_default_action_for_file),
	(athena_mime_get_default_application_for_file_internal),
	(athena_mime_get_default_application_for_file),
	(athena_mime_is_default_application_for_file_user_chosen),
	(athena_mime_get_default_component_sort_conditions),
	(athena_mime_get_default_component_for_file_internal),
	(athena_mime_get_short_list_applications_for_file),
	(athena_mime_get_short_list_components_for_file),
	(athena_mime_get_short_list_methods_for_file),
	(athena_mime_get_all_applications_for_file),
	(athena_mime_get_all_components_for_file),
	(athena_mime_set_default_application_for_file),
	(athena_mime_set_default_component_for_file),
	(athena_mime_set_short_list_applications_for_file),
	(athena_mime_set_short_list_components_for_file),
	(athena_mime_add_application_to_short_list_for_file),
	(athena_mime_remove_application_from_short_list_for_file),
	(athena_mime_add_component_to_short_list_for_file),
	(athena_mime_remove_component_from_short_list_for_file),
	(athena_mime_extend_all_applications_for_file),
	(athena_mime_remove_from_all_applications_for_file),
	(athena_do_component_query): 
	* libathena-extensions/athena-mime-actions.h:
	* libathena-extensions/athena-program-chooser.c:
	(repopulate_program_list), (is_component_default_for_file),
	(program_file_pair_is_default_for_file),
	(program_file_pair_is_in_short_list_for_file),
	(add_to_short_list_for_file), (remove_from_short_list_for_file),
	(remove_default_for_item), (set_default_for_item):
	* libathena-extensions/athena-program-choosing.c:
	(any_programs_available_for_file):
	* src/file-manager/fm-directory-view.c: (switch_location_and_view),
	(create_open_with_gtk_menu), (reset_bonobo_open_with_menu),
	(activate_callback):
	* src/athena-applicable-views.c: (athena_navigation_info_new):
	* src/athena-sidebar.c: (athena_sidebar_update_all),
	(athena_sidebar_set_uri):
	* src/athena-window.c: (athena_window_load_content_view_menu):
	* test/test-athena-mime-actions-set.c: (main):
	* test/test-athena-mime-actions.c: (main): Portions of the fix
	for 2379 (the parts that don't make it crash).

2000-10-30  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	* components/services/athena-dependent-shared/eazel-services-header.c:
	(eazel_services_header_middle_new):
	Separate the left and right text offsets.  Tweak them some more.
	
2000-10-30  Ramiro Estrugo  <ramiro@eazel.com>

	* athena-clean.sh:
	Add trilobite-eazel-install-service to list of processes to kill.
	Also alphabetize the list.
	
2000-10-30  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-thumbnails.c:
	(make_thumbnail_path):
	fixed bug 4190, problem thumbnailing icons in vault, by adding
	a test to make sure it tries to keep the thumbnails for remote
	files locally.
	
2000-10-30  Ramiro Estrugo  <ramiro@eazel.com>

	* icons/athena-launch-icon.png:
	* athena.png:

	I removed these from Makefiles, but forgot to take them out of
	CVS.
	
2000-10-30  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (done), (main):
	Fixed 4203
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_string_sequence_to_glist),
	(corba_packagedatastruct_from_packagedata):
	Changed because I added debug and removed it again...
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_pre_install_packages),
	(eazel_install_download_packages),
	(eazel_install_check_existing_packages),
	(eazel_install_fetch_dependencies):
	Made a set of enums for check_for_existing_packages since it no
	longer really acts as a *cmp function (has four result values
	rather then 3)
	* components/services/install/lib/eazel-install-logic.h:
	Also renamed the status enum for the main functions

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring):
	Also renamed the status enum for the main functions (in
	logic.[ch])
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach),
	(eazel_install_problem_case_to_string),
	Moved get_required_name into -types.c (as
	packagedata_get_readable_name), so everyone gets the benefit of
	it.
	(eazel_install_problem_handle_cases):
	Now also sets the downgrade flag in handle cases.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_rpm_set_settings),
	No longer always set rpm debub
	(eazel_install_start_transaction_make_rpm_argument_list):
	Don't set --oldpackage on -e.
	
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_get_readable_name):
	Moved here from -problem.c(get_required_name)
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (eazel_install_packagedata_to_xml):
	Now also put provides into xml. This was needed for the menu path
	info fix that Bart asked for. Unfortunately this means huge
	transaction files, need to put in a boolean or such.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.h:
	Added list containing all .*\.desktop$ or .*\.kdelnk$ files that
	where installed.	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_dependency_check),
	Print nicer dep check strings (using packagedata_get_readable_name)
	(athena_service_install_check_for_desktop_files),
	In preflight, find any .*\.desktop$  or .*\.kdelnk$ files.
	(athena_service_install_preflight_check),
	call check_for_desktop_files only on toplevel packages
	(athena_service_install_installing),
	Moved the dialog box for athena updates down to done.
	(athena_install_service_locate_menu_entries),
	Locates where the menu entries went
	(athena_service_install_done):
	Pop up the dialog if athena was updated, also generate message
	reg. where menu entries went. Fixes 3431
	
	* athena-installer/src/installer.c: (jump_to_retry_page),
	(get_detailed_errors_foreach), (eazel_install_dep_check):
	Used packagedata_get_readable_name instead of get_requried_name.
	
2000-10-30  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/mozilla-preferences.cpp:
	* components/mozilla/mozilla-preferences.h:
	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize),
	(athena_mozilla_content_view_destroy),
	(eazel_services_scheme_translate),
	(test_make_full_uri_from_relative),
	(mozilla_content_view_one_time_happenings):
	Fix bug 4112 - Mozilla component does not listen for proxy
	configuration changes.

	Move all the gconf and proxy related things to
	mozilla-preferences.cpp, makes the main view implementation a
	little less convoluted.

	Add gconf notifications for changes in the proxy and route these
	changes to the mozilla universe.

	Also some minor style changes.

2000-10-30  Darin Adler  <darin@eazel.com>

	Fix bug 4202 (rename a file to an existing file will crash
	Athena).
	
	* libathena-extensions/athena-file.c: (rename_callback): Mark
	the overwritten file as "gone" if we succeed in renaming to an
	existing file's name. Either the module overwrote the file or the
	file was deleted "under Athena's nose" -- in either case it is
	gone.
	(athena_file_update_name): Fix comment.

2000-10-30  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar-title.c: (update_icon):
	added "eazel-services:" and "man:" to the schemes with custom
	sidebar icons via the recently implemented hack (which will be
	replaced by a real framework after PR2).
	
	* icons/Makefile.am:
	* icons/manual.png:
	added icon for man: scheme

2000-10-30  Andy Hertzfeld  <andy@eazel.com>

	cleaned up the sidebar for the summary view by putting in a
	temporary hack to get the right icon and giving the view
	a shorter title.
	
	* components/services/summary/athena-view/athena-summary-view.c
	: (summary_load_location_callback):
	changed the summary view's title to "Eazel Services" so it fits
	better in the sidebar.
	
	* src/athena-sidebar-title.c: (update_icon):
	added a hack to special-case the "eazel:" uri to get the appropriate
	icon; we'll remove this after PR2 and replace it with a real
	framework.
	
2000-10-30  Darin Adler  <darin@eazel.com>

	* icons/Makefile.am: Removed gnome-core.png again.

2000-10-30  Josh Barrow  <josh@eazel.com

	* icons/gnome-core.png: 
	Removed

	* icons/i-core.png:
	Made this be the old gnome-core icon, per Arlo's suggestion.

2000-10-30  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 4166, "New Folder" offset problem.

	Also reverted Enter to activate selected items instead of
	entering renaming mode.

	* libathena-extensions/athena-icon-container.c: 
	(relayout):
	Call athena_icon_container_update_scroll_region before
	processing pending reveal and rename actions.

	(key_press_event):
	Enter keypress activates selected items
	
2000-10-30  Robey Pointer  <robey@eazel.com>

	* athena-installer/src/proxy.c: (load_nscp_proxy_settings),
	(load_galeon_proxy_settings), (attempt_http_proxy_autoconfigure):

	Try to find proxy settings via Galeon too.

2000-10-30  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form):

	Fixing the box packing on the news widget.  Still not optimal but
	looks a little better than it did.  Will continue tweaking it until
	it is acceptable.

2000-10-30  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(file_opened_callback), (file_read_callback), (load_done):
	
	Fixed athena_gdk_pixbuf_load_async bug that would cause
	it to fail loading xpm files. (bug 4140)

2000-10-30  Rebecca Schulman  <rebecka@eazel.com>
	Fixed bug 4176, that files remaining to be
	copied goes up instead of down.  The short
	fix for this was just to change the wording to
	reflect what was actually being counted.

	* libathena-extensions/athena-file-operations.c:
	(progress_dialog_set_files_done_text), (handle_xfer_ok):
	changed "Files remaining to be [copied, moved,...]" to
	"Files [copied, moved,...]"

2000-10-30  Darin Adler  <darin@eazel.com>

	Fixed bug 4057 (clicking the back button while opening a huge
	directory often crashes).
	
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_for_each): The function was iterating
	some icons twice. All the icons on the new_icons list are also on
	the icons list.
	(icon_destroy): Also be sure to remove the icon from the new_icons
	list if it happens to be destroyed while still on that list.

	* configure.in:
	* Makefile.shared:
	Got rid of the shared part of the code to generate .xml.h
	files. It's no longer needed since the po directory takes care of
	everything itself.
	
	* components/loser/content/Makefile.am:
	* components/loser/sidebar/Makefile.am:
	* components/mozilla/Makefile.am:
	* components/sample/Makefile.am:
	* components/services/summary/athena-view/Makefile.am:
	* libathena/Makefile.am:
	* src/Makefile.am:
	* src/file-manager/Makefile.am:
	Got rid of the per-directory part of the code to generate .xml.h
	files.
	
	* components/loser/content/athena-content-loser-ui.xml.h:
	* components/loser/sidebar/athena-sidebar-loser-ui.xml.h:
	* components/mozilla/athena-mozilla-ui.xml.h:
	* components/sample/athena-sample-content-view-ui.xml.h:
	* components/services/summary/athena-view/athena-summary-view-ui.xml.h:
	* libathena/athena-clipboard-ui.xml.h:
	* src/file-manager/athena-directory-view-ui.xml.h:
	* src/file-manager/athena-icon-view-ui.xml.h:
	* src/file-manager/athena-search-list-view-ui.xml.h:
	* src/athena-service-ui.xml.h:
	* src/athena-shell-ui.xml.h:
	Got rid of the checked-in copies of the .xml.h files. The worst
	part!

2000-10-30  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (forgot_password_button_cb):

	Fixing Bug #4178.  The Help button was not working right.

2000-10-29  John Sullivan  <sullivan@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_login_dialog): Change "Please login to eazel services"
	to "Please log in to Eazel services", in two places.

2000-10-30  Rebecca Schulman  <rebecka@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (summary_load_location_callback):
	Add setting of window and sidebar title to the summary view
	to "Eazel Services Summary".  I'm not necessarily attached to the wording
	but we should definitely make it something other than "eazel".
	this fixes a bug I filed, #4183

2000-10-30  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/helper/eazel-helper.pam:

	Yeah!  Found out how to let eazel-helper run even if root has
	no password set.  Add "nullok" to the pwdb line in the pam
	config file.

2000-10-30  Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_canonical),
	(athena_self_check_file_utilities):
	athena_make_uri_canonical was relying on GnomeVFSURI sort-of
	handling relative uris, even though they are illegal in GnomeVFS.
	My earlier fix in gnome-vfs "broke" some of this broken behavior. 
	Added more special-case handling of cryptic absolute to 
	athena_make_uri_canonical to make it behave like before and not
	break existing behavior that depends on it. Added some bandaids for
	conversions that are clearly wrong but that may need more work 
	throughout the code that depends on it, for now I'm making it
	behave like the old call.
	My earlier fix to gnome-vfs fixes 2803. Change the test to reflect 
	the correct behavior.

2000-10-30  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/helper/README:
	* components/services/trilobite/helper/eazel-helper.security.in:

	Set fallback (in pam and usermode) to false: always needs to run
	as root.

2000-10-30  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_eazel_news_entry_row):
	disabled the "use all the space" since it causes too much flashing
	during size negotiation.  I'll either fix the flashing or remove
	it from athena_label soon.
	
2000-10-29  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-label.c:
	(athena_label_initialize_class), (athena_label_size_allocate),
	(get_clipped_width), (label_recompute_line_geometries):
	made athena_label interpret a wrap width of -1 to mean "use
	all of the available space".
	
	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_service_entry_row), (generate_eazel_news_entry_row),
	(generate_update_news_entry_row):
	made the news items use all of the available space by setting its
	wrap width to -1.
	
2000-10-29  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_eazel_news_entry_row),
	(authn_cb_succeeded), (authn_cb_failed):
	improved formatting of news items, now that we finally have a long
	one.  Also, removed some unconditional debugging messages.
	
2000-10-29  Robey Pointer  <robey@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(eazel_install_callback_delete_files):
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install_delete_files), (eazel_install_get_epv):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_class_initialize), (create_temporary_directory),
	(eazel_install_delete_downloads), (eazel_install_install_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_emit_dependency_check_default):
	* components/services/install/lib/eazel-install-public.h:

	Change delete_files from a signal to an explicit API call.  Also
	be sure to erase the temp dir even if it has no files in it.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_done),
	(athena_service_install_failed),
	(athena_service_install_view_update_from_uri):
	* components/services/install/server/Makefile.am:

	Make the install view use the new explicit delete_files call, and
	condense those into a single dialog box.

	* athena-installer/src/callbacks.c: (begin_install),
	(druid_finish):
	* athena-installer/src/installer.c: (install_done),
	(eazel_installer_do_install), (eazel_installer_initialize):
	* athena-installer/src/installer.h:

	Fix the bootstrap installer for the delete_files call, and don't
	forget to delete the package list too.  Also, set forced-downgrade
	to TRUE until a post-PR2 bug is fixed.
	
2000-10-29  Mike Fleming  <mfleming@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: switch authority-less eazel-services URL's 
	from "eazel-services:/" to "eazel-services:///"  

	* src/athena-window-service-ui.c: (goto_online_storage),
	(goto_software_catalog), (detach_service_ui),
	(athena_window_install_service_ui):

	Go back to initing ammonite each time these menus are called.  
	I didn't want to bother with trying to make it work.


2000-10-29  J Shane Culpepper  <pepper@eazel.com>

	* components/loser/content/athena-content-loser-ui.xml.h:
	* components/loser/sidebar/athena-sidebar-loser-ui.xml.h:
	* components/mozilla/athena-mozilla-ui.xml.h:
	* components/sample/athena-sample-content-view-ui.xml.h:
	* components/services/summary/athena-view/athena-summary-view-u
	i.xml.h:
	* libathena/athena-clipboard-ui.xml.h:
	* src/file-manager/athena-directory-view-ui.xml.h:
	* src/file-manager/athena-icon-view-ui.xml.h:
	* src/file-manager/athena-search-list-view-ui.xml.h:
	* src/athena-service-ui.xml.h:
	* src/athena-shell-ui.xml.h:
	* src/athena-shell.c: (display_caveat):

	Fixing bad spelling in caveat.

2000-10-29  Robey Pointer  <robey@eazel.com>

	* components/services/install/server/Makefile.am:

	Move RPMLIBS even *earlier* in the Makefile -- way back!  Seems to
	need to be the very first thing or else tons of libs get better
	precedence.

2000-10-29  Mike Fleming  <mfleming@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (athena_summary_view_load_uri),
	(merge_bonobo_menu_items):
	* src/athena-window-service-ui.c: (goto_online_storage),
	(goto_software_catalog), (detach_service_ui),
	(athena_window_install_service_ui):

	Change uses of "am_i_logged_in" and "who_is_logged_in" to 
	"ammonite_get_default_user_username"  Fix misc bugs/memory leaks.

2000-10-29  Arlo Rose  <arlo@eazel.com>

	* icons/temp-home.png:
	Added some extra stuff to the house to make it look better.

2000-10-28  Arlo Rose  <arlo@eazel.com>

	* icons/temp-home.png:
	Did a new home icon for PR2 that isn't my happy sunflower.

2000-10-28  Arlo Rose  <arlo@eazel.com>

	* icons/arlo/Makefile.am:
	* icons/arlo/i-regular.png:
	* icons/arlo/i-regular72.png:
	* icons/arlo/i-regular96.png:
	* icons/arlo/i-regular192.png:
	Fixed non-AA i-regular* icons to look the same as the AA versions.

2000-10-28  Robey Pointer  <robey@eazel.com>

	* components/services/install/server/Makefile.am:

	Move RPMLIBS earlier in the Makefile, to try to force the
	sleipnir build to use the right version of libdb.

2000-10-28  Ramiro Estrugo  <ramiro@eazel.com>

	* Makefile.am:
	* icons/Makefile.am:
	* athena-launch-icon.png:
	Fix bug 4155.  Athena Panel launching icon installed in the
	wrong place.  Needs to be $prefix/share/pixmaps, not
	$prefix/share/pixmaps/athena.

	Also added more ChangeLog files to EXTRA_DIST so they can be
	availalble in tarballs.
	
2000-10-28  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_login_dialog):
	* src/athena-service-ui.xml.h:
	* src/athena-shell.c: (display_caveat):

	Fixes for Bug #4104 and Bug# 4134. Changed error text to be more
	descriptive about account activation and added new wording for 
	caveat dialog.

2000-10-28  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/server/Makefile.am:
	Undoh rpm stuff

2000-10-28  Josh Barrow  <josh@eazel.com>

	* athena-clean.sh:
	Added mpg123 to the list of things to kill.  This finishes
	bug 4076.

2000-10-28  Josh Barrow  <josh@eazel.com>

	* athena-clean.sh:
	Changed to clean more things.

	* README
	Changed to reflect actual requirements.

	I actually checked these in a while ago, just neglected to
	check in the ChangeLog

2000-10-27  Eskil Heyn Olsen  <eskil@eazel.com>

	* configure.in:
	Doh doh doh

2000-10-27  Ramiro Estrugo  <ramiro@eazel.com>

	* src/Makefile.am:
	Dumshit me, I forgot to take out the file I retired from the
	makefile.
	
2000-10-27  Ramiro Estrugo  <ramiro@eazel.com>

	Fix bug 4054 - fix athena GNOME menu item so it does not
	"crash" athena.

	Fix bug 4117 - change default for PR2 back to desktop off.

	Also fix the issue about turning off the gnome crash dialog for
	out of process components.
	
	* icons/Makefile.am:
	* icons/athena-launch-icon.png:
	New launch icon from Arlo.

	* src/run-athena:
	Change this beast to not always run athena-clean.sh.  It only
	runs athena-clean.sh right before/after running Athena and not
	for every single invocation of 'run-athena'.  

	Also, dont start the desktop anymore, since there is not a
	preference in Athena to toggle the desktop.

	Finally, turn on the environment variable needed to prevent the
	gnome crash dialog from showing up for out of process components.
	
	* athena.desktop:
	Update icon and launch script back to run-athena.

	* athena.spec.in:
	We're back to using run-athena.
	
	* src/launch-athena:
	Retire.

2000-10-27  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/server/Makefile.am:
	Moved RPM_LIBS to top to ensure the right db is used.
	
2000-10-27  J Shane Culpepper  <pepper@eazel.com>

	* src/athena-window-service-ui.c: (goto_online_storage):

	Fixing Bug # 4097.  Should now point to correct place.

2000-10-27  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_rpm_set_settings):
	Output which rpmrc file I read.
	* configure.in:
	Attempt at fixing the install view breaking on rpm builds and not
	eazel-hacking builds.

2000-10-27  John Sullivan  <sullivan@eazel.com>

	Fixed bug 4087 (crash leaving Summary view)

	* components/services/summary/athena-view/athena-summary-view.c: 
	(athena_summary_view_destroy): Don't unset container and unref
	component here; that's not necessary for the component that's
	created automagically. And doing so causes a double-destroy.
	(update_menu_items), (merge_bonobo_menu_items): Removed 
	ui_component field from details and changed callers to get the
	ui_component elsewise when needed (to clarify that it isn't
	owned here).
	* src/athena-service-ui.xml: Changed "Eazel Services" to
	"Eazel Services Home" since all the services are Eazel Services.
	* src/athena-service-ui.xml.h: gotta check this in too.

2000-10-27  Andy Hertzfeld  <andy@eazel.com>

	at Bud's request, implemented bug 4127, add a preference to
	show or hide Athena' desktop.
		
	* libathena-extensions/athena-global-preferences.h:
	define ATHENA_PREFERENCES_SHOW_DESKTOP
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_create_dialog), (global_preferences_register):
	register the desktop preference and show the checkbox in
	the appearance section of preferences
	* src/athena-application.c: (athena_application_initialize),
	(athena_application_destroy), (check_for_and_run_as_super_user),
	(desktop_changed_callback):
	watch the desktop preference and show or hide the desktop window
	when it changes.
	* src/athena-main.c: (main):
	show the desktop at launch if the preference is set and it's not
	overriden by command-line options.
	
2000-10-27  Darin Adler  <darin@eazel.com>

	Fixed bugs in file renaming. These changes along with the
	gnome-vfs ones take care of bug 3846 (cancel dialog persists after
	renaming online storage folder).

	* libathena-extensions/athena-file.c:
	(athena_file_get_gnome_vfs_uri): Moved higher so it could be
	used by rename code.
	(operation_remove): Separated out the remove operation so we can
	remove the operation before the callback. This makes it safe to
	do a nautlius_file_cancel from inside a callback.
	(operation_free): Call the separate remove. Also cut down because
	we don't need so much state in the operation object any more.
	(operation_complete): Call remove before calling callback as
	described above.
	(rename_callback): A new callback that uses set_file_info results
	instead of the old one that used xfer.
	(athena_file_rename): Change to use set_file_info instead of
	xfer. Also updates the MIME type now, which will fix a bug I
	think.
	(athena_file_update_info): Use gnome_vfs_file_info_dup instead
	of gnome_vfs_file_info_ref so it works with any info, including
	static ones on the stack.
	(set_permissions_callback), (athena_file_set_permissions),
	(set_owner_and_group_callback), (set_owner_and_group): Change to
	use the info returned by the async. set_file_info. This simplifies
	things a lot.
	
	* src/file-manager/fm-error-reporting.c: (rename_callback),
	(cancel_rename_callback), (cancel_rename), (fm_rename_file):
	Rewrote renaming code. Use object data to keep track of pending
	renames so we can cancel a previous one if we try to re-rename the
	same file again. This allowed the code to get a lot simpler too.
	
	* libathena-extensions/athena-directory-async.c:
	(directory_load_done): Fixed bug that prevented the directory from
	ever noticing files that are no longer around. This code never
	worked because we checked for the wrong error code (EOF means
	success here).
	
	* po/Makefile.in.in: Re-removed this file. Seth checked it in by
	accident. This is a generated file, not one that should be checked
	in.
	
	* src/athena-window.c: (athena_window_realize): Got rid of
	"//"-style comments and used #if 0 instead.

	* components/loser/content/athena-content-loser-ui.xml.h:
	* components/loser/sidebar/athena-sidebar-loser-ui.xml.h:
	* components/mozilla/athena-mozilla-ui.xml.h:
	* components/sample/athena-sample-content-view-ui.xml.h:
	* components/services/summary/athena-view/athena-summary-view-ui.xml.h:
	* libathena/athena-clipboard-ui.xml.h:
	* src/file-manager/athena-directory-view-ui.xml.h:
	* src/file-manager/athena-icon-view-ui.xml.h:
	* src/file-manager/athena-search-list-view-ui.xml.h:
	* src/athena-service-ui.xml.h:
	* src/athena-shell-ui.xml.h:
	Someone checked in some .xml.h files generated with an old
	Bonobo. Soon, this nightmare will be over and we won't check these
	files in any more.
	
2000-10-27  Arlo Rose  <arlo@eazel.com>

	* src/athena-first-time-druid.c: (make_anti_aliased_label):
	Made a font size change.

2000-10-28  Mathieu Lacage  <mathieu@eazel.com>

	second round of fixing of the sgml. Will be 
	the last one hopefuly.
	* user-guide/C/sgml/chapter-1.sgml:
	* user-guide/C/sgml/chapter-2.sgml:
	* user-guide/C/sgml/chapter-3.sgml:
	* user-guide/C/sgml/install.sgml:
	* user-guide/C/sgml/intro.sgml:

2000-10-27  Mathieu Lacage  <mathieu@eazel.com>

	* user-guide/C/sgml/chapter-1.sgml:
	* user-guide/C/sgml/chapter-2.sgml:
	* user-guide/C/sgml/chapter-3.sgml:
	* user-guide/C/sgml/install.sgml:
	* user-guide/C/sgml/intro.sgml:
	* user-guide/C/sgml/athena.sgml:
	update to John's latest version, fix the sgml where needed.
	Need a new round of checking on my laptop. Help now displays 
	images !! hooray for Ali Abdin :)

2000-10-27  Robin * Slomkowski  <rslomkow@eazel.com>

	* README: package build requirments changed to be current
	left hole3s for gnome-vfs, ammonite, and medusa

2000-10-27  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_eazel_news_entry_row),
	(generate_login_dialog):
	finished bug 3793 for Shane, new login dialog for summary view, by
	changing the widget layout to satisfy Arlo.  Also marked more
	strings for translation.
	
2000-10-27  Arlo Rose  <arlo@eazel.com>

	* components/services/athena-dependent-shared/eazel-services-exte
	nsions.h:
	Tweaked text offests.

2000-10-27  John Sullivan  <sullivan@eazel.com>

	Grumble grumble canonical grumble uri grumble.

	Josh found another assertion failure involving
	canonical uris. Yay Josh! Boo canonical uri troubles!
	
	* libathena-extensions/athena-directory.c:
	(athena_directory_get_internal): Removed call to
	athena_uri_is_canonical_uri since it isn't quite the
	right check. Decided that the right check here is
	pointless.
	* libathena-extensions/athena-file-utilities.c:
	* libathena-extensions/athena-file-utilities.h:
	Removed athena_uri_is_canonical_uri since it now has
	no callers.

2000-10-27  John Sullivan  <sullivan@eazel.com>

	Fixed bug 4085 for now (need Support menu item in Services menu)

	The URL will have to be updated again later, as the bug report says.

	* src/athena-service-ui.xml: Added Support menu item at end, made
	underline accelerators unique
	* components/services/summary/athena-view/athena-summary-view-u
	i.xml: tweaked wording and made underline accelerators unique

	* components/services/summary/athena-view/athena-summary-view-u
	i.xml.h:
	* src/athena-service-ui.xml.h: These guys changed.

	* src/athena-window-service-ui.c: 
	(goto_services_support): New function, goes to magic URI.
	(athena_window_install_service_ui): add verb to connect menu item
	to function.

2000-10-27  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (forgot_password_button_cb):

	Fixing the url for the change password button.

2000-10-27  John Sullivan  <sullivan@eazel.com>

	Fixed bug 4114 (typing single word into location bar crashes)

	Grumble grumble canonical grumble uri grumble.

	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_canonical): Return of the workaround to
	convert file://foo to file:///foo, marked with appropriate
	FIXME.
	(athena_uri_is_canonical_uri): Changed implementation to just
	call make_uri_canonical and compare. It had been doing a subset
	of the things that make_uri_canonical does, but it had gotten out
	of synch.
	(athena_self_check_file_utilities): Updated tests and added more.

2000-10-27  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-db2html2/gdb3html.[ch]:
        Added a 'base_path' to the Context struct
        (parse_file): Do some minimal parsing to get the base path from the
        provided filename on the command line.

        * components/help/converters/gnome-db2html2/sect-elements.c:
        * components/help/converters/gnome-db2html2/toc-elements.c:
        (sect_figure_end_element),
        (sect_inlinegraphic_start_element),
        (sect_infobox_start_element),
        (toc_artheader_end_element):
        Use 'file://' URIs on images (using base_path to get the path of the
        image). This means images should now work within SGML files. Should
        fix bug #3938

2000-10-27  Ramiro Estrugo  <ramiro@eazel.com>

	Final bits of arlification for the install view.  Make the fonts
	smaller and use a better fill icon.

	* components/services/install/athena-view/athena-service-install-view.c:
	(generate_install_form):
	* components/services/login/athena-view/athena-change-password-view.c:
	(generate_change_password_form):
	* components/services/athena-dependent-shared/eazel-services-extensions.c:
	(eazel_services_label_new):
	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	* components/services/athena-dependent-shared/eazel-services-footer.c:
	(footer_item_new), (eazel_services_footer_update):
	Reverse the order of font_size and weight as its usually specified.
	
	* components/services/athena-dependent-shared/eazel-services-header.c:
	(eazel_services_header_title_new),
	(eazel_services_header_middle_new),
	(eazel_services_header_set_left_text),
	(eazel_services_header_set_right_text):
	* components/services/athena-dependent-shared/eazel-services-header.h:
	Split the constructors into 2 for the 2 common header cases.
	
	* components/services/athena-dependent-shared/icons/Makefile.am:
	Add a new icon for the middle header fill.
	
	* components/services/athena-dependent-shared/test-footer-header.c:
	(main):
	Update for header constructor changes.
	
	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (athena_summary_view_load_uri):
	Quiet down the debug spew.


2000-10-27  Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-list.c: (athena_gdk_gc_copy):
	An attempt to fix a list view redraw glitch Andy and I were trying to 
	track down.

2000-10-27  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_rpm_set_settings):
	Always enable rpm debugging (needed temporarily)

2000-10-27  Andy Hertzfeld  <andy@eazel.com>

	* components/music/athena-music-view.c: (add_play_controls):
	left justified the song label in the music view to make it
	look cleaner.
	
2000-10-27  Josh Barrow  <josh@eazel.com>

	* icons/ardmore/Makefile.am:
	* icons/ardmore/theme_preview.png:
	Added theme preview to the Ardmore theme.

	* icons/villanova/Makefile.am:
	* icons/villanova/theme_preview.png:
	Added theme preview to the Villanova theme.

	* athena-installer/src/Makefile:
	As Eskil says, "Yes."

2000-10-26  Seth Nickell  <seth@eazel.com>

	* src/athena-window.c: (athena_window_realize):

	Commented out a wm hints line that was causing Athena to be
	unfocusable (hence not allowing keyboard input, making it
	hard to work on things) in Sawfish. Coordination with 
	Sawfish/John Harper is probably needed here...

2000-10-26  Eskil Heyn Olsen  <eskil@eazel.com>

	This introduces the problem thingy to libeazelinstall. A set of
	funcs that can create humanreadable descriptions of a installation
	failure, plus repair descriptions and even better, automagically
	execute them. Basically this is all the RepairCase related crap
	from the bootstrap installer.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (tree_helper), (install_failed), (delete_files), (done), (main):
	Use the new problem thingy
	
	* components/services/install/lib/Makefile.am:
	Added the .c and .h file for the problem thingy

	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_check_existing_packages):
	Loads of debug output in the case that people kept nagging me
	about. If they still don't get that this is a known problem, they
	must be blind.
	
	* components/services/install/lib/eazel-install-problem.h:
	* components/services/install/lib/eazel-install-problem.c:
	(get_required_name), (get_detailed_messages_foreach),
	(compare_problem_case), (add_case), (add_force_install_both_case),
	(add_force_remove_case), (add_remove_case), (add_update_case),
	(get_detailed_cases_foreach),
	(eazel_install_problem_case_to_string),
	(eazel_install_problem_case_foreach_to_string),
	(eazel_install_problem_case_foreach_destroy),
	(eazel_install_problem_case_new),
	(eazel_install_problem_case_destroy),
	(eazel_install_problem_case_list_destroy),
	(eazel_install_problem_new), (eazel_install_problem_finalize),
	(eazel_install_problem_class_initialize),
	(eazel_install_problem_initialize),
	(eazel_install_problem_get_type), (problem_step_foreach_remove),
	(eazel_install_problem_step), (eazel_install_problem_tree_to_case),
	(eazel_install_problem_tree_to_string),
	(eazel_install_problem_cases_to_string),
	(find_dominant_problem_type), (find_problems_of_type),
	(find_dominant_problems), (build_categories_from_problem_list),
	(eazel_install_problem_handle_cases):
	The problem thingy.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_rpm_set_settings),
	(eazel_install_prepare_rpm_system):
	Set rpm debug if debug==TRUE, also fixed a debug message
	reg. cannot open rpm db.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.h:
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_update_from_uri):
	Allocate the problem thingy.
	
	* athena-installer/src/Makefile:
	Yes.
	
	* athena-installer/src/installer.c: (get_required_name):
	Used the samen get_required_name as the problem thingy
	
	* athena-installer/src/prescript:
	Removed the hack that we inserted for bug night.

2000-10-26  Robey Pointer  <robey@eazel.com>

	* components/services/login/athena-view/athena-change-password-
	view.c: (run_away_timer), (authn_succeeded), (authn_failed):

	Tidy up the password-change view a bit to try to make it more
	stable, and use more of the info from ammonite.  If ammonite
	throws away the current login (which happens whenever the server
	responds oddly), switch back to the summary view to force a
	re-login instead of drifting away.

2000-10-26  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-container.c: (destroy),
	(icon_destroy):
	fixed bug 4108, changing themes in the list view crashes athena.
	Fixed by removing the call to preferences_remove_callback from
	icon_destroy and putting it into the widget's destroy method like
	it should have been.  This also could have been hurting performance
	and causing other weird problems.
	
2000-10-26  Arlo Rose  <arlo@eazel.com>

	* components/services/athena-dependent-shared/eazel-services-exte
	nsions.h:
	Fixed a font weight problem.
	
2000-10-26  Ramiro Estrugo  <ramiro@eazel.com>
	
	* components/services/athena-dependent-shared/eazel-services-header.h:
	* components/services/athena-dependent-shared/eazel-services-header.c:
	(eazel_services_header_new),
	(eazel_services_header_set_left_text),
	(eazel_services_header_set_right_text):
	Change the 'constructor' to accept left/right strings a boolean
	that determines whether the logo is visible.
	* components/services/install/athena-view/athena-service-install-view.c:
	(generate_install_form):
	* components/services/login/athena-view/athena-change-password-view.c:
	(generate_change_password_form):
	* components/services/summary/athena-view/athena-summary-view.c:
	(generate_summary_form):
	Update for header changes.  Fixes bug 4099 (Secondary Header broke
	with test changed to the athena widget)
	
	* components/services/athena-dependent-shared/eazel-services-extensions.c:
	(eazel_services_get_current_date_string):
	Change the date format string.  Using a format of "%e" worked on
	one computer but spewed warnings on another.
	
	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	Tweak the header text offset a bit.
	
	* components/services/athena-dependent-shared/eazel-services-footer.c:
	(footer_item_new):
	Fix the last item's right boundary to make this beast be up to the
	most stringent Arlo standards.

	* components/services/athena-dependent-shared/test-footer-header.c: (main):
	Add a middle header to test new header features.

	* components/services/athena-dependent-shared/shared-service-widgets.c:
	* components/services/athena-dependent-shared/shared-service-widgets.h:
	Retire the old way to do middle headers.

2000-10-26  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_prepare_rpm_system):
	Moved the addition of the opened db into the if clause.
	
	* components/services/time/command-line/Makefile.am:
	Added GNOMELOCALEDIR
	
	* components/services/trilobite/helper/Makefile.am:
	Trickery to make the eazel-helper.security file be build during
	make and not make install, as the latter is Real Bad<tm> as the
	rpm version will point to a nonexisting binary.
	
	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.c: (trilobite_get_distribution):
	Inserted a else to fix the mandrake/redhat issue.
	
2000-10-26  John Sullivan  <sullivan@eazel.com>

	Fixed bug 4064 (Can't get a right-click menu in vault)

	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_canonical): Changed this to call
	gnome_vfs_uri_new () and gnome_vfs_uri_to_string () so
	we get the same canonicalization behavior as gnome-vfs,
	other than the special Athena-specific cases.
	(athena_self_check_file_utilities): Added a bunch of
	new checks, including copying & pasting many from
	gnome-vfs.
	* libathena-extensions/athena-directory.c:
	(athena_self_check_directory): added a couple of checks.

2000-10-26  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (forgot_password_button_cb), (generate_login_dialog):

	Adding the button toggle between register and i forgot my password
	options in the login dialog.  Still need to tweak the ui before the
	login is finished.

2000-10-26  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-icon-container.c: (relayout),
	(button_press_event), (key_press_event), (get_icon_being_renamed),
	(pending_icon_to_rename_destroy_callback),
	(get_pending_icon_to_rename), (set_pending_icon_to_rename),
	(process_pending_icon_to_rename), (is_renaming_pending),
	(is_renaming),
	(athena_icon_container_start_renaming_selected_item),
	(end_renaming_mode):
	* libathena-extensions/athena-icon-container.h:
	* libathena-extensions/athena-icon-private.h:
	* src/file-manager/fm-directory-view.c:
	(reveal_newly_added_folder), (new_folder_done):
	Folder renaming now starts when the icon is added rather than
	at some arbitrary timeout after the new folder command is
	issued. Fixed icon container to handle a request to rename an
	unpositioned icon.

2000-10-26  Eskil Heyn Olsen  <eskil@eazel.com>

	* src/Makefile.am:
	Install launch-athena, should fix rpmbuilding.

2000-10-26  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form):
	changed "additional services" message in summary view as requested
	by marketing.
	
2000-10-26  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	Fix bug 3845.  When configured to use an HTTP proxy, Mozilla won't
	go through Ammonite.  The fix is to tell the mozilla network
	library to NOT use the proxy to resolve 'localhost'.

2000-10-26  Gene Z. Ragan  <gzr@eazel.com>

	* libathena-extensions/athena-directory-async.c:
	(dequeue_pending_idle_callback):
	Did some refactoring to stop an assertion in AthenaDirectory
	add_to_hash_table from firing. This involved removing two lists
	of AthenaFiles that we being created and then merged.  Now one
	list is being used and the condition that causes the assertion (duplicate
	files in the hash table) is not being created.
	
	* components/tree/athena-tree-model.c:
	(athena_tree_model_directory_files_changed_callback):
	Removed the world famous ANOMALY error at the request of Darin.
	
2000-10-26  Robey Pointer  <robey@eazel.com>

	* components/services/login/athena-view/athena-change-password-
	view.c: (authn_failed):

	Better logging of a failed password change attempt.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_category):
	* athena-installer/src/installer.c: (add_bullet_point_to_vbox),
	(jump_to_error_page), (jump_to_retry_page):

	Factor out the bullet point generation and make it line-wrap
	(using Gtk's unfortunately lame line-wrapping algorithm).  Do
	better debugging on failed package lists.

2000-10-26  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (footer_item_clicked_callback):

	Fixing location callbacks to go to the right place when a user is
	logged in.

2000-10-26  Michael Engber  <engber@eazel.com>

	* src/file-manager/fm-desktop-icon-view.c:
	(quit_athena_desktop_menu_item_callback),
	(fm_desktop_icon_view_create_background_context_menu_items):

	Add "Quit Athena Desktop" to desktop context menu

2000-10-26  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	Make the font smaller (11 vs 13) as requested by Arlo.	
	
2000-10-26  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (authn_cb_succeeded), (athena_summary_view_initialize),
	(athena_summary_view_destroy):

	Rolling back gconf evil that seems to be causing the production runs
	of the summary to segfault.

2000-10-26  Rebecca Schulman  <rebecka@eazel.com>
	Fixed the panel menu item to launch the desktop
	and one athena window, starting at the user's 
	home directory by default.  To do this, we created
	a new script called launch-athena.  Ramiro 
	recommended some changes to run-athena that
	I also did.

	* athena.desktop:
	Changed run-athena to launch-athena
	* athena.spec.in:
	Changed run-athena to launch-athena,
	since run-athena won't be needed in the
	rpm
	* src/Makefile.am:
	added launch-athena to the build
	* src/launch-athena:
	* src/run-athena:
	removed the mozilla environment 
	LD_LIBRARY_PATH hacks.
	
	* user-guide/C/sgml/chapter-1.sgml:
	Corrected an HTML error.


2000-10-26  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (athena_summary_view_load_uri),
	(merge_bonobo_menu_items):
	* src/athena-window-service-ui.c: (goto_online_storage),
	(goto_software_catalog):

	Fixing exported function name used from ammonite.

2000-10-26  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 2814, move "built-in bookmarks" checkbox from the
	edit bookmarks window to preferences/navigation.
	
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_create_dialog), (global_preferences_register):
	added a checkbox to control the "hide built-in bookmarks" preference
	* libathena-extensions/athena-global-preferences.h:
	renamed preference path so the built-in bookmarks preference can
	be in the preferences window
	* src/athena-bookmarks-window.c: (create_bookmarks_window),
	(repopulate):
	removed the built-in bookmarks checkbox from the edit bookmarks
	window
	
2000-10-26  Andy Hertzfeld  <andy@eazel.com>

	added a new theme from Susan
	
	* configure.in:
	* icons/Makefile.am:
	* icons/villanova/.cvsignore:
	* icons/villanova/Makefile.am:
	* icons/villanova/villanova.xml:
	* icons/villanova/*.png:
	
2000-10-26  Pavel Cisler  <pavel@eazel.com>

	* librsvg/Makefile.am:
	fix the build.
	Checking in for Ramiro.

2000-10-26  Darin Adler  <darin@eazel.com>

	Fix bug 4052 (sidebar file count is not updated as settings are
	changed).
	
	* libathena-extensions/athena-directory-async.c:
	(dequeue_pending_idle_callback): Add a missing call to
	athena_file_changed.

2000-10-26  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_update_news_entry_row),
	(athena_summary_view_load_uri):

	Adding debug prints to locate optimized build crash in the summary view.

2000-10-26  Andy Hertzfeld  <andy@eazel.com>

	moved the eazel throbber into the default theme; moved Arlo's throbber
	into his theme and restored the generic throbber to the gnome theme.
	Updated the theme files to reflect this.
	
	* configure.in:
	* icons/ardmore/ardmore.xml:
	* icons/arlo/Makefile.am:
	* icons/arlo/arlo.xml:
	* icons/arlo/throbber/.cvsignore:
	* icons/arlo/throbber/Makefile.am:
	* icons/default.xml:
	* icons/eazel/Makefile.am:
	* icons/eazel/eazel.xml:
	* icons/gnome/Makefile.am:
	* icons/gnome/gnome.xml:
	* icons/gnome/throbber/.cvsignore:
	* icons/gnome/throbber/Makefile.am:
	* icons/throbber/Makefile.am:

2000-10-26  Darin Adler  <darin@eazel.com>

	Fix bug 3998 (Move to Trash crashes Athena if item with that
	name already in trash).

	* libathena-extensions/athena-directory.c:
	(athena_directory_notify_files_moved): Change the sequence so
	that the renaming doesn't try to update the file hash twice.
	
	* src/file-manager/fm-icon-view.c: (compute_menu_item_info):
	Handle NULL icon container case. This case happened to Will while
	testing.
	
	* src/file-manager/fm-directory-view.c: (load_directory): Fix
	GList leak.
	* src/athena-view-frame.c: (athena_view_frame_destroy): Fix
	string leak.
	* src/athena-window-menus.c: (append_bookmark_to_menu): Fix
	GdkPixbuf ref. leak.

	* libathena-extensions/athena-user-level-manager.c:
	(user_level_set_default_if_needed): Tiny coding style change.
	
2000-10-26  Rebecca Schulman  <rebecka@eazel.com>

	* athena.spec.in:  Moved the spec file entry
	from the binaries section to the data section,
	so the manual files' permissions will be set
	correctly, and changed *.sgml to * so
	we'll get the associated .css files (they're
	style sheets, I think?) and the images 
	installed, too.

2000-10-26  Mathieu Lacage  <mathieu@eazel.com>

	* athena.spec.in: add sgml files in rpms

2000-10-26  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(get_link_name), (make_next_duplicate_name):
	Link names weren't properly escaped causing them not to
	get selected.

	* src/file-manager/fm-directory-view.c: (copy_move_done_callback),
	(new_folder_done),
	(fm_directory_view_trash_state_changed_callback):
	added asserts

2000-10-26  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/eazel-services-footer.c:
	(footer_destroy), (label_enter_event), (label_leave_event),
	(image_enter_event), (image_leave_event),
	(prelight_data_free_callback), (image_add_prelighting),
	(label_add_prelighting), (footer_item_new):
	Final arlification touches.  Make the footer item's left and right
	bumpers prelight as well.
	
2000-10-26  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(mozilla_is_uri_handled_by_athena):
	Add "gnome-help" and "ghelp" to the list of uris handled by
	Athena as requested by Ali.
	
2000-10-26  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/Makefile.am:
	Add LIBPNG to test program link line.  It was breaking for me.
	
2000-10-26  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/shared-service-utilities.c:
	* components/services/athena-dependent-shared/shared-service-utilities.h:
	* components/services/athena-dependent-shared/shared-service-widgets.c:
	* components/services/athena-dependent-shared/shared-service-widgets.h:
	Remove a bunch of unused code.  Also removed 'go_to_uri()' which
	does the exact same thing (and nothing more) than
	'athena_view_open_location()'.  Use that directly instead.

	* components/services/install/athena-view/athena-service-install-view.c:
	(show_dialog_and_run_away),
	(athena_service_install_view_update_from_uri):
	* components/services/inventory/athena-view/athena-inventory-view.c:
	(gather_config_button_cb), (register_later_cb),
	(make_http_post_request):
	* components/services/login/athena-view/athena-change-password-view.c:
	(authn_succeeded), (maintenance_button_cb):
	Tiny bit of 'go_to_uri' cleanup.
	
	* components/services/summary/athena-view/athena-summary-view.c
	: (logged_in_callback), (logged_out_callback),
	(preferences_button_cb), (register_button_cb), (goto_service_cb),
	(goto_update_cb), (error_dialog_cancel_cb),
	(footer_item_clicked_callback):
	Add #defines for magical uris and 'go_to_uri' cleanup.

2000-10-26  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/main.c: (main):
	Dont need to check the mozilla environment anymore.
	
2000-10-26  Mathieu Lacage  <mathieu@eazel.com>

	Fix bug 2571: action not computed corected for dnd in list view.
	Also, the dnd in list view should be slightly nicer now :)
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_marshal_NONE__POINTER_POINTER_POINTER_INT_INT_INT), space
	(athena_gtk_marshal_NONE__POINTER_POINTER_POINTER_POINTER_INT_INT
	_UINT): brand new function for brand new signal as below :)
	* libathena-extensions/athena-gtk-extensions.h: prototype.
	
	* libathena-extensions/athena-list.c:
	(athena_list_initialize_class), 
	(athena_list_get_drop_action):
	* libathena-extensions/athena-list.h:
	Add signal get_default_action, remove old code to compute
	default action...

	* src/file-manager/fm-list-view.c:
	(athena_list_find_icon_list_drop_target),
	(fm_list_get_default_action), (set_up_list):
	connect to new signal, move old code to there, cleanup, finish.

2000-10-26  Andy Hertzfeld  <andy@eazel.com>

	* components/music/athena-music-view.c: (selection_callback),
	(add_play_controls), (athena_music_view_set_album_image),
	(athena_music_view_update):
	minimized flashing in the music view by fixing the size of the
	song label and play time, since it was relaying everything out
	when they changed.
	
2000-10-26  Mathieu Lacage  <mathieu@eazel.com>

        Make prelighted icons not prelighted when you leave the list 
	view without dropping. Also, move the actual prelighting
	operation from fm-list-view to athena-list.
	Also, remove FIXME about this bug since it is fixed.
	* libathena-extensions/athena-list.c:
	(athena_list_drag_leave),
	(athena_list_find_icon_list_drop_target),
	(athena_list_prelight_if_necessary):
	* src/file-manager/fm-list-view.c: (fm_list_handle_dragged_items):

2000-10-25  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/Makefile.am:
	Fix bug 4031.  Mozilla component wont run cause of unresolved
	symbols.  Link in the standard location of Mozilla
	(/usr/lib/mozilla) to make it always work without having to mess
	with environment stuff.
	
2000-10-25  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	* components/services/athena-dependent-shared/eazel-services-footer.c:
	(footer_item_new), (eazel_services_footer_update):
	* components/services/athena-dependent-shared/eazel-services-header.c:
	(eazel_services_header_new):
	Move more constants to shared place.
	
2000-10-26  Mathieu Lacage  <mathieu@eazel.com>

	* libathena-extensions/athena-drag.c: spaces...
	* libathena-extensions/athena-list.c:
	(athena_list_drag_start), 
	(athena_list_drag_leave): spaces.
	* src/file-manager/fm-list-view.c: 
	(fm_list_receive_dropped_icons): make dnd work in list 
	view by removing some old code from there which was made 
	useless by some recent changes in teh copy/move code...

2000-10-25  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(eazel_services_scheme_untranslate):

	Fix 3969; Untranslating eazel-services URI's works
	correctly for non-default users.

2000-10-25  John Sullivan  <sullivan@eazel.com>

	Fixed problems that were causing crash when Services button pressed.

	* libathena-extensions/athena-directory-async.c:
	(load_directory_done), (dequeue_pending_idle_callback):
	Was missing several NULL checks.

2000-10-25  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (generate_install_form), (show_dialog_and_run_away):

	A few quick tweaks to make the installer screenshot-worthy, and to
	fix a possible case where it would switch to a new URI before it
	had told athena it was done loading.  (I think that was
	confusing Athena in some corner cases.)
	
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(wipe_redirect_table), (add_redirect),
	(trilobite_redirect_lookup):

	Add "/" back to the keys when adding and removing, since otherwise
	we end up with a big blob of evil-named keys.  Fix the bug that
	the missing "/" was hiding: namely, that mass-removing keys had
	stopped working after the gconf upgrade.
	
2000-10-25  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/main.c: (run_test_cases), (main):
	* components/mozilla/athena-mozilla-content-view.c:
	(is_uri_partial), (make_full_uri_from_relative),
	(mozilla_dom_mouse_click_callback),
	(test_make_full_uri_from_relative):

	Fix bugzilla.eazel.com 3949.  Better (but still not perfect) 
	support for relative URI's.  The cases that aren't handled are rarely
	encountered in my experiance.  I'd make it perfect, but I just
	don't have time right now.
	Also added self-test.

2000-10-25  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/eazel-services-extensions.c:
	(eazel_services_label_new):
	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	* components/services/athena-dependent-shared/eazel-services-footer.c:
	(footer_item_new), (eazel_services_footer_update):
	* components/services/athena-dependent-shared/eazel-services-header.c:
	(eazel_services_header_new):
	Place the font families, weights and sizes in the header file so
	that Arlo can arloify them.
	
2000-10-25  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory.h:
	* libathena-extensions/athena-file-private.h:
	* libathena-extensions/athena-directory-async.c: (istr_equal),
	(istr_hash), (istr_set_new), (istr_set_insert), (add_istr_to_list),
	(istr_set_get_as_list), (istr_set_destroy): New set of functions
	for manipulating a set of case-insensitive strings (private for
	now).
	(mime_list_cancel): Change to use the istr_set.
	(get_filter_options_for_directory_count): Moved up so it can be
	used by the directory load code.
	(load_directory_done): Common function to use when a load is
	completed or cancelled.
	(dequeue_pending_idle_callback): Update file count and MIME list
	as well as just loading the files.
	(should_get_directory_count): New cover that takes into account
	the fact that a directory load is already getting the count.
	(should_get_mime_list): New cover that takes into account
	the fact that a directory load is already getting the MIME list.
	(start_monitoring_file_list): Set up more stuff since a load
	does a lot more now.
	(directory_count_start): Don't start a directory count if we are
	already loading the directory's file list.
	(mime_list_one), (mime_list_callback), (mime_list_load): Change to
	use the istr_set. Also removed some code that set variables that
	were never used.
	(mime_list_start): Don't start a MIME list if we are already
	loading the directory's file list.

	* components/adapter/Makefile.am:
	* components/hardware/Makefile.am:
	* components/html/Makefile.am:
	* components/loser/content/Makefile.am:
	* components/loser/sidebar/Makefile.am:
	* components/mozilla/Makefile.am:
	* components/music/Makefile.am:
	* components/rpmview/Makefile.am:
	* components/sample/Makefile.am:
	* components/services/install/command-line/Makefile.am:
	* components/services/install/lib/Makefile.am:
	* components/services/install/athena-view/Makefile.am:
	* components/services/install/server/Makefile.am:
	* components/services/inventory/lib/Makefile.am:
	* components/services/inventory/athena-view/Makefile.am:
	* components/services/login/athena-view/Makefile.am:
	* components/services/athena-dependent-shared/Makefile.am:
	* components/services/summary/lib/Makefile.am:
	* components/services/summary/athena-view/Makefile.am:
	* components/services/time/command-line/Makefile.am:
	* components/services/time/athena-view/Makefile.am:
	* components/services/time/service/Makefile.am:
	* components/services/trilobite/libtrilobite/Makefile.am:
	* components/services/trilobite/sample/command-line/Makefile.am:
	* components/services/trilobite/sample/lib/Makefile.am:
	* components/services/trilobite/sample/athena-view/Makefile.am:
	* components/services/trilobite/sample/service/Makefile.am:
	* components/services/vault/command-line/Makefile.am:
	* components/tree/Makefile.am:
	* helper-utilities/authenticate/Makefile.am:
	* athena-installer/src/Makefile.am:
	Changed all use of CPPFLAGS to use INCLUDES instead as it says in
	the automake documentation.
	
	* libathena-extensions/athena-glib-extensions.h: Reformatting.
	* libathena-extensions/athena-glib-extensions.c:
	(athena_g_hash_table_remove_deep_custom),
	(athena_g_hash_table_remove_deep), (destroy_deep_helper),
	(athena_g_hash_table_destroy_deep_custom): Reformatting.

2000-10-25  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(new_folder_xfer_callback):
	new_folder_xfer_callback was not escaping the space in
	duplicate_name, this was causing us to not recognize
	second and subsequent new folders (& select them).
	* src/file-manager/fm-directory-view.c: (copy_move_done_callback):
	moved free call to better spot

2000-10-25  J Shane Culpepper  <pepper@eazel.com>

	* src/athena-window-service-ui.c: (goto_online_storage):

	Fixing url string.  Had one too many slashes.

2000-10-25  John Sullivan  <sullivan@eazel.com>

	Fixed various usability problems with the services log-in
	dialog that I ran into. Some coding tweaks too.

	* components/services/summary/athena-view/athena-summary-view.c:
	(generate_error_dialog): move cast to cause fewer of them
	(name_or_password_field_activated): New function, auto-clicks the
	OK button if the password row is activated.
	(generate_login_dialog): move cast to cause fewer of them; use
	#defines for button indices and row numbers; changed "Opps" to
	"Oops" (Oops!); set default button to OK button; wire up
	name_or_password_field_activated; start with focus in Name field.

2000-10-25  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (athena_summary_view_load_uri),
	(merge_bonobo_menu_items):
	* src/Makefile.am:
	* src/athena-window-service-ui.c: (goto_online_storage),
	(goto_software_catalog):

	Fixing the services menu items to go to correct locations.

2000-10-25  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-query.c:
	Fixed a include problem.
	* components/services/install/lib/eazel-install-rpm-glue.h:
	Added /me to authors

2000-10-25  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-types.c:
	(categorydata_new):
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_category):
	* athena-installer/src/installer.c:
	(eazel_installer_add_category):

	Add <DEFAULT/> option to the package list XML file, and make all
	default choices be pre-clicked when the user gets to the selection
	page.

2000-10-25  Darin Adler  <darin@eazel.com>

	* src/athena-applicable-views.c: (athena_navigation_info_new),
	(athena_navigation_info_free),
	(athena_navigation_info_get_location): Changed to store the
	location URI separate from the AthenaFile object. AthenaFile
	was munging URLs that had queries in them, causing big problems
	for the software catalog among other things. This is a good
	short-term fix.

2000-10-25  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query):
	Don't bomb out when db cannot be accessed.

2000-10-25  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-list.c:
	(athena_list_set_selection):
	athena_list_set_selection used to pass a bogus AthenaCListRow*
	to row_set_selected
	
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_new_folder):
	whitespace change

	* src/file-manager/fm-list-view.c:
	comment corrected

2000-10-25  Darin Adler  <darin@eazel.com>

	* components/adapter/bonobo-stream-vfs.c: (vfs_get_info),
	(vfs_set_info), (vfs_write), (vfs_read), (vfs_seek), (vfs_copy_to),
	(vfs_commit), (vfs_revert), (vfs_destroy),
	(bonobo_stream_vfs_class_init), (bonobo_stream_vfs_open):
	Update for changes to the BonoboStream class. Also did a thorough code
	review, fixed some small bugs, and added a bunch of FIXMEs for things
	that are broken.

2000-10-25  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/eazel-services-constants.h:
	Removed.  It was a bad try.  Stuff is now in eazel-services-extensions.h.
	
	* components/services/athena-dependent-shared/Makefile.am:
	* components/services/athena-dependent-shared/eazel-services-extensions.c:
	(pixbuf_new_from_name), (eazel_services_image_new),
	(eazel_services_label_new):
	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	Add a place to put shared services extensions.
	
	* components/services/athena-dependent-shared/eazel-services-footer.c:
	(footer_item_new), (footer_remainder_new),
	(eazel_services_footer_update):
	* components/services/athena-dependent-shared/eazel-services-header.c:
	(eazel_services_header_new):
	* components/services/athena-dependent-shared/test-footer-header.c:
	Remove a bunch of duplicated code and put it in a shared
	extensions location.  Make the footer real.  Add an item_clicked
	signal to the footer.

	* components/services/summary/athena-view/athena-summary-view.c:
	Hook up the footer for item clicks.
	
	* libathena-extensions/athena-image.c:
	(athena_image_new_loaded):
	* libathena-extensions/athena-image.h:
	* libathena-extensions/athena-label.c:
	(athena_label_new_loaded):
	* libathena-extensions/athena-label.h:
	Add constructors that take a bunch of arguments for the various
	widgets attributes.  Makes the widgets easier to use for callers
	that need to tweak many attributes (like eazel services).
	
2000-10-25  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/.cvsignore:
	* components/services/athena-dependent-shared/Makefile.am:
	* components/services/athena-dependent-shared/eazel-services-constants.h:
	* components/services/athena-dependent-shared/eazel-services-footer.c:
	(eazel_services_footer_initialize_class),
	(eazel_services_footer_initialize), (footer_destroy),
	(pixbuf_new_from_name), (label_new), (label_enter_event),
	(label_leave_event), (label_button_press_event), (label_free_data),
	(label_free_uri), (image_new), (image_new_from_name),
	(buffered_widget_add_prelighting), (footer_item_new),
	(footer_remainder_new), (eazel_services_footer_new),
	(eazel_services_footer_update):
	* components/services/athena-dependent-shared/eazel-services-footer.h:
	* components/services/athena-dependent-shared/eazel-services-header.c:
	(eazel_services_header_initialize_class),
	(eazel_services_header_initialize), (header_destroy),
	(pixbuf_new_from_name), (label_new), (image_new),
	(image_new_from_name), (eazel_services_header_new),
	(eazel_services_header_set_text):
	* components/services/athena-dependent-shared/eazel-services-header.h:
	Two new widgets to deal with services views headers and footers.
	
	* components/services/install/athena-view/athena-service-install-view.c:
	(generate_install_form):
	* components/services/login/athena-view/athena-change-password-view.c:
	(generate_change_password_form):
	* components/services/summary/athena-view/athena-summary-view.c:
	(generate_summary_form):
	Use the new footer and header widgets.
	
	* components/services/athena-dependent-shared/shared-service-widgets.c:
	* components/services/athena-dependent-shared/shared-service-widgets.h:
	Retire some old code.

	* components/services/athena-dependent-shared/test-footer-header.c:
	(delete_event), (main):
	Add a test for the new header and footer widgets.
	
2000-10-25  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-label.c:
	(athena_label_size_request), (render_buffer_pixbuf):
	Make sure text layout honors the vertical and horizontal offsets.

	(athena_scalable_font_draw_text):
	* test/test-athena-image.c: (label_new), (label_enter_event),
	(label_leave_event), (label_free_data),
	(buffered_widget_add_prelighting), (header_new), (footer_item_new),
	(footer_remainder_new), (footer_new), (main):
	More work on prelighting footers.
	
2000-10-25  Andy Hertzfeld  <andy@eazel.com>

	* components/services/athena-dependent-shared/shared-service-widg
	ets.c: (create_image_widget), (create_image_widget_from_uri):
	fixed bug where local images were not showing up in the summary
	view.
	
2000-10-24  Andy Hertzfeld  <andy@eazel.com>

	worked on bug 3898, selection in the aa icon view is too slow.
	Fixed by using a fill to make the selection pixbuf with some tiny
	blits for the rounded corners, instead of stretching a pixbuf.
	Also, made the selection color themable in the process.
	
	* libathena-extensions/athena-icon-canvas-item.c:
	(clear_rounded_corners), (draw_label_text_aa):
	make the selection pixbuf with a fill and then some
	blits for the corner.
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_initialize), (icon_destroy),
	(athena_icon_container_set_is_fixed_size),
	(athena_icon_container_theme_changed):
	made it read the selection color from the current theme
	* libathena-extensions/athena-icon-private.h:
	added a field to keep the selection color w/alpha.
	* icons/default.xml:
	added semi-transparent gray selection color to default theme.
	
2000-10-24  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-buffered-widget.c:
	Remove a bunch of extraneous includes.
	
2000-10-24  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/icons/Makefile.am:
	Rename one of the icons.
	
	* test/test-athena-image.c: (delete_event), (icon_get_path),
	(pixbuf_new_from_name), (label_new), (label_enter_event),
	(label_leave_event), (label_new_with_prelight), (image_new),
	(image_new_from_name), (header_new), (footer_new), (main):
	Add better test for image and label widgets.
	
2000-10-24  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/Makefile.am:
	Fix the broken build.  Add missing header to sources.
	
2000-10-24  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic.c:
	Moved a CORBA include, so EAZEL_INSTALL_NO_CORBA doesn't include
	it
	
	* components/services/time/command-line/main.c: (main):
	* components/services/time/idl/trilobite-eazel-time-service.idl:
	* components/services/time/athena-view/trilobite-eazel-time-view.
	c: (server_button_pressed), (timediff_button_pressed),
	(trilobite_eazel_time_view_initialize),
	(trilobite_eazel_time_view_destroy):
	* components/services/time/service/trilobite-eazel-time-service-pri
	vate.h:
	* components/services/time/service/trilobite-eazel-time-service.c:
	(impl_Trilobite_Eazel_Time_Service_set_time_server),
	(trilobite_eazel_time_service_get_epv),
	(trilobite_eazel_time_service_finalize),
	(trilobite_eazel_time_service_initialize_load_config),
	(get_nist_time), (trilobite_eazel_time_service_get_server_time):
	Revived the timeservice, made it use nist/ntp (defaults to
	nist1.sjc.certifiedtime.com). Uses code from gnuclear to do the
	actual nist parse.
	
	* athena-installer/src/Makefile:
	Yes.
	* athena-installer/src/installer.c: (start_over),
	(add_update_package), (eazel_install_preflight), (check_system),
	(more_check_system):
	Fixed the "will update eog && will remove eog" bug. Now it just
	say "will update eog x 2". Also checks for rh7.x and rpm v.4.x
	
	* athena-installer/src/prescript:
	Temporarily hacked prescript to run
	/h/public/bin/eazel-trilobite-configure (if present), and set
	athena to use gegl as services server.
	
	* athena.spec.in:
	Updated deps to ORBit >= 0.5.3 and oaf >= 0.6.0

2000-10-24  Robey Pointer  <robey@eazel.com>

	* libathena-extensions/athena-directory-async.c:
	(mime_list_callback):

	Fix a typo that caused a failure to not report that it failed.

2000-10-24  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/athena-dependent-shared/icons/Makefile.am:
	* components/services/athena-dependent-shared/icons/eazel-logo-left-side-repeat.png:
	* components/services/athena-dependent-shared/icons/eazel-logo-right-side-eazel-logo.png:
	* components/services/athena-dependent-shared/icons/summary-service-normal-fill.png:
	* components/services/athena-dependent-shared/icons/summary-service-normal-left-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-normal-right-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-prelight-fill.png:
	* components/services/athena-dependent-shared/icons/summary-service-prelight-left-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-prelight-right-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-remainder-fill.png:
	* components/services/athena-dependent-shared/icons/summary-service-remainder-left-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-remainder-right-bumper.png:

	New icons for summary view.
	
2000-10-24  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_eazel_news_entry_row), (generate_update_news_entry_row):
	lots of layout tweaks to please Arlo; it's still not finished yet
	since I wasn't able to shrink the news section properly
	
	* libathena-extensions/athena-tabs.c:
	(athena_tabs_initialize), (draw_tab_label), (draw_all_tabs),
	(athena_tabs_prelight_tab), (athena_tabs_select_tab):
	changed font size, text spacing and prelight behaviour as
	specified by Arlo.
	
	* icons/eazel/Back.png:
	* icons/eazel/Forward.png:
	* icons/eazel/Home.png:
	* icons/eazel/Refresh.png:
	* icons/eazel/Search.png:
	* icons/eazel/SearchWeb.png: 
	* icons/eazel/Services.png:
	* icons/eazel/Stop.png:
	* icons/eazel/Up.png:

	updated Susan's toolbar icons
	
2000-10-24  Arlo Rose  <arlo@eazel.com>

	* components/services/summary/athena-view/icons/
	gray_tab_pieces/prelight-active-bridge.png:
	Fixed a typo.

2000-10-24  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/Makefile.am:
	* librsvg/art_rgba.c: (art_rgba_rgba_composite),
	(art_rgba_fill_run), (art_rgba_run_alpha):
	* librsvg/art_rgba.h:
	* librsvg/rsvg.c:
	Make Raph's latest changes work with the old version of libart in
	gnome-libs-1-0.
	
2000-10-24  Arlo Rose  <arlo@eazel.com>

	* icons/arlo/Makefile.am:
	* icons/arlo/i-directory.xml:
	* icons/arlo/emblem-nowrite-72.png:
	* icons/arlo/emblem-nowrite-96.png:
	Some old stuff I guess I never checked in...

	
	* components/services/summary/athena-view/icons/
	gray_tab_pieces/prelight-fill.png:
	* components/services/summary/athena-view/icons/
	gray_tab_pieces/active-prelight-bridge.png:
	* components/services/summary/athena-view/icons/
	gray_tab_pieces/prelight-active-bridge.png:
	* components/services/summary/athena-view/icons/
	gray_tab_pieces/prelight-right-bumper.png:
	* components/services/summary/athena-view/icons/
	gray_tab_pieces/prelight-left-bumper.png:
	Making the summary view tabs pre-light better.
	
2000-10-24  Raph Levien  <raph@acm.org>

	* librsvg/rsvg.c: Implemented the "opacity" property for objects
	and groups. This makes rsvg render more SVG files exported from
	Adobe Illustrator 9 correctly and should make Arlo happy.

	* librsvg/opacity.svg: New test file including opacity examples.

2000-10-24  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_update_news_entry_row), (authn_cb_failed),
	(login_button_cb), (generate_login_dialog),
	(athena_summary_view_load_uri):

	Adding login changes to the summary view.  Still needs a bit more
	work but looks better.

2000-10-24  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-glib-extensions.c:
	(athena_g_hash_table_remove_deep_custom),
	(athena_g_hash_table_destroy_deep_helper):
	These two fns now properly handle key == value (won't double free)

2000-10-24  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(handle_xfer_ok):
	* libathena-extensions/athena-glib-extensions.c:
	(athena_g_hash_table_remove_deep_custom),
	(athena_g_hash_table_remove_deep),
	(athena_g_hash_table_destroy_deep_helper),
	(athena_g_hash_table_destroy_deep_custom),
	(athena_g_hash_table_destroy_deep):
	* libathena-extensions/athena-glib-extensions.h:
	* src/file-manager/fm-directory-view.c: (debuting_uri_data_free):
	Fix embarrassing check-in sloppiness

2000-10-24  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-glib-extensions.c:
	(athena_g_hash_table_remove_deep_custom),
	(athena_g_hash_table_remove_deep),
	(athena_g_hash_table_free_deep_helper),
	(athena_g_hash_table_free_deep_custom),
	(athena_g_hash_table_free_deep):
	* libathena-extensions/athena-glib-extensions.h:
	Fixed APIs of new utils to match existing, similar, fns.

	* src/file-manager/fm-directory-view.c: (debuting_uri_data_free),
	(debuting_uri_add_file_callback), (copy_move_done_data_free),
	(pre_copy_move_add_file_callback), (copy_move_done_partition_func),
	(copy_move_done_callback):
	Icons now left selected after copy_move operation.

2000-10-24  Brian Frank  <bfrank@eazel.com>

	* data/static_bookmarks.xml
	Updated bookmarks list to current links

2000-10-24  Darin Adler  <darin@eazel.com>

	Some work towards reducing load_directory calls.

	Also fixed bug 3978 (Many Bonobo warnings/errors on quit).
	
	* libathena-extensions/athena-directory-async.c:
	(set_up_request_by_file_attributes),
	(update_file_info_in_list_if_needed),
	(dequeue_pending_idle_callback), (request_is_satisfied),
	(get_info_callback), (file_info_start):
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-file-attributes.h:
	* libathena-extensions/athena-file-private.h:
	* libathena-extensions/athena-file.c:
	(athena_file_new_from_info), (destroy),
	(athena_file_update_info), (athena_file_update_name),
	(athena_file_compare_by_type),
	(athena_file_get_string_attribute), (get_description),
	(update_description_for_link), (athena_file_get_type_as_string),
	(athena_file_get_mime_type), (athena_file_is_mime_type),
	(athena_file_check_if_ready):
	* libathena-extensions/athena-file.h:
	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_actions_get_required_file_attributes),
	(athena_mime_get_default_action_type_for_file),
	(athena_mime_get_default_application_for_file_internal),
	(athena_mime_get_default_component_for_file_internal),
	(athena_mime_get_short_list_applications_for_file),
	(athena_mime_get_short_list_components_for_file),
	(athena_mime_get_short_list_methods_for_file),
	(athena_mime_get_all_applications_for_file),
	(athena_mime_get_all_components_for_file),
	(athena_mime_set_short_list_applications_for_file),
	(athena_mime_set_short_list_components_for_file):
	Get rid of the distinction between slow and default MIME type once
	again. We (Pavel, Maciej, John, and I) decided it's better not to
	have multiple opinions on the MIME type, despite our original idea
	that we needed the slow MIME type for some things, even on remote
	file systems.
	
	* libathena-extensions/athena-glib-extensions.h:
	Fixed the formatting in this file.
	
	* src/file-manager/fm-directory-view.c: (load_location_callback):
	Only force a reload if we are reloading the same directory. This
	is needed to take advantage of the loading already done for us by
	the framework.
	(load_directory): Take a AthenaDirectory instead of a URI string.
	Also take a boolean parameter to control if we force a reload.
	(finish_loading_uri): Respect the boolean parameter that tells us
	whether to force a reload.
	(filtering_changed_callback): Use the new load_directory.
	
	* src/athena-applicable-views.c: (athena_navigation_info_new),
	(athena_navigation_info_cancel), (athena_navigation_info_free):
	Monitor the directory while we are loading the component. We
	already need to load the directory to get the MIME types, so this
	does no additional harm, and it prepares us to consolidate the
	loading done for different reasons.
	
	* src/athena-main.c: (main): Use athena_setenv instead of
	putenv, since it's more portable.
	
	* src/athena-window-manage-views.c: Quick simplification pass on
	state machine. Got rid of the use of varargs and renamed a bunch
	of things.
	
	* src/athena-window-manage-views.h:
	* src/athena-window-private.h:
	Moved external functions from athena-window-manage-views.c to
	all be in athena-window-manager-views.h. This is one step in
	reducing the number of clients that need access to private stuff
	in AthenaWindow.
	
	* src/athena-window-service-ui.c: (detach_service_ui),
	(athena_window_install_service_ui): Detach the service UI on
	"destroy" rather that using set_data_full, because finalize time
	is too late.

	* src/athena-view-frame.c: (athena_view_frame_destroy):
	Got rid of extra unref that was messing things up here.
	
2000-10-24  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(uris_are_equal), (athena_mozilla_content_view_load_uri):
	Fix for bug 3908.  Browsing to web documents deeper than the root
	is broken.  I fixed it by backing out my previous broken fix for
	"reloading" a web page.  There is a separate bug for the reload
	issue which ill fix properly later.
	
2000-10-24  Ramiro Estrugo  <ramiro@eazel.com>

	* configure.in:
	Make the require rpm version be 3.0.4 or greater.  Not just 3.0.4.
	
2000-10-24  Andy Hertzfeld  <andy@eazel.com>

	added new certified emblem from Susan
	
	* data/emblems/Makefile.am:
	* data/emblems/certified.png:
	added certified.png
	* icons/Makefile.am:
	* icons/emblem-certified.svg:
	added emblem-certified.svg, removed emblem-certified.gif

2000-10-23  Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(parse_previous_duplicate_name),
	(athena_self_check_file_operations):
	Fix 3971 - "duplicate" from context-click menu adds space to
	beginning of the name.
	This was a case of misinterpretting files such as ".bashrc" as
	an extension.
	Added tests that catch this problem and fixed it. 

2000-10-24  Josh Barrow  <josh@eazel.com>

	* athena.spec.in:
	Make it require 3.0.4 or *greater*.  I'm using 3.0.5 and it 
	works fine.

2000-10-23  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-types.c:
	(categorydata_new):
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_category):
	* athena-installer/src/installer.c: (strip_categories),
	(start_over_make_category_func), (start_over),
	(jump_to_retry_page), (add_force_packages), (add_force_remove),
	(add_update_package), (toggle_button_toggled),
	(eazel_installer_add_category), (eazel_installer_do_install):

	add <EXCLUSIVE/> tag to categories in package-list.xml to indicate
	that a category can't be selected with any other category (it's
	mutually exclusive with them).  added puppet-strings to the
	bootstrap installer to support that.
	
2000-10-23  Eskil Heyn Olsen  <eskil@eazel.com>

	* user-guide/C/Makefile.am:
	Fixing tinderbox build.
	
2000-10-23  Eskil Heyn Olsen  <eskil@eazel.com>

	* configure.in:
	Some code to test for rpm version. We require 3.0.4. If it fucks
	up, feel free to revert.
	
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-object.c:
	Moved the DEFAULT_RPM_DB_ROOT into -private.h
	
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query):
	Code so you can call the query function directly
	(EAZEL_INSTALL_SLIM/NO_CORBA)
	
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_fill_from_rpm_header):
	Moved support for rpm < 3.0.4
	
	* athena-installer/src/Makefile:
	* athena-installer/src/callbacks.c: (begin_install):
	* athena-installer/src/installer.c: (insert_info_page),
	(create_window), (check_system), (more_check_system),
	(eazel_installer_initialize):
	If eazel-hacking is installed, offer to remove it.
	
2000-10-23  Mike Fleming  <mfleming@eazel.com>

	* components/services/summary/athena-view/main.c: (main):
	Add gconf-init
	
	* components/services/summary/athena-view/athena-summary-view.c
	: (save_default_eazel_service_user), (authn_cb_succeeded),
	(am_i_logged_in), (logged_in_callback),
	(athena_summary_view_initialize),
	(athena_summary_view_destroy):

	Store previously used Eazel Service user for later.  The ammonite
	login dialog makes use of this as the default username.
	

2000-10-23  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-types.c:
	(packagedata_fill_from_rpm_header):

	Fix a few warnings that show up on older rpmlibs.

2000-10-23  Pavel Cisler  <pavel@eazel.com>

	Last part of fix to 2989 - Disk thrashing on Athena startup.
	* libathena-extensions/athena-trash-directory.c: (add_volume):
	When starting up, don't try to create a Trash up-front, just search
	for existing Trash directories. The first time Athena ever runs,
	this will still take the same ammount of time, the next time it
	will use the cached entries.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_can_move_file_to_trash):
	Trash monitor no longer creates Trash directories on startup.
	Create them lazily when trying to move an item to the Trash.

2000-10-23  Mathieu Lacage  <mathieu@eazel.com>

	* user-guide/C/Makefile.am: make it install files for real...

2000-10-23  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 1945, Image viewer component does not display XPMs
	Fixed bug 1964, doesn't load xpm images using the loader framework.
	
	* components/image-viewer/athena-image-view.c:
	(load_image_from_stream):
	Fixed some leaks and call close on the loader to fix TIFF and XPM loading.
	
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(athena_gdk_pixbuf_load):
	Now it does. Loader must be closed to cause callbacks an non-progressive
	loaders to complete.

	* components/services/install/lib/eazel-install-types.c:
	(packagedata_fill_from_rpm_header):
	Fixed a couple of build breaking unitilaized variable warnings.
	
	* components/tree/athena-tree-view.c:
	Updated function call to new prototype that was causing build to fail.	

2000-10-23  Mathieu Lacage  <mathieu@eazel.com>

	* components/help/hyperbola-filefmt.c:
	(fmt_help_populate_tree_from_subdir): add lookup 
	for sgml and xml files.

2000-10-23  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_local_xml_package_list):
	* athena-installer/src/installer.c: (strip_categories),
	(start_over_make_category_func), (start_over),
	(jump_to_retry_page), (add_force_packages), (add_force_remove),
	(add_update_package), (eazel_installer_add_category),
	(eazel_installer_do_install), (eazel_installer_initialize):
	* athena-installer/src/link.sh:
	
	Reduce category description text to 10pt and adjust the layout to
	match Arlo specs.  Change g_message's to LOG_DEBUG just to annoy
	Eskil (actually, so we can turn them on/off easily with --debug).

2000-10-23  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(handle_xfer_ok), (sync_xfer_callback),
	(athena_file_operations_copy_move),
	(athena_file_operations_move_to_trash),
	(athena_file_operations_delete), (do_empty_trash):
	* libathena-extensions/athena-file-operations.h:
	Added callback for copy_move operation - to support
	selecting icons afterward.

	* libathena-extensions/athena-glib-extensions.c:
	(athena_g_hash_table_remove_deep_custom),
	(athena_g_hash_table_remove_deep),
	(athena_g_hash_table_free_deep_helper),
	(athena_g_hash_table_free_deep_custom),
	(athena_g_hash_table_free_deep):
	* libathena-extensions/athena-glib-extensions.h:
	Added misc hash table utilities

	* src/file-manager/fm-directory-view.c: (debuting_uri_data_free),
	(debuting_uri_add_file_callback), (copy_move_done_data_free),
	(pre_copy_move_add_file_callback), (pre_copy_move),
	(copy_move_done_partition_func), (copy_move_done_callback),
	(fm_directory_view_create_links_for_files),
	(fm_directory_view_duplicate_selection), (new_folder_done),
	(fm_directory_view_new_folder),
	(fm_directory_view_move_copy_items):
	Hooked up to new copy_move callback. There are still problems,
	the icons get unselected by someone after they're selected.

2000-10-23  Eskil Heyn Olsen  <eskil@eazel.com>

	* README:
	Added that we require rpm 3.0.4 if --enable-eazel-service

	* components/services/install/lib/eazel-install-types.c:
	(packagedata_fill_from_rpm_header):
	Fix for older rpm's (although installation will probably still
	be borked, should insert #error instead.

	* athena.spec.in:
	athena-trilobite requires rpm = 3.0.4

2000-10-23  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (create_package):

	Athena doesn't always encode "rpm_id=" into "rpm_id%3D", so
	check for both.

2000-10-23  Darin Adler  <darin@eazel.com>

	* Makefile.shared: Fix extra dependency that was causing the xml.h
	files to be generated too often.
	* configure.in: Fix code that detects the gcc options to work even
	with -O on.
	
	* src/athena-view-frame.h:
	* src/athena-view-frame.c:
	(athena_view_frame_initialize_class),
	(view_frame_loaded), (view_frame_failed),
	(athena_view_frame_handle_client_destroy),
	(athena_view_frame_handle_client_gone),
	(athena_view_frame_new), (check_if_view_is_gone),
	(athena_view_frame_set_to_component),
	(athena_view_frame_get_is_underway):
	Revamp set of signals to be easier to understand. Handle all
	failures uniformly,
	
	* src/athena-window-manage-views.h:
	* src/athena-window-manage-views.c: (change_selection),
	(athena_window_update_for_new_location),
	(athena_window_has_really_changed),
	(athena_window_set_state_info),
	(athena_window_set_sidebar_panels),
	(zoom_level_changed_callback), (get_history_list_callback),
	(change_selection_callback), (change_status_callback),
	(failed_callback), (load_underway_callback),
	(load_complete_callback), (open_location_callback),
	(open_location_in_new_window_callback), (title_changed_callback),
	(athena_window_connect_view), (athena_window_disconnect_view):
	Make more of the view management private to this file. Use the
	signals by their new names. Disconnect all the signals, not just
	the error-related ones.
	
	* src/athena-window.c:
	(athena_window_set_content_view_widget): Updated the debugging
	check to do it with the new Bonobo UI calls.

2000-10-23  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form):
	made the summary view not display the news section when there is
	no news to display.
	
2000-10-23  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	Added a comment to the ssl_rename variable.
	Added a function stub for querying the server about packages. Not
	impl yet.
	
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_check_for_file_conflicts),
	(eazel_install_do_transaction_fill_hash),
	(eazel_install_monitor_process_pipe),
	(eazel_install_monitor_err_process_pipe),
	(eazel_install_monitor_subcommand_pipe),
	(eazel_install_do_transaction_all_files_check),
	(eazel_install_clean_name_to_package_hash),
	(eazel_install_start_transaction),
	(eazel_install_check_existing_packages),
	(eazel_install_fetch_dependencies), (dump_one_package),
	(eazel_install_do_file_conflict_check),
	(eazel_install_ensure_deps), (eazel_uninstall_upward_traverse),
	(eazel_uninstall_globber):
	Added comments and clarified some variable names.
	No file dep checking on --force.
	No whatrequires check on uninstall on --force
	Moved the all_files_check call into ensure_deps, so if packages
	are pruned we can rerun ensure_deps.
	No longer check if a provides file is a directory before conflict
	check (not needed because of fix in eazel-install-types).
	Calling g_main_iteration during file conflict checking if
	EAZEL_INSTALL_SLIM is set.
	Clean up some lists and hashtables at the end of a transaction.
	
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize), (eazel_install_class_initialize),
	(eazel_install_initialize), (eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_emit_done):
	All default funcs are NULL if EAZEL_INSTALL_NO_CORBA set.
	Set private->revert to TRUE during revert.
	Some more debug output.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file), (eazel_install_fetch_file),
	(eazel_install_fetch_package), (get_search_url_for_package):
	Don't add the package to downloaded_files list till after we've
	checked the version and name.
	If revert, use &flag=8 otherwise 12.
	
	* components/services/install/lib/eazel-install-query.c:
	(eazel_install_simple_rpm_query):
	Assert that the dbs hashtable is !null.
	
	* components/services/install/lib/eazel-install-rpm-glue.h:
	* components/services/install/lib/eazel-install-rpm-glue.c:
	(eazel_install_rpm_set_settings),
	(eazel_install_start_transaction_make_rpm_argument_list),
	(eazel_install_monitor_rpm_process_pipe),
	(eazel_install_free_rpm_system),
	(eazel_install_prepare_rpm_system),
	(eazel_install_package_modifies_provides_compare),
	(eazel_install_do_rpm_dependency_check):
	Loads of debug code to grab stderr & stdout output from rpm.
	More comments in the do_rpm_dependency_check func.
	
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-types.c:
	(categorydata_new), (categorydata_list_copy), (categorydata_copy),
	(packagedata_list_copy), (packagedata_copy),
	(packagedata_fill_from_rpm_header), (packagedata_destroy):
	Added a boolean flag to packagedata_copy, toggles whether or not
	to deep copy.
	Fix rpm header load to not add directories to the ->provides list
	(using a wonderfull O(n²) function, I'll leave it to the reader to
	improve it).
	Uncommented the rpmheaderFree call.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(eazel_install_packagelist_to_xml):
	More debug output (we can never have enough!)
	
	* athena-installer/src/Makefile:
	Yes.
	
	* athena-installer/src/callbacks.c: (druid_cancel),
	(druid_delete), (begin_install), (druid_finish), (prep_install):
	* athena-installer/src/installer.c: (create_what_to_do_page),
	(strip_categories), (start_over_make_category_func), (start_over),
	(jump_to_retry_page), (create_window), (eazel_install_progress),
	(eazel_download_progress), (add_force_packages),
	(add_force_remove), (add_update_package), (get_required_name),
	(get_detailed_errors_foreach), (get_detailed_errors),
	(eazel_install_preflight), (eazel_install_delete_files),
	(install_done), (check_system), (eazel_installer_do_install),
	(eazel_installer_initialize):
	* athena-installer/src/installer.h:
	* athena-installer/src/link.sh:
	* athena-installer/src/main.c: (main):
	Now takes a --tmpdir argument
	Puts builddate in window title
	Has a system for creating RepairCases when traversing a tree in
	install_failed signal handler.
	Now handles stuff like "need to updage eog" and then there is no
	update for eog.
	Hopefully also handles circular conflict cases.
	Now has a completely obfuscated call stack...

2000-10-23  Mathieu Lacage  <mathieu@eazel.com>

	* user-guide/C/sgml/chapter-1.sgml:
	applying patch from John Fleck to make it work better
	with the current gnome-db2html behaviour.

2000-10-23  John Sullivan  <sullivan@eazel.com>

	* src/athena-window-menus.c: (append_bookmark_to_menu):
	Fixed memory leak I happened to notice.

2000-10-23  J Shane Culpepper  <pepper@eazel.com>

	* athena.spec.in:

	Fixing the spec to pick up new image directory.

2000-10-23  John Sullivan  <sullivan@eazel.com>

	Fixed 3568: Bonobo verbs and data leak when menus rebuilt

	Michael Meeks added verb-removing support to Bonobo, which
	I have now deployed in Athena.

	* libathena-extensions/athena-bonobo-extensions.h:
	* libathena-extensions/athena-bonobo-extensions.c:
	(remove_verbs): New function, walks through the XML nodes
	beneath a specified path and removes each verb it finds.
	(athena_bonobo_remove_menu_items_and_verbs): Now calls
	remove_verbs; also changed name from _remove_menu_items
	for clarity.

	* src/file-manager/fm-directory-view.c:
	(reset_bonobo_open_with_menu):
	* src/athena-window-menus.c:
	(athena_window_remove_bookmarks_menu_items),
	(athena_window_remove_go_menu_items): Removed FIXMEs
	and updated for name change.

2000-10-23  John Sullivan  <sullivan@eazel.com>

	* src/athena-applicable-views.c:
	(get_athena_navigation_result_from_gnome_vfs_result):
	Improved the warning message output to the terminal when 
	get-file-info returns a GnomeVFSResult for which we don't 
	have a nice user error message.

2000-10-23  Mike Fleming  <mfleming@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_get_services_address)
	Added small comment to currently unused  function with regards to
	format of gconf paramameter (services-host)

2000-10-22  Martin Baulig  <baulig@suse.de>

	This is Maciej checking in Martin's fix for 3691. Credit to him,
	blame to me.
	
	* components/adapter/athena-adapter-embed-strategy.h
	(AthenaAdapterEmbedStrategyClass): Added "activate" and "deactivate"
	signals.
	(athena_adapter_embed_strategy_get): Removed ui_container argument.
	(athena_adapter_embed_strategy_activate): New function; emits
	the "activate" signal.
	(athena_adapter_embed_strategy_deactivate): New function; emits
	the "deactivate" signal.

	* components/adapter/athena-adapter-control-embed-strategy.c
	(athena_adapter_control_embed_strategy_activate): New static function;
	this is the handler of the "activate" signal.
	(athena_adapter_control_embed_strategy_deactivate): New static function;
	this is the handler of the "deactivate" signal.

	* components/adapter/athena-adapter-embeddable-embed-strategy.c
	(athena_adapter_embeddable_embed_strategy_activate): New static function;
	this is the handler of the "activate" signal.
	(athena_adapter_embeddable_embed_strategy_deactivate): New static function;
	this is the handler of the "deactivate" signal.

	* components/adapter/athena-adapter.c (athena_adapter_activate_callback):
	New static function; connect this to the "activate" signal of the adapter
	control.

2000-10-23  Kjartan Maraas  <kmaraas@gnome.org>

	* src/athena-shell-ui.xml.h: Check in a file containing
	the strings to be translated instead of the 0-byte file that's
	there now.
	
2000-10-23  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (service_tab_selected_callback),
	(updates_tab_selected_callback):
	made the updates section of the summary use the new, image-based tabs.
	
	* libathena-extensions/athena-tabs.c: (draw_all_tabs):
	made it handle the right edge for the single tab case properly.
	
2000-10-22  Andy Hertzfeld  <set EMAIL_ADDRESS environment variable>

	* components/services/summary/
		athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_login_dialog),
	(athena_summary_view_load_uri), (service_tab_selected_callback):
	
	added image-based tabs to the summary view.  Also, fixed problem where
	the throbber kept spinning until the login dialog was dismissed by
	making it a non-modal dialog by refraining from calling gnome_run_dialog
	Currently, only the service tabs have been converted but the update
	tab is coming soon.
	
	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-tabs.c:
	(athena_tabs_initialize_class), (athena_tabs_initialize),
	(athena_tabs_new), (tab_item_destroy), (tab_item_destroy_cover),
	(athena_tabs_destroy), (athena_tabs_unload_tab_pieces),
	(load_tab_piece), (athena_tabs_load_tab_pieces),
	(athena_tabs_hit_test), (measure_height), (recalculate_size),
	(athena_tabs_size_request), (draw_tab_piece_aa),
	(draw_pixbuf_tiled_aa), (allocate_cleared_pixbuf),
	(measure_tab_name), (draw_tab_label), (draw_all_tabs),
	(tab_item_find_by_name), (athena_tabs_expose),
	(athena_tabs_draw), (athena_tabs_add_tab),
	(athena_tabs_remove_tab), (athena_tabs_prelight_tab),
	(athena_tabs_select_tab), (athena_tabs_press_event),
	(athena_tabs_leave_event), (athena_tabs_motion_event):
	* libathena-extensions/athena-tabs.h:
	added a new class for the fancy Arlo tabs in the summary view,
	based on the sidebar tabs.

	* configure.in:
	* components/services/summary/
		athena-view/Makefile.am:
	* components/services/summary/
		athena-view/icons/.cvsignore:
	* components/services/summary/
		athena-view/icons/Makefile.am:
	* components/services/summary/
		athena-view/icons/gray_tab_pieces/.cvsignore:
	* components/services/summary/
		athena-view/icons/gray_tab_pieces/*.png
	
	added Arlo's new tab images for the summary view
	
	* src/athena-property-browser.c:
	(athena_property_browser_initialize), (add_new_button_callback),
	(done_button_callback):
	
	added a done button to the property dialog to make it easier to
	dismiss it.
	
2000-10-22  Mike Fleming  <mfleming@eazel.com>

	* libathena-extensions/athena-stock-dialogs.c:
	(timed_wait_free), (timed_wait_callback):

	Made timed-wait dialog remember the dialog.  Was being triggered
	during a DAV rename w/ debug info on.

2000-10-22  Robert Brady  <rwb197@zepler.org>

	* configure.in: Added en_GB to ALL_LINGUAS.

Sun Oct 22 05:25:46 2000  George Lebl <jirka@5z.com>

	* librsvg/rsvg-ft.c (rsvg_ft_ctx_done): Things allocated with
	  glib functions must be freed with g_free, not free

2000-10-21  Eskil Heyn Olsen  <eskil@eazel.com>

	* athena.spec.in:
	Dep on bonobo>=0.24 and medusa >= 0.2.1

2000-10-21  Gene Z. Ragan  <gzr@eazel.com>

	* THANKS:
	Added syncomm to THANKS file.
	
2000-10-21  Josh Barrow  <josh@eazel.com>

	* AUTHORS:
	* THANKS:
	* src/athena-window-menus.c: (help_menu_about_athena_callback):
	Added Eli to the about box and moved him from THANKS to AUTHORS, per 
	Maciej.

2000-10-21  Ali Abdin  <aliabdin@aucegypt.edu>

	* components/help/converters/gnome-db2html2/toc-elements.c:
	(toc_sect_end_element): Add in 'break;' at the appropriate areas of
	the code. Should fix some issues. DOH!! This was also needed to fix
	Bug #3863. Thank god for testers.

2000-10-21  Zbigniew Chyla  <cyba@gnome.pl>

	* configure.in: Added pl to ALL_LINGUAS.

2000-10-21  Mathieu Lacage <mathieu@eazel.com>

	* user-guide/C/img/*.png: remove till I can find time to redo all
	the screenshots: people are complaining it kills their bandwith for
	no good reason.

2000-10-21  Ali Abdin  <aliabdin@aucegypt.edu>

        * components/help/converters/gnome-db2html2/sect-elements.c:
        (sect_sect_end_element): Add in 'break;' at the appropriate areas of
        the code. Should fix some issues. Fixes Bug #3863.

2000-10-21  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (generate_install_form),
	(athena_service_install_downloading),
	(athena_service_install_installing):

	Remove artificial pauses I was using for testing (oops), and
	change the font size of the overall feedback text to something
	readable in AA.

2000-10-20 John Fleck <jfleck@inkstain.net>

	* user-guide/C/sgml/athena.sgml - changed "doctype" to "DOCTYPE"
	in the dtd declaration. This is needed for gnome-db2html2 to
	correctly render the document into html for Mozilla to display

2000-10-20  Robey Pointer  <robey@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_from_packagedata),
	(packagedata_from_corba_packagedatastruct):
	* components/services/install/lib/eazel-install-protocols.c:
	(get_url_for_package):
	* components/services/install/lib/eazel-install-types.c:
	(packagedata_new), (packagedata_copy),
	(packagedata_fill_from_rpm_header), (packagedata_destroy):
	* components/services/install/lib/eazel-install-types.h:
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (eazel_install_packagedata_to_xml):
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (add_padding_to_box), (generate_install_form),
	(show_overall_feedback), (make_new_status),
	(current_progress_bar_complete),
	(athena_service_install_downloading),
	(athena_service_install_installing),
	(athena_service_install_view_update_from_uri):

	Add package "summary" field to store the RPM one-line summary
	field (we want to show it in the installer).

2000-10-20  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_update_icon):
	at Arlo's urging, I removed the emblem scale pinning that was added
	last week, which isn't right if you think of the emblems as part
	of the icons like Arlo does.  I also added an emblem scale factor to
	make the emblems a more reasonable size.
	
	* src/file-manager/fm-list-view.c:
	fixed bug 3900, emblems too large in the list view, by correct
	the LIST_VIEW_MINIMAL_EMBLEM_SIZE constant, which was set too large.
	
2000-10-20  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3548 (modal error dialog is flakey in summary view)

	I made a bunch of small improvements to this file. Most of
	these had been checked in earlier but accidentally clobbered,
	but there are some new ones too.

	* components/services/summary/athena-view/athena-summary-view.c:
	Removed feedback_text field from details struct. This was used in
	an unnecessary and leak-inducing way before.
	(generate_summary_form): Remove period following exclamation point
	in on-screen text.
	(error_dialog_retry_cb): Removed this function.
	(set_dialog_parent): New helper function to parent a dialog on
	the AthenaSummaryView's window.
	(generate_error_dialog): Removed "Retry" button since it is 
	extremely unlikely to work, thus resulting in constant frustration;
	Removed initialized but unused "reply" variable; removed extra 
	initialization of "dialog" variable; use OK button instead of
	Cancel since there's only one button now; set up error message
	with parameter instead of details field; set text justification
	and line wrap to accommodate longer messages; parent the dialog
	so it doesn't appear in some random place.
	(authn_cb_failed): pass message to generate_error_dialog directly;
	removed unnecessary capital letter in message.
	(generate_login_dialog): remove initialized but unused "reply" variable;
	change "Please Login" to "Please log in"; parent the dialog.
	(athena_summary_view_load_uri): collapse a lot of identical code;
	improve error messages; display error message when xml file couldn't
	be parsed (was supposed to before, but wasn't); only generate the
	summary form if xml file was parsed.
	* libathena/athena-clipboard-ui.xml.h:
	* src/file-manager/athena-directory-view-ui.xml.h:
	* src/file-manager/athena-icon-view-ui.xml.h:
	* src/file-manager/athena-search-list-view-ui.xml.h:
	* src/athena-service-ui.xml.h:
	* src/athena-shell-ui.xml.h:

2000-10-21  Mathieu Lacage  <mathieu@eazel.com>

	* user-guide/C/sgml/chapter-1.sgml:
	stupid me: forgot a sect2 in the middle of nowhere...

2000-10-20  Rebecca Schulman  <rebecka@eazel.com>
	Fix for bug 1768, to put a hard limit on
	the number of files for PR2.  We do this 
	by keeping a count of confirmed files
	in directories, and stopping a load once the confirmed 
	file count reaches a certain level.

	* libathena-extensions/athena-directory-async.c:
	(set_file_unconfirmed), (dequeue_pending_idle_callback),
	(directory_load_one), (directory_load_done),
	(directory_load_callback), (mark_all_files_unconfirmed),
	(athena_directory_stop_monitoring_file_list):
	Increment or decrement file count when marking a file confirmed
	or unconfirmed.
	* libathena-extensions/athena-directory-private.h:
	add file count file
	* libathena-extensions/athena-directory.c:
	(athena_directory_add_file), (athena_directory_remove_file),
	(athena_directory_file_list_length_reached):
	increment and decrement file counts here when a file is added.
	A file is always confirmed when it is initially added, so 
	increment always, but only decrement the count when we are 
	removing a confirmed file.
	* libathena-extensions/athena-directory.h:
	Add function athena_directory_file_list_length_reached
	as public 
	* src/file-manager/fm-directory-view.c:
	(check_for_directory_hard_limit), (done_loading):
	when we finish loading the directory, display the hard limit
	dialog if necesssary, to let the user know we've stopped the directory
	load to prevent athena from overloading.

2000-10-20  Darin Adler  <darin@eazel.com>

	* components/loser/content/Makefile.am:
	* components/loser/sidebar/Makefile.am:
	* components/mozilla/Makefile.am:
	* components/sample/Makefile.am:
	* components/services/summary/athena-view/Makefile.am:
	* libathena/Makefile.am:
	* src/Makefile.am:
	* src/file-manager/Makefile.am:
	We need to include the .xml.h files in EXTRA_DIST. My mistake
	turning that off (killed the Tinderbox).
	
	* src/athena-window-manage-views.c:
	(position_and_show_window_callback),
	(athena_window_end_location_change_callback): Fix small ref
	mistake I might have introduced with my last check-in.

2000-10-20  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c:
	* components/services/summary/athena-view/tests/README:
	* components/services/summary/athena-view/tests/redirects.xml:
	* components/services/summary/athena-view/tests/services.xml:
	* src/athena-service-ui.xml.h:

	Added simple test xmls to generate lots of entries in the summary view.

2000-10-20  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_service_entry_row):
	fixed a memory leak in the summary view, where it was allocating a
	structure used in a callback but never releasing it.
	
2000-10-20  Andy Hertzfeld  <andy@eazel.com>

	* components/hardware/icons/Makefile.am:
	* components/hardware/icons/CD_drive.png:
	* components/hardware/athena-hardware-view.c:
	(setup_overview_form):
	added a better icon for CD drives from Susan, and used it in the
	hardware view instead of the CD icon it was using.
	
2000-10-20  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3805, Athena tries to parse text files on the desktop as XML.
	
	* libathena-extensions/athena-link.c:
	(local_get_root_property):
	Do a check on the mime type of the file before processing it as XML.
	Also fix a bug where a NULL XMLDoc was being used.

2000-10-20  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 3803, pin image size for downloaded images in summary
	view
	
	* components/services/athena-dependent-shared/shared-service-widg
	ets.c: (create_image_widget_from_uri):
	added optional image size pinning to create_image_widget_from_uri
	
	* components/services/athena-dependent-shared/shared-service-widg
	ets.h:
	changed parameters to create_image_widget_from_uri
	
	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_eazel_news_entry_row), (generate_update_news_entry_row):
	pinned downloaded images to a maximum size, fixing bug 3803.  Also,
	tweaked button layout a bit.
	
2000-10-20  Darin Adler  <darin@eazel.com>

	* Makefile.am:
	* Makefile.shared:
	* components/loser/content/Makefile.am:
	* components/loser/sidebar/Makefile.am:
	* components/mozilla/Makefile.am:
	* components/sample/Makefile.am:
	* components/services/install/command-line/Makefile.am:
	* components/services/summary/athena-view/Makefile.am:
	* libathena-extensions/Makefile.am:
	* libathena/Makefile.am:
	* src/Makefile.am:
	* src/file-manager/Makefile.am:
	Moved some shared Makefile stuff to a shared include file so we
	don't use "copy and paste technology" in our Makefiles. Fixed the
	rule that builds .xml.h files so it doesn't have to be copied and
	pasted everywhere.
	
	* components/loser/content/athena-content-loser-ui.xml.h:
	* components/loser/sidebar/athena-sidebar-loser-ui.xml.h:
	* components/mozilla/athena-mozilla-ui.xml.h:
	* components/sample/athena-sample-content-view-ui.xml.h:
	* libathena/athena-clipboard-ui.xml.h:
	* src/file-manager/athena-directory-view-ui.xml.h:
	* src/file-manager/athena-icon-view-ui.xml.h:
	* src/file-manager/athena-search-list-view-ui.xml.h:
	* src/athena-shell-ui.xml.h:
	Regenerated the xml.h files with the new Bonobo tool, which keeps
	things in alphabetical order to minimize cvs thrashing.
	
	* components/services/summary/athena-view/Makefile.am:
	* components/services/summary/athena-view/athena-summary-view-ui.xml.h:
	Added localization for the summary view UI.
		
	* src/Makefile.am:
	Added localization for the service UI pieces.
	
	* libathena-extensions/athena-buffered-widget.c:
	(athena_buffered_widget_initialize),
	(connect_to_background_if_needed): Fixed bug where the widget
	would stay connected after the background was destroyed. John saw
	it once, but I'm not sure how to reproduce it.
	
	* athena.spec.in: Fix some bad spelling and strange wording.
	
	* src/athena-applicable-views.h:
	* src/athena-applicable-views.c: (got_file_info_callback),
	(athena_navigation_info_new), (athena_navigation_info_cancel),
	(athena_navigation_info_free),
	(athena_navigation_info_get_location),
	(athena_navigation_info_get_initial_content_id):
	Removed lots of cruft from this class so it's private and can be
	changed around a bit.
	
	* src/athena-window-manage-views.c:
	(athena_window_update_internals): Use the new
	athena_navigation_info_get_location.
	(handle_unreadable_location): Get rid of unneeded file == NULL
	check.
	(load_view_for_new_location): Use the new
	athena_navigation_info_get_initial_content_id.
	(set_view_location_and_selection): Use the new
	athena_navigation_info_get_location.
	(athena_window_end_location_change_callback): Use the new
	athena_navigation_info_get_location.
	(athena_window_begin_location_change): Remove some unnecessary
	code.

2000-10-20  Mathieu Lacage  <mathieu@eazel.com>

	More ids in sects.
	* user-guide/C/sgml/chapter-2.sgml:
	* user-guide/C/sgml/chapter-3.sgml:

2000-10-20  Mathieu Lacage  <mathieu@eazel.com>

	Add sect ids and big caps entities
	* user-guide/C/sgml/chapter-1.sgml:
	* user-guide/C/sgml/install.sgml:
	* user-guide/C/sgml/intro.sgml:
	* user-guide/C/sgml/manual.sgml:

2000-10-20  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3902 (Some search results do not have file
	info displayed)

	* libathena-extensions/athena-directory-async.c:
	(async_job_wake_up): Remove directory from hash table
	when it's awoken; clear already_waking_up boolean at
	end of routine.

2000-10-20  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-sidebar-title.c: (update_font):
	Make the code that looks for largest font that fits a sidebar
	title work even if we dont find the exact font we look for.
	Fixes bug 2812.
	
2000-10-20  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/Makefile.am:
	* librsvg/rsvg.c: (rsvg_text_handler_characters):
	Make sure the font used for text is svg icons actually exists.
	Fix (rather a worksround) for bug 3774.  We will have a better fix
	later (bug 3904).
	
2000-10-22  Andy Hertzfeld  <andy@eazel.com>

	made the images show up again in the summary view by adding
	image fetching from the service via http.
	
	* components/services/athena-dependent-shared/
	shared-service-widgets.c: (create_image_widget_from_pixbuf),
	(create_image_widget), (create_image_widget_from_uri):
	restructured code a bit so I could at fetching from a uri instead of
	a local icon.  Added optimization so a local icon could be used
	at the service's discretion.
	
	* components/services/athena-dependent-shared/
	  shared-service-widgets.h:
	added create_image_widget_from_uri
	
	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_eazel_news_entry_row), (generate_update_news_entry_row):
	made it fetch the icons from the service
	
2000-10-20  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/rsvg.c: (rsvg_text_handler_characters),
	(rsvg_start_text):
	Quiet down the debug spewage.
	
2000-10-20  Ramiro Estrugo  <ramiro@eazel.com>

	* athena.spec.in:
	Forgot to add the font metrics to the rpm spec file.
	
2000-10-20  Ramiro Estrugo  <ramiro@eazel.com>

	* data/fonts/urw/Makefile.am:
	* data/fonts/urw/fonts.dir:
	* data/fonts/urw/n019003l.afm:
	* data/fonts/urw/n019004l.afm:
	* data/fonts/urw/n019023l.afm:
	* data/fonts/urw/n019024l.afm:
	Added missing font metrics.
	Also update to latest urw fonts.

2000-10-20  Maciej Stachowiak  <mjs@eazel.com>

	* components/adapter/bonobo-stream-vfs.h,
	components/adapter/bonobo-stream-vfs.c: (vfs_write), (vfs_read),
	(vfs_seek), (vfs_truncate), (vfs_copy_to), (vfs_close), (vfs_eos),
	(vfs_length), (bonobo_stream_vfs_class_init),
	(bonobo_stream_vfs_init), (bonobo_stream_vfs_get_type),
	(Bonobo_Stream_vfs__create), (bonobo_stream_vfs_new_internal),
	(bonobo_stream_vfs_open), (bonobo_stream_vfs_new): Moved here from
	libathena-extensions; bunches of cleanup to match athena style
	better.

	* components/adapter/Makefile.am: Added above two files to build.

	* components/adapter/athena-adapter-progressive-load-strategy.c:
	Up the load chunk.
	
	* components/adapter/athena-adapter-stream-load-strategy.c:
	Include "bonobo-stream-vfs.h" not
	<libathena-extensions-stream-vfs.h>

	* libathena-extensions/bonobo-stream-vfs.c,
	libathena-extensions/bonobo-stream-vfs.h: Removed from here.
	
	* libathena-extensions/Makefile.am: Removed from build.

2000-10-20  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_eazel_news_entry_row), (generate_update_news_entry_row):

	Added vseparators, fixed button sizes, added new buttons to the
	updates section.  I'm almost getting good at this stuff !

2000-10-20  Robey Pointer  <robey@eazel.com>

	* icons/Makefile.am:
	* icons/services-rpm-72.png:
	* libathena-extensions/athena-icon-factory.c:

	Add new eazel-install: icon for Arlo and make the icon factory use
	it instead of the gnome-pack-rpm one.

2000-10-20  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 2948, list view does not prelight under cursor when
	dragging files.
	
	* libathena-extensions/athena-list.c:
	* libathena-extensions/athena-list.h:
	(athena_list_initialize), (draw_cell_pixmap), (draw_cell),
	(athena_list_prelight_if_necessary),

	(athena_list_set_drag_prelight_row):
	New function to set drag prelight row based on mouse position.
	
	* src/file-manager/fm-list-view.c: (fm_list_handle_dragged_items):
	
	* components/image-viewer/athena-image-view.c:
	(view_size_allocate_cb):
	Removed some old debug code.
	
2000-10-19  Robey Pointer  <robey@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install_stop), (eazel_install_get_epv):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_install_packages),
	(eazel_install_emit_install_progress_default),
	(eazel_install_emit_download_progress_default),
	(eazel_install_emit_preflight_check_default),
	(eazel_install_emit_delete_files_default):
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_xfer_callback), (gnome_vfs_fetch_remote_file):

	Make the install lib check for corba events while doing a download
	(which might take a while) so that it can receive a "stop"
	message.  Ref itself while doing the install to avoid a mess.  Try
	to catch some corba exceptions and abort on them.  Set a flag on
	the "stop" message and cancel the gnome-vfs operation.  Make the
	download_progress callback be a two-way call to trick corba into
	checking for potential incoming "stop" calls.  These sum up to a
	rough hack which will be cleaned out when the installer is broken
	up into more stateful components post-PR2.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_destroy),
	(current_progress_bar_complete),
	(athena_service_install_downloading),
	(athena_service_install_installing),
	(athena_service_need_password),
	(athena_service_install_view_update_from_uri),
	(service_install_stop_loading_callback):

	Send "stop" message to the install view when the user hits the
	"stop" button, and also when the view is about to be destroyed.
	Cleanly handle the "stop" button by treating it like an abort.
	Use better-named /tmp directory, for security reasons.
	
2000-10-20  Ramiro Estrugo  <ramiro@eazel.com>

	* configure.in:
	Update for latest freeype2 rpm changes.
	
2000-10-20  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_eazel_news_entry_row), (generate_update_news_entry_row):

	Adding "infinite" row capabilities for generated tables.  Fixed several
	more layout issues.  The buttons are completely screwed up now from a
	ui perspective.  Trying to fix that now.

2000-10-19  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/lib/eazel-summary-shared.c:
	(eazel_news_data_new), (update_news_data_new),
	(parse_a_eazel_news_item), (parse_a_update_news_item):
	* components/services/summary/lib/eazel-summary-shared.h:
	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_update_news_entry_row):

	New xml parsing information.  Fixed button labels and sizes.  A few
	minor ui tweaks.

2000-10-20  Mathieu Lacage  <mathieu@eazel.com>

	Add screenshot images.
	* user-guide/C/sgml/chapter-1.sgml:
	* user-guide/C/sgml/chapter-2.sgml:
	* user-guide/C/sgml/chapter-3.sgml:
	* user-guide/C/sgml/install.sgml:

2000-10-19  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/
	athena-summary-view.c: (authn_cb_failed), (logout_button_cb), 
	(logged_in_callback), (logged_out_callback),
	(bonobo_logout_callback), (bonobo_preferences_callback),
	(update_menu_items), (merge_bonobo_menu_items):
	
	fixed the login menu command, and added support for the preferences
	and logout command.  Made it properly show and hide the appropriate
	commands according to the logged_in state
	
	* components/services/summary/athena-view/
	athena-summary-view-ui.xml:
	added menu items for preferences and logout
	
	* src/athena-service-ui.xml:
	added tooltips for service menu commands

2000-10-19  Mathieu Lacage  <mathieu@eazel.com>

	* user-guide/C/Makefile.am: modify to install sgml 
	instead of html
	* user-guide/C/img/.cvsignore: add 
	* user-guide/C/sgml/.cvsignore: add

	sgml files.
	* user-guide/C/sgml/chapter-1.sgml:
	* user-guide/C/sgml/chapter-2.sgml:
	* user-guide/C/sgml/chapter-3.sgml:
	* user-guide/C/sgml/install.sgml:
	* user-guide/C/sgml/intro.sgml:
	* user-guide/C/sgml/manual.sgml:
	* user-guide/C/sgml/model.sgml:

	screenshots....
	* user-guide/C/img/*.png

2000-10-19  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_error_dialog), (generate_login_dialog),
	(athena_summary_view_load_uri):

	Fixing dialogs and error control cases.  Works a little better now
	but still doesn't destroy the error dialogs like its supposed to do.

2000-10-19  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (logged_in_callback):

	Fixing login callback so that view does not crash.

2000-10-19  Darin Adler  <darin@eazel.com>

	Check in the xml.h files. It would be better not to have these
	checked in, but it helps the translators if they are. If we
	come up with something better later, we can get rid of them.
	For now, if you exit a ui.xml file, then you should also do
	a build and check in the generated xml.h file.

	* components/loser/content/athena-content-loser-ui.xml.h:
	* components/loser/sidebar/athena-sidebar-loser-ui.xml.h:
	* components/mozilla/athena-mozilla-ui.xml.h:
	* components/sample/athena-sample-content-view-ui.xml.h:
	* libathena/athena-clipboard-ui.xml.h:
	* src/file-manager/athena-directory-view-ui.xml.h:
	* src/file-manager/athena-icon-view-ui.xml.h:
	* src/file-manager/athena-search-list-view-ui.xml.h:
	* src/athena-shell-ui.xml.h:

2000-10-19  Darin Adler  <darin@eazel.com>

	Do some routine housekeeping that will help make the future
	switchover to libxml2 easier.
	
	* components/help/converters/gnome-db2html2/gdb3html.h:
	* components/help/hyperbola-nav-index.c:
	* components/help/hyperbola-nav-search.c:
	* libathena-extensions/athena-directory-async.c:
	* libathena-extensions/athena-directory-metafile.c:
	* libathena-extensions/athena-directory-metafile.h:
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-file.c:
	* libathena-extensions/athena-icon-factory.c:
	* libathena-extensions/athena-link-set.c:
	* libathena-extensions/athena-link.c:
	* libathena-extensions/athena-theme.c:
	* libathena-extensions/athena-volume-monitor.c:
	* libathena-extensions/athena-xml-extensions.h:
	* librsvg/rsvg.c:
	* src/athena-bookmark-list.c:
	* src/athena-bookmark-parsing.c:
	* src/athena-bookmark-parsing.h:
	* src/athena-link-set-window.c:
	* src/athena-property-browser.c:
	* src/athena-sidebar.c:
	* src/athena-theme-selector.c:
	* src/athena-window-menus.c:
	Use the <gnome-xml/> prefix on all includes of gnome-xml headers.
	This is allowed with the version of libxml1 we use now, and
	required for libxml2. Note that we now require the newer libxml1
	version that allows this, because Bonobo requires it.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (parse_category), (parse_shared),
	(parse_memory_transaction_file), (parse_local_xml_package_list),
	(generate_xml_package_list), (osd_parse_dependency),
	(osd_parse_implementation), (osd_parse_softpkg),
	(osd_parse_shared):
	* components/services/summary/lib/eazel-summary-shared.c:
	(build_services_glist_from_xml), (build_eazel_news_glist_from_xml),
	(build_update_news_glist_from_xml), (parse_summary_xml_file):
	* components/services/trilobite/libtrilobite/helixcode-utils.c:
	(xml_get_value):
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_redirect_parse_xml):
	* libathena-extensions/athena-xml-extensions.c:
	(athena_xml_get_children):
	Use xmlChildrenNode instead of childs, as recommended by the
	libxml maintainer for libxml1/libxml2 compatibility.
	
	* src/athena-main.c: (main): Use the LIBXML_TEST_VERSION macro
	as recommended by the libxml maintainer for libxml1/libxml2
	compatibility.
	
	* components/music/athena-music-view.c:
	Added a lot of FIXMEs. Some other rudimentary cleanup.

2000-10-19  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-icon-container.c:
	(icon_is_positioned), (pending_icon_to_reveal_destroy_callback),
	(get_pending_icon_to_reveal), (set_pending_icon_to_reveal),
	(reveal_icon), (process_pending_icon_to_reveal),
	(lay_down_icons_tblr), (relayout):
	* libathena-extensions/athena-icon-private.h:
	* src/file-manager/fm-directory-view.c: (start_renaming_item),
	(reveal_newly_added_folder), (new_folder_done),
	(fm_directory_view_new_folder), (fm_directory_view_set_selection),
	(fm_directory_view_select_file):

	Newly added folders are now revealed (bug 2208). Other cases
	(e.g. duplicate) still remain. They will require adding new hooks
	to athena-file-operations.

2000-10-19  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (athena_summary_view_load_uri),
	(bonobo_login_callback):

	Fixing login menu callback and adding logic to only display login
	dialog when no user is logged in.

2000-10-19  John Sullivan  <sullivan@eazel.com>

	Fixed some cases where the error message for why a
	location couldn't be loaded was misleading or too generic.
	I ran into some of these while fiddling with the proxy 
	settings to try out services, so I'm sure other users
	will too.

	* libathena-extensions/athena-directory-async.c:
	(file_info_start): When you can't make a vfs_uri, use
	error GNOME_VFS_ERROR_INVALID_URI. It had been leaving
	this defaulting to GNOME_VFS_OK, which caused locations
	like "bogus:foo" to have a mysterious error message.
	
	* src/athena-applicable-views.c:
	(get_athena_navigation_result_from_gnome_vfs_result):
	* src/athena-applicable-views.h:
	* src/athena-window-manage-views.c:
	(athena_window_end_location_change_callback): Added
	separate messages for HOST_NOT_FOUND and HOST_HAS_NO_ADDRESS.
	You can get the former by specifying a bogus host name in the
	HTTP Proxy settings, and the latter by not specifying a
	host name at all in the HTTP Proxy settings.

2000-10-19  John Sullivan  <sullivan@eazel.com>

	* components/help/help-contents.oafinfo:
	Changed name of sidebar panel from "Help Contents" to "Help"
	since there is only one Help sidebar panel, and the longer
	title made it take too much space and stand out while adding
	no value.

2000-10-19  John Sullivan  <sullivan@eazel.com>

	Fixed bugzilla bug 3648 (not clear what "xxx" under
	folders means)

	* libathena-extensions/athena-file.c:
	(athena_file_get_string_attribute_with_default):
	Change some of the default strings; use "..." when
	we were using "--" (for info not yet obtained); use
	"? items" or "? bytes" when we were using "xxx" 
	(for info not readable).
	(athena_file_get_top_left_text): Use "..." when
	we were using "--"

2000-10-19  Andy Hertzfeld  <andy@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (athena_summary_view_destroy), (merge_bonobo_menu_items):
	unmerge the summary component's menu items properly by keeping a
	reference to the ui component and unhooking it in the summary view's
	destroy method.
	
2000-10-19  Andy Hertzfeld  <andy@eazel.com>

	first pass at making the summary view merge its menu commands onto
	the services menu. This isn't finished yet.
	
	* components/services/summary/athena-view/Makefile.am:
	added a ui xml file for the summary menu commands
	* components/services/summary/athena-view/athena-summary-view-ui.xml:
	defined the summary view menu items
	* components/services/summary/athena-view/athena-summary-view.c
	: (athena_summary_view_initialize), (bonobo_register_callback),
	(bonobo_login_callback), (detach_ui), (merge_bonobo_menu_items):
	merge the menu items when the view is activated, unmerge when destroyed
	
	* src/athena-window-service-ui.c: (goto_software_catalog):
	made the software catalog command use the real url.
	
2000-10-19  Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-file-utilities.c:
	(athena_uri_get_basename):
	Ooops, fix a stupid mistake in my last checkin that broke file 
	change notification for fancy names.

2000-10-19  Eskil Heyn Olsen  <eskil@eazel.com>

	* athena.spec.in:
	Removed eog dep and added xpdf for athena-extras.

2000-10-19  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/loser/content/Makefile.am:
	* components/loser/sidebar/Makefile.am:
	* components/mozilla/Makefile.am:
	* components/sample/Makefile.am:
	* libathena/Makefile.am:
	* src/Makefile.am:
	* src/file-manager/Makefile.am:
	Fun with Build chapter IX.

2000-10-18  Andy Hertzfeld  <andy@eazel.com>

	* components/music/athena-music-view.c:
	(athena_music_view_initialize), (set_album_cover),
	(image_button_callback), (athena_music_view_set_album_image):
	completed bug 2261, setting images for album covers, by making
	the set album cover button the proper size, and leaving it visible
	even when there's a cover so you can change it after setting it.
	
2000-10-18  Eskil Heyn Olsen  <eskil@eazel.com>

	* src/file-manager/Makefile.am:
	Fun with Build.
	I'm feeble and only very slowly finding
	all the -ui.xml.h thing I need to fix.

2000-10-18  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/sample/Makefile.am:
	* libathena/Makefile.am:
	Still trying to fix the bloody build...

2000-10-18  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/loser/content/Makefile.am:
	* components/loser/sidebar/Makefile.am:
	* components/mozilla/Makefile.am:
	* components/sample/Makefile.am:
	* po/POTFILES.in:
	* src/Makefile.am:
	* src/file-manager/Makefile.am:
	Still fixing the tinderbox build.

2000-10-18  Ramiro Estrugo  <ramiro@eazel.com>

	* README:
	Update for new Mozilla M18 rpms.
	
2000-10-18  Rebecca Schulman  <rebecka@eazel.com>

	Fixed problems in making the new bonobo translation 
	that confused the headers.  Also added .cvsignore
	entries for the new generated xml files.
	
	* components/loser/content/.cvsignore:
	* components/loser/content/Makefile.am:
	* components/loser/sidebar/.cvsignore:
	* components/loser/sidebar/Makefile.am:
	* components/mozilla/.cvsignore:
	* components/mozilla/Makefile.am:
	* components/sample/.cvsignore:
	* components/sample/Makefile.am:
	* icons/.cvsignore:
	* libathena/.cvsignore:
	* libathena/Makefile.am:
	* src/.cvsignore:
	* src/Makefile.am:
	* src/file-manager/.cvsignore:
	* src/file-manager/Makefile.am:

2000-10-18  Eskil Heyn Olsen  <eskil@eazel.com>

	* po/POTFILES.in:
	Removing more .xml.h files to make tinderbox build again.

2000-10-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 3705, Bookmark icons do not appear in the menu item

	This was caused by a strange precedence issue in the setting of
	UI component pixbuf data.  If a menu item has alread been created,
	setting the pixbuf data will have no effect.  Either the verb for 
	the item has to be set with the data or the item has to have
	its XML contructed  with the pixbuf type and data included in it
	at creation time. I have opted for the latter choice.
	
	* libathena-extensions/athena-bonobo-extensions.c:
	* libathena-extensions/athena-bonobo-extensions.h:	
	(athena_bonobo_add_menu_item):
	Added setting of bitmap data if it is present as a
	valid argument passed into the function.
		
	* src/file-manager/fm-directory-view.c:
	(add_open_with_app_bonobo_menu_item),
	(add_open_with_viewer_bonobo_menu_item):
	Call athena_bonobo_add_menu_item
	
	* src/athena-window-menus.c: (append_bookmark_to_menu):
	Call athena_bonobo_add_menu_item
	
	* src/athena-window.c: (athena_window_filter),
	(athena_window_realize), (view_menu_choose_view_callback),
	(athena_window_show):
	Work in progress to handle focus issues when performing
	click drag operations in background windows.
	
	* libathena-extensions/athena-gdk-extensions.c:
	* libathena-extensions/athena-gdk-extensions.h:
	(athena_gdk_window_set_wm_hints_input):
	New function set input files of WM_HINTS. This 
	will be used later to handle click drag in background
	windows.

2000-10-18  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(uris_are_equal), (athena_mozilla_content_view_load_uri):
	Add support for reloading pages while ignoring the mozilla cache.
	Fixes bug 2780.
	
2000-10-18  Robey Pointer  <robey@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_fetch_uri):
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(check_gconf_init):

	Fix new incompatability with gnome-vfs (EOF is now an "error").
	
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_name_for_regular_file):

	Begin the slightly distateful process of adding special-case uri
	scheme icons to the left panel: make the install view use the RPM
	package icon.  Eventually we need to generalize the association of
	icons with uri schemes.

2000-10-18  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3839 (want Athena User Manual menu item)
	Note that this menu item does not actually work, due
	to bug 3876.

	* src/athena-shell-ui.xml:
	Add menu item for bringing up Athena User Manual.
	* src/athena-window-menus.c:
	(help_menu_athena_manual_callback),
	(athena_window_initialize_menus): Add verb
	and callback for Athena User Manual menu item.

2000-10-18  Eskil Heyn Olsen  <eskil@eazel.com>

	* configure.in:
	If no bonobo-ui-extract, AC_MSG_ERROR rather then cryptic failure
	during compile.
	
	* libathena/Makefile.am:
	Removed some evil blankspace

	* po/POTFILES.in
	Had to remove nautitlus-mozilla-ui.xml.h, since it's a conditional
	build, and eg. is not built on tinderbox.eazel.com. Better fix
	will have to come later, need new rpms' in softcat.
	
2000-10-18  J Shane Culpepper  <pepper@eazel.com>

	* components/services/summary/athena-view/athena-summary-view.c
	: (generate_summary_form), (generate_service_entry_row),
	(generate_eazel_news_entry_row), (generate_update_news_entry_row),
	(authn_cb_succeeded), (authn_cb_failed), (login_button_cb),
	(generate_error_dialog), (generate_login_dialog),
	(widget_set_athena_background_color),
	(athena_summary_view_initialize),
	(athena_summary_view_load_uri):

	New summary view ui.  Still missing a few fetures but works ok now.

2000-10-18  Mathieu Lacage  <mathieu@eazel.com>

	disable bug-buddy for athena.
	* src/athena-main.c: (main):

2000-10-19  Kjartan Maraas  <kmaraas@gnome.org>

	* */Makefile.am: Feeble attempt to hook up generation
	of .h files from the *-ui.xml files to get them included
	in the translations. This will need to be done in a better
	way I guess.
	* configure.in: Added a check for bonobo-ui-extract.
	
2000-10-18  Pavel Cisler  <pavel@eazel.com>

	* components/tree/athena-tree-view.c:
	* libathena-extensions/athena-directory.c:
	(athena_directory_notify_files_moved),
	(athena_directory_schedule_metadata_copy),
	(athena_directory_schedule_metadata_move),
	(athena_directory_schedule_metadata_remove):
	* libathena-extensions/athena-file-utilities.c:
	(athena_uri_get_basename):
	* libathena-extensions/athena-file-utilities.h:
	* libathena-extensions/athena-file.c:
	(athena_file_get_internal):
	* src/athena-theme-selector.c: (add_theme_to_icons):
	Clean up calls to gnome_vfs_extract_short_name, remove explicit
	unescaping because gnome_vfs_extract_short_name now does it.
	Eliminate some copy-paste technology, creating a new call
	athena_uri_get_basename.

2000-10-18  Robey Pointer  <robey@eazel.com>

	* components/services/login/athena-view/athena-change-password-
	view.c: (user_logged_in), (generate_change_password_form):
	* components/services/login/athena-view/athena-change-password-
	view.oafinfo:

	Fill in the username automatically if you're already logged in.
	Make the prompts more i18n'able.  Change title from "Log in" to
	"Change password".  Fix oafinfo typo that caused the change-pw
	view to never get displayed.
	
2000-10-18  Darin Adler  <darin@eazel.com>

	Some Music View fixes. Andy asked me to work on this.
	
	* components/music/main.c: (main): Make warnings drop into the
	debugger.
	
	* components/music/athena-music-view.c:
	(athena_music_view_destroy): Change to use a AthenaFile object
	instead of using a uri string.
	(set_album_cover): Use the file object.
	(metadata_callback): Get rid of the unref that was causing a lot
	of trouble.
	(athena_music_view_update): Get the uri from the file object
	instead of vice versa.
	(detach_file): Cancel the call when releasing the file.
	(athena_music_view_load_uri): Release the old file and get a new
	one when the URI changes.

2000-10-17  Maciej Stachowiak  <mjs@eazel.com>

	Fixed bugzilla.eazel.com bugs 2222, 3177, 3468, 3650, 3788
	(some vestiges of wait_until_ready remain in the farther reaches
	of the UI).
	
	* libathena-extensions/athena-mime-actions.h,
	libathena-extensions/athena-mime-actions.c
	(athena_mime_actions_check_if_required_attributes_ready,
	athena_mime_actions_get_required_file_attributes,
	athena_mime_actions_wait_for_required_file_attributes): New
	functions to help with monitoring or waiting for required
	attributes for the athena mime API.
	(athena_mime_get_default_action_type_for_file,
	athena_mime_get_default_action_for_file,
	athena_mime_get_default_application_for_file_internal,
	athena_mime_get_default_application_for_file,
	athena_mime_is_default_application_for_file_user_chosen,
	athena_mime_get_default_component_for_file_internal,
	athena_mime_get_default_component_for_file,
	athena_mime_is_default_component_for_file_user_chosen,
	athena_mime_get_short_list_applications_for_file,
	athena_mime_get_short_list_components_for_file,
	athena_mime_get_short_list_methods_for_file,
	athena_mime_get_all_applications_for_file,
	athena_mime_has_any_applications_for_file,
	athena_mime_get_all_components_for_file,
	athena_mime_has_any_components_for_file,
	athena_mime_set_default_action_type_for_file,
	athena_mime_set_default_application_for_file,
	athena_mime_set_default_component_for_file,
	athena_mime_set_short_list_applications_for_file,
	athena_mime_set_short_list_components_for_file,
	athena_mime_add_application_to_short_list_for_file,
	athena_mime_remove_application_from_short_list_for_file,
	athena_mime_add_component_to_short_list_for_file,
	athena_mime_remove_component_from_short_list_for_file,
	athena_mime_extend_all_applications_for_file,
	athena_mime_remove_from_all_applications_for_file,
	mime_type_get_supertype): Don't `athena_file_wait_until_ready'
	for the required attributes; instead assert (Well, return_if_fail)
	that they are available using
	`athena_file_check_if_ready'. Also, use
	`athena_file_get_uri_scheme' where possible.

	* libathena-extensions/athena-directory-async.c
	(mime_list_callback): Correct some coding mistakes.

	* libathena-extensions/athena-wait-until-ready.h,
	libathena-extensions/athena-directory.c: Remove
	`athena_directory_wait_until_ready'.

	* libathena-extensions/athena-file.h,
	libathena-extensions/athena-file.c
	(athena_file_get_uri_scheme): new convenience function.
	
	* libathena-extensions/athena-program-chooser.c:
	(repopulate_program_list, is_application_default_for_file,
	is_component_default_for_file,
	is_component_in_short_list_for_file,
	is_application_in_short_list_for_file,
	program_file_pair_is_default_for_file,
	program_file_pair_is_in_short_list_for_file,
	add_to_short_list_for_file, remove_from_short_list_for_file,
	remove_default_for_item, set_default_for_item): wait_until_ready
	for required file attributes.

	* libathena-extensions/athena-program-choosing.c:
	(any_programs_available_for_file): wait_until_ready for required
	file attributes.

	* src/file-manager/fm-directory-view.c: (switch_location_and_view,
	create_open_with_gtk_menu, reset_bonobo_open_with_menu,
	activate_callback): Wait for the right file attributes.

	* src/athena-applicable-views.c: (got_file_info_callback),
	(athena_navigation_info_new): Wait for the right file
	attributes. (no wait_until_ready).
	
	* src/athena-sidebar.c: (athena_sidebar_destroy,
	athena_sidebar_update_buttons, athena_sidebar_update_all),
	athena_sidebar_set_uri): Monitor the file the sidebar is
	displaying, and update when it's attributes change.
	
	* src/athena-window-manage-views.c
	(athena_window_set_content_view): Wait for the right file
	attributes. (no wait_until_ready).

	* src/athena-window.c: (athena_window_destroy,
	view_menu_choose_view_callback, view_menu_vfs_method_callback,
	athena_window_real_load_content_view_menu,
	athena_window_load_content_view_menu): Wait for the right
	attributes. (no wait_until_ready in this chain).
	
	* test/test-athena-mime-actions-set.c (main): Wait for the right attributes.
	* test/test-athena-mime-actions.c (main): Wait for the right attributes.

2000-10-18  Darin Adler  <darin@eazel.com>

	* components/notes/athena-notes.c: (make_notes_view):
	* src/athena-location-bar.c: (athena_location_bar_new):
	* src/athena-simple-search-bar.c:
	(athena_simple_search_bar_new):
	Use calls by new names.
	
	* libathena-extensions/athena-undo-signal-handlers.c:
	(editable_key_press_event), (athena_undo_editable_set_undo_key):
	Disabled the undo-key part of undo also. The old code was actually
	harmless because it got the name of the signal wrong, but it's
	better to have it disabled.
	* src/athena-shell-ui.xml: Added a comment that points out the
	2nd place where undo has been disabled.
	
	* libathena/athena-clipboard.h:
	* libathena/athena-clipboard.c: (cut_callback),
	(copy_callback), (paste_callback), (clear_callback),
	(set_paste_sensitive_if_clipboard_contains_data),
	(focus_changed_callback), (target_destroy_callback),
	(athena_clipboard_set_up_editable), (first_focus_callback),
	(control_destroyed_callback),
	(athena_clipboard_set_up_editable_in_control),
	(disconnect_set_up_in_control_handlers):
	Some minor cleanup of the clipboard code. Includes bug fixes for
	items that are already in focus when the clipboard is hooked up
	(should never happen), and a fix for code that was using
	gtk_signal_disconnect on something that was connected with
	gtk_signal_connect_while_alive (doesn't work). Also got rid of
	misguided code that was copying a Bonobo_UIContainer with memcpy
	(since Bonobo_UIContainer is just a pointer).
	
	* src/Makefile.am:
	* src/athena-window-private.h:
	Changed source file name from athena-service-menu to
	athena-service-ui, since it does a toolbar item, not just a
	menu.
	
	* src/athena-window-service-ui.c:
	* src/athena-window-service-ui.h:
	A second cut at the service UI code. It no longer leaks a UI
	component.

	* src/athena-window.c: (athena_window_constructed),
	(athena_window_get_ui_container): Use our own pointer to the UI
	container instead of asking the shell UI for its container.

2000-10-18  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3862 (Icon view reversed after looking at list view)
	Fixed bug 916 (workaround for Bonobo radio item bug)
	Also fixed bug where the "tighter layout" and "reversed order"
	items in the context menu were doing nothing at all.

	* src/file-manager/fm-icon-view.c: 
	Removed "updating_toggle_menu_item" from Details struct.
	(set_tighter_layout): New helper function, handles the code
	common to the Bonobo and GTK menu callbacks.
	(gtk_tighter_layout_callback), (gtk_sort_reversed_callback),
	New functions used for GTK context menu. Will go away when 
	we use Bonobo for context menus.
	(tighter_layout_state_changed_callback),
	(sort_reversed_state_changed_callback): Use passed state value,
	including checking for empty state (empty state happens when
	component is removed from container). This lets us eliminate the
	checks for "updating_toggle_item".	
	(handle_radio_item): Removed check for updating_toggle_menu_item.
	This already worked correctly without this check.
	(insert_one_context_menu_item),	(append_one_context_menu_item),
	(append_one_toggle_context_menu_item): Tweaked these to pass in
	an initial toggle state for toggle menu items, to avoid setting
	the toggle state after the callback has been attached. All this
	code will be removed when we switch to Bonobo for context menus.
	(fm_icon_view_create_selection_context_menu_items),
	(fm_icon_view_create_background_context_menu_items),
	(update_layout_menus):

2000-10-18  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_create_font_family):
	Remove the fixed font from the list of available fonts.  Its a bad
	one to use because it crashes the SideBar sometimes.  The problem
	is that the fixed font doesnt support the "find the largest
	fitting font" game that the SideBar plays for long strings.

	Its kinda lame to fix the bug by yanking the font, but we have
	many font improvements planned for after PR2 which will render
	this issue irrelevant.

	Fixes bug 2256.
	
2000-10-18  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/rsvg-ft.c: (rsvg_ft_measure_or_render_string),
	(rsvg_ft_render_string), (rsvg_ft_measure_string):
	* librsvg/rsvg-ft.h:
	Add new function to only measure a string without doing all the
	rendering work.
	
	* libathena-extensions/athena-scalable-font.c:
	(athena_scalable_font_measure_text):
	Use the new rsvg_ft string measuring api.

	Fixes bug 2544.
	
2000-10-18  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-font-factory.c:
	(font_hash_node_lookup_with_insertion),
	(athena_font_factory_get_fallback_font):
	* libathena-extensions/athena-gdk-extensions.c:
	(athena_get_largest_fitting_font), (athena_gdk_font_get_bold):
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_widget_set_font_by_name):
	* libathena-extensions/athena-icon-factory.c: (embed_text):
	* src/athena-zoom-control.c: (draw_number):
	Use gdk_fontset_load() instead of gdk_font_load() to make i18n
	work better.  Also marked some hard-coded fonts fot localization.
	There is still an open bug on writing useful comments about these
	for the localizers.  Fixes bugs 3143 and 3144.

	Thanks to Yukihiro Nakai <ynakai@redhat.com> for pointing these
	problems out and providing patches to fix them.
	
	* src/athena-profiler.c: (window_print_button_callback),
	(window_save_button_callback), (dump_dialog_new),
	(dump_dialog_show):
	Same as above plus mark some strings for localization and add
	assertions to currently unimplemented functions.
	
2000-10-18  Maciej Stachowiak  <mjs@eazel.com>

	* ChangeLog: rolled over to ChangeLog-20001018.

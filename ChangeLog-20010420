2001-04-19  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-preferences-dialog.c:
	* libathena-extensions/athena-preferences-dialog.h:
	Retire this class.  It was a bad idea to use subclassing for the
	specific use of the preferences dialog in athena.  Hooking
	signals up to a regular GnomeDialog is good enough.
	
	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_defaults),
	(athena_global_preferences_initialize):
	Remove the implementation of the Athena preferences dialog from
	here.  That is something that is specific to the Athena shell.
	The code lives in the Athena shell itself now.
	
	* libathena-extensions/athena-preferences-box.h:
	* libathena-extensions/athena-preferences-box.c:
	(athena_preferences_box_initialize),
	(preferences_box_select_pane),
	(preferences_box_category_list_recreate),
	(preferences_box_add_pane), (athena_preferences_box_update),
	(preferences_box_find_pane), (preferences_box_populate_pane),
	(athena_preferences_box_populate), (user_level_changed_callback),
	(athena_preferences_dialog_new):
	Add support for building preference boxes using structures to
	describe them.  Also add a convenience function for creating a
	GnomeDialog with a preference box as its sole child.
	
	* libathena-extensions/athena-preferences-pane.c:
	* libathena-extensions/athena-preferences-pane.h:
	(athena_preferences_pane_add_item_to_nth_group): Remove this
	function as its no longer used.

	* libathena-extensions/athena-sidebar-functions.h:
	* libathena-extensions/athena-sidebar-functions.c:
	(sidebar_panel_make_preference_key):
	Make the known sidebar panel enabled preference keys public as
	string constants.
	
	* src/Makefile.am:
	* src/athena-preferences-dialog.h:
	* src/athena-preferences-dialog.c:
	(dialog_button_clicked_callback), (dialog_close_callback),
	(preferences_dialog_create),
	(global_preferences_populate_sidebar_panels_callback),
	(preferences_dialog_populate_sidebar_tabs_group),
	(preferences_dialog_destroy), (global_preferences_get_dialog),
	(athena_preferences_dialog_show):
	Move the implementation of the Athena preference dialog into the
	Athena shell itself.
	
	* src/athena-window-menus.c: (user_level_customize_callback):
	Update for new preference dialog show function.

2001-04-19  Ramiro Estrugo  <ramiro@eazel.com>

	* components/hardware/main.c: (main):
	* components/help/hyperbola-main.c: (main):
	* components/history/athena-history-view.c: (main):
	* components/image-viewer/athena-image-view.c: (main):
	* components/music/main.c: (main):
	* components/notes/Makefile.am:
	* components/notes/athena-notes.c: (main):
	* components/text/main.c: (main):
	* components/throbber/main.c: (main):
	Make all standard components call the eel function to stop in the
	debugger after warnings and criticals.  This also makes then spew
	nicer messages that include the process id and program name.
	
2001-04-19  Seth Nickell  <snickell@stanford.edu>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	* libathena-extensions/athena-global-preferences.h:
	Add a preference for having the desktop directory point at the
	Unix homedir rather than the default Athena desktop directory.
	
	* libathena-extensions/athena-file-utilities.c:
	(athena_get_desktop_directory):
	Check the preference and return the appropriate directory.
	
	* src/athena-application.c: (athena_application_startup),
	(confirm_ok_to_run_as_root), (desktop_location_changed_callback):
	Add a callback for updating the desktop when the preference
	changes.

	* src/athena-desktop-window.h:
	* src/athena-desktop-window.c:
	(athena_desktop_window_update_directory),
	(athena_desktop_window_new):
	Add boolean variable affect_desktop_on_next_location_change to
	allow reloading of the desktop dir (rather than loading on open
	in to a new/toplevel window). Add a function for telling the
	desktop window to point to the updated destkop location.
	
	* src/athena-window-manage-views.c: (open_location):
	Check whether this open should be done in the desktop itself or
	if we should open a new window (/ recycle an existing window).

2001-04-19  Darin Adler  <darin@eazel.com>

	Fix bug 8082 (Dragging a file to a treeview destination causes
	athena to freeze):

	* libathena-extensions/athena-file-operations.c:
	(transfer_info_destroy): Destroy the hash table in a way that
	ignores the values. This is just a loose end from changes I made
	to the copy machinery a few days back.

	* libathena-extensions/athena-monitor.h:
	Add missing include to fix build.

2001-04-19  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-monitor.h:
	* libathena-extensions/athena-monitor.c:
	(athena_monitor_active): New function to check if
	the monitoring is working. We'll use this to decide
	whether or not to do the "reload the desktop every
	4 seconds hack" that Miguel is going to check in soon.

	* libathena-extensions/athena-volume-monitor.c:
	(mount_volume_get_name), (mount_volume_activate),
	(mount_volume_deactivate), (get_cdrom_type):
	Fixed some Solaris build problems with patch by
	Laszlo Peter <Laszlo.Peter@ireland.sun.com>.

	* libathena-extensions/athena-cdrom-extensions.h:
	Added missing include needed to build on Solaris
	from the same patch.

2001-04-19  Christopher James Lahey  <clahey@ximian.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-icon-canvas-item.c
	(real_map_pixbuf): Changed map_pixbuf to real_map_pixbuf.
	(map_pixbuf): This now checks if rendered_pixbuf exists and
	matches the needed pixbuf.  If not, it calls real_map_pixbuf.
	Changed the semantics of map_pixbuf to always return a reffed
	object and changed all calls to map_pixbuf to always unref the
	object returned.

2001-04-19  Darin Adler  <darin@eazel.com>

	Fix bug 8000 (Can get two identical "View as" items in "View as"
	menu):

	* src/athena-window-private.h:
	* src/athena-window-manage-views.h:
	* src/athena-window-manage-views.c:
	(location_has_really_changed): Make logic clearer by using else
	instead of two if statements.
	(view_frame_info_new), (view_frame_info_free),
	(set_view_frame_info), (view_frame_get_label),
	(view_frame_get_id), (athena_window_get_content_view_id),
	(load_content_view), (athena_window_set_sidebar_panels): Store a
	AthenaViewIdentifier with each view.
	
	* src/athena-window.h:
	* src/athena-window.c: (athena_window_destroy): We no longer
	have to store the content view identifier separately.
	(remove_first_child): New function.
	(update_extra_viewer_in_view_as_menus): Shared by the two below,
	this is the old replace_extra_viewer_in_view_as_menus, simplified
	and changed to support both adding and removing the extra viewer.
	(remove_extra_viewer_in_view_as_menus): Cover for removing.
	(replace_extra_viewer_in_view_as_menus): Cover for adding.
	(athena_window_synch_view_as_menus): Simplify code a lot by
	removing some special cases and taking advantage of the fact that
	the position of the chosen item is always the same in both menus.
	(chose_component_callback): Removed the FIXME now that the bug is
	fixed.

	* NEWS: Tweak wording.
	
2001-04-19  Darin Adler  <darin@eazel.com>

	Fixed bug 8065 (Cut and Paste file in Trash -> file deleted)

	* src/file-manager/fm-directory-view.c:
	(trash_or_delete_files_common): Simplified this a lot and removed
	parameters. Added a new parameter so the "move to trash within
	trash means delete if nothing else is being moved" rule only takes
	effect for the actual "move to trash" command, not when you are
	dragging or pasting files.
	(fm_directory_view_trash_or_delete_files): Call new simpler
	function.
	(fm_directory_view_move_copy_items): Call new simpler
	function. Also use trash_or_delete_files_common only when moving
	files. It doesn't help any when you copy or make links to files,
	so just use the normal copy code for that.

2001-04-19  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 8049, Athena makes sound even when control center
	"Enable sound server startup" switch is off
	
	* components/music/athena-music-view.c: (play_current_file):
	Check status of sound server gnome preference and display an
	informational dialog if music view playback is compromised
	as a result.
	
	* src/file-manager/fm-icon-view.c: (should_preview_sound):
	Check status of sound server gnome preference as one of
	the conditions when determining if we should preview
	the audio file on rollover.
	
2001-04-19  Darin Adler  <darin@eazel.com>

	* configure.in: Oops, said INIT instead of AC_INIT.

2001-04-19  Darin Adler  <darin@eazel.com>

	* configure.in: Removed conflict markers accidentally
	checked in along with the bug fix.

2001-04-19  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: updated to be in sync with Gregory Leblanc's
	                changes to the athena.spec.in

2001-04-18  Darin Adler  <darin@eazel.com>

	* NEWS: Put in some news about Athena 1.0.3.
	* THANKS: Tweaked formatting a tiny bit.

2001-04-18  Gene Z. Ragan  <gzr@eazel.com>

	Fix an error that was introduced that caused floppy
	devices to not get identified.  The floppy prefix
	should be /dev/fd not /dev/fd/
	
	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_initialize_class),
	(mount_volume_auto_add):

2001-04-18  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: <delete if not using a buddy>

	* libathena-extensions/athena-volume-monitor.c:
	(volume_is_floppy), (mount_volume_auto_add):
	* src/file-manager/fm-desktop-icon-view.c: (create_mount_link):

2001-04-18  Darin Adler  <darin@eazel.com>

	* athena.spec.in: Checked in spec file changes contributed
	by Gregory Leblanc <gleblanc@cu-portland.edu>. Tinderbox will
	tell me soon if I blew it.

2001-04-18  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-icon-container.c:
	(start_rubberbanding): Use the new EelCanvasRect instead of
	GnomeCanvasRect for better rubber-banding speed in AA mode.

	* src/Makefile.am:
	* libathena/Makefile.am:
	* libathena-extensions/Makefile.am:
	Added dependencies so the IDL files get recompiled before we
	compile any .c files.

2001-04-18  Gene Z. Ragan  <gzr@eazel.com>
	
	Fixed bug 7925, Athena prevents playing audio cds.
	
	* libathena-extensions/athena-volume-monitor.c:
	Disable the audio cd mounting while I work at making
	it more seamless.

2001-04-18  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 7999, "Disks" desktop submenu lacks "Floppy" item
	
	* libathena-extensions/athena-volume-monitor.c:
	(mount_volume_get_name), (mount_volume_auto_add),
	(mount_volume_add_filesystem):
	Handle "auto" types by using a placeholder volume
	type.
	
	* libathena-extensions/athena-volume-monitor.h:
	Add a new type ATHENA_VOLUME_AUTO to handle
	auto fstab entries.  This is really a placeholder
	type to be used by the code that creates the removable
	volume list.  When the volume is actually mounted, the
	file system type is loaded from /proc/mounts.
	
2001-04-18  Gene Z. Ragan  <gzr@eazel.com>

	Fix bug 8102, with Athena running, CDs get ejected
	(wrong and makes the kernel unhappy)
	
	* libathena-extensions/athena-volume-monitor.c:
	(mount_volume_iso9660_add):
	Remove ioctls that are not needed and may cause the
	cd to allow ejecting even with a mounted volume.

2001-04-18  Josh Barrow  <josh@whitecape.org>

	* po/POTFILES.in:
	Removed fm-icon-text-window.c from this file to fix build horkage 
	I was seeing.

2001-04-18  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.h:
	Remove ATHENA_PREFERENCES_ICON_CAPTIONS, its not needed anymore.

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_populate_pane): Add support for installing a
	list if strings to ignore when enforcing the unique choice rule
	for enumeration lists items.
	(global_preferences_create_dialog),
	(athena_global_preferences_initialize): Register the
	enumerations at initialization time instead of dialog creation
	time.  This is needed so that sanity checking on enumeration
	preferences can occur even if the user hasnt opened the dialog.

	* libathena-extensions/athena-preferences-item.h:
	* libathena-extensions/athena-preferences-item.c:
	(athena_preferences_item_initialize_class),
	(athena_preferences_item_initialize), (preferences_item_destroy),
	(preferences_item_update_enumeration_list_uniqueness),
	(preferences_item_update_enumeration_list),
	(preferences_item_create_enumeration_list),
	(enumeration_list_changed_callback),
	(athena_preferences_item_enumeration_list_set_unique_exceptions):
	Make sure the string pickers are wired such that duplicate choices cannot be
	made by the user.  We do this by making items that would result in duplicates
	insensitive.  Its possible to bypass this rule for some items.  We use the
	use the enumeration_list_unique_exceptions.
	
	* libathena-extensions/athena-preferences.c:
	(preferences_block_callbacks), (preferences_unblock_callbacks):
	New private functions to block/unblock preferences callbacks.
	(string_list_is_valid): New private function to sanity check the
	values of a string list.
	(athena_preferences_get_string_list): Sanity check the results
	of this function for greater convenience of the callers - they no
	longer need to do error checking on the result.
	(preferences_entry_invoke_callbacks_if_needed): Invoke callbacks
	only if they are not blocked.

	* src/file-manager/Makefile.am:
	* src/file-manager/fm-icon-text-window.c:
	* src/file-manager/fm-icon-text-window.h:
	Retire these 2 files.  There no longer is a Icon Captions window.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize), (fm_directory_view_destroy):
	Update for slight change in the Icon Captions preference name.

	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_get_icon_text_attributes_from_preferences): New
	function to fetch the icon caption attributes from preferences.  A
	similar function used to live in fm-icon-text-window.[ch].  That
	is no longer the case now that the Icon Captions have moved into
	the preferences dialog.
	(fm_icon_view_get_icon_text_attribute_names): Simplify the munging
	of icon captions by using a string list.
	(fm_icon_view_merge_menus): Remove the Icon Captions menu.  The
	Icon Captions picker now lives in the preferences dialog.
	
	* src/file-manager/athena-icon-view-ui.xml:
	Remove Icon Captions menu item which no longer exists.
	
2001-04-17  Darin Adler  <darin@eazel.com>

	* THANKS: Added a translator's name.
	* check-POTFILES.pl: Made it work for more file extensions.
	* check-THANKS.pl: Updated for recent email changes.

	* components/image-viewer/io-png.h: Fixed includes.
	* components/image-viewer/io-png.c: Fixed includes.
	* components/adapter/athena-zoomable-proxy.c: Add include of
	<config.h>.
	* components/music/Makefile.am: Add non-compiled files to
	EXTRA_DIST. This makes check-headers-in-Makefile.pl happy.
	* components/tree/main.c: Removed this unused file since it's just
	a call to the standard main function.
	* components/tree/athena-tree-change-queue.c: Add include of
	<config.h>.
	
	* libathena/Makefile.am:
	* libathena-adapter/Makefile.am:
	* libathena-extensions/Makefile.am:
	* src/Makefile.am:
	Do the dist-hook dance so we don't include generated files in the
	tarball.
	
	* libathena-extensions/athena-dateedit-extensions.h:
	* libathena-extensions/athena-dateedit-extensions.c:
	(athena_gnome_date_edit_get_date_as_string): Rewrite to use
	eel_gstrdup_strftime.
	
	* src/athena-window-manage-views.c:
	(athena_window_content_view_matches_iid): We can get a NULL
	content view IID in some cases, so make sure we don't call strcmp
	on it.

2001-04-17  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-gconf-extensions.c:
	(simple_value_is_equal), (athena_gconf_value_is_equal):
	Implement the missing GconfValue comparison for lists.
	
	* libathena-extensions/athena-global-preferences.h:
	More consistent name for the icon captions preference.

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_register_enumerations): Allow enumeration ids
	to be installed for string lists.  A bit of a hack to let
	enumeration lists work in the AthenaPreferencesItem object.
	(global_preferences_install_one_default): Add support for string
	lists.
	(global_preferences_create_dialog):
	Move the icon captions widgetry from its own lonesome dialog into
	the preferences dialog.
	
	* libathena-extensions/athena-preferences-box.h:
	* libathena-extensions/athena-preferences-box.c:
	(athena_preferences_box_new):
	Remove unused parameter from constructor.  Remove some crufty
	unused code.  Match the Athena style more.
	
	* libathena-extensions/athena-preferences-dialog.h:
	* libathena-extensions/athena-preferences-dialog.c:
	(athena_preferences_dialog_construct):
	Remove some crufty unused signals, defines and code.  Match the
	Athena style more.  Dont hard code the default size.  Let Gtk do
	that work for us.  Remove unused dialog_destroy callback.

	* libathena-extensions/athena-preferences-item.h:
	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_destroy),
	(preferences_item_update_enumeration_list),
	(preferences_item_set_main_child),
	(preferences_item_add_connection_child),
	(preferences_item_create_enumeration_radio),
	(preferences_item_create_enumeration_list),
	(preferences_item_create_boolean),
	(preferences_item_update_editable_string),
	(preferences_item_create_editable_string),
	(preferences_item_create_editable_integer),
	(preferences_item_create_enumeration_menu),
	(preferences_item_create_font), (preferences_item_create_padding),
	(preferences_item_create_smooth_font),
	(athena_preferences_item_new),
	(enumeration_list_changed_callback),
	(preferences_item_update_displayed_value):
	Add support for enumerations lists.
	Cleanup the way children are added to the main box.  Allow for
	more than one child (for enum list support).  Keep a list of
	widgets and their respective changed signal ids, so they can all
	be blocked and unblocked when needed.
	
	* libathena-extensions/athena-preferences.h:
	* libathena-extensions/athena-preferences.c:
	(update_auto_string_list), (preferences_entry_update_auto_storage),
	(preferences_entry_remove_auto_storage),
	(athena_preferences_add_auto_string_list),
	(athena_preferences_remove_auto_string),
	(athena_preferences_remove_auto_string_list):
	Add support for auto storage of string lists.  

	* src/athena-application.c: (check_required_directories): Update
	for EelStringList _as_string changes.

2001-04-17  Josh Barrow  <josh@whitecape.org>

	* AUTHORS:
	Changed my e-mail address.  I no longer use josh@eazel.com

2001-04-17 John Fleck <jfleck@inkstain.net>
	
        * reviewed by laszlo.kovacs@sun.com
        * gdb3html.h, sect-elements.[h,c], toc-elements.c 
        fixing bugs #7605, #8001, #7059, #6890

2001-04-17  Ramiro Estrugo  <ramiro@eazel.com>

	* components/tree/athena-tree-expansion-state.c:
	(expansion_state_load_callback),
	(athena_tree_expansion_state_load_from_preferences),
	(athena_tree_expansion_state_save_to_preferences),
	(athena_tree_expansion_state_initialize),
	(athena_tree_expansion_state_save):
	Update for string_list set/get preferences changes.
	
	* libathena-extensions/athena-gconf-extensions.h:
	* libathena-extensions/athena-gconf-extensions.c:
	(athena_gconf_set_string_list), (athena_gconf_get_string_list):
	Use GSList instead of GList as this the format that GConf
	understands.
	
	* libathena-extensions/athena-preferences.h:
	* libathena-extensions/athena-preferences.c:
	(athena_preferences_set_string_list),
	(athena_preferences_get_string_list),
	(athena_preferences_default_set_string_list),
	(athena_preferences_default_get_string_list),
	(preferences_entry_remove_callback),
	(preferences_entry_remove_auto_storage),
	(athena_self_check_preferences):
	Use EelStringList instead of GList for string_list preferences.
	
	* src/athena-shell.c: (save_window_states),
	(restore_one_window_callback), (restore_window_states):
	Update for string_list set/get preferences changes.  Simplify a
	little by using a string list iterator and string lists instead of
	parsing the geometry strings "by hand."

2001-04-17  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-monitor.c:
	#include <glib.h> for g_return macros in the case where HAVE_FAM_H
	ain't defined.
	
2001-04-16  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-monitor.c:
	Need to #include <stdio.h> even when HAVE_FAM ain't defined.
	
2001-04-16  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-monitor.c:
	Add #include <stdio.h> to fix undefined NULL error on tinderbox.
	
2001-04-16  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 7767, umounting a volume should abort finding trash dir.
	
	Add two new signals to the volume monitor; volume_unmount_started and
	volume_unmount_failed.  volume_unmount_started is emitted before
	the volume is unmounted.  This allows interested parties to close
	any open files that they might have open and perform any other
	finalization tasks before the device is unmounted.
	
	* libathena-extensions/athena-volume-monitor.c:
	* libathena-extensions/athena-volume-monitor.h:
	(athena_volume_monitor_initialize_class):
	Add two new signals, volume_unmount_started and volume_unmount_failed.
	(display_mount_error), (close_error_pipe),
	(athena_volume_monitor_mount_unmount_removable):
	Prepare for and call volume_unmount_failed in the case that an
	unmount is unable to be completed.

	* libathena-extensions/athena-trash-directory.c:
	(athena_trash_directory_initialize):
	Connect to new volume monitor signal.
	(volume_unmount_started_callback):
	Rename callback to be consistent with the new volume monitor
	signal name.

2001-04-16  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-mime-actions.c:
	Removed unused (and now uninstalled) eel library self checks
	header.

2001-04-16  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-preferences-private.h:
	Remove unused header.
	
	* libathena-extensions/athena-directory.c:
	(athena_directory_get_internal):
	Remove unnecessary removal of preferences callbacks at exit time.
	This happens automatically.

	* libathena-extensions/athena-gconf-extensions.h:
	* libathena-extensions/athena-gconf-extensions.c:
	(athena_gconf_client_get_global), (athena_gconf_set_integer),
	(athena_gconf_get_integer), (athena_gconf_is_default),
	(athena_gconf_monitor_add), (athena_gconf_monitor_remove),
	(athena_gconf_value_free), (athena_gconf_notification_add),
	(athena_gconf_notification_remove):
	New functions for easier addition and removal of notifications.
	New funtions for easier addition and removal of directory
	monitoring.
	Add a #define for a undefined connection.

	* libathena-extensions/athena-global-preferences.h:
	Remove SOUND_STATE hack.

	* libathena-extensions/athena-sound.c:
	(kill_sound_if_necessary), (athena_sound_initialize),
	(athena_sound_kill_sound), (athena_sound_register_sound),
	(athena_sound_can_play_sound):
	Use gconf directly for the sound state hack, since athena
	preferences arent really useful for this specific use because of
	initialization, and default value issues.
	
	* libathena-extensions/athena-global-preferences.c:
	(athena_global_preferences_initialize): 
	Pass in the storage prefix when initializing preferences.
	
	* libathena-extensions/athena-preferences.h:
	We now need to pass in the storage prefix when initializing.
	
	* libathena-extensions/athena-preferences.c:
	Change the way preferences are initialized a little bit.  We now
	feed the initialize function a storage prefix to use for gconf.
	Add assertions for any public function that was used before
	initialization.  Make the key allocations a little faster by
	caching the prefixes that hardly ever change.  Simplify the
	addition and removal of gconf notifications by using the new gconf
	extensions to do so.
	Add a little bit of self checks.  I need to figure out a gconf
	problem before adding more checks, these are very minimal for now.

2001-04-16  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-main.c:
	(main): Dont include eel library self checks header since its now
	private.  Also dont run the eel library self checks anymore.

2001-04-16  Darin Adler  <darin@eazel.com>

	* src/athena-window-menus.c: (help_menu_about_athena_callback):
	Stop trying to translate the copyright statement. It should just
	always use "(C)" so it doesn't depend on the character set. No need
	for the fancy copyright symbol from Latin-1.

2001-04-16  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-monitor.c: (get_fam_connection):
	Don't give a warning if there's no FAM daemon to connect to, just
	silently don't use FAM.
	(process_fam_notifications): Improve wording of the warning you
	get when FAM goes away.

2001-04-16  Darin Adler  <darin@eazel.com>

	Changes to use FAM if it's there. Now the hard part is getting FAM
	installed on people's systems.

	* libathena-extensions/athena-directory-async.c:
	(find_monitor): Tightened up the function.
	(monitor_file_compare), (find_any_monitor): Functions to see if a
	file still has a reason to be monitored.
	(athena_directory_monitor_add_internal): Start FAM monitoring.
	(athena_directory_monitor_remove_internal): Stop FAM monitoring.
	* libathena-extensions/athena-directory-private.h: Add a place
	to keep track of the FAM monitor.
	* libathena-extensions/athena-file-private.h: Add a place
	to keep track of the FAM monitor.
	* libathena-extensions/athena-directory.c:
	(athena_directory_destroy): Stop FAM monitoring.
	* libathena-extensions/athena-file.c: (destroy): Stop FAM
	monitoring.
	
	* libathena-extensions/athena-monitor.c:
	(get_event_uri): Use FAMREQUEST_GETREQNUM instead of going
	directly at the struct.
	(process_fam_notifications): Get rid of the messages and call
	athena_file_changes_consume_changes on the way out.
	(athena_monitor_file): Get rid of the message.
	(athena_monitor_directory): Get rid of the message and use
	FAMREQUEST_GETREQNUM instead of going directly at the struct.
	(athena_monitor_cancel): Get rid of the message and use
	FAMREQUEST_GETREQNUM instead of going directly at the struct.

2001-04-16  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena/Makefile.am:
	Add missing eel includes.
	
2001-04-16  Darin Adler  <darin@eazel.com>

	Some work on FAM.

	* libathena-extensions/athena-monitor.h:
	* libathena-extensions/athena-monitor.c: (get_fam_connection),
	(get_request_hash_table), (get_event_uri),
	(process_fam_notifications), (athena_monitor_file),
	(athena_monitor_directory), (athena_monitor_cancel): Improved
	API, fixed some storage leaks, simplified some code, made it
	handle URI escaping properly, use the file changes queue. Almost
	ready for prime time!

	* libathena-extensions/athena-file-changes-queue.h:
	* libathena-extensions/athena-file-changes-queue.c:
	(athena_file_changes_queue_file_changed),
	(athena_file_changes_consume_changes):
	* libathena-extensions/athena-directory-notify.h:
	* libathena-extensions/athena-directory.c:
	(call_files_changed_unref_free_list),
	(athena_directory_notify_files_changed):
	Added a new kind of notification for the file changed case.

2001-04-16  Darin Adler  <darin@eazel.com>

	* src/athena-view-frame.c: (destroy_view), (attach_view): Fixed
	the problem that was making the image view crash. We want to unref
	right away, but not release the CORBA object reference until we
	are done.

	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_initialize_class),
	(get_removable_volumes), (volume_is_removable),
	(volume_is_read_only), (mount_volume_get_cdrom_name),
	(mount_volume_activate_cdda), (mount_volume_activate_cdrom),
	(get_current_mount_list), (verify_current_mount_state),
	(get_cdrom_type), (load_additional_mount_list_info):
	Some code cleanups. Got rid of a few ifdefs.
	
2001-04-16  Darin Adler  <darin@eazel.com>

	Fixed API to icon factory that took an anti-aliased parameter when
	creating a scalable icon. Instead it should be possible to get a
	scalable icon and then get either an anti-aliased-optimized or
	non-anti-alias-optimized version of the icon.

	* libathena-extensions/athena-bookmark.h:
	* libathena-extensions/athena-bookmark.c:
	(athena_bookmark_get_pixmap_and_mask): Pass FALSE so we get the
	non-anti-aliased version.
	(athena_bookmark_get_pixbuf): Add parameter to indicate if we
	want the anti-aliased-optimized version or not.
	(athena_bookmark_update_icon): Get rid of anti-aliased boolean
	here since we are just updating the scalable icon.
	(athena_bookmark_set_icon_to_default): Get rid of anti-aliased
	boolean here since we are just updating the scalable icon.

	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_update_icon): Pass in a flag to indicate
	if we need the anti-aliased version of the icon or not.

	* libathena-extensions/athena-icon-factory.h:
	* libathena-extensions/athena-icon-factory.c:
	(athena_scalable_icon_new_from_text_pieces): Removed the
	anti-aliased parameter.
	(athena_scalable_icon_hash), (athena_scalable_icon_equal):
	Remove the anti-aliased flag. A scalable icon itself is created
	before we make the "anti-aliased or not" choice.
	(athena_icon_factory_get_icon_for_file): Since we no longer know
	whether the icon will be needed anti-aliased or not, make the
	thumbnail code always use the anti-aliased version (and added
	FIXME). Also changed the "loading" image to use the normal icon
	name case instead of hard-coding.
	(athena_icon_factory_get_emblem_icon_by_name): Removed the
	anti-aliased parameter.
	(athena_icon_factory_get_emblem_icons_for_file): Removed the
	anti-aliased parameter.
	(load_specific_icon): Add an anti-aliased parameter.
	(load_icon_for_scaling): Add an anti-aliased parameter.
	(load_icon_scale_if_necessary): Pass in the anti-aliased parameter
	from the icon size request.
	(get_icon_from_cache): Pass in the anti-aliased parameter from the
	icon size request.
	(athena_icon_factory_get_pixbuf_for_icon): Add an anti-aliased
	parameter.
	(cache_key_hash): Include the anti-aliased flag in the hash.
	(cache_key_equal): Include the anti-aliased flag in the compare.
	(athena_icon_factory_get_pixbuf_for_file): Pass the anti-aliased
	parameter into the get_pixbuf half, not the get_icon_for_file
	half.
	(athena_icon_factory_get_pixbuf_from_name): Pass the
	anti-aliased parameter into the get_pixbuf half, not the
	scalable_icon_new half.
	(load_icon_with_embedded_text): Remove the anti-aliased parameter.

	* src/file-manager/fm-icon-view.c: (get_icon_images_callback): Get
	rid of code to pass in the anti-aliased parameter.
	* src/file-manager/fm-list-view.c:
	(fm_list_view_get_emblem_pixbufs_for_file): Pass the anti-aliased
	parameter to the pixbuf-getting function, not the
	scalable-icon-getting part.
	* src/athena-bookmark-parsing.c:
	(athena_bookmark_new_from_node): No need to pass an anti-aliased
	parameter (before it was always FALSE).
	* src/athena-sidebar-title.c: (update_emblems): Pass FALSE for
	the anti-aliased parameter to the get_pixbuf call rather than to
	the get_icons call.
	* src/athena-window-manage-views.c: (get_history_list_callback):
	No need to pass FALSE for anti-aliased any more.
	* src/athena-window-menus.c: (append_bookmark_to_menu): No need
	to pass FALSE for anti-aliased any more.

2001-04-16  Gene Z. Ragan  <gzr@eazel.com>

	Add a global to track the presence of /etc/mnttab and
	use that value instead of the improper ifdef that
	I added last week.  Check the value of this variable
	and use the result to determine to use mnttab or
	/proc/mounts.
	
	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_initialize_class),
	(get_current_mount_list):

2001-04-15  George Lebl <jirka@5z.com>

	* configure.in, po/cs.po:  Being the nationalistic bastard I am,
	  made an initial translation since nobody else seemed to want to
	  do so and I didn't want Czech to be so far behid others.  Currently
	  only about 13% done.

2001-04-13  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-volume-monitor.c:
	(locate_audio_cd): Simplify code a bit and get rid of unnecessary
	use of GnomeVFSURI.
	
	* src/file-manager/fm-directory-view.c: (queue_pending_files):
	Don't filter files at this level. Even invisible files might be
	formerly-visible files.
	* src/file-manager/fm-icon-view.c: (fm_icon_view_add_file),
	(fm_icon_view_file_changed): Filter out files that should not be
	visible, now that they are not filtered earlier.
	* src/file-manager/fm-list-view.c: (fm_list_view_add_file),
	(fm_list_view_file_changed): Filter out files that should not be
	visible, now that they are not filtered earlier.

2001-04-13  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-file-operations-progress.c:
	(athena_file_operations_progress_done): Remove code that fills
	the progress bar to the end. The callback from gnome-vfs now takes
	care of this (need the new gnome-vfs with bug fixes).
	
	* libathena-extensions/athena-file-operations.c:
	(handle_close_callback), (create_transfer_dialog): Handle the
	cancel button in a cleaner way. Just make it close the dialog and
	fall into the code already there to handle cases where the dialog
	is closed directly.
	
	* src/file-manager/fm-icon-view.c: (get_default_zoom_level): Fixed
	a strangely named variable.
	(fm_icon_view_begin_loading): Don't set the zoom level if the view
	does not support zooming (desktop view anyone?).
	(default_zoom_level_changed_callback): Don't set the zoom level if
	the view does not support zooming (desktop view anyone?).
	
	* src/athena-window.c: (handle_view_as_item_from_bonobo_menu):
	Use eel_strcmp, because the container path can be NULL in some
	cases.

2001-04-13  Pavel Cisler  <pavel@eazel.com>

	* src/file-manager/fm-list-view.c: (real_get_link_column),
	(real_get_column_specification):
	Move the emblem column after the name column.
	Give the emblem column a title.

2001-04-13  Gene Z. Ragan  <gzr@eazel.com>

	Fix issues in the volume monitor that crept in over time.
	We used to only open /proc/mounts once per second. We now
	do that again. All other file opening tasks now only
	occur when the state of mounts changes.
	
	* libathena-extensions/athena-volume-monitor.c:
	(get_removable_volumes), (volume_is_removable),
	(mount_volume_activate), (mount_volume_deactivate),
	(get_current_mount_list), (verify_current_mount_state),
	(load_additonal_mount_list_info), (mount_volume_add_filesystem):
	
	* src/file-manager/fm-desktop-icon-view.c:
	(create_unique_volume_name):

2001-04-13  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-profiler.c: (dump_dialog_show):
	Dont use a translated font name here.
	
2001-04-12  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena/athena-view-standard-main.h:
	* libathena/athena-view-standard-main.c:
	(athena_view_standard_main_multi), (athena_view_standard_main):
	Add support for gettext.  Add a post initialize callback so that
	callers can initialize any component specific stuff before the
	main even loop begins (athena preferences for example)
	Update for standard main changes.
	Add documentation for these functions.  Also add criticals to make
	the code a little bit more robust.

	* components/help/hyperbola-main.c: (main):
	* components/history/athena-history-view.c: (main):
	* components/music/main.c: (main):
	* components/notes/athena-notes.c: (main):
	* components/sample/main.c: (main):
	* components/text/main.c: (main):
	* components/tree/main.c: (main):
	Update for standard main changes.  Make these a little simpler by
	putting gettext support in standard main itself.  Also, make sure
	that components that use preferences initialize them.
	
	* src/athena-main.c: (main):
	Dont do the preferences initialization if we are about to kill the
	athena shell.
	
2001-04-12  Seth Nickell  <snickell@stanford.edu>

	* libathena-extensions/Makefile.am:

	Hang head in shame. Add athena-monitor.h to Makefile.am's
	headers list.

2001-04-12  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-bookmark.c:
	(athena_bookmark_get_pixbuf), (athena_bookmark_get_icon),
	(athena_bookmark_icon_is_different),
	(athena_bookmark_update_icon),
	(athena_bookmark_set_icon_to_default),
	(athena_bookmark_disconnect_file),
	(athena_bookmark_new_with_icon):
	* libathena-extensions/athena-dateedit-extensions.c:
	(athena_gnome_date_edit_get_date_as_string):
	* libathena-extensions/athena-dateedit-extensions.h:
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_update_icon):
	* libathena-extensions/athena-icon-factory.c:
	(cache_key_destroy), (athena_scalable_icon_get_text_pieces),
	(athena_scalable_icon_new_from_text_pieces),
	(athena_scalable_icon_ref), (athena_scalable_icon_unref),
	(athena_icon_factory_get_icon_for_file),
	(athena_icon_factory_get_emblem_icon_by_name),
	(get_icon_from_cache), (athena_icon_factory_get_pixbuf_for_file),
	(athena_icon_factory_get_pixbuf_from_name),
	(load_icon_with_embedded_text), (athena_scalable_icon_list_free):
	* libathena-extensions/athena-icon-factory.h:
	* libathena-extensions/athena-program-chooser.c:
	(launch_mime_capplet):
	* libathena-extensions/athena-program-choosing.c:
	(athena_launch_application),
	(athena_launch_application_from_command):
	* libathena-extensions/athena-program-choosing.h:
	* src/file-manager/fm-desktop-icon-view.c:
	(change_background_callback):
	* src/file-manager/fm-directory-view.c: (run_script_callback),
	(activate_callback):
	* src/file-manager/fm-list-view.c:
	(fm_list_view_get_emblem_pixbufs_for_file):
	* src/athena-bookmark-list.c: (append_bookmark_node):
	* src/athena-bookmark-parsing.c:
	(athena_bookmark_new_from_node):
	* src/athena-search-bar-criterion.c:
	(athena_search_bar_criterion_get_location):
	* src/athena-sidebar-title.c: (update_emblems):
	Fix overeager search and replace of eel with athena.  These
	functions got accidentally eel-ized.
	
2001-04-12  Seth Nickell  <snickell@stanford.edu>

	* libathena-extensions/athena-monitor.c:
	(athena_monitor_add_file), (athena_monitor_add_directory),
	(athena_monitor_remove):

	Fix stupid build breakage.
	
2001-04-12  Seth Nickell  <snickell@stanford.edu>

	* libathena-extensions/athena-monitor.c:
	(athena_monitor_process_fam_notifications):

	Add comments to unhandled FAM signals.

2001-04-12  Seth Nickell  <snickell@stanford.edu>

	Add some initial code to deal with file notification and
	monitoring. This isn't hooked in yet, but provides interfaces
	for Athena code to use.

	* configure.in:
	Add configure checks for FAM.
	
	* libathena-extensions/Makefile.am:
	Include FAM libraries if they exist.
	
	* libathena-extensions/athena-monitor.c:
	(athena_monitor_establish_connection),
	(athena_monitor_get_fam),
	(athena_monitor_find_path_from_request),
	(athena_monitor_find_request_from_path),
	(athena_monitor_delete_first_request_found),
	(athena_monitor_get_uri),
	(athena_monitor_process_fam_notifications),
	(athena_monitor_add_file), (athena_monitor_add_directory),
	(athena_monitor_remove):
	* libathena-extensions/athena-monitor.h:
	The code that actually communicates w/ FAM.
	
2001-04-12  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-file-operations-progress.c:
	(athena_file_operations_progress_new_file): Get rid of the +1
	I added here. I was actually working around a gnome-vfs bug with
	this (even though I didn't know it) and now I've fixed the bug.

	* src/file-manager/fm-directory-view.c: (debuting_uri_data_free):
	Fixed another g_free problem I introduced that was causing a core
	dump on quit.

2001-04-12  Darin Adler  <darin@eazel.com>

	* src/file-manager/fm-directory-view.c:
	Damn! Checked in too fast without thinking. This should make it
	compile again.

2001-04-12  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-file.c:
	Get rid of stray % character.
	
	* src/file-manager/fm-directory-view.c: (remove_debuting_uri),
	(debuting_uri_add_file_callback), (copy_move_done_partition_func):
	Fix bug I introduced with my last check-in, where we try to g_free
	a GINT_TO_POINTER(TRUE).

2001-04-12  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_one_default),
	(global_preferences_install_defaults),
	(global_preferences_populate_pane), (default_font_callback),
	(default_smooth_font_callback), (default_home_location_callback):
	Simplify the installation of default values.  Use the same
	mechanism as we do for constant default values, but provide a 
	callback for dynamic values.	
	
	* libathena-extensions/athena-preferences.h:
	* libathena-extensions/athena-preferences.c:
	(preferences_key_make_for_default),
	(preferences_key_make_for_default_getter),
	(athena_preferences_set_user_level),
	(athena_preferences_get_user_level_name_for_display),
	(athena_preferences_get_user_level_name_for_storage),
	(athena_preferences_user_level_clamp): New function to clamp a
	user level to the valid values.
	(athena_preferences_user_level_is_valid): New function to test a
	user level for validity.
	
	* libathena-extensions/athena-sidebar-functions.h:
	Add public define for sidebar panel preferences name prefix.

	* libathena-extensions/athena-sidebar-functions.c:
	(sidebar_panel_make_preference_key): Make this function private as
	its not used anymore.

2001-04-11  Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(sync_transfer_callback): Put flags in the debuting_uris hash
	table so we can tell files that are actually moved from files that
	are not because they are already in the right place.
	
	* src/file-manager/fm-directory-view.c:
	(copy_move_done_data_free): Use athena_file_list_free to save
	code.
	(remove_not_really_moved_files): Function to pick out files that
	are not actually moved (recognized by the flag in the
	debuting_uris hash table) and treat them as if they had already
	been moved.
	(copy_move_done_callback): Use g_hash_table_foreach_remove with
	the function above.
	
	* src/Athena_shell.oaf.in: Fix the the typo.
	
	* src/athena-sidebar-tabs.c: (get_property_bag): New function
	so we can share more code.
	(tab_item_destroy): Use new function for clarity and to fix lack
	of CORBA_exception_free.
	(get_tab_image_name): New function factored out.
	(athena_sidebar_tabs_update_tab_item): Use new function, also
	reduced some redundant code.
	(athena_sidebar_tabs_connect_view): Use new function for clarity
	and to save some code.
	
	* src/athena-view-frame.c: (destroy_view), (attach_view): Don't
	bother holding a reference to the AthenaView since it's part of
	the same object as the BonoboControl.
	
	* src/athena-window-menus.c: (help_menu_about_athena_callback):
	Get rid of non-ASCII character in a msgid string.
	
	* src/athena-window.c: (add_view_as_bonobo_menu_item): Fix tip
	string to be easier to translate.

2001-04-11  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fix non-medusa build:

	* libathena-extensions/athena-medusa-support.c,
	src/file-manager/athena-indexing-info.c,
	src/file-manager/fm-search-list-view.c:

	Several small changes to make compilation work when HAVE_MEDUSA
	isn't defined. From a patch sent to athena-list by Jason
	Leach <jasonleach@usa.net>

2001-04-11  Ramiro Estrugo  <ramiro@eazel.com>

	* athena.spec.in:
	Remove some stuff that no longer exists in athena.
	
2001-04-11  Ramiro Estrugo  <ramiro@eazel.com>

	* Makefile.am:
	Remove athena-installer.
	
	* acconfig.h:
	Remove EAZEL_SERVICES, PAM and RPM defines.
	
	* components/Makefile.am:
	Remove rpmview and services directories.
	
	* athena.spec.in:
	Remove all the trilobite stuff.
	
	* configure.in:
	Remove eazel services, installer, rpm checks, pam checks and 
	authenticate helper 
	
	* helper-utilities/Makefile.am:
	* helper-utilities/authenticate/.cvsignore:
	* helper-utilities/authenticate/Makefile.am:
	* helper-utilities/authenticate/athena-authenticate-fork.c:
	* helper-utilities/authenticate/athena-authenticate-pam.c:
	* helper-utilities/authenticate/athena-authenticate.c:
	* helper-utilities/authenticate/athena-authenticate.h:
	Retire.  Its not used.  If its ever needed again, it can be
	resurrected in trilobite.
	
	* components/rpmview/.cvsignore:
	* components/rpmview/Makefile.am:
	* components/rpmview/Athena_View_rpm.oaf.in:
	* components/rpmview/main.c:
	* components/rpmview/athena-rpm-verify-window.c:
	* components/rpmview/athena-rpm-verify-window.h:
	* components/rpmview/athena-rpm-view-install.c:
	* components/rpmview/athena-rpm-view-install.h:
	* components/rpmview/athena-rpm-view-private.h:
	* components/rpmview/athena-rpm-view.c:
	* components/rpmview/athena-rpm-view.h:
	* components/services/.cvsignore:
	* components/services/Makefile.am:
	* components/services/clone/.cvsignore:
	* components/services/clone/Makefile.am:
	* components/services/clone/eazel-clone-lib.c:
	* components/services/clone/eazel-clone-lib.h:
	* components/services/clone/eazel-clone.c:
	* components/services/docs/directories:
	* components/services/docs/eazel-services-framework-draft:
	* components/services/docs/install-user-settings:
	* components/services/docs/installer-dep-check:
	* components/services/docs/installer-rpm-cases:
	* components/services/docs/installer-rpmsearch:
	* components/services/docs/packagexml.dtd:
	* components/services/install-view/.cvsignore:
	* components/services/install-view/Makefile.am:
	* components/services/install-view/Athena_View_install.oaf.in:
	* components/services/install-view/callbacks.c:
	* components/services/install-view/callbacks.h:
	* components/services/install-view/forms.c:
	* components/services/install-view/forms.h:
	* components/services/install-view/main.c:
	* components/services/install-view/athena-service-install-view.c:
	* components/services/install-view/athena-service-install-view.h:
	* components/services/install/.cvsignore:
	* components/services/install/Makefile.am:
	* components/services/install/command-line/.cvsignore:
	* components/services/install/command-line/Makefile.am:
	* components/services/install/command-line/eazel-alt-install-corba.c:
	* components/services/install/command-line/eazel-gen-pre-xml.sh:
	* components/services/install/command-line/eazel-gen-xml.c:
	* components/services/install/command-line/eazel-test-inventory.c:
	* components/services/install/command-line/eazel-test-packsys.c:
	* components/services/install/command-line/eazel-test-softcat.c:
	* components/services/install/command-line/eazel-test-types.c:
	* components/services/install/command-line/genpkg_list.example:
	* components/services/install/idl/.cvsignore:
	* components/services/install/idl/Makefile.am:
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/.cvsignore:
	* components/services/install/lib/Makefile.am:
	* components/services/install/lib/eazel-install-corba-callback.c:
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba-types.c:
	* components/services/install/lib/eazel-install-corba-types.h:
	* components/services/install/lib/eazel-install-corba.c:
	* components/services/install/lib/eazel-install-logic2.c:
	* components/services/install/lib/eazel-install-logic2.h:
	* components/services/install/lib/eazel-install-metadata.c:
	* components/services/install/lib/eazel-install-metadata.h:
	* components/services/install/lib/eazel-install-object.c:
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-problem.c:
	* components/services/install/lib/eazel-install-problem.h:
	* components/services/install/lib/eazel-install-protocols.c:
	* components/services/install/lib/eazel-install-protocols.h:
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-query-lex.l:
	* components/services/install/lib/eazel-install-query-parse.h:
	* components/services/install/lib/eazel-install-query.h:
	* components/services/install/lib/eazel-install-rpm-signature.c:
	* components/services/install/lib/eazel-install-rpm-signature.h:
	* components/services/install/lib/eazel-install-tests.c:
	* components/services/install/lib/eazel-install-tests.h:
	* components/services/install/lib/eazel-install-xml-package-list.c:
	* components/services/install/lib/eazel-install-xml-package-list.h:
	* components/services/install/lib/eazel-package-system-dpkg.c:
	* components/services/install/lib/eazel-package-system-dpkg.h:
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system-rpm3-private.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	* components/services/install/lib/eazel-package-system-rpm3.h:
	* components/services/install/lib/eazel-package-system-rpm4.c:
	* components/services/install/lib/eazel-package-system-rpm4.h:
	* components/services/install/lib/eazel-package-system-skeleton.c:
	* components/services/install/lib/eazel-package-system-skeleton.h:
	* components/services/install/lib/eazel-package-system-types.c:
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system.c:
	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.c:
	* components/services/install/lib/eazel-softcat.h:
	* components/services/install/lib/libeazelinstall.h:
	* components/services/install/lib/makefile.staticlib.in:
	* components/services/install/server/.cvsignore:
	* components/services/install/server/Makefile.am:
	* components/services/install/server/Trilobite_Service_install.oaf.in:
	* components/services/install/server/main.c:
	* components/services/install/server/trilobite-eazel-install-service.png:
	* components/services/inventory-view/.cvsignore:
	* components/services/inventory-view/Makefile.am:
	* components/services/inventory-view/Athena_View_inventory.oaf.in:
	* components/services/inventory-view/main.c:
	* components/services/inventory-view/athena-inventory-config-page.c:
	* components/services/inventory-view/athena-inventory-disable-page.c:
	* components/services/inventory-view/athena-inventory-disable-page.h:
	* components/services/inventory-view/athena-inventory-enable-page.c:
	* components/services/inventory-view/athena-inventory-enable-page.h:
	* components/services/inventory-view/athena-inventory-view-private.h:
	* components/services/inventory-view/athena-inventory-view.c:
	* components/services/inventory-view/athena-inventory-view.h:
	* components/services/inventory/.cvsignore:
	* components/services/inventory/Makefile.am:
	* components/services/inventory/Trilobite_Service_inventory.oaf.in:
	* components/services/inventory/eazel-inventory-client.c:
	* components/services/inventory/eazel-inventory-collect-hardware.c:
	* components/services/inventory/eazel-inventory-collect-hardware.h:
	* components/services/inventory/eazel-inventory-collect-software.c:
	* components/services/inventory/eazel-inventory-collect-software.h:
	* components/services/inventory/eazel-inventory-service-interface.idl:
	* components/services/inventory/eazel-inventory-service.c:
	* components/services/inventory/eazel-inventory-service.h:
	* components/services/inventory/eazel-inventory-upload-callback.c:
	* components/services/inventory/eazel-inventory-upload-callback.h:
	* components/services/inventory/eazel-inventory-utils.c:
	* components/services/inventory/eazel-inventory-utils.h:
	* components/services/inventory/eazel-inventory.c:
	* components/services/inventory/eazel-inventory.h:
	* components/services/inventory/main.c:
	* components/services/login/.cvsignore:
	* components/services/login/Makefile.am:
	* components/services/login/athena-view/.cvsignore:
	* components/services/login/athena-view/Makefile.am:
	* components/services/login/athena-view/Athena_View_change-password.oaf.in:
	* components/services/login/athena-view/main.c:
	* components/services/login/athena-view/athena-change-password-view.c:
	* components/services/login/athena-view/athena-change-password-view.h:
	* components/services/login/athena-view/password-box.c:
	* components/services/login/athena-view/password-box.h:
	* components/services/athena-dependent-shared/.cvsignore:
	* components/services/athena-dependent-shared/Makefile.am:
	* components/services/athena-dependent-shared/eazel-services-extensions.c:
	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	* components/services/athena-dependent-shared/eazel-services-footer.c:
	* components/services/athena-dependent-shared/eazel-services-footer.h:
	* components/services/athena-dependent-shared/eazel-services-header.c:
	* components/services/athena-dependent-shared/eazel-services-header.h:
	* components/services/athena-dependent-shared/icons/.cvsignore:
	* components/services/athena-dependent-shared/icons/Makefile.am:
	* components/services/athena-dependent-shared/icons/config-gather.png:
	* components/services/athena-dependent-shared/icons/eazel-logo-left-side-repeat.png:
	* components/services/athena-dependent-shared/icons/eazel-logo-right-side-logo.png:
	* components/services/athena-dependent-shared/icons/eazel-services-header-middle-fill.png:
	* components/services/athena-dependent-shared/icons/eazel-services-logo-tile.png:
	* components/services/athena-dependent-shared/icons/inventory-service-icon.png:
	* components/services/athena-dependent-shared/icons/register.png:
	* components/services/athena-dependent-shared/icons/service-summary-large-grey-section.png:
	* components/services/athena-dependent-shared/icons/service-summary-large-teal-section.png:
	* components/services/athena-dependent-shared/icons/service-summary-logo-bottom.png:
	* components/services/athena-dependent-shared/icons/service-summary-short-grey-section.png:
	* components/services/athena-dependent-shared/icons/service-watch.png:
	* components/services/athena-dependent-shared/icons/services-warning.png:
	* components/services/athena-dependent-shared/icons/softcat-service-icon.png:
	* components/services/athena-dependent-shared/icons/summary-service-normal-fill.png:
	* components/services/athena-dependent-shared/icons/summary-service-normal-left-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-normal-right-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-prelight-fill.png:
	* components/services/athena-dependent-shared/icons/summary-service-prelight-left-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-prelight-right-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-remainder-fill.png:
	* components/services/athena-dependent-shared/icons/summary-service-remainder-left-bumper.png:
	* components/services/athena-dependent-shared/icons/summary-service-remainder-right-bumper.png:
	* components/services/athena-dependent-shared/icons/time-sync-service-icon.png:
	* components/services/athena-dependent-shared/icons/vault-service-icon.png:
	* components/services/athena-dependent-shared/test-footer-header.c:
	* components/services/summary/.cvsignore:
	* components/services/summary/Makefile.am:
	* components/services/summary/Athena_View_services-summary.oaf.in:
	* components/services/summary/eazel-summary-shared.c:
	* components/services/summary/eazel-summary-shared.h:
	* components/services/summary/icons/.cvsignore:
	* components/services/summary/icons/Makefile.am:
	* components/services/summary/icons/active-fill.png:
	* components/services/summary/icons/active-inactive-bridge.png:
	* components/services/summary/icons/active-left-bumper.png:
	* components/services/summary/icons/active-prelight-bridge.png:
	* components/services/summary/icons/active-right-bumper.png:
	* components/services/summary/icons/fill-background.png:
	* components/services/summary/icons/inactive-active-bridge.png:
	* components/services/summary/icons/inactive-fill.png:
	* components/services/summary/icons/inactive-left-bumper.png:
	* components/services/summary/icons/inactive-right-bumper.png:
	* components/services/summary/icons/prelight-active-bridge.png:
	* components/services/summary/icons/prelight-fill.png:
	* components/services/summary/icons/prelight-left-bumper.png:
	* components/services/summary/icons/prelight-right-bumper.png:
	* components/services/summary/main.c:
	* components/services/summary/athena-summary-callbacks.c:
	* components/services/summary/athena-summary-callbacks.h:
	* components/services/summary/athena-summary-dialogs.c:
	* components/services/summary/athena-summary-dialogs.h:
	* components/services/summary/athena-summary-footer.c:
	* components/services/summary/athena-summary-footer.h:
	* components/services/summary/athena-summary-menu-items.c:
	* components/services/summary/athena-summary-menu-items.h:
	* components/services/summary/athena-summary-view-private.h:
	* components/services/summary/athena-summary-view-ui.xml:
	* components/services/summary/athena-summary-view.c:
	* components/services/summary/athena-summary-view.h:
	* components/services/summary/athena-tabs.c:
	* components/services/summary/athena-tabs.h:
	* components/services/summary/redirects.xml:
	* components/services/summary/services.xml:
	* components/services/summary/tests.txt:
	* components/services/time/.cvsignore:
	* components/services/time/Makefile.am:
	* components/services/time/command-line/.cvsignore:
	* components/services/time/command-line/Makefile.am:
	* components/services/time/command-line/main.c:
	* components/services/time/idl/.cvsignore:
	* components/services/time/idl/Makefile.am:
	* components/services/time/idl/trilobite-eazel-time-service.idl:
	* components/services/time/athena-view/.cvsignore:
	* components/services/time/athena-view/Makefile.am:
	* components/services/time/athena-view/main.c:
	* components/services/time/athena-view/trilobite-eazel-time-view.c:
	* components/services/time/athena-view/trilobite-eazel-time-view.h:
	* components/services/time/athena-view/trilobite-eazel-time-view.oafinfo:
	* components/services/time/service/.cvsignore:
	* components/services/time/service/Makefile.am:
	* components/services/time/service/main.c:
	* components/services/time/service/trilobite-eazel-time-service-private.h:
	* components/services/time/service/trilobite-eazel-time-service-public.h:
	* components/services/time/service/trilobite-eazel-time-service.c:
	* components/services/time/service/trilobite-eazel-time-service.oafinfo:
	* components/services/time/service/trilobite-eazel-time-service.png:
	* components/services/trilobite/.cvsignore:
	* components/services/trilobite/Makefile.am:
	* components/services/trilobite/doc/gconf.txt:
	* components/services/trilobite/helper/.cvsignore:
	* components/services/trilobite/helper/Makefile.am:
	* components/services/trilobite/helper/README:
	* components/services/trilobite/helper/eazel-helper.c:
	* components/services/trilobite/helper/eazel-helper.pam:
	* components/services/trilobite/helper/eazel-helper.security.in:
	* components/services/trilobite/idl/.cvsignore:
	* components/services/trilobite/idl/Makefile.am:
	* components/services/trilobite/idl/trilobite-service.idl:
	* components/services/trilobite/libtrilobite/.cvsignore:
	* components/services/trilobite/libtrilobite/Makefile.am:
	* components/services/trilobite/libtrilobite/libtrilobite-service.h:
	* components/services/trilobite/libtrilobite/libtrilobite.h:
	* components/services/trilobite/libtrilobite/makefile.staticlib.in:
	* components/services/trilobite/libtrilobite/trilobite-core-distribution.c:
	* components/services/trilobite/libtrilobite/trilobite-core-distribution.h:
	* components/services/trilobite/libtrilobite/trilobite-core-messaging.c:
	* components/services/trilobite/libtrilobite/trilobite-core-messaging.h:
	* components/services/trilobite/libtrilobite/trilobite-core-network-slim.c:
	* components/services/trilobite/libtrilobite/trilobite-core-network.c:
	* components/services/trilobite/libtrilobite/trilobite-core-network.h:
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c:
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h:
	* components/services/trilobite/libtrilobite/trilobite-i18n.h:
	* components/services/trilobite/libtrilobite/trilobite-md5-tools.c:
	* components/services/trilobite/libtrilobite/trilobite-md5-tools.h:
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	* components/services/trilobite/libtrilobite/trilobite-redirect.h:
	* components/services/trilobite/libtrilobite/trilobite-root-client-private.h:
	* components/services/trilobite/libtrilobite/trilobite-root-client-public.h:
	* components/services/trilobite/libtrilobite/trilobite-root-client.c:
	* components/services/trilobite/libtrilobite/trilobite-root-helper.c:
	* components/services/trilobite/libtrilobite/trilobite-root-helper.h:
	* components/services/trilobite/libtrilobite/trilobite-service-passwordquery-private.h:
	* components/services/trilobite/libtrilobite/trilobite-service-passwordquery-public.h:
	* components/services/trilobite/libtrilobite/trilobite-service-passwordquery.c:
	* components/services/trilobite/libtrilobite/trilobite-service-private.h:
	* components/services/trilobite/libtrilobite/trilobite-service-public.h:
	* components/services/trilobite/libtrilobite/trilobite-service.c:
	* components/services/trilobite/sample/.cvsignore:
	* components/services/trilobite/sample/Makefile.am:
	* components/services/trilobite/sample/command-line/.cvsignore:
	* components/services/trilobite/sample/command-line/Makefile.am:
	* components/services/trilobite/sample/command-line/main.c:
	* components/services/trilobite/sample/idl/.cvsignore:
	* components/services/trilobite/sample/idl/Makefile.am:
	* components/services/trilobite/sample/idl/sample-service.idl:
	* components/services/trilobite/sample/lib/.cvsignore:
	* components/services/trilobite/sample/lib/Makefile.am:
	* components/services/trilobite/sample/lib/sample-service-public.h:
	* components/services/trilobite/sample/athena-view/.cvsignore:
	* components/services/trilobite/sample/athena-view/Makefile.am:
	* components/services/trilobite/sample/athena-view/Athena_View_service-sample.oaf.in:
	* components/services/trilobite/sample/athena-view/icons/.cvsignore:
	* components/services/trilobite/sample/athena-view/icons/Makefile.am:
	* components/services/trilobite/sample/athena-view/main.c:
	* components/services/trilobite/sample/athena-view/athena-sample-service-view.c:
	* components/services/trilobite/sample/athena-view/athena-sample-service-view.h:
	* components/services/trilobite/sample/service/.cvsignore:
	* components/services/trilobite/sample/service/Makefile.am:
	* components/services/trilobite/sample/service/Trilobite_Service_sample.oaf.in:
	* components/services/trilobite/sample/service/main.c:
	* components/services/trilobite/sample/service/sample-service-impl.c:
	* components/services/trilobite/utils/.cvsignore:
	* components/services/trilobite/utils/Makefile.am:
	* components/services/trilobite/utils/eazel-helper-test.c:
	* athena-installer/.cvsignore:
	* athena-installer/Makefile.am:
	* athena-installer/install-lib/.cvsignore:
	* athena-installer/install-lib/Makefile.am:
	* athena-installer/libtrilobite/.cvsignore:
	* athena-installer/libtrilobite/Makefile.am:
	* athena-installer/athena-installer.glade:
	* athena-installer/package-list.xml.in:
	* athena-installer/src/.cvsignore:
	* athena-installer/src/HACKING:
	* athena-installer/src/Makefile.am:
	* athena-installer/src/bootstrap-background.xpm:
	* athena-installer/src/callbacks.c:
	* athena-installer/src/callbacks.h:
	* athena-installer/src/create-eazel-installer.sh:
	* athena-installer/src/error-symbol.xpm:
	* athena-installer/src/evil.xpm:
	* athena-installer/src/fake-stock.c:
	* athena-installer/src/fake-stock.h:
	* athena-installer/src/gnome-dialog-util.c:
	* athena-installer/src/gnome-dialog-util.h:
	* athena-installer/src/gnome-dialog.c:
	* athena-installer/src/gnome-dialog.h:
	* athena-installer/src/gnome-druid-page.c:
	* athena-installer/src/gnome-druid-page.h:
	* athena-installer/src/gnome-druid.c:
	* athena-installer/src/gnome-druid.h:
	* athena-installer/src/gnome-messagebox.c:
	* athena-installer/src/gnome-messagebox.h:
	* athena-installer/src/gnome-types.h:
	* athena-installer/src/gtk-hackery.c:
	* athena-installer/src/installer.c:
	* athena-installer/src/installer.h:
	* athena-installer/src/link.sh:
	* athena-installer/src/main.c:
	* athena-installer/src/athena-druid-page-eazel.c:
	* athena-installer/src/athena-druid-page-eazel.h:
	* athena-installer/src/athena-druid.c:
	* athena-installer/src/athena-druid.h:
	* athena-installer/src/package-list-depends.xml:
	* athena-installer/src/package-tree.c:
	* athena-installer/src/package-tree.h:
	* athena-installer/src/prescript:
	* athena-installer/src/proxy.c:
	* athena-installer/src/proxy.h:
	* athena-installer/src/rpmsearch.cgi:
	* athena-installer/src/support.c:
	* athena-installer/src/support.h:
	Retire.  These now live in the trilobite module.
	
2001-04-10  John Harper  <jsh@eazel.com>

	* src/athena-first-time-druid.c (druid_finished): re-removed
	the code to immediately add the services link (looks like it
	was added as a result of Rebecca's checkin of 2001-04-06),
	since it's done at idle time now

2001-04-09  Ramiro Estrugo  <ramiro@eazel.com>

	* acconfig.h:
	Add HAVE_AMMONITE.
	
	* components/mozilla/main.c: (main):
	* components/mozilla/athena-mozilla-content-view.c:
	(translate_uri_athena_to_mozilla),
	(translate_uri_mozilla_to_athena):
	Use HAVE_AMMONITE instead of EAZEL_SERVICES for the specific
	Ammonite features.
	
	* components/text/services/Makefile.am:
	Fix rogue spacing.
	
	* configure.in:

	* libathena-extensions/athena-directory.c:
	(athena_self_check_directory):
	Remove EAZEL_SERVICES from self test code.  Run the test for the
	eazel-services uri scheme regardless.
	
	* libathena-extensions/athena-mime-actions.h:
	* libathena-extensions/athena-mime-actions.c:
	(mime_get_all_components_for_uri_scheme): New flavor of function
	tha takes a uri scheme parameter instead of a AthenaFile.
	(athena_mime_has_any_components_for_uri_scheme): New function to
	find out if there exists any components registered to handle a uri
	scheme.

	* src/Makefile.am:
	Use AMMONITE_CFLAGS and AMMONITE_LIBS instead of SERVICES_LIBS
	hac.
	
	* src/athena-services.h,
	* src/athena-services.c: New files for putting all shared
	services related code in one places. 

	* src/athena-window-menus.c: (services_button_callback),
	(athena_window_initialize_menus_part_1):
	Remove EAZEL_HACKING hackery.  Make the services code always be
	linked in.  Use new shared services functions to determine whether
	we need to populate the services menus and toolbars.
	
	* src/athena-window-service-ui.c: (goto_services_summary),
	(goto_online_storage), (goto_software_catalog),
	(athena_window_install_service_ui):
	Simplify by using shared services code.  Remove all Ammonite code
	from here.  Ammonite code is constrained to athena-services.[ch]
	only.  Use shared services code t determine the target uris for
	services callbacks.
	
	* src/athena-window-toolbars.c: (set_up_toolbar_images):
	* src/athena-window.c: (athena_window_constructed):
	Remove EAZEL_HACKING hackery.  Decide at runtime whether to setup
	the services toobar or not.

2001-04-09  John Sullivan  <sullivan@eazel.com>

	Wired up the remaining new view global preferences,
	and added a menu item for resetting the current view
	to match preferences. I know of one large bug (the
	default choice of Icons vs List doesn't work) and several
	small bugs that I'll write up now.

	This change requires a recent API change in eel (for
	eel_list_set_sort_type and eel_list_set_sort_column).

	* libathena-extensions/athena-global-preferences.c:
	Fixed typo.
	
	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(reset_to_defaults_callback), (real_merge_menus),
	(fm_directory_view_reset_to_defaults),
	(fm_directory_view_initialize_class): Added support for
	"Reset to Defaults" command, which subclasses override
	to Do The Right Thing.
	
	* src/file-manager/athena-directory-view-ui.xml:
	Add "Reset to View Preferences" menu item.

	* src/athena-shell-ui.xml: Add placeholder to support location
	of "Reset to View Preferences" menu item.

	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_reset_to_defaults), (fm_icon_view_initialize_class):
	Set sort criterion, sort-reversedness, tighter layout, and
	zoom level to match defaults.
	
	* src/file-manager/fm-list-view.c: 
	(fm_list_view_initialize_class): wire up reset_to_defaults handler;
	set up auto-storage variables for sort order & sort reversed preferences.
	(fm_list_view_initialize): Set up preferences callbacks to notice changes
	to default sort order, sort reversed, and zoom level.
	(set_sort_order_from_metadata_and_preferences),
	(set_zoom_level_from_metadata_and_preferences): New functions, broken
	out of fm_list_view_begin_loading for reuse.
	(default_sort_criteria_changed_callback),
	(default_zoom_level_changed_callback): React to preference changes
	by resorting or rezooming as appropriate.
	(fm_list_view_begin_loading): Call broken-out functions.
	(fm_list_view_reset_to_defaults): Set sort order, sort-reversedness,
	and zoom level to default values.
	(fm_list_view_sort_items): Use variable defaults instead of hardwired
	constants for sort order & sort-reversedness. Call new eel_list versions
	of set_sort_type and set_sort_column so the column titles redraw
	correctly.
	(get_sort_column_from_attribute): Use variable default for sort attribute
	instead of hardwired constant.
	(get_attribute_from_sort_type): New function, converts between
	AthenaFileSortType enum values and named attributes.
	(real_get_default_sort_attribute): Use get_attribute_from_sort_type instead
	of hardwired constant.

	* src/athena-application.c:
	(default_folder_viewer_changed_callback),
	(athena_application_startup): When the default folder viewer
	preference changes, tell gnome-vfs about it.

2001-04-09  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	Fix 6024 properties window and file copy dialog should ellipsize
		 paths in middle, not at start

	* libathena-extensions/athena-file-operations.c:
	(ellipsize_string_for_dialog):
	Use ellipsize_middle now that we support it.
	
	* src/file-manager/fm-list-view.c: (truncate_middle_callback),
	(get_cell_text):
	Use the new ellipsizing API.
	
2001-04-09  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-sidebar-functions.h:
	Fix a bogus comment.
	
2001-04-09  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	Fix list view default zoom level value.

	* libathena-extensions/athena-preferences-group.c:
	(athena_preferences_group_get_num_visible_items),
	(athena_preferences_group_get_max_caption_width),
	(athena_preferences_group_align_captions):
	Use athena_prefereces_item_is_showing() instead of GTK_VISIBLE
	and athena_preferences_is_visible().
	
	* libathena-extensions/athena-preferences-item.h:
	* libathena-extensions/athena-preferences-item.c:
	(athena_preferences_item_is_showing): New function.
	(preferences_item_get_control_showing): Make this one private.
	(athena_preferences_item_update_showing): Use new function.
	
	* libathena-extensions/athena-preferences-pane.c:
	(preferences_pane_update_and_resize_callback),
	(athena_preferences_pane_initialize),
	(athena_preferences_pane_add_control_preference):
	Update the pane on user level changes as well so that alignment
	are right.  This is a bit of a hack.
	
	* src/file-manager/fm-icon-view.c: (get_default_sort_order),
	(fm_icon_view_real_get_directory_sort_by),
	(fm_icon_view_set_directory_sort_by),
	(fm_icon_view_real_set_directory_sort_by),
	(get_default_sort_in_reverse_order),
	(fm_icon_view_real_get_directory_sort_reversed),
	(fm_icon_view_set_directory_sort_reversed),
	(fm_icon_view_real_set_directory_sort_reversed),
	(get_default_directory_tighter_layout),
	(fm_icon_view_real_get_directory_tighter_layout),
	(fm_icon_view_set_directory_tighter_layout),
	(fm_icon_view_real_set_directory_tighter_layout),
	(get_sort_criterion_by_sort_type), (get_default_zoom_level),
	(fm_icon_view_begin_loading), (fm_icon_view_get_zoom_level),
	(fm_icon_view_set_zoom_level), (fm_icon_view_zoom_to_level),
	(fm_icon_view_restore_default_zoom_level),
	(default_zoom_level_font_size_changed_callback),
	(default_sort_order_changed_callback),
	(default_sort_in_reverse_order_changed_callback),
	(default_use_tighter_layout_changed_callback),
	(default_zoom_level_changed_callback), (fm_icon_view_initialize),
	(fm_icon_view_update_icon_container_font_size_table):
	Use preferences to obtain the default values for zoom level,
	zoom level font size, sort order, sort reversed and tighter
	layout.

	* src/file-manager/fm-list-view.c: (get_default_zoom_level):
	Use preferences to obtain the default zoom level.
	
2001-04-08  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	Miseed this file in last checkin.
	
2001-04-08  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_register_enumerations),
	(global_preferences_create_dialog),
	(global_preferences_populate_sidebar_panels_callback),
	(global_preferences_install_font_defaults),
	(global_preferences_populate_pane):
	Make the way we deal with enumerations simpler.  Add "View
	Preferences" pane and all the related defines.
	
	* libathena-extensions/athena-preferences-group.h:
	* libathena-extensions/athena-preferences-group.c:
	(athena_preferences_group_initialize_class),
	(athena_preferences_group_initialize),
	(athena_preferences_group_destroy),
	(athena_preferences_group_new),
	(athena_preferences_group_add_item),
	(athena_preferences_group_update),
	(athena_preferences_group_get_num_visible_items),
	(athena_preferences_group_get_title_label),
	(athena_preferences_group_get_max_caption_width),
	(athena_preferences_group_align_captions):
	Add support for 2 columns.  Add better support for caption
	alignment.  Some minor style tweaking.
	
	* libathena-extensions/athena-preferences-item.h:
	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_destroy),
	(preferences_item_update_enumeration_radio),
	(preferences_item_create_enumeration_radio),
	(preferences_item_create_boolean),
	(preferences_item_create_editable_string),
	(preferences_item_create_editable_integer),
	(preferences_item_update_enumeration_menu),
	(preferences_item_create_enumeration_menu),
	(preferences_item_create_font), (preferences_item_create_padding),
	(smooth_font_changed_callback),
	(preferences_item_create_smooth_font),
	(athena_preferences_item_new),
	(enumeration_radio_changed_callback), (font_changed_callback),
	(enumeration_menu_changed_callback),
	(preferences_item_update_displayed_value),
	(athena_preferences_item_get_child_width),
	(athena_preferences_item_update_showing):
	Add support for padding items.  Rename the enumeration items to
	better describe their look and function.
	No longer need to store the whole enumeration.  We just need the
	enumeration id to make enumeration queries.  Remove the
	constrained integer stuff which is replaced by the use of an
	enumeration id.
	
	* libathena-extensions/athena-preferences-pane.h:
	* libathena-extensions/athena-preferences-pane.c:
	(athena_preferences_pane_add_item_to_nth_group),
	(preferences_pane_get_max_caption_width),
	(athena_preferences_pane_update),
	(athena_preferences_pane_get_num_visible_groups):
	Better caption alignment.
	
	* libathena-extensions/athena-preferences.h:
	* libathena-extensions/athena-preferences.c:
	(preferences_entry_free), (athena_preferences_get_description),
	(athena_preferences_set_enumeration_id),
	(athena_preferences_get_enumeration_id):
	No longer store the whole enumeration, just an enumeration id.
	
	* src/file-manager/fm-icon-view.c: (fm_icon_view_initialize),
	(fm_icon_view_update_icon_container_font_size_table):
	* src/file-manager/fm-list-view.c: (fm_list_view_initialize),
	(fm_list_view_update_font):
	Update for new "View Preferences" preferences.  Not hooked up for
	real yet.
	
2001-04-07  John Sullivan  <sullivan@eazel.com>

	Fixed bug 3787 (If location bar is turned off, user cannot
	change viewer)

	Now the "View as" choices, including "View as...", appear
	at the bottom of the View menu as well as in the location bar.

	* libathena-extensions/athena-bonobo-extensions.h:
	* libathena-extensions/athena-bonobo-extensions.c:
	(add_numbered_menu_item_internal): Handle radio item case; change
	signature to support this.
	(athena_bonobo_add_numbered_menu_item),
	(athena_bonobo_add_numbered_toggle_menu_item):
	Updated for change to add_numbered_menu_item_internal.
	(athena_bonobo_add_numbered_radio_menu_item): New function,
	just like its fellows but creates a one-of-many menu item.
	(athena_bonobo_get_numbered_menu_item_index_from_command),
	(athena_bonobo_get_numbered_menu_item_container_path_from_command):
	New functions that return info given one of the numbered-menu-item
	generated commands. Useful for callbacks when all you have in hand
	is the command itself.
	
	* src/athena-shell-ui.xml: Add "View as" command; add placeholders
	and separators and "View as" menu item to View menu.
	Also removed pixmap from Close Window menu item because it was
	silly to have a pixmap on exactly one item in the File menu.
	
	* src/athena-window-manage-views.c: Took "static" off of
	athena_window_content_matches_iid so I could make it public
	and use it in athena-window.c.
	
	* src/athena-window-private.h: Added fields to Details struct
	and prototypes for functions needed by View As stuff.

	* src/athena-window-menus.c: 
	(view_menu_view_as_callback): New callback function used by
	"View as" verb.
	(athena_window_initialize_menus_part_1): Wire up "View as"
	verb; register for Bonobo UI events to catch radio items being
	selected.
	
	* src/athena-window.c: 
	(set_dummy_initial_view_as_menu): Changed "View as ..." to
	"View as...", which matches the new name of "View as Other..."
	(free_stored_viewers): New function, frees and nulls out the
	view identifiers stored in the Details struct for the "View as"
	menus.
	(athena_window_destroy): Call free_stored_viewers.
	(activate_nth_short_list_item): New function, switches viewers
	by viewer index.
	(activate_extra_viewer): New function, switches to sometimes-
	present extra viewer (used when current viewer isn't in short list).
	(handle_view_as_item_from_bonobo_menu): If item whose state has
	changed is a "View as" item, dispatch accordingly.
	(athena_window_handle_ui_event_callback): Call
	handle_view_as_item_from_bonobo_menu if UI event was state
	changing to TRUE.
	(view_as_menu_switch_views_callback), 
	(create_view_as_menu_item): Changed to store viewer index and
	whether viewer is "extra viewer" rather than storing 
	AthenaViewIdentifier. This is used for option menu in location
	bar and now closely matches the mechanism used for the View menu.
	(add_view_as_bonobo_menu_item): New function used by View menu
	View As items.
	(replace_extra_viewer_in_view_as_menus),
	(athena_window_synch_view_as_menus): 
	(load_view_as_menus_callback): Renamed and cleaned up to separate
	information gathering from widget updating; now handle View As 
	items in View menu also.
	(chose_component_callback): Added FIXME for pre-existing bug 8000.
	(athena_window_show_view_as_dialog): New function, extracted
	from view_as_menu_choose_view_callback.
	(view_as_menu_choose_view_callback): Now calls extracted function.
	(refresh_stored_viewers): New function, updates the list of viewers
	stored in the Details struct.

2001-04-06  Rebecca Schulman  <rebecka@eazel.com>
	Fix bugzilla.eazel.com bug 7933, and the athena
	half of bug 7934, by removing the search preferences
	from athena, and removing the ability to make a new
	index from Athena.  These features may return at 
	some point, but in the future will require a root
	password.

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_defaults),
	(global_preferences_create_dialog),
	(global_preferences_install_font_defaults):
	* libathena-extensions/athena-global-preferences.h:
	Remove all of the medusa preferences, including the
	preference to make the preference itself sensitive and
	insensitive, and all callbacks and set up related
	to the search preference
	
	* libathena-extensions/athena-medusa-support.c:
	(athena_medusa_services_are_enabled),
	(athena_medusa_check_cron_is_enabled),
	(athena_medusa_get_configuration_file_path),
	(athena_medusa_get_explanation_of_enabling):
	* libathena-extensions/athena-medusa-support.h:
	Remove functions to enable / disable medusa,
	and to check on cron.  Add new function
	to explain how to turn on medusa as root, so that
	the same message can be adjusted, and used in multiple 
	dialogs
	
	* src/file-manager/fm-search-list-view.c:
	(report_index_age_as_status), (load_location_callback),
	(display_indexed_search_problems_dialog),
	(display_system_services_are_disabled_dialog):
	Remove dialog about medusa being blocked, since medusa
	can only be either on or off now. Clarify the message
	about medusa being off, and change the message to tell
	the user how to turn medusa on as root, instead of
	recommending they change their preference in athena about
	searching. Refactor status message about last indexing
	time to simplify the load_location_callback.  Don't tell
	users that "an index can't be created right now", but instead
	tell them how to create an index as root, when this information
	is appopriate.   Remove two FIXMEs that are now obsolete.
	
	* src/file-manager/athena-indexing-info.c:
	(set_close_hides_for_dialog), (show_index_progress_dialog),
	(show_reindex_request_dialog),
	(last_index_time_and_reindex_button_dialog_new),
	(index_progress_dialog_new), (show_indexing_info_dialog),
	(athena_indexing_info_show_dialog):
	Remove dialog about medusa being blocked, and make the index
	status dialog explain clearly that there is no index in the
	case where medusa is turned off, instead of giving an error
	message.  Change the state changed callbacks to coincide 
	with concurrent changes to the medusa "system state" API.
	Fix a bug that could cause athena to crash if the index
	status dialog was up when medusa was turned on (a race condition
	of two callbacks trying to destroy the same dialog)
	
	* src/athena-first-time-druid.c: (druid_finished),
	(athena_first_time_druid_show):
	Remove medusa and cron pages from the first time druid.  Includes
	removing the callbacks to change the page order based on
	whether medusa and/or cron are available. 

2001-04-06  Gene Z. Ragan  <gzr@eazel.com>

	Fix a compile error in the volume monitor code.
	
	* libathena-extensions/athena-volume-monitor.c:
	(mount_volume_get_cdda_name), (open_cdda_device),
	(locate_audio_cd):

2001-04-06  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: upped version to 1.0.2.1 too keep
	  track of the 3 active branches of athena
	  development and keep HEAD sorting higher.

2001-04-06  Gene Z. Ragan  <gzr@eazel.com>

	Attempt to track down possible file descriptor leak.
	
	* libathena-extensions/athena-volume-monitor.c:
	(get_removable_volumes), (get_current_mount_list),
	(open_cdda_device), (locate_audio_cd):

2001-04-06  Gene Z. Ragan  <gzr@eazel.com>
	
	Add more verbose error message in the case that
	/proc/mounts or /etc/mnttab cannot be opened.
	
	* libathena-extensions/athena-volume-monitor.c:
	(get_current_mount_list):

2001-04-05  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Don Melton <don@eazel.com>

	* help/athena-user-manual/C/TRACKED_CHANGES:
	* help/athena-user-manual/C/athena-user-manual.sgml:
	
	Remove documentation about search from the manual for now.
	Unfortunately, we were not able to get in touch with Dan Mueth
	regarding this change.  The translated copies of the edited manual
	will be changed tomorrow morning.

2001-04-05  Pavel Cisler  <pavel@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	* libathena-extensions/athena-file.c:
	(athena_file_fit_date_as_string),
	(athena_file_fit_modified_date_as_string),
	(athena_file_get_date_as_string):
	* libathena-extensions/athena-file.h:
	Add a new function that returns a modified date string,
	formatted to fit a given width. Make the old
	athena_file_get_date_as_string call it.
	
	* src/file-manager/fm-list-view.c: (measure_width_callback),
	(trucante_middle_callback), (get_cell_text), (set_up_list):
	Hook up to the get_cell_text signal. For modified text return
	a nicely formatted text string, for everything else just
	ellipsize the result.

2001-04-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 7986 ("Paste Files" disabled in trash:)

	* src/file-manager/fm-directory-view.c: 
	(real_update_menus): Made "Paste Files" sensitivity depend
	on is_read_only rather than can_create_files.

	* src/file-manager/fm-search-list-view.c:
	(fm_search_list_view_initialize_class), (real_is_read_only):
	Made search list view override is_read_only instead of
	supports_creating_files.

2001-04-05  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_theme_changed):
	Update for Arlo's new icon.
	
2001-04-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 7985 (Separately group "Move to Trash" and
	"Delete" menu items to avoid accidental selection)

	* src/file-manager/athena-directory-view-ui.xml:
	Moved Move to Trash and Delete into their own
	menu section (surrounded by separators).	
	* src/file-manager/fm-directory-view.c: Updated menu
	paths that have now changed.
	* src/athena-shell-ui.xml: Added placeholder used by
	Move to Trash and Delete to get ordering right.

2001-04-05  Arlo Rose  <arlo@eazel.com>

	* icons/Makefile.am:
	* icons/note-indicator.png:
	Made icon a single note.	

	* icons/text-selection-frame-aa.png:
	* icons/text-selection-frame.png:
	Added non aa version of the text selection frame for dragging.

2001-04-05  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 7821, SOLARIS: Athena hangs attempted to initialize ESD
	
	* libathena-extensions/athena-global-preferences.h:
	Remove unused sound init preference.
	
	* libathena-extensions/athena-sound.c:
	* libathena-extensions/athena-sound.h:
	(athena_sound_initialize):
	Remove call to esd_open_audio. It is the wrong call to use and
	caused problems on Solaris.
	
	(athena_sound_can_play_sound):
	Call esd_sound_open to determine if we can handle audio playback.
		
2001-04-05  Gene Z. Ragan  <gzr@eazel.com>
	
	Fixed bug 7790, Music View silently fails if sound
	hardware busy or missing
	
	* components/music/esd-audio.c: (esdout_playing), (esdout_close),
	(esdout_loop), (esdout_open):
	Modify logic used to determine if another process has opened a
	connection to esd, blocking us from doing so.
	
	* components/music/athena-music-view.c:
	(update_play_controls_status), (play_current_file),
	(add_play_controls):
	Add code in anticipation of adding support to disable controls at
	appropriate times.

2001-04-05  Ramiro Estrugo  <ramiro@eazel.com>

	* components/rpmview/Makefile.am:
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize),
	(athena_rpm_view_update_from_uri),
	(athena_rpm_view_drag_data_received), (pixbuf_new_named),
	(image_new_named):
	Remove depenency on Athena themes and thus libathena-extensions.
	
	* components/services/install-view/Makefile.am:
	* components/services/install-view/callbacks.c:
	(athena_service_install_done):
	* components/services/install-view/athena-service-install-view.c:
	(athena_service_install_view_initialize_class):
	* components/services/inventory-view/Makefile.am:
	* components/services/login/athena-view/Makefile.am:
	* components/services/athena-dependent-shared/Makefile.am:
	* components/services/athena-dependent-shared/eazel-services-extensions.c:
	(eazel_services_pixbuf_new), (eazel_services_image_new),
	(eazel_services_image_new_clickable),
	(eazel_services_image_new_from_uri),
	(eazel_services_clickable_image_new_from_uri),
	(eazel_services_label_new), (eazel_services_label_new_clickable),
	(eazel_services_get_current_date_string),
	(eazel_services_gconf_handle_error),
	(preferences_unref_global_gconf_client),
	(preferences_get_global_gconf_client),
	(preferences_gconf_get_boolean), (preferences_gconf_get_string),
	(smooth_graphics_changed_notice),
	(listen_for_smooth_graphics_changes),
	(eazel_services_get_user_level):
	* components/services/athena-dependent-shared/eazel-services-extensions.h:
	* components/services/summary/Makefile.am:
	* components/services/summary/athena-summary-menu-items.c:
	(ui_component_set_hidden), (update_menu_items):
	* components/services/summary/athena-summary-view.c:
	(athena_summary_view_initialize_class):
	Remove dependency on libathena-extensions.
	
	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-tabs.h:
	* libathena-extensions/athena-tabs.c:
	* components/services/summary/athena-tabs.h:
	* components/services/summary/athena-tabs.c:
	Move the athena tabs widget to the only place where its used -
	the summary view.

	* libathena-extensions/athena-file-utilities.c:
	Trim down the includes to only whats needed.
	
	* libathena-extensions/athena-file-dnd.h:
	* libathena-extensions/athena-file-dnd.c:
	Make the ERASE_KEYWORD be part only of athena-file-dnd.h as
	ATHENA_FILE_DND_ERASE_KEYWORD to make it clear where it lives.
	
	* components/tree/athena-tree-view-dnd.c:
	(athena_tree_view_move_copy_files):
	(athena_drag_can_accept_items),
	(athena_drag_file_receive_dropped_keyword):
	* libathena-extensions/athena-icon-dnd.c:
	(create_selection_shadow), (handle_local_move),
	(handle_nonlocal_move), (selection_includes_special_link):
	* src/file-manager/fm-list-view.c: (fm_list_receive_dropped_icons):
	Update for eel dnd changes.  Make sure all public eel dnd stuff
	has the right namespace.
	
2001-04-05  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-profiler.c:
	Add missing eel includes to fix profile build.
	
2001-04-04  John Sullivan  <sullivan@eazel.com>

	Various little tweaky cleanups.

	* src/athena-property-browser.c:
	(athena_property_browser_initialize),
	(athena_emblem_dialog_new),
	(athena_color_selection_dialog_new),
	(athena_property_browser_update_contents):
	* src/athena-sidebar.c: (athena_sidebar_initialize_class),
	(athena_sidebar_update_buttons):
	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize), (exit_remove_mode):
	Changed code that was making buttons wider by using
	bracketing spaces (e.g. "  Done  ") to set the button
	padding instead. Simplified some places that were unnecessarily
	creating button labels explicitly to instead just use
	gtk_button_new_with_label. Added a few ellipses in button
	labels that needed them. Made the "Empty Trash" button in
	the sidebar check the preference to decide whether to use
	ellipses or not.

2001-04-04  John Harper  <jsh@eazel.com>

	Fixed bug 7950 (After running First-Time Druid there are two
	Athena windows displaying the home directory):

	* src/athena-first-time-druid.c (druid_finished): moved all
	athena link creation to idle handlers. Otherwise we may try
	to get a metadata factory before athena is fully initialized.
	(This means that oafd will spawn an additional athena
	process, giving the extra window)

2001-04-04  John Sullivan  <sullivan@eazel.com>

	Fixed bugs 3681, 4705, 5154, all having to do with the funky
	behavior where the zoom level is sort of persistent as you
	navigate around. Now it will always use the default zoom level 
	unless the directory has a different stored value. Ramiro plans 
	to implement global preferences for the default zoom level (one
	each for icon & list view) that will replace the constant
	defaults.

	* src/file-manager/fm-icon-view.c: 
	(get_default_zoom_level): New bottleneck function for getting
	the default zoom level for icon view. Currently returns a
	constant; later will return a preferences value.
	(fm_icon_view_begin_loading), (fm_icon_view_get_zoom_level),
	(fm_icon_view_set_zoom_level),
	(fm_icon_view_restore_default_zoom_level),
	(fm_icon_view_initialize): Use get_default_zoom_level. Also
	get rid of code that was saving the current zoom level to use
	as default next time.
	
	* src/file-manager/fm-list-view.c: 
	(get_default_zoom_level): New bottleneck function for getting
	the default zoom level for list view. Currently returns a
	constant; later will return a preferences value.
	(fm_list_view_initialize),
	(fm_list_view_restore_default_zoom_level),
	(fm_list_view_begin_loading), (fm_list_view_set_zoom_level):
	Use get_default_zoom_level. Also get rid of code that was 
	saving the current zoom level to use as default next time.


	Other stuff
	
	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize): Removed some unnecessary
	extra invisible widgets. I was trying to get the window size
	to pin sensibly but have not (yet) actually gotten that to work.

2001-04-04  Ramiro Estrugo  <ramiro@eazel.com>

	* configure.in:
	Remove athenaclist cut-n-paste code.
	
	* cut-n-paste-code/widgets/Makefile.am:
	* cut-n-paste-code/widgets/athenaclist/.cvsignore:
	* cut-n-paste-code/widgets/athenaclist/Makefile.am:
	* cut-n-paste-code/widgets/athenaclist/athenaclist.c:
	* cut-n-paste-code/widgets/athenaclist/athenaclist.h:
	Remove athenaclist cut-n-paste code.

	* libathena-extensions/athena-file-dnd.h:
	* libathena-extensions/athena-file-dnd.c:
	New file with Drag and Drop code that operated on AthenaFile
	objects.
	
	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-list-column-title.c:
	* libathena-extensions/athena-list-column-title.h:
	* libathena-extensions/athena-list.c:
	* libathena-extensions/athena-list.h:
	* libathena-extensions/athena-ctree.c:
	* libathena-extensions/athena-ctree.h:
	* libathena-extensions/athena-drag.c:
	* libathena-extensions/athena-drag.h:
	Move these widget into eel.
	
	* libathena-extensions/athena-icon-dnd.h:
	* libathena-extensions/athena-icon-dnd.c:
	Update for eel dnd code move.
	
	* athena-installer/install-lib/Makefile.am:
	* athena-installer/libtrilobite/Makefile.am:
	Remove some voodoo that was needed for cut-n-paste code in
	trilobite that no longer is among us.
	
	* components/help/hyperbola-nav-tree.c:
	* components/music/athena-music-view.c:
	* components/rpmview/athena-rpm-verify-window.c:
	* components/rpmview/athena-rpm-view-private.h:
	* components/rpmview/athena-rpm-view.c:
	* components/tree/athena-tree-view-dnd.c:
	* components/tree/athena-tree-view-dnd.h:
	* components/tree/athena-tree-view-private.h:
	* components/tree/athena-tree-view.c:
	* src/file-manager/fm-directory-view.c:
	* src/file-manager/fm-list-view.c: (fm_list_view_initialize),
	* src/athena-sidebar.c:
	Update for clist, ctree, list and dnd code that now lives in eel.
	Also do more #include cleanup.
	
2001-04-04  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/Makefile.am:
	* components/mozilla/athena-mozilla-content-view.c:
	* components/services/clone/Makefile.am:
	* components/services/install-view/Makefile.am:
	* components/services/install/command-line/Makefile.am:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_query):
	* components/services/install/server/Makefile.am:
	* components/services/inventory-view/Makefile.am:
	* components/services/inventory/Makefile.am:
	* components/services/login/athena-view/Makefile.am:
	* components/services/login/athena-view/athena-change-password-view.c:
	* components/services/athena-dependent-shared/Makefile.am:
	* components/services/athena-dependent-shared/eazel-services-footer.c:
	* components/services/athena-dependent-shared/eazel-services-header.c:
	* components/services/summary/Makefile.am:
	* components/services/summary/eazel-summary-shared.c:
	(eazel_summary_fetch_data_async),
	(eazel_summary_fetch_data_cancel):
	* components/services/summary/main.c: (main):
	* components/services/summary/athena-summary-callbacks.c:
	* components/services/summary/athena-summary-callbacks.h:
	* components/services/summary/athena-summary-dialogs.c:
	* components/services/summary/athena-summary-footer.c:
	* components/services/summary/athena-summary-menu-items.c:
	* components/services/summary/athena-summary-menu-items.h:
	* components/services/summary/athena-summary-view.c:
	* components/services/time/athena-view/Makefile.am:
	* components/services/trilobite/libtrilobite/Makefile.am:
	* components/services/trilobite/libtrilobite/trilobite-core-network.c:
	(trilobite_open_uri):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c:
	(trilobite_get_config_dir_string):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.h:
	* components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_redirect_fetch_table_async),
	(trilobite_redirect_fetch_table_cancel):
	* components/services/trilobite/sample/command-line/Makefile.am:
	* components/services/trilobite/sample/athena-view/Makefile.am:
	* components/services/trilobite/sample/service/Makefile.am:
	* components/services/trilobite/utils/Makefile.am:
	Lots of components cleanup.  Remove many unused #includes.
	Replace cut-n-paste code with eel.  Fix Makefiles to link only the
	stuff that is needed.  This is an effort to minimize the
	dependence on libathena-extensions.  Theres a few dependencies
	left to go.
		
	* components/services/trilobite/libtrilobite/trilobite-file-utilities.c:
	* components/services/trilobite/libtrilobite/trilobite-file-utilities.h:
	Retire this cut-n-paste code.  Use the vfs extensions from eel
	instead.
	
2001-04-04  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-file-utilities.c:
	* libathena-extensions/athena-file-utilities.h:
	Move vfs extensions to eel.
	
	* components/services/install-view/athena-service-install-view.c:
	* components/services/install/server/main.c:
	* components/services/inventory/eazel-inventory-collect-hardware.c:
	(add_info):
	* components/services/inventory/eazel-inventory-service.c:
	(impl_Trilobite_Eazel_Inventory_upload):
	* components/text/athena-text-view.c: (handle_service_menu_item):
	* components/tree/athena-tree-view.c: (select_current_location),
	(tree_load_location_callback), (got_activation_uri_callback):
	* libathena-extensions/athena-bookmark.c:
	(athena_bookmark_compare_with), (athena_bookmark_compare_uris),
	(bookmark_file_changed_callback):
	* libathena-extensions/athena-directory-async.c:
	(top_left_cancel), (activation_uri_cancel), (top_left_start),
	(activation_uri_start):
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory.c:
	(athena_directory_make_uri_canonical), (athena_directory_new),
	(athena_directory_notify_files_moved),
	(athena_self_check_directory):
	* libathena-extensions/athena-drag.c:
	(athena_drag_items_in_trash),
	(athena_drag_default_drop_action_for_icons):
	* libathena-extensions/athena-file-operations.c:
	(format_and_ellipsize_uri_for_dialog),
	(athena_file_operations_copy_move):
	* libathena-extensions/athena-file.c:
	(athena_file_get_internal),
	(athena_file_get_parent_uri_for_display),
	(athena_file_can_rename), (athena_file_get_uri_scheme),
	(athena_file_is_in_trash), (athena_self_check_file):
	* libathena-extensions/athena-icon-dnd.c:
	(athena_icon_container_selection_items_local):
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_name_for_file),
	(athena_icon_factory_get_emblem_icons_for_file):
	* libathena-extensions/athena-link.c:
	(athena_link_local_get_image_uri):
	* libathena-extensions/athena-metafile.c:
	(construct_private_metafile_vfs_uri), (metafile_read_cancel),
	(metafile_read_restart):
	* libathena-extensions/athena-tabs.c:
	* libathena-extensions/athena-theme.c:
	* libathena-extensions/athena-thumbnails.c:
	(make_thumbnail_uri):
	* libathena-extensions/athena-trash-file.c:
	(athena_trash_file_initialize):
	* libathena-extensions/athena-trash-monitor.c:
	(athena_trash_files_changed_callback),
	(athena_trash_monitor_initialize):
	* src/file-manager/fm-desktop-icon-view.c:
	(update_trash_link_and_delete_copies):
	* src/file-manager/fm-directory-view.c: (show_trash_callback),
	(trash_or_delete_files_common),
	(fm_directory_view_trash_or_delete_files),
	(fm_directory_view_move_copy_items):
	* src/file-manager/fm-properties-window.c:
	(is_merged_trash_directory):
	* src/athena-application.c:
	(athena_make_uri_list_from_shell_strv):
	* src/athena-first-time-druid.c: (read_file_handle_cancel_cover),
	(initiate_file_download):
	* src/athena-location-bar.c: (try_to_expand_path),
	(athena_location_bar_set_location),
	(athena_location_bar_get_location),
	(athena_location_bar_update_label):
	* src/athena-profiler.c:
	(athena_profiler_bonobo_ui_report_callback):
	* src/athena-property-browser.c: (add_pattern_to_browser),
	(emblem_dialog_clicked):
	* src/athena-sidebar.c: (receive_dropped_uri_list):
	* src/athena-theme-selector.c: (add_theme_to_icons):
	* src/athena-window-manage-views.c: (set_displayed_location),
	(check_bookmark_location_matches), (handle_go_elsewhere),
	(viewed_file_changed_callback), (determined_initial_view_callback),
	(open_location_prefer_existing_window_callback),
	(report_redirect_callback):
	* src/athena-window-menus.c: (show_bogus_bookmark_window):
	Update for vfs extensions move to eel.  Also cleanup the #include
	state of some of these files.  Removed unused #includes.  Remove
	some cut-n-paste code in services components and use the
	extensions in eel directly.
	
2001-04-04  Ramiro Estrugo  <ramiro@eazel.com>

	* README:
	Add new librsvg and eel dependency entries.

	* applets/launcher/Makefile.am:
	* applets/preferences-applet/Makefile.am:
	Add eel library to make it link properly.

2001-04-04  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/Makefile.am:
	Add missing header file.
	
2001-04-03  Darin Adler  <darin@eazel.com>

	* components/notes/athena-notes.c: (do_destroy),
	(notes_get_indicator_image), (make_notes_view), (main):
	Use athena_view_standard_main to simplify and remove code.

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_populate_pane): Code had N_() wrapped around
	an empty string. That's a no-no. Calling _("") on empty string
	gives you the complete translator info, which must be avoided.

2001-04-03  Ramiro Estrugo  <ramiro@eazel.com>

	* Makefile.am:
	Remove librsvg.

	* librsvg/.cvsignore:
	* librsvg/Makefile.am:
	* librsvg/art_render.c:
	* librsvg/art_render.h:
	* librsvg/art_render_gradient.c:
	* librsvg/art_render_gradient.h:
	* librsvg/art_render_mask.c:
	* librsvg/art_render_mask.h:
	* librsvg/art_render_svp.c:
	* librsvg/art_render_svp.h:
	* librsvg/art_rgba.c:
	* librsvg/art_rgba.h:
	* librsvg/example-nested-transform.svg:
	* librsvg/makefile-simple:
	* librsvg/opacity.svg:
	* librsvg/rsvg-bpath-util.c:
	* librsvg/rsvg-bpath-util.h:
	* librsvg/rsvg-css.c:
	* librsvg/rsvg-css.h:
	* librsvg/rsvg-defs.c:
	* librsvg/rsvg-defs.h:
	* librsvg/rsvg-ft.c:
	* librsvg/rsvg-ft.h:
	* librsvg/rsvg-paint-server.c:
	* librsvg/rsvg-paint-server.h:
	* librsvg/rsvg-path.c:
	* librsvg/rsvg-path.h:
	* librsvg/rsvg.c:
	* librsvg/rsvg.h:
	* librsvg/subpixel-text-test:
	* librsvg/test-ft-gtk.c:
	* librsvg/test-ft.c:
	* librsvg/test-rsvg.c:
	* librsvg/test.svg:
	Move librsvg to its own top level GNOME CVS module.

	* configure.in:
	Add librsvg and eel dependencies.
	Remove librsvg and font entries.

	* athena.spec.in:
	Remove font entries.  Add librsvg and eel requirements.
	
	* data/Makefile.am:
	* data/fonts/.cvsignore:
	* data/fonts/Makefile.am:
	* data/fonts/urw/.cvsignore:
	* data/fonts/urw/Makefile.am:
	* data/fonts/urw/README:
	* data/fonts/urw/fonts.dir:
	* data/fonts/urw/n019003l.afm:
	* data/fonts/urw/n019003l.pfb:
	* data/fonts/urw/n019003l.pfm:
	* data/fonts/urw/n019004l.afm:
	* data/fonts/urw/n019004l.pfb:
	* data/fonts/urw/n019004l.pfm:
	* data/fonts/urw/n019023l.afm:
	* data/fonts/urw/n019023l.pfb:
	* data/fonts/urw/n019023l.pfm:
	* data/fonts/urw/n019024l.afm:
	* data/fonts/urw/n019024l.pfb:
	* data/fonts/urw/n019024l.pfm:
	Retire default fonts.  These now live in eel.

	* libathena/athena-undo-transaction.c:
	(athena_undo_transaction_destroy):
	* libathena/athena-view.c: (athena_view_destroy):
	Update for eel changes.  Use eel-gtk-macros.
	
	* athena-installer/src/athena-druid-page-eazel.c:
	(athena_druid_page_eazel_destroy),
	(athena_druid_page_eazel_finalize),
	(athena_druid_page_eazel_size_allocate),
	(athena_druid_page_eazel_size_request):
	Update for eel changes.  Use eel-gtk-macros.

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-bonobo-extensions.c:
	* libathena-extensions/athena-bonobo-extensions.h:
	* libathena-extensions/athena-bookmark.c:
	* libathena-extensions/athena-ctree.c:
	* libathena-extensions/athena-customization-data.c:
	* libathena-extensions/athena-dateedit-extensions.c:
	* libathena-extensions/athena-dateedit-extensions.h:
	* libathena-extensions/athena-directory-async.c:
	* libathena-extensions/athena-directory-background.c:
	* libathena-extensions/athena-directory-background.h:
	* libathena-extensions/athena-directory-metafile-monitor.c:
	* libathena-extensions/athena-directory-metafile.c:
	* libathena-extensions/athena-directory.c:
	* libathena-extensions/athena-drag-window.c:
	* libathena-extensions/athena-drag.c:
	* libathena-extensions/athena-druid-page-eazel.c:
	* libathena-extensions/athena-druid.c:
	* libathena-extensions/athena-entry.c:
	* libathena-extensions/athena-file-changes-queue.c:
	* libathena-extensions/athena-file-operations-progress.c:
	* libathena-extensions/athena-file-operations.c:
	* libathena-extensions/athena-file-private.h:
	* libathena-extensions/athena-file-utilities.c:
	* libathena-extensions/athena-file.c:
	* libathena-extensions/athena-font-factory.c:
	* libathena-extensions/athena-gconf-extensions.c:
	* libathena-extensions/athena-generous-bin.c:
	* libathena-extensions/athena-global-preferences.c:
	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-horizontal-splitter.c:
	* libathena-extensions/athena-icon-canvas-item.c:
	* libathena-extensions/athena-icon-canvas-item.h:
	* libathena-extensions/athena-icon-container.c:
	* libathena-extensions/athena-icon-container.h:
	* libathena-extensions/athena-icon-dnd.c:
	* libathena-extensions/athena-icon-factory.c:
	* libathena-extensions/athena-icon-factory.h:
	* libathena-extensions/athena-icon-private.h:
	* libathena-extensions/athena-icon-text-item.c:
	* libathena-extensions/athena-keep-last-vertical-box.c:
	* libathena-extensions/athena-lib-self-check-functions.c:
	* libathena-extensions/athena-lib-self-check-functions.h:
	* libathena-extensions/athena-link-set.c:
	* libathena-extensions/athena-link.c:
	* libathena-extensions/athena-list-column-title.c:
	* libathena-extensions/athena-list.c:
	* libathena-extensions/athena-medusa-support.c:
	* libathena-extensions/athena-merged-directory.c:
	* libathena-extensions/athena-metafile-factory.c:
	* libathena-extensions/athena-metafile.c:
	* libathena-extensions/athena-mime-actions.c:
	* libathena-extensions/athena-preferences-box.c:
	* libathena-extensions/athena-preferences-dialog.c:
	* libathena-extensions/athena-preferences-group.c:
	* libathena-extensions/athena-preferences-item.c:
	* libathena-extensions/athena-preferences-pane.c:
	* libathena-extensions/athena-preferences.c:
	* libathena-extensions/athena-preferences.h:
	* libathena-extensions/athena-program-chooser.c:
	* libathena-extensions/athena-program-choosing.c:
	* libathena-extensions/athena-program-choosing.h:
	* libathena-extensions/athena-search-uri.c:
	* libathena-extensions/athena-sidebar-functions.c:
	* libathena-extensions/athena-tabs.c:
	* libathena-extensions/athena-theme.c:
	* libathena-extensions/athena-thumbnails.c:
	* libathena-extensions/athena-trash-directory.c:
	* libathena-extensions/athena-trash-file.c:
	* libathena-extensions/athena-trash-monitor.c:
	* libathena-extensions/athena-undo-context.c:
	* libathena-extensions/athena-undo-manager.c:
	* libathena-extensions/athena-undo-signal-handlers.c:
	* libathena-extensions/athena-vfs-directory.c:
	* libathena-extensions/athena-vfs-file.c:
	* libathena-extensions/athena-view-identifier.c:
	* libathena-extensions/athena-volume-monitor.c:
	Use new eel library.

	* libathena-extensions/athena-art-extensions.c:
	* libathena-extensions/athena-art-extensions.h:
	* libathena-extensions/athena-art-gtk-extensions.c:
	* libathena-extensions/athena-art-gtk-extensions.h:
	* libathena-extensions/athena-background-canvas-group.c:
	* libathena-extensions/athena-background-canvas-group.h:
	* libathena-extensions/athena-background.c:
	* libathena-extensions/athena-background.h:
	* libathena-extensions/athena-caption-table.c:
	* libathena-extensions/athena-caption-table.h:
	* libathena-extensions/athena-caption.c:
	* libathena-extensions/athena-caption.h:
	* libathena-extensions/athena-clickable-image.c:
	* libathena-extensions/athena-clickable-image.h:
	* libathena-extensions/athena-debug-drawing.c:
	* libathena-extensions/athena-debug-drawing.h:
	* libathena-extensions/athena-debug.c:
	* libathena-extensions/athena-debug.h:
	* libathena-extensions/athena-ellipsizing-label.c:
	* libathena-extensions/athena-ellipsizing-label.h:
	* libathena-extensions/athena-enumeration.c:
	* libathena-extensions/athena-enumeration.h:
	* libathena-extensions/athena-font-manager.c:
	* libathena-extensions/athena-font-manager.h:
	* libathena-extensions/athena-font-picker.c:
	* libathena-extensions/athena-font-picker.h:
	* libathena-extensions/athena-gdk-extensions.c:
	* libathena-extensions/athena-gdk-extensions.h:
	* libathena-extensions/athena-gdk-font-extensions.c:
	* libathena-extensions/athena-gdk-font-extensions.h:
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	* libathena-extensions/athena-gdk-pixbuf-extensions.h:
	* libathena-extensions/athena-glib-extensions.c:
	* libathena-extensions/athena-glib-extensions.h:
	* libathena-extensions/athena-glyph.c:
	* libathena-extensions/athena-glyph.h:
	* libathena-extensions/athena-gnome-extensions.c:
	* libathena-extensions/athena-gnome-extensions.h:
	* libathena-extensions/athena-graphic-effects.c:
	* libathena-extensions/athena-graphic-effects.h:
	* libathena-extensions/athena-gtk-extensions.c:
	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-macros.h:
	* libathena-extensions/athena-image-table.c:
	* libathena-extensions/athena-image-table.h:
	* libathena-extensions/athena-image-with-background.c:
	* libathena-extensions/athena-image-with-background.h:
	* libathena-extensions/athena-image.c:
	* libathena-extensions/athena-image.h:
	* libathena-extensions/athena-label-with-background.c:
	* libathena-extensions/athena-label-with-background.h:
	* libathena-extensions/athena-label.c:
	* libathena-extensions/athena-label.h:
	* libathena-extensions/athena-labeled-image.c:
	* libathena-extensions/athena-labeled-image.h:
	* libathena-extensions/athena-lib-self-check-functions.c:
	* libathena-extensions/athena-lib-self-check-functions.h:
	* libathena-extensions/athena-password-dialog.c:
	* libathena-extensions/athena-password-dialog.h:
	* libathena-extensions/athena-radio-button-group.c:
	* libathena-extensions/athena-radio-button-group.h:
	* libathena-extensions/athena-region.c:
	* libathena-extensions/athena-region.h:
	* libathena-extensions/athena-scalable-font-private.h:
	* libathena-extensions/athena-scalable-font.c:
	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-self-checks.c:
	* libathena-extensions/athena-self-checks.h:
	* libathena-extensions/athena-smooth-text-layout-cache.c:
	* libathena-extensions/athena-smooth-text-layout-cache.h:
	* libathena-extensions/athena-smooth-text-layout.c:
	* libathena-extensions/athena-smooth-text-layout.h:
	* libathena-extensions/athena-smooth-widget.c:
	* libathena-extensions/athena-smooth-widget.h:
	* libathena-extensions/athena-stock-dialogs.c:
	* libathena-extensions/athena-stock-dialogs.h:
	* libathena-extensions/athena-string-list.c:
	* libathena-extensions/athena-string-list.h:
	* libathena-extensions/athena-string-map.c:
	* libathena-extensions/athena-string-map.h:
	* libathena-extensions/athena-string-picker.c:
	* libathena-extensions/athena-string-picker.h:
	* libathena-extensions/athena-string.c:
	* libathena-extensions/athena-string.h:
	* libathena-extensions/athena-text-caption.c:
	* libathena-extensions/athena-text-caption.h:
	* libathena-extensions/athena-viewport.c:
	* libathena-extensions/athena-viewport.h:
	* libathena-extensions/athena-wrap-table.c:
	* libathena-extensions/athena-wrap-table.h:
	* libathena-extensions/athena-xml-extensions.c:
	* libathena-extensions/athena-xml-extensions.h:
	Remove these files.  These are all part of eel now.
	
	* applets/launcher/athena-launcher-applet.c:
	* applets/preferences-applet/athena-preferences-applet.c:
	* components/adapter/Makefile.am:
	* components/adapter/main.c:
	* components/adapter/athena-adapter-control-embed-strategy.c:
	* components/adapter/athena-adapter-embed-strategy.c:
	* components/adapter/athena-adapter-embeddable-embed-strategy.c:
	* components/adapter/athena-adapter-factory-server.c:
	* components/adapter/athena-adapter-file-load-strategy.c:
	* components/adapter/athena-adapter-load-strategy.c:
	* components/adapter/athena-adapter-progressive-load-strategy.c:
	* components/adapter/athena-adapter-stream-load-strategy.c:
	* components/adapter/athena-adapter.c:
	* components/hardware/Makefile.am:
	* components/hardware/athena-hardware-view.c:
	* components/help/Makefile.am:
	* components/help/help-method.c:
	* components/help/hyperbola-filefmt.c:
	* components/help/hyperbola-nav-tree.c:
	* components/history/Makefile.am:
	* components/history/athena-history-view.c:
	* components/image-viewer/Makefile.am:
	* components/image-viewer/athena-image-view.c:
	* components/loser/content/Makefile.am:
	* components/loser/content/athena-content-loser.c:
	* components/loser/sidebar/Makefile.am:
	* components/loser/sidebar/athena-sidebar-loser.c:
	* components/mozilla/Makefile.am:
	* components/mozilla/bonobo-extensions.c:
	* components/mozilla/athena-mozilla-content-view.c:
	* components/music/Makefile.am:
	* components/music/athena-music-view.c:
	* components/notes/Makefile.am:
	* components/notes/athena-notes.c:
	* components/rpmview/Makefile.am:
	* components/rpmview/athena-rpm-verify-window.c:
	* components/rpmview/athena-rpm-view-install.c:
	* components/rpmview/athena-rpm-view.c:
	* components/sample/athena-sample-content-view.c:
	* components/services/install-view/Makefile.am:
	* components/services/install-view/callbacks.c:
	* components/services/install-view/forms.c:
	* components/services/install-view/athena-service-install-view.c:
	* components/services/install/lib/eazel-install-logic2.c:
	* components/services/install/server/main.c:
	* components/services/inventory-view/Makefile.am:
	* components/services/inventory-view/athena-inventory-config-page
	.c:
	* components/services/inventory-view/athena-inventory-disable-pag
	* components/services/inventory-view/athena-inventory-enable-page
	* components/services/inventory-view/athena-inventory-view.c:
	* components/services/inventory/Makefile.am:
	* components/services/inventory/eazel-inventory-upload-callback.c:
	* components/services/inventory/eazel-inventory.c:
	* components/services/inventory/main.c:
	* components/services/login/athena-view/Makefile.am:
	* components/services/login/athena-view/athena-change-password-
	view.c:
	* components/services/login/athena-view/password-box.c:
	* components/services/athena-dependent-shared/Makefile.am:
	* components/services/athena-dependent-shared/eazel-services-exte
	nsions.c:
	* components/services/athena-dependent-shared/eazel-services-exte
	nsions.h:
	* components/services/athena-dependent-shared/eazel-services-foot
	er.c:
	* components/services/athena-dependent-shared/eazel-services-head
	er.c:
	* components/services/athena-dependent-shared/test-footer-header.
	c:
	* components/services/summary/Makefile.am:
	* components/services/summary/athena-summary-callbacks.c:
	* components/services/summary/athena-summary-dialogs.c:
	* components/services/summary/athena-summary-dialogs.h:
	* components/services/summary/athena-summary-footer.c:
	* components/services/summary/athena-summary-menu-items.c:
	* components/services/summary/athena-summary-view-private.h:
	* components/services/summary/athena-summary-view.c:
	* components/services/time/athena-view/main.c:
	* components/services/time/athena-view/trilobite-eazel-time-view.
	c:
	* components/services/trilobite/sample/athena-view/Makefile.am:
	* components/text/Makefile.am:
	* components/text/athena-text-view.c:
	* components/throbber/Makefile.am:
	* components/throbber/main.c:
	* components/throbber/athena-throbber.c:
	* components/tree/Makefile.am:
	* components/tree/athena-tree-change-queue.c:
	* components/tree/athena-tree-expansion-state.c:
	* components/tree/athena-tree-model.c:
	* components/tree/athena-tree-node.c:
	* components/tree/athena-tree-view-dnd.c:
	* components/tree/athena-tree-view.c:
	* helper-utilities/authenticate/Makefile.am:
	* helper-utilities/authenticate/athena-authenticate.c:
	* athena-installer/src/athena-druid.c:
	* src/Makefile.am:
	* src/file-manager/fm-desktop-icon-view.c:
	* src/file-manager/fm-directory-view.c:
	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-error-reporting.c:
	* src/file-manager/fm-icon-text-window.c:
	* src/file-manager/fm-icon-view.c:
	* src/file-manager/fm-list-view.c:
	* src/file-manager/fm-properties-window.c:
	* src/file-manager/fm-search-list-view.c:
	* src/file-manager/athena-indexing-info.c:
	* src/athena-about.c:
	* src/athena-application.c:
	* src/athena-bookmark-list.c:
	* src/athena-bookmark-parsing.c:
	* src/athena-bookmarks-window.c:
	* src/athena-complex-search-bar.c:
	* src/athena-component-adapter-factory.c:
	* src/athena-desktop-window.c:
	* src/athena-first-time-druid.c:
	* src/athena-link-set-window.c:
	* src/athena-location-bar.c:
	* src/athena-main.c:
	* src/athena-navigation-bar.c:
	* src/athena-profiler.c:
	* src/athena-property-browser.c:
	* src/athena-search-bar-criterion.c:
	* src/athena-search-bar.c:
	* src/athena-shell.c:
	* src/athena-sidebar-tabs.c:
	* src/athena-sidebar-title.c:
	* src/athena-sidebar.c:
	* src/athena-signaller.c:
	* src/athena-simple-search-bar.c:
	* src/athena-switchable-navigation-bar.c:
	* src/athena-switchable-search-bar.c:
	* src/athena-theme-selector.c:
	* src/athena-view-frame-corba.c:
	* src/athena-view-frame.c:
	* src/athena-window-manage-views.c:
	* src/athena-window-menus.c:
	* src/athena-window-toolbars.c:
	* src/athena-window.c:
	* src/athena-window.h:
	* src/athena-zoom-control.c:
	Update for new eel library usage.

	* test/test-athena-background.c:
	* test/test-athena-clickable-image.c:
	* test/test-athena-font-manager.c:
	* test/test-athena-font-picker.c:
	* test/test-athena-font-simple.c:
	* test/test-athena-font.c:
	* test/test-athena-glyph-simple.c:
	* test/test-athena-glyph.c:
	* test/test-athena-image-background.c:
	* test/test-athena-image-scrolled.c:
	* test/test-athena-image-simple.c:
	* test/test-athena-image-table.c:
	* test/test-athena-image-tile.c:
	* test/test-athena-image.c:
	* test/test-athena-label-background.c:
	* test/test-athena-label-flavorful.c:
	* test/test-athena-label-offset.c:
	* test/test-athena-label-scrolled.c:
	* test/test-athena-label-simple.c:
	* test/test-athena-label-wrapped.c:
	* test/test-athena-label.c:
	* test/test-athena-labeled-image.c:
	* test/test-athena-password-dialog.c:
	* test/test-athena-pixbuf-tile.c:
	* test/test-athena-smooth-text-layout.c:
	* test/test-athena-viewport-constraint.c:
	* test/test-athena-widgets.c:
	Remove these.  They live in eel now.

	* test/vsignore:
	* test/kefile.am:
	* test/st-athena-preferences-change.c:
	* test/st-athena-preferences-display.c:
	* test/st-athena-wrap-table.c:
	* test/st.c:
	* test/st.h:
	Update for new eel library usage.

2001-04-03  Darin Adler  <darin@eazel.com>

	reviewed by: John Harper <jsh@eazel.com>

	* src/athena-application.c: (update_session): New function,
	reads preferences and updates the session based on whether the
	Athena needs to be kept running to manage the desktop.
	(init_session): Use the new functions and register to update the
	session when the preferences change.

2001-04-03  John Harper  <jsh@eazel.com>

	Fixed part of bug 7823 (Athena window hints make it unusable
	with the IceWM window manager):

	* src/athena-desktop-window.c (realize): don't include
	WIN_STATE_HIDDEN in the desktop window's state hints

	IceWM apparently interprets this bit as meaning `don't display
	the window', despite the GNOME documentation saying that it
	just means `not on taskbar but window visible'

2001-04-03  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 7967 (Tree view uses non-standard colors instead of
	gtk theme colors):

	* libathena-extensions/athena-list.c,
	libathena-extensions/athena-list.h
	(athena_list_set_alternate_row_colors,
	athena_list_set_background_color_offsets): new functions.
	They give some control over how the list background is drawn.
	The offsets function takes two offsets into the GtkStyle
	structure (which should point to GdkColor structures)

	* libathena-extensions/athena-ctree.c
	(athena_ctree_init): call the above two functions with
	suitable values to make the tree look like it used to, before
	being derived from the AthenaList widget

2001-04-03  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena/athena-bonobo-workarounds.c:
	(athena_bonobo_object_force_destroy): Add new version that is
	not vulnerable to the problem of an unref coming in from the other
	process during the destroy phase. This version relies on Bonobo
	internals, so it's a truly evil bit of code, and I should be
	severely punished for even thinking of writing it.
	(athena_bonobo_object_force_destroy_at_idle): Added some more
	checks that I thought would help me in debugging.
	
	* src/athena-shell-ui.xml: Improve wording of tooltip for the Up
	command.

	* components/notes/athena-notes.c: Some code cleanup.

	* src/file-manager/fm-directory-view.c: Fixed a typo.
	
2001-04-03  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* src/athena-window.c: (add_to_history_list):
	Imposed a 50-item limit on the length of the
	history list. Perhaps someday we'll save it to
	disk and organize old items by date, but this
	fixes the immediate problem of the list getting
	unboundedly long.

2001-04-03  John Sullivan  <sullivan@eazel.com>

	* libathena-extensions/athena-ellipsizing-label.c:
	(recompute_ellipsized_text): Made ellipsizing labels
	use middle-truncation, now that it's available (added
	by Pavel recently, yay!).

2001-04-03  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7949 (Athena allows Cut/Copy on icons that
	can't be moved)

	* src/file-manager/fm-directory-view.c: (real_update_menus):
	Fixed up sensitivity logic for Cut/Copy/Paste and a couple
	of related items.

2001-04-03  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_populate_pane): Added missing calls to
	_() so things in the pane are translated.

2001-04-02  Mike Fleming  <mfleming@eazel.com>

	* README:

	Updated README to explain problems with mozilla 0.8.1

2001-04-02  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-gdk-font-extensions.c:
	Remove rogue unused #include.

	* libathena-extensions/athena-text-caption.c:
	Remove rogue unused #include.

2001-04-02  Darin Adler  <darin@eazel.com>

	Make file operations progress dialog always stay up for at least 1
	second total so it doesn't just appear and disappear.
	
	Preparing for a fix to the athena-adapter process leaking when
	Athena is terminated by Ctrl-C, I cleaned up some of the code
	inside the adapter.

	Improved the warning you get when neither /etc/mnttab nor
	/proc/mounts can be opened.

	Fix bug 6888 (when I view a large image, it appears first at 100%,
	then zoomed to fit).

	Re-added part of the code to make components go away when the main
	program that is hosting them goes away. The X-window-based
	solution is not working as well as I had hoped, so I'm re-adding
	the 20-second-timeout-based solution.

	* components/adapter/athena-adapter-embed-strategy.c:
	(athena_adapter_embed_strategy_initialize_class),
	(athena_adapter_embed_strategy_get),
	(athena_adapter_embed_strategy_emit_open_location): Change the
	strategy new functions to use more-normal reference rules. The
	caller no longer expects them to "use up" a reference.
	
	* components/adapter/athena-adapter-control-embed-strategy.c:
	(athena_adapter_control_embed_strategy_destroy),
	(athena_adapter_control_embed_strategy_new): Don't keep a
	reference to the BonoboControl around after creating the frame.
	
	* components/adapter/athena-adapter-embeddable-embed-strategy.c:
	(athena_adapter_embeddable_embed_strategy_destroy),
	(athena_adapter_embeddable_embed_strategy_new): Don't keep a
	reference to the BonoboEmeddable around after creating the frame.
	
	* components/image-viewer/athena-image-view.c: (redraw_control),
	(scrolled_window_size_allocate_callback),
	(control_factory_common), (init_bonobo_image_generic_factory):
	Some name changes, and a fix so that we don't show the image first
	at 100%, and then shrink to fit. The downside is that this might
	be too hard-coded to the current behavior of Athena, but it's
	better than flashing every time you open an image.
	
	* components/services/trilobite/utils/.cvsignore: Ignore some
	files in this new directory.
	
	* libathena-extensions/athena-file-operations-progress.h:
	* libathena-extensions/athena-file-operations-progress.c:
	(athena_file_operations_progress_update), (close_callback),
	(athena_file_operations_progress_destroy), (map_callback),
	(delete_event_callback),
	(athena_file_operations_progress_initialize),
	(athena_file_operations_progress_initialize_class),
	(athena_file_operations_progress_new),
	(athena_file_operations_progress_set_total),
	(athena_file_operations_progress_set_operation_string),
	(athena_file_operations_progress_new_file),
	(athena_file_operations_progress_clear),
	(athena_file_operations_progress_update_sizes),
	(delayed_close_callback), (athena_file_operations_progress_done):
	Did a lot of code cleanups throughout the file, and added a new
	call athena_file_operations_progress_done. Use this instead of
	gtk_object_destroy so that the window can linger long enough for
	the user to see it, if a copy was really fast.
	
	* libathena-extensions/athena-file-operations.c:
	(transfer_info_destroy), (parent_for_error_dialog),
	(create_transfer_dialog), (handle_transfer_ok),
	(handle_transfer_vfs_error): Change to use the new
	athena_file_operations_progress_done call instead of
	gtk_object_destroy when done with the progress dialog.
	
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_update_scroll_region): Fix indentation.
	
	* libathena-extensions/athena-volume-monitor.c:
	(get_current_mount_list): Replace cryptic g_return_if_fail message
	with better-worded g_warning.
	
	* libathena/athena-view.c: (set_frame_callback),
	(widget_destroyed_callback),
	(athena_view_construct_from_bonobo_control): Re-added code to
	monitor the lifetime of the frame and self-destruct when the frame
	goes away. The X-window-based solution wasn't working 100%, and
	this solution does.
	
	* src/athena-sidebar.c: (toggle_sidebar_panel),
	(sidebar_for_each_sidebar_panel): Change object data key to use a
	prefix that includes the word "athena". Tweak code that builds
	the menu so that it always includes any panel that's displayed,
	even if the user level says it shouldn't be there.

2001-04-02  Michael Engber  <engber@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	* libathena-extensions/athena-background-canvas-group.c:
	(athena_background_canvas_group_initialize_common):
	Put back in call to gnome_canvas_set_dither.

2001-04-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	* acconfig.h:
	* configure.in:
	Add a ATHENA_SOURCE_DIRECTORY that contains the location of the
	athena source code, so that some checks can work without having
	to do 'make install'
	
	* components/services/install-view/athena-service-install-view.c:
	(athena_service_install_view_initialize_class):
	Initialize preferences so that smooth widgets and other athena
	specific preferences work.
	
	* components/services/summary/athena-summary-view.c:
	(athena_summary_view_initialize_class):
	Initialize preferences so that smooth widgets and other athena
	specific preferences work.

	* libathena-extensions/Makefile.am:
	Remove macros that arent needed any more.

	* libathena-extensions/athena-entry.h:
	* libathena-extensions/athena-entry.c:
	(athena_entry_initialize), (obscure_cursor),
	(athena_entry_key_press), (athena_entry_motion_notify),
	(athena_entry_set_text), (athena_entry_insert_text),
	(athena_entry_delete_text), (athena_entry_initialize_class),
	(athena_entry_set_special_tab_handling):
	Make all the attributes private.
	
	* libathena-extensions/athena-font-manager.c:
	(at_exit_handler), (athena_free_static_storage_at_exit),
	(gnome_vfs_init_if_needed), (font_description_table_add),
	(font_description_table_new), (directory_contains_file),
	(ensure_local_font_table),
	(athena_font_manager_get_default_font),
	(athena_font_manager_get_default_bold_font),
	(athena_self_check_font_manager):
	Remove dependency on athena-file-utilities.  Update for new
	machanism for finding data in the source directory so that checks
	work even when Athena has not undergone 'make install.'
	
	* libathena-extensions/athena-global-preferences.c:
	(smooth_graphics_mode_changed_callback),
	(athena_global_preferences_initialize):
	Keep track of preferences smooth graphics mode changes and call
	the new smooth widget api for changing the smoothness of all
	tracked widgets.
	
	* libathena-extensions/athena-scalable-font.c:
	Remove a rogue unused #include.
	
	* libathena-extensions/athena-smooth-widget.h:
	* libathena-extensions/athena-smooth-widget.c:
	(athena_smooth_widget_global_set_is_smooth),
	(athena_smooth_widget_register):
	Dont use preferences to track global smoothness changes.  Add a
	function to that instead.

	* src/athena-location-bar.c: (athena_location_bar_initialize):
	Update for privatized AthenaEntry attributes.

2001-04-02  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	Moved the font preferences from the Icon & List Views
	pane into the Appearance pane, and tweaked the wording.
	It was too weird having the font choices in two places.

2001-04-02  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 7918 (Preferences window wider than it needs to be)
	This also fixes the bug where the HTTP Host text field was
	a little shorter than the HTTP Location text field.

	* libathena-extensions/athena-caption.h:
	* libathena-extensions/athena-caption.c:
	(athena_caption_set_extra_spacing): Renamed from
	_set_spacing, since there's a minimum fixed amount
	of spacing that's always used. The bug was that this
	routine was (only) being used to align items by setting the 
	padding of the 2nd item in the box. This sets an equal
	amount of blank space before and after the item, when
	we only want the space before. Fixed by changing it to
	use gtk_box_set_spacing instead.
	(athena_caption_set_child): Don't use the spacing for
	the padding here either.
	
	* libathena-extensions/athena-preferences-item.h:
	* libathena-extensions/athena-preferences-item.c:
	(athena_preferences_item_set_caption_extra_spacing):
	Renamed from _set_caption_spacing for clarity.

	* libathena-extensions/athena-preferences-group.c:
	(preferences_group_align_captions): Updated for name
	change.

2001-04-01  Andy Hertzfeld  <andy@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>
	
	added a way for sidebar views to specify small images that
	are displayed in their tab for notification purposes.  Used
	that to make the notes component indicate if a note is present or
	not.
	
	* components/notes/athena-notes.c: (get_bonobo_properties),
	(set_bonobo_properties), (load_note_text_from_metadata),
	(done_with_file), (notes_load_metainfo),
	(notify_listeners_if_changed), (notes_save_metainfo), (do_destroy),
	(notes_get_indicator_image), (make_notes_view):
	added a property bag to the notes component to provide a tab_image
	property, and made it notify the listeners when the note text
	changes.
	
	* icons/Makefile.am:
	* icons/note-indicator.png:
	new notes indicator image from Arlo.
	
	* src/athena-sidebar-tabs.c: (tab_item_destroy),
	(pixbuf_composite), (draw_one_tab_plain), (draw_one_tab_themed),
	(get_tab_width), (draw_or_layout_all_tabs),
	(athena_sidebar_tabs_expose),
	(athena_sidebar_tabs_update_tab_item), (get_tab_item_from_view),
	(athena_sidebar_tabs_update_all_indicators),
	(athena_sidebar_tabs_update_indicator),
	(tab_indicator_changed_callback),
	(athena_sidebar_tabs_connect_view):
	* src/athena-sidebar-tabs.h:
	made the sidebar tabs hook up to the athena_view's tab_image
	property and use it to display a notification image in the tab
	if necessary.
	
	* src/athena-sidebar.c: (view_loaded_callback),
	(athena_sidebar_add_panel):
	connect the sidebar tabs to a newly added view, once the view
	is loaded.
	
	* src/athena-view-frame.c: (athena_view_frame_get_control):
	* src/athena-view-frame.h:
	added athena_view_frame_get_control so view properties can be
	accessed by the sidebar.
	
2001-03-31  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-sidebar.c: (toggle_sidebar_panel):
	Restore the "dance."  It was needed after all to deal with
	situations when the display become out of whack with the number of
	running sidebar panels, for example when a panel crashes.
	Added a comment to this effect as well.
	
2001-03-31  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-preferences-item.c:
	(athena_preferences_item_set_constrained_integer_values):  When
	the constrained interger values are change, we need to update the
	displayed value as well, otherwise the very first time the
	preferences dialogs shows, the selected entry will be wrong.

	* libathena-extensions/athena-preferences.c:
	(preferences_key_make_for_getter):
	Fix for bug 7939 - preference value not set at Intermediate level
	when defined at Novice and visible at Advanced.
	The problem was that when a preference is not visible and it does
	not have a default for the current user_level, then the default
	value was 0.  The fix was to do is to find the closest
	(lowest) user_level with a good default and use that.
	
2001-03-31  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-sidebar-functions.h:
	* libathena-extensions/athena-sidebar-functions.c:
	(compare_view_identifiers), (sidebar_is_sidebar_panel_enabled),
	(sidebar_is_sidebar_panel_enabled_cover),
	(sidebar_get_sidebar_panel_view_identifiers),
	(athena_sidebar_get_enabled_sidebar_panel_view_identifiers),
	(athena_sidebar_panel_make_preference_key),
	(athena_sidebar_for_each_panel):
	New functions.  Move sidebar and sidebar panel specific code used
	throughout Athena to its own place.
	
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_populate_sidebar_panels_callback),
	(global_preferences_create_sidebar_panels_pane),
	(global_preferences_install_sidebar_panel_defaults):
	Move sidebar and sidebar panel specific code to
	athena-sidebar-functions.[ch].  Simplify sidebar panel creation
	a bit.
	
	* libathena-extensions/athena-global-preferences.h:
	Remove the sidebar panel NAMESPACE as preferences dont support
	namespaces any more.

	* src/athena-sidebar.c: (any_panel_matches_iid): Tiny anal
	renaming.
	(toggle_sidebar_panel): Simplify this function a bit.  The
	previous "dance" that the code was doing was not really
	necessariy.
	(sidebar_for_each_sidebar_panel),
	(sidebar_add_panel_context_menu_items): Simplify a lot by using
	the new sidebar panel iterator.  Remove a bunch of oaf code which
	is handled by the iterator in sidebar-functions.  Also, only
	create the menu items if the preference is visible at the current
	user level.
	(athena_sidebar_get_sidebar_panel_key): Yank this function as it
	is not needed anymore.

	* src/athena-window.c: (athena_window_for_each_sidebar_panel),
	(athena_window_initialize): Keep track of sidebar panel changes
	for each individual panel instead of trying to use the whole
	namespace.  The namespace thing was a broken feature of
	preferences which is no longer supported.
	(update_sidebar_panels_from_preferences): Update for new public
	sidebar functions.

2001-03-31  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-window.c: (athena_window_initialize),
	(athena_window_destroy):
	Fix a bug introduced by my last checkin.  No longer need to remove
	callback for builtin bookmark menu, as this is done
	automatically.  This was causing a preferences critical.
	Also changed the other preference callback to be automatically
	removed.
	
2001-03-31  Ramiro Estrugo  <ramiro@eazel.com>

	* src/athena-window-menus.c:
	(athena_window_initialize_bookmarks_menu): Use _while_alive
	for the preferences callback to avoid potential problem.
	(update_user_level_menu_item), (user_level_changed_callback),
	(athena_window_initialize_menus_part_1):
	Fix bug 6615 - Holding open Preferences menu blocks user-level
	menu item changes.

	The user level menu items where getting out of whack if more that
	1 AthenaWindow existed at the time of a user level change.  The
	fix was to keep track of user level changes and update the menu
	items when needed.  Also a tiny function renaming to make its
	function clearer.
	
2001-03-31  Ramiro Estrugo  <ramiro@eazel.com>

	* configure.in:
	Fix bug 7952 - configure.in reference to mozilla source is wrong.
	Update the Url to reflect reality.

	* README:
	Small tweak to the Mozilla requirements documentation.
	
2001-03-31  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-preferences-box.c:
	(preferences_box_select_pane),
	(preferences_box_category_list_recreate),
	(athena_preferences_box_new),
	(athena_preferences_box_find_pane):
	If the preferences dialog is currently selecting a pane, then make
	sure that pane gets selected again (if visible) after a user level
	change.

	* libathena-extensions/athena-preferences-box.h:
	Small parameter name tweaking.
	
2001-03-31  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-preferences-item.h:
	* libathena-extensions/athena-preferences-item.c:
	(athena_preferences_item_update_showing): New function to update
	the showing state of the item depending on preferences visibility.
	(preferences_item_construct),
	(preferences_item_value_changed_callback),
	(preferences_item_create_enum),
	(preferences_item_update_displayed_value): Make
	update_displayed_value private.  It no longer needs to be called
	by the parent container.  Since preference items now get updated
	by value changed callbacks.

	* libathena-extensions/athena-preferences-group.c:
	(athena_preferences_group_update): No need to update the showing
	state of the items over here.  Simpy call the new preferences item
	function to do this.

	* libathena-extensions/athena-preferences-dialog.c:
	(athena_preferences_dialog_initialize),
	(athena_preferences_dialog_destroy):
	Have the callback automatically removed.  Small style tweaking.

2001-03-30  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_value_changed_callback),
	(preferences_item_create_enum),
	(preferences_item_create_short_enum),
	(preferences_item_create_boolean),
	(preferences_item_create_editable_string),
	(preferences_item_create_editable_integer),
	(preferences_item_create_constrained_integer),
	(preferences_item_create_font),
	(preferences_item_create_smooth_font):
	Add value changed callbacks for the preference associated with
	each item.  In this callback, we update the diplay value of the
	item.  This way, regardless of when and where the preference
	values change, the preferences dialog will always be up to date.
	
2001-03-30  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_update_constrained_integer): Remove a rogue
	printf I left in by accident.
	
2001-03-30  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	Changed from Mike Fleming to hide the proxy authentication
	preferences when the "Use Proxy" preference is FALSE.
	
	* libathena-extensions/athena-preferences-group.c:
	(athena_preferences_group_add_item):
	Change the item packing parameters so that items will be sized to
	their natural sizes.  Otherwise they fill the avaialable space and
	screw up the usage of control preferences to properly hide items
	and have everything update accordingly.
	
	* libathena-extensions/athena-preferences-pane.c:
	(preferences_pane_control_preference_changed_callback):
	Force a queue resize when the pane is updated so that empty space
	resulting from controlled preferences items being hidden will go
	away.
	
2001-03-30  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-enumeration.h:
	* libathena-extensions/athena-enumeration.c:
	(athena_enumeration_new_from_tokens),
	(athena_enumeration_get_entry_position),
	(athena_enumeration_get_value_position),
	(athena_enumeration_get_entries),
	(athena_self_check_enumeration):
	New functions to make this data structure more useful and easier
	to use.  Also added self checks.
	
	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_destroy),
	(preferences_item_update_constrained_integer),
	(constrained_integer_changed_callback),
	(athena_preferences_item_set_constrained_integer_values):
	Use a AthenaEnumeration instead of maintaing 2 lists of entries
	and values ourselves.  Makes this code a little bit simpler.
	
2001-03-30  Michael Engber  <engber@eazel.com>

	* components/notes/athena-notes.c: (notes_save_metainfo):
	update saved copy of notes when writing metadata

2001-03-30  Michael Engber  <engber@eazel.com>

	* components/notes/athena-notes.c:
	(load_note_text_from_metadata):
	fix leak

2001-03-30  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: John Sullivan  <sullivan@eazel.com>

	Part of bug 4832

	Added preferences for HTTP proxy username/password.

	Really, this is sub-optimal:

	o The first-time druid still doesn't have UI for this
	o The password is presented and stored in the clear (? does this matter?
	  It's transmitted in the clear, too)
	o If the user is using an HTTP proxy that requires authentication, but
	  have not filled out the username/password correctly, they get an
	  "Access Denied" dialog
	o There's no way to tell embedded mozilla about this (bug 74171), so
	  embedded mozilla prompts the user again for the password

	* libathena-extensions/athena-global-preferences.c:
	* libathena-extensions/athena-global-preferences.h:

2001-03-30  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Mike Fleming  <mfleming@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_create_dialog),
	(global_preferences_populate_pane):
	No need to explicitly add pane update callbacks for control
	preference.  These happen automatically as needed now.
	
	* libathena-extensions/athena-preferences-pane.h:
	* libathena-extensions/athena-preferences-pane.c:
	(athena_preferences_pane_destroy),
	(athena_preferences_pane_find_group),
	(preferences_pane_control_preference_changed_callback),
	(athena_preferences_pane_add_control_preference):
	New function to add control preferences to the pane.  For each
	unique control preference, a callback will be added to update the
	pane so that control actions (such as hiding or showing items) can
	take place as needed.
	
2001-03-30  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Sullivan  <sullivan@eazel.com>

	* components/text/athena-text-view.c: (merge_bonobo_menu_items):
	Add a FIXME for a bug.
	
	* libathena-extensions/athena-gconf-extensions.h:
	* libathena-extensions/athena-gconf-extensions.c:
	(athena_gconf_get_value), (athena_gconf_value_is_equal),
	(athena_gconf_value_free): New convenience functions for using
	GConf values directly.

	* libathena-extensions/athena-gdk-font-extensions.c:
	Remove a FIXME for a bug i fixed recently.
	
	* libathena-extensions/athena-preferences.c:
	(preferences_callback_entry_invoke_function),
	(preferences_entry_invoke_callbacks_if_needed),
	(preferences_something_changed_notice),
	(preferences_global_table_check_changes_function),
	(preferences_entry_update_cached_value),
	(preferences_entry_ensure_gconf_connection),
	(preferences_callback_entry_free_func), (preferences_entry_free),
	(preferences_global_table_insert):
	Fix bug 5875 - Preference callbacks should only trigger when
	values change.
	The problem was twofold.  First, when the user level changed, we
	would invoke all callbacks regardless of whether the value had
	changed or not.  Second, when a GConf value changed notice
	triggered, we would invoke the corresponding Athena preference
	callback regardless of whether the value according to Athena
	changed or not.
	The fact that Athena preferences have a visibility attribute
	means that even if the GConf value changes, they may have a
	different value (a default due to high visibility for example)
	
2001-03-30  John Sullivan  <sullivan@eazel.com>

	* libathena-extensions/athena-preferences.c:
	(update_auto_integer_or_boolean): Removed bogus return_if_fail.
	
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_initialize_class): Set up auto-storage
	variable for click policy preference.
	(button_press_event): Use auto-storage variable instead of
	calling athena_preferences_get.
	
	* src/file-manager/fm-directory-view.c: 
	(fm_directory_view_initialize_class): Set up auto-storage variables
	for three preferences checked elsewhere in this class.
	(open_alternate_callback), (open_location), (confirm_delete_directly),
	(confirm_delete_from_trash), (fm_directory_view_activate_files): 
	Use auto-storage variables instead of calling athena_preferences_get.
	(confirm_trash_changed_callback), (enable_delete_changed_callback):
	Removed these functions.
	(real_update_menus): Removed code setting up callbacks to update
	static variables when the preference changed. The auto-storage
	variables have the same effect with much less code.
	
2001-03-30  Michael Engber  <engber@eazel.com>

	* components/notes/athena-notes.c:
	(load_note_text_from_metadata), (done_with_file),
	(notes_load_metainfo), (notes_save_metainfo):
	Ensure notes have actually changed, by comparing to a
	copy of the old value, before responding to change signals.

2001-03-30  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: the toad that lives under my table

	* components/services/trilobite/Makefile.am:
	Build utils/
	
	* components/services/trilobite/helper/eazel-helper.c: (main):
	Added ability to launch a start-medusa script.
	
	* components/services/trilobite/libtrilobite/trilobite-root-helper.h:
	* components/services/trilobite/libtrilobite/trilobite-root-helper.c:
	(trilobite_root_helper_run):
	Added a enum for a start-medusa command.
	
	* components/services/trilobite/utils/Makefile.am:
	* components/services/trilobite/utils/eazel-helper-test.c:
	(get_password_dude), (main):
	Added a program to test root helper, for educational reasons
	mostly.
	
	* configure.in:
	Added components/services/trilobite/utils/Makefile

2001-03-30  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7913 (fm_get_text_attribute_names_preference
	should cache preference value for speed)

	Fixed bug 7914 (athena_icon_canvas_item_initialize
	should cache smooth_font for speed)

	Added a new way to stay up-to-date with the value of a
	preference: you register a (typically global) variable
	with a particular preference, and the preferences machinery
	updates its value automatically whenever the preference
	changes. This is a replacement for using 
	athena_preferences_get (and _get_integer and _get_boolean)
	repeatedly, and is much more efficient. We might eventually 
	replace all the callers of _get_xxx with calls to this, and 
	remove those calls entirely.

	I deployed this in the two specific cases Pavel found with
	profiling (bugs 7913 & 7914) and some more places. I'll
	deploy it in more places still later.

	* libathena-extensions/athena-preferences.h:
	* libathena-extensions/athena-preferences.c:
	(update_auto_string), (update_auto_integer_or_boolean): 
	New helper functions to	update an individual auto-storage variable.
	(preferences_entry_update_auto_storage): New function, updates
	all auto-storage variables for a particular preference.
	(preferences_something_changed_notice): update auto-storage variables
	before calling callbacks.
	(preferences_entry_ensure_gconf_connection): New function, extracted
	from preferences_entry_add_callback.
	(preferences_entry_add_callback): Now calls extracted function.
	(preferences_entry_add_auto_storage): New function, adds a single
	auto-storage variable for a given preference.
	(preferences_entry_check_remove_connection): New function, extracted
	from preferences_entry_remove_callback.
	(preferences_entry_remove_callback): Now calls extracted function.
	(preferences_entry_remove_auto_storage): New function, removes a single
	auto-storage variable for a given preference.
	(preferences_entry_free): Free the auto-storage list.
	(athena_preferences_add_auto_string),
	(athena_preferences_add_auto_integer),
	(athena_preferences_add_auto_boolean),
	(athena_preferences_remove_auto_string),
	(athena_preferences_remove_auto_integer),
	(athena_preferences_remove_auto_boolean): Public cover functions
	for the three basic types of auto-storage variables.
	(athena_preferences_remove_callback): Fixed small bug where this
	function would unnecessarily add an entry before removing it.
	
	* libathena-extensions/athena-font-factory.c:
	(athena_font_factory_get_font_from_preferences):
	Reworked to use auto-storage variable.

	* libathena-extensions/athena-global-preferences.c:
	(athena_global_preferences_initialize): Set up auto-storage
	variables for icon view & default smooth font preferences.
	(global_preferences_get_smooth_font),
	(global_preferences_get_smooth_bold_font): Changed to take
	font file name instead of preferences name.
	(athena_global_preferences_get_icon_view_smooth_font),
	(athena_global_preferences_get_default_smooth_font),
	(athena_global_preferences_get_default_smooth_bold_font):
	Use auto-storage variables.

	* libathena-extensions/athena-icon-canvas-item.c:
	(athena_icon_canvas_item_initialize_class): Set up
	auto-storage variable for click policy preference.
	(in_single_click_mode): Use auto-storage variable.

	* libathena-extensions/athena-icon-factory.c:
	(should_display_image_file_as_itself): Use auto-storage
	variable for thumbnail policy.

	* src/file-manager/fm-icon-text-window.c:
	(fm_get_text_attribute_names_preference): Use auto-storage
	variable for icon captions.

	* src/file-manager/fm-icon-view.c: 
	(should_preview_sound): Use auto-storage variable for
	sound-preview preference.
	(fm_icon_view_initialize_class): Set up auto-storage variable
	for sound-preview preference.

2001-03-29  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(sync_transfer_callback): Don't send out notifications in the case
	where we did a no-op move on top of self.
	(athena_file_operations_copy_move): Get rid of code that
	complains about move on top of self, since that's no longer
	considered an error.

	* configure.in: We require the new gnome-vfs now because we need
	the code that handles move to self better.

2001-03-29  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-gdk-font-extensions.c:
	(athena_string_ellipsize_start):
	Rework to only measure one character width at a time when zeroing
	in on the right width.

	* libathena-extensions/athena-gdk-font-extensions.c:
	(athena_string_ellipsize_end),
	(athena_string_ellipsize_middle),
	* libathena-extensions/athena-gdk-font-extensions.h:
	
	Add athena_string_ellipsize_middle and athena_string_ellipsize_end.
	
	* libathena-extensions/athena-gdk-font-extensions.c:
	(athena_self_check_ellipsize),
	(athena_self_check_ellipsize_start),
	(athena_self_check_ellipsize_middle),
	(athena_self_check_ellipsize_end),
	(athena_self_check_gdk_font_extensions):

	Add test cases for the new calls.

2001-03-29  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-background-canvas-group.c:
	Comment out call to gnome_canvas_set_dither because it no
	longer serves a useful purpose and it removes our dependancy
	on using a gnome-libs > 1.2.8 - bug 7922.

	(athena_background_canvas_group_initialize_common):
	* libathena-extensions/athena-background.c:
	(athena_background_destroy):
	* libathena-extensions/athena-background.h:
	* libathena-extensions/athena-directory-background.c:
	(theme_image_path_to_uri),
	(athena_file_background_get_default_settings_for_theme),
	(athena_file_background_get_default_settings),
	(athena_file_background_read_desktop_settings),
	(athena_file_background_write_desktop_settings),
	(athena_file_background_write_desktop_default_settings),
	(athena_file_background_matches_default_settings),
	(athena_file_background_is_set), (background_changed_callback),
	(initialize_background_from_settings):
	* src/athena-sidebar.c: (background_settings_changed_callback),
	(athena_sidebar_update_appearance):
	Remove combine mode from athena-background. It no longer serves
	any purpose (background always draw dithered now) - bug 2190 & 5516.

2001-03-29  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7915 (update_font called repeatedly causes slowdown).

	Fix black line on right side of icon view that I introduced when I
	was doing the cut/copy/paste work.

	* libathena-extensions/athena-label.h:
	* libathena-extensions/athena-label.c:
	(athena_label_set_text): Add a boolean result to tell whether
	the label text was changed for the convenience of callers who want
	to do work only if it changes.
	
	* src/athena-sidebar-title.c: (update_title): Only call
	update_font if the title changed.

	* src/file-manager/fm-directory-view.c: (real_realize): Set
	background to the normal background from the style. Now we see a
	gray background again instead of a black one.
	(fm_directory_view_initialize_class): Set scrollbar_spacing to 0
	since the extra 3 pixels don't do us any good.
	
2001-03-29  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Josh noticed that the special "thumbnail is loading" icon
	was no longer used. Darin and I found the problem.

	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_get_icon_for_file): Store URI rather
	than local path for special "loading" image.

2001-03-29  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7596 (After sidebar panel crashes, right-click menu shows
	wrong state):

	* src/athena-sidebar.c: (get_page_iid): New function, shared by
	old and new code.
	(athena_sidebar_active_panel_matches_id_or_is_damaged): New name,
	uses get_page_iid.
	(athena_sidebar_hide_active_panel_if_matches): Call by new name.
	(any_panel_matches_id): New function.
	(toggle_sidebar_panel): Use presence in the sidebar to decide what
	to do, rather than using the previous setting of the preference.
	(athena_sidebar_add_panel_items): Use the presence of items in
	the sidebar to decide which items get checked, rather than using
	the preference settings.
	(athena_sidebar_add_panel), (athena_sidebar_remove_panel): Get
	rid of erroneous use of _().

2001-03-29  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	At TigerT's suggestion, changed default thumbnail image
	limit from 1 MB to 3 MB to cover the range of most
	current digital cameras.

2001-03-29  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* components/notes/athena-notes.c: (schedule_save_callback),
	(cancel_pending_save), (schedule_save),
	(set_note_text_from_metadata), (done_with_file),
	(notes_save_metainfo), (on_changed), (make_notes_view):
	Notes now saves changes after a timeout instead of waiting
	until focus change - bug 6884.

2001-03-29  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7921 ("Up" should select folder you came from)

	* src/athena-window-manage-views.h:
	* src/athena-window-manage-views.c:
	(athena_window_open_location_with_selection):
	New private-to-athena-window call, just calls
	existing private call open_location with the
	right parameters.
	
	* src/athena-window.c: (athena_window_go_up):
	Set current location as selection when going up.

2001-03-29  John Sullivan  <sullivan@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>

	Fixed bug 3328 (Need a preference to specify upper bounds for
	thumbnailing)

	In Speed Tradeoffs at Advanced level, you can now choose an
	upper bound for image file size that will get thumbnailed.

	* libathena-extensions/athena-global-preferences.c:
	* libathena-extensions/athena-global-preferences.h:
	Add thumbnail limit preference.
	
	* libathena-extensions/athena-icon-factory.c:
	(destroy_icon_factory), (get_icon_factory): Add and
	remove callback for thumbnail-limit preference.
	(thumbnail_limit_changed_callback): Store new value in global
	variable; send icons-changed signal.
	(athena_icon_factory_get_icon_for_file): Use global
	variable instead of constant when determining thumbail limit.
	
	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_update_constrained_integer): Check the
	label strings correctly; this was working for the font size
	menus only because the label strings were just the number
	printf'ed into a string.

2001-03-28  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	A change to reduce the number of orphaned processes when Athena
	is not terminated cleanly. This is an architecture problem, and
	this hack only partly addresses it.

	Add code to AthenaViewFrame, AthenaView, and AthenaThrobber
	to destroy components when the corresponding widgets are
	destroyed.  Since X destroys windows when processes go away, this
	tells us immediately when processes disappear. This does not help
	in the case where Athena happens to die after creating a
	component, but before attaching the widget to its parent.

	This is not a complete solution to the orphaned processes problem
	because of 2 other categories of orphaned processes:
	
	    1) the adapter factory
	    2) non-AthenaView components, which won't get the advantage
	       of this fix because it's in Athena (a fix could go into
	       Bonobo, or into each component)

	* libathena/athena-bonobo-workarounds.h:
	* libathena/athena-bonobo-workarounds.c:
	(set_gone_flag), (athena_bonobo_object_force_destroy),
	(object_is_gone), (remote_check_data_free),
	(remote_check_timed_callback), (remote_check_destroy_callback),
	(athena_bonobo_object_call_when_remote_object_disappears),
	(force_destroy_cover),
	(athena_bonobo_object_force_destroy_when_owner_disappears):
	New code, implementing the machinery to notice when remote objects
	go away and to self-destruct when they do. Also code that does the
	timeout that used to be in AthenaViewFrame.
	
	* libathena/athena-view.c: (widget_destroyed_callback),
	(athena_view_construct_from_bonobo_control): Connect to the
	widget's destroy signal, and self-destruct when it happens.
	
	* components/throbber/athena-throbber.c:
	(athena_throbber_destroy), (null_pointer_callback),
	(athena_throbber_initialize): Destroy the BonoboControl when the
	throbber (a widget) is destroyed. Requires noticing when the
	control goes away (the old code just had a stale pointer to it).
	
	* src/athena-view-frame.c: (destroy_view),
	(athena_view_frame_destroy), (view_frame_failed_callback),
	(queue_view_frame_failed), (view_frame_failed_cover),
	(check_socket_gone_idle_callback), (check_socket_gone_callback),
	(attach_view): Use the new machinery instead of doing it
	ourselves, but sadly had to add some fairly complex code to catch
	the case where the socket is destroyed because the plug is gone.

2001-03-28  Robey Pointer  <robey@eazel.com>

	* components/services/install/command-line/eazel-test-softcat.c:
	(main):

	Fix build bustage -- missed one of the "pr" -> "per" things.

2001-03-28  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Re-fixed bug 6820 (directory sort order is different in tree
	view):

	* components/tree/athena-tree-view.c: realized that I can get
	the tree model node directly from the row's data pointer,
	there's no need to map the row to a node (which is a linear
	operation). Also, cache the clist->tree-view mapping to avoid a
	call to gtk_object_data_get each comparison

	(create_tree): enabled the custom comparison function


	Work to share more drawing code between AthenaList and
	AthenaCTree:

	* libathena-extensions/athena-ctree.c (get_cell_style,
	draw_cell_pixbuf): deleted. Use similarly named athena_list_
	functions instead

	(draw_row): only draw the special tree pixbuf if `height > 0'.
	This fixes a weird clipping bug

	* libathena-extensions/athena-list.c (get_cell_style,
	draw_cell_pixbuf): renamed as athena_list_X
	

	Ensure that the list view fetches the correct icons (i.e.
	special anti-aliased images if the view is in smooth mode)

	* libathena-extensions/athena-list.c
	(athena_list_is_anti_aliased): new function

	* src/file-manager/fm-list-view.c
	(fm_list_view_update_smooth_graphics_mode): call update_icons
	(fm_list_view_get_emblem_pixbufs_for_file, install_row_images):
	pass the correct aa mode to the icon factory


	Draw tree-view icons in smooth mode when appropriate:

	* components/tree/athena-tree-view.c
	(update_smooth_graphics_mode,
	smooth_graphics_mode_changed_callback): new functions. As yet
	they don't refetch all icons when the smooth preference
	changes..


	Fixed the bug introduced recently where the tree gets a title
	bar:

	* libathena-extensions/athena-list.c
	(athena_list_realize): don't turn on titles

	* src/file-manager/fm-list-view.c (create_list): set the
	CLIST_SHOW_TITLES flag

2001-03-28  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* components/notes/athena-notes.c: (set_note_text_from_metadata),
	(done_with_file), (notes_load_metainfo), (notes_save_metainfo),
	(do_destroy):
	Notes updates text on metadata changes - bug 4422.

2001-03-28  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>
	who glanced at it before passing out

	* components/services/install/lib/eazel-install-logic2.c:
	(dedupe_foreach_depends):

	Backport a fix for deduping from the branch. (This may fix some
	bugs related to deduping suites; to be honest, nobody remembers
	what this patch was originally supposed to do.)

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize):
	* components/services/install/lib/eazel-package-system-types.c:
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.h:

	Change 'eazel_softcat_set_packages_pr_query' to
	'eazel_softcat_set_packages_per_query' because I just can't see
	one extra letter making a difference in a function name that long
	anyway.
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_initialize), (eazel_softcat_set_packages_per_query),
	(eazel_softcat_get_info), (eazel_softcat_get_info_plural):

	Backport a fix for suites from the branch.  This caused wrong
	error messages for the case where a suite contained only one
	package (which is currently nearly 99% of all suites in softcat).
	Adam noticed this a few days ago.

	* athena-installer/src/installer.c: (report_unusual_errors):

	Fix a trivial FIXME.

	These should be the last of the patches that need to be backported
	from the 1.0 branch.

2001-03-28  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(flatten_packagedata_dependency_tree), (packagedata_list_prune),
	(packagedata_is_suite):
	Added a (bool)packagedata_is_suite call which checks if the
	suite_id field is actually a suite or something else.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages_helper), (get_softcat_info), (post_check),
	(check_dependencies_foreach), (do_dep_check_internal),
	(check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages):
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_package):
	Use the packagedata_is_suite call.

2001-03-28  Jason Leach  <jasonleach@usa.net>

	reviewed by: Darin Adler <darin@eazel.com>
	
	* libathena-extensions/athena-directory-private.h: builddir !=
	srcdir fix by changing #include "athena-idle-queue.h" to
	#include <libathena/athena-idle-queue.h>.

2001-03-28  John Sullivan  <sullivan@eazel.com>

	reviewed by: Eli Goldberg <eli@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	Tweaked wording of font & font size preferences. They're
	still a little awkward, but I think mostly in ways that
	reflect their actual use, which is still a little awkward.

2001-03-28  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: upped version to 1.0.1.1 to keep version numbers
	up above branch work.

2001-03-28  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Followup on my recent tree change to get rid of some flicker.

	* components/tree/athena-tree-view.c:
	(set_selected_row_position): Only scroll the view if the row isn't
	already in the right position. Prevents the case where it scrolls
	by less than a whole row.
	
	* cut-n-paste-code/widgets/athenaclist/athenaclist.h:
	* cut-n-paste-code/widgets/athenaclist/athenaclist.c:
	(athena_clist_thaw), (athena_clist_check_unfrozen),
	(real_resize_column), (real_row_move), (resync_selection),
	(athena_clist_map), (athena_clist_style_set),
	(real_sort_list):
	Add code to detect changes and only redraw when actual changes
	happen. Also make freeze/thaw with no changes between them a no-op
	by having the frozen check schedule a refresh at thaw time as a
	side effect. It used to do a refresh every time it got thawed. Add
	calls to do refresh for all cases where the old code was counting
	on thaw implying a full refresh.
	
	* libathena-extensions/athena-ctree.c: (real_tree_move),
	(real_select_all), (athena_ctree_insert_gnode),
	(athena_ctree_remove_node), (athena_ctree_expand_recursive),
	(athena_ctree_expand_to_depth),
	(athena_ctree_collapse_recursive),
	(athena_ctree_collapse_to_depth),
	(athena_ctree_toggle_expansion_recursive),
	(athena_ctree_real_select_recursive),
	(athena_ctree_set_node_info), (athena_ctree_set_indent),
	(athena_ctree_set_spacing), (athena_ctree_set_line_style),
	(athena_ctree_sort_recursive), (athena_ctree_sort_node),
	(athena_ctree_sort_single_node):
	Use the new unfrozen check that has a side effect of making the
	next thaw do a refresh. Add the new refresh calls that are needed
	now that thaw doesn't always do a refresh. Removed some
	unnecessary drawing for cases where things haven't changed.
	
	* libathena-extensions/athena-list.c:
	(athena_list_track_new_column_width):
	Use the new unfrozen check that has a side effect of making the
	next thaw do a refresh.
	
	* src/file-manager/fm-list-view.c: (fm_list_view_set_zoom_level):
	Formatting tweak.

2001-03-28  Ramiro Estrugo  <ramiro@eazel.com>

	* components/text/athena-text-view-ui.xml:
	* components/text/athena-text-view.c: (merge_bonobo_menu_items):
	* libathena-extensions/athena-font-factory.c:
	(athena_font_factory_get_font_by_family):
	Change "default" to "GTK System Font."  Also add a FIXME for the fact
	that the string "GTK System Font" is hard coded in many places.
	Im going to fix this better in a bit.
	
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_populate_pane):
	Add documentation for the preference and preference dialog item
	structures and tables.  Also cleanup a bit of cruft left over from
	the last checkin.
	
	* libathena-extensions/athena-preferences-item.c:
	(athena_preferences_item_initialize), (preferences_item_destroy),
	(preferences_item_create_constrained_integer),
	(preferences_item_create_font),
	(constrained_integer_changed_callback),
	(athena_preferences_item_set_constrained_integer_values):
	* libathena-extensions/athena-preferences-item.h:
	Add support for having the constrained integer values be
	independent of the labels.
	
2001-03-28  Ramiro Estrugo  <ramiro@eazel.com>

	Fix bugs:

	7343 - Fonts checks should work even when athena has not
	undergone 'make install'

	7703 - index status dialog is mixing gnome dialog font and
	athena custom font

	7204 - Need a better way to pick a fallback font

	1102 - Embedded text should use preferences to determine the font
	it uses

	7357 - Preferences dialog spews critical in the ja_JP locale

	7344 - AthenaScalable should not be doing any preferences
	peeking

	7345 - Default font "helvetica" hard coded and marked for
	translatation in many places

	7834 - Should mark selected style in font picker menu

	5239 - Please make the text viewer use a fixed-width font

	7401 - Non smooth font family picker should have a "GTK System
	Font" entry

	Work in progress for related bugs:

	5101 - font sizes hard-coded in icon view
	5456 - Sidebar tabs use hard coded font families
	7670 - Font size is small in list view.

	reviewed by: Glynn Foster <glynn.foster@ireland.sun.com>

	* components/notes/athena-notes.c: (make_notes_view):
	Dont translate the font name.
	
	* components/text/athena-text-view-ui.xml:
	Add default and fixed entries.

	* components/text/athena-text-view.c:
	(athena_text_view_initialize_class),
	(athena_text_view_initialize), (athena_text_view_destroy),
	(athena_text_view_update_font), (handle_ui_event),
	(merge_bonobo_menu_items), (athena_text_view_zoom_to_level),
	(zoomable_zoom_to_fit_callback), (font_changed_callback):
	Dont store the font name and size.  Compute these as needed.  Use
	deltas instead of hard coded font sizes to compute the font size
	for a given zoom level.  Store the font changes in preferences.
	
	* libathena-extensions/athena-caption.c:
	(athena_caption_initialize), (athena_caption_set_title_label),
	(athena_caption_get_title_label),
	(athena_caption_get_title_label_width),
	(athena_caption_set_child), (athena_caption_set_spacing):
	* libathena-extensions/athena-caption.h:
	Add support for nice caption alignments.
	
	* libathena-extensions/athena-directory.c:
	(add_preferences_callbacks), (remove_preferences_callbacks):
	A bit of a hack.  Keep track of changes in the default smooth font
	so that embedded icon text previews can be updated as needed.
	
	* libathena-extensions/athena-font-factory.c:
	(athena_font_factory_get_font_by_family),
	A temporary hack for default system font usage.  In a future
	checkin this will not be needed anymore.
	
	(athena_font_factory_get_font_from_preferences):
	Dont translate font names anymore.
	
	* libathena-extensions/athena-font-manager.c:
	(font_description_new), (font_description_free),
	(font_description_get_char_set), (font_description_table_for_each),
	(font_list_find_bold_callback), (get_test_font_dir),
	(athena_self_check_font_manager):
	* libathena-extensions/athena-font-manager.h:
	Merge char_set_registry and char_set_encoding into one string
	'char_set.'  Make the font checks work even if athena has not
	undergone 'make install'
	
	* libathena-extensions/athena-font-picker.c:
	(athena_font_picker_initialize), (athena_font_picker_destroy),
	(font_picker_populate), (font_make_style_name),
	(font_style_entry_new), (compare_style),
	(global_font_list_populate_callback):
	* libathena-extensions/athena-font-picker.h:
	Sublcass the font picker from AthenaCaption so that it will
	nicely align in the preferences dialog.
	Mark selected style in font picker menus by using radio buttons.
	Fix a storage leak on destruction.
	
	* libathena-extensions/athena-glib-extensions.c:
	(athena_compare_integer), (athena_self_check_glib_extensions):
	* libathena-extensions/athena-glib-extensions.h:
	New GCompare function for integers.
	
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_defaults),
	(global_preferences_create_dialog),
	(global_preferences_create_search_pane),
	(global_preferences_create_sidebar_panels_pane),
	(global_preferences_pane_update_callback),
	(global_preferences_get_dialog),
	(global_preferences_install_sidebar_panel_defaults),
	(global_preferences_make_sidebar_panel_key),
	(global_preferences_is_sidebar_panel_enabled),
	(global_preferences_install_home_location_defaults),
	(global_preferences_install_font_defaults),
	(global_preferences_install_medusa_defaults),
	(global_preferences_populate_pane),
	(global_preferences_get_smooth_font),
	(global_preferences_get_smooth_bold_font),
	(athena_global_preferences_get_icon_view_smooth_font),
	(athena_global_preferences_get_default_smooth_font),
	(athena_global_preferences_get_default_smooth_bold_font),
	(athena_global_preferences_initialize):
	* libathena-extensions/athena-global-preferences.h:
	Simplify the creation of preferences by using structures to
	describe both preferences and preference fialog entries.
	
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_get_system_font):
	* libathena-extensions/athena-gtk-extensions.h:
	New function to obtain the "Gtk System Font."
	
	* libathena-extensions/athena-icon-canvas-item.c:
	(athena_icon_canvas_item_initialize_class),
	(athena_icon_canvas_item_set_arg),
	(athena_icon_canvas_item_get_arg),
	(athena_icon_canvas_item_set_smooth_font_size):
	* libathena-extensions/athena-icon-canvas-item.h:
	Use signed integers for the font dimensions.
	
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_initialize),
	(athena_icon_container_update_icon),
	(athena_icon_container_theme_changed),
	(athena_icon_container_set_font_size_table):
	* libathena-extensions/athena-icon-container.h:
	* libathena-extensions/athena-icon-private.h:
	Dont translate the font names.  Rename the font size table to
	better reflect its purpose.  Use signed integers for font sizes.
	
	* libathena-extensions/athena-icon-factory.c:
	(embedded_text_font_changed_callback), (embedded_text_font_free),
	(embed_text):
	Keep track of changes in the smooth font used for embedded text so
	that the icon text previews will update as needed.
	
	* libathena-extensions/athena-preferences-box.c:
	(athena_preferences_box_find_pane):
	* libathena-extensions/athena-preferences-box.h:
	New function to find a named pane.
	
	* libathena-extensions/athena-preferences-group.c:
	(preferences_group_align_captions),
	(athena_preferences_group_update),
	(athena_preferences_group_get_title_label):
	* libathena-extensions/athena-preferences-group.h:
	Add support for aligning captions.
	
	* libathena-extensions/athena-preferences-item.c:
	(athena_preferences_item_initialize),
	(preferences_item_construct), (preferences_item_update_enum),
	(preferences_item_create_enum),
	(preferences_item_update_short_enum),
	(preferences_item_create_short_enum),
	(preferences_item_update_boolean),
	(preferences_item_create_boolean),
	(preferences_item_update_editable_string),
	(preferences_item_create_editable_string),
	(preferences_item_update_editable_integer),
	(preferences_item_create_editable_integer),
	(preferences_item_update_constrained_integer),
	(preferences_item_create_constrained_integer),
	(preferences_item_update_font), (preferences_item_create_font),
	(preferences_item_update_smooth_font),
	(preferences_item_create_smooth_font),
	(athena_preferences_item_new),
	(enum_radio_group_changed_callback),
	(boolean_button_toggled_callback), (font_item_changed_callback),
	(editable_string_changed_callback),
	(editable_integer_changed_callback),
	(constrained_integer_changed_callback),
	(athena_preferences_item_update_displayed_value),
	(preferences_item_update_editable_integer_settings_at_idle),
	(athena_preferences_item_get_control_showing),
	(athena_preferences_item_set_constrained_integer_paramaters),
	(athena_preferences_item_child_is_caption),
	(athena_preferences_item_get_caption_title_label_width),
	(athena_preferences_item_set_caption_spacing):
	* libathena-extensions/athena-preferences-item.h:
	Add a new CONSTRAINED INTEGER item type.  Add support for aligning
	captions.
	Dont translate font names.
	
	* libathena-extensions/athena-preferences-pane.c:
	(athena_preferences_pane_add_group),
	(athena_preferences_pane_add_item_to_nth_group),
	(athena_preferences_pane_get_num_visible_groups),
	(athena_preferences_pane_get_num_groups),
	(athena_preferences_pane_find_group):
	* libathena-extensions/athena-preferences-pane.h:
	Add a function for finding a named group.
	
	* libathena-extensions/athena-scalable-font.c:
	(athena_scalable_font_get_default_font),
	(athena_scalable_font_get_default_bold_font):
	Dont peek preferences for the default fonts.  These are now
	handled in athena-global-preferences.
	
	* libathena-extensions/athena-smooth-text-layout.c:
	(smooth_text_layout_line_list_new),
	(smooth_text_layout_line_list_new_wrapped),
	(athena_smooth_text_layout_new),
	(athena_smooth_text_layout_set_font_size):
	Use signed integers for font sizes.

	* libathena-extensions/athena-string-picker.c:
	(athena_string_picker_initialize),
	(athena_string_picker_set_string_list):
	Update for Caption superclass changes.  Dont make singleton
	choices insensitive.
	
	* libathena-extensions/athena-text-caption.c:
	(athena_text_caption_initialize):
	* libathena-extensions/athena-text-caption.h:
	Update for Caption superclass changes.  Fix errors in header comments.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_initialize), (fm_directory_view_destroy):
	* src/file-manager/fm-directory-view.h:
	Remove knowledge of font stuff.  The fonts for icon and list view
	are now handled separately so each subclass will have to do its
	own preferences listening.
	
	* src/file-manager/fm-icon-view.c: (set_sort_criterion_by_id),
	(font_changed_callback), (smooth_font_changed_callback),
	(standard_font_size_changed_callback),
	(fm_icon_view_initialize_class), (fm_icon_view_initialize),
	(fm_icon_view_update_icon_container_font_size_table),
	(fm_icon_view_update_icon_container_smooth_font),
	(create_icon_container):
	Keep track of icon view font changes.  Use deltas to compute the
	font sizes instead of hard coded point sizes.
	
	* src/file-manager/fm-list-view.c: (fm_list_view_initialize_class),
	(fm_list_view_initialize), (fm_list_view_update_font),
	(font_or_font_size_changed_callback),
	(fm_list_view_image_display_policy_changed):
	Keep track of list view font changes.  Use deltas to compute the
	font sizes instead of hard coded point sizes.

	* src/file-manager/athena-indexing-info.c:
	(last_index_time_and_reindex_button_dialog_new),
	(index_progress_dialog_new):
	Dont use smooth labels mixed in with regular gtk labels.

	* src/athena-sidebar-tabs.c:
	(athena_sidebar_tabs_load_theme_data),
	(smooth_font_changed_callback), (athena_sidebar_tabs_initialize),
	(athena_sidebar_tabs_destroy):
	Add macros and FIXME for hard coded font size.  NULL out the tab_font
	when its unreffed, otherwise all hell breaks lose when user level
	changes.  Update for default font changes.
	
	* src/athena-sidebar-title.c: (smooth_font_changed_callback),
	(athena_sidebar_title_initialize),
	(athena_sidebar_title_destroy), (update_font):
	Keep track of smooth font changes.  Update for default font changes.
	
	* test/test-athena-font-manager.c: (font_iterator_callback):
	* test/test-athena-font-picker.c: (update_font),
	(print_selected_font_callback), (main):
	* test/test-athena-label-simple.c: (use_system_font_callback),
	(use_system_font_bold_callback), (main):
	Update for font picker and font manager changes.
	
2001-03-27  Darin Adler  <darin@eazel.com>

	reviewed (a bit) by: John Sullivan <sullivan@eazel.com>

	Some tree view changes so it only does work when the tree view is
	open, not when it's closed. Also improved speed by not creating so
	many pixmaps, which required changing lots of classes to use
	pixbufs instead of pixmaps.

	* components/tree/libmain.c: (tree_shlib_object_destroyed),
	(tree_shlib_make_object): Changed to use AthenaTreeView
	subclass of AthenaView, not widget.
	
	* components/tree/main.c: (main): Use standard main.

	* components/rpmview/athena-rpm-view.c:
	(file_activation_callback), (fill_filename_tree_int),
	(fill_filename_tree), (athena_rpm_view_update_from_uri):
	Update to use AthenaCList instead of GtkCList.
	
	* components/tree/athena-tree-change-queue.h: Got rid of ADDED
	(it's now the same as CHANGED).
	
	* components/tree/athena-tree-model.h:
	* components/tree/athena-tree-model.c:
	(athena_tree_model_initialize_class): No more ADDED.
	(destroy_file_hash): New function.
	(athena_tree_model_destroy): Destroy deferral hashes.
	(athena_tree_model_node_begin_monitoring): Use changed instead
	of added.
	(report_node_changed): Emit changed instead of added.
	(process_file_change): New function.
	(process_directory_done_loading): New function.
	(add_file_to_hash): New function.
	(athena_tree_model_directory_files_changed_callback),
	(athena_tree_model_directory_done_loading_callback): Either put
	the file in the hash table or send the notification.
	(process_one_changed_file), (process_one_done_loading_file):
	Helper functions to send notifications.
	(athena_tree_model_set_defer_notifications): Start deferring
	notifications by making hash tables. Stop deferring notifications
	by sending out all the notifications and then getting rid of the
	hash tables.
	
	* components/tree/athena-tree-view.h:
	* components/tree/athena-tree-view-private.h:
	* components/tree/athena-tree-view.c:
	(athena_tree_view_insert_model_node), (ctree_is_node_expanded),
	(athena_tree_view_update_model_node),
	(awaited_node_or_uri_found), (notify_done_loading),
	(notify_node_seen), (get_selected_row),
	(get_selected_row_position), (set_selected_row_position),
	(dequeue_pending_idle_callback), (schedule_pending_idle_callback),
	(unschedule_pending_idle_callback),
	(athena_tree_view_load_from_filesystem), (ctree_compare_rows),
	(create_tree), (tree_map_callback), (tree_unmap_callback),
	(athena_tree_view_initialize), (athena_tree_view_destroy),
	(get_uri_sequence_to_root),
	(call_when_uri_loaded_or_parent_done_loading),
	(cancel_selection_in_progress),
	(expand_uri_sequence_and_select_end), (select_current_location),
	(tree_load_location_callback), (got_activation_uri_callback),
	(ctree_get_first_selected_node),
	(athena_tree_view_update_all_icons),
	(athena_tree_view_initialize_class):
	Convert to use pixbufs instead of pixmaps. Convert to use
	AthenaList instead of GtkCList. Fix storage leak of name.
	Get rid of weak use of callback function pointers. Add feature
	where the selected row is kept in position as new items are added.
	Eliminated ADDED and jsut used CHANGED instead. Defer creating the
	tree view until the first map. Turn off processing when unmapped.
	Change AthenaTreeView to be AthenaView subclass, not a widget.
	
	* components/tree/athena-tree-view-dnd.c:
	(athena_tree_view_drag_begin), (athena_tree_view_drag_motion),
	(get_data_on_first_target_we_support),
	(athena_tree_view_button_press),
	(athena_tree_view_button_release),
	(athena_tree_view_motion_notify),
	(athena_tree_view_set_dnd_icon),
	(athena_tree_view_collapse_node),
	(athena_tree_view_expand_or_collapse_row),
	(athena_tree_view_tree_node_at), (auto_scroll_timeout_callback),
	(athena_tree_view_real_scroll),
	(athena_tree_view_collapse_all),
	(athena_tree_view_receive_dropped_icons),
	(athena_tree_view_drag_destroy),
	(athena_tree_view_drag_destroy_real):
	Switch from GtkCList to AthenaCList. Also get rid of code that
	assumes AthenaTreeView is a widget. Also convert to use pixbufs
	instead of pixmaps.
	
	* cut-n-paste-code/widgets/athenaclist/athenaclist.h:
	* cut-n-paste-code/widgets/athenaclist/athenaclist.c:
	(athena_clist_optimal_column_width), (athena_clist_set_text),
	(athena_clist_set_pixbuf), (athena_clist_get_pixbuf),
	(athena_clist_set_pixtext), (athena_clist_get_pixtext),
	(set_cell_contents), (cell_size_request), (real_insert_row),
	(draw_row), (draw_rows), (row_delete):
	Change to use pixbufs instead of pixmaps. Remove most of the
	drawing code since this can only be used as a base class for
	AthenaList anyway. Add boolean to set_cell_contents so it
	redraws only if the cell has changed.
	
	* libathena-extensions/athena-ctree.h:
	* libathena-extensions/athena-ctree.c: (COLUMN_FROM_XPIXEL),
	(athena_ctree_get_type), (athena_ctree_class_init),
	(athena_ctree_set_arg), (athena_ctree_get_arg),
	(athena_ctree_init), (ctree_attach_styles),
	(ctree_detach_styles), (athena_ctree_realize),
	(athena_ctree_event), (athena_ctree_unrealize),
	(athena_ctree_button_press), (draw_drag_highlight),
	(athena_ctree_row_at), (get_cell_rectangle),
	(athena_ctree_set_prelight), (draw_cell_pixbuf),
	(get_cell_style), (athena_ctree_draw_expander),
	(athena_ctree_draw_lines), (draw_row), (tree_draw_node),
	(athena_ctree_link), (athena_ctree_unlink), (real_row_move),
	(real_tree_move), (change_focus_row_expansion), (real_tree_expand),
	(real_tree_collapse), (column_auto_resize), (auto_resize_columns),
	(cell_size_request), (set_cell_contents), (set_node_info),
	(row_new), (row_delete), (real_select_row), (real_unselect_row),
	(real_tree_select), (real_tree_unselect), (select_row_recursive),
	(real_select_all), (real_unselect_all), (ctree_is_hot_spot),
	(athena_ctree_construct), (real_insert_row),
	(athena_ctree_insert_node), (athena_ctree_insert_gnode),
	(real_remove_row), (athena_ctree_remove_node), (real_clear),
	(athena_ctree_post_recursive),
	(athena_ctree_post_recursive_to_depth),
	(athena_ctree_pre_recursive),
	(athena_ctree_pre_recursive_to_depth),
	(athena_ctree_find_node_ptr), (athena_ctree_node_nth),
	(athena_ctree_find), (athena_ctree_find_by_row_data),
	(athena_ctree_find_all_by_row_data),
	(athena_ctree_find_by_row_data_custom),
	(athena_ctree_find_all_by_row_data_custom),
	(athena_ctree_is_hot_spot), (athena_ctree_expand_recursive),
	(athena_ctree_expand_to_depth),
	(athena_ctree_collapse_recursive),
	(athena_ctree_collapse_to_depth),
	(athena_ctree_toggle_expansion_recursive),
	(athena_ctree_real_select_recursive),
	(athena_ctree_node_set_text), (athena_ctree_node_set_pixbuf),
	(athena_ctree_node_set_pixtext), (athena_ctree_set_node_info),
	(athena_ctree_node_set_shift), (remove_grab),
	(athena_ctree_node_set_selectable),
	(athena_ctree_node_get_cell_type),
	(athena_ctree_node_get_text), (athena_ctree_node_get_pixbuf),
	(athena_ctree_node_get_pixtext), (athena_ctree_get_node_info),
	(athena_ctree_node_set_cell_style),
	(athena_ctree_node_get_cell_style),
	(athena_ctree_node_set_row_style), (athena_ctree_node_moveto),
	(athena_ctree_node_is_visible), (athena_ctree_set_indent),
	(athena_ctree_set_spacing), (athena_ctree_set_show_stub),
	(athena_ctree_set_line_style), (tree_sort),
	(athena_ctree_sort_recursive), (real_sort_list),
	(athena_ctree_sort_node), (athena_ctree_sort_single_node),
	(fake_unselect_all), (selection_find), (resync_selection),
	(real_undo_selection), (check_drag), (drag_dest_info_destroy),
	(drag_dest_cell), (athena_ctree_drag_begin),
	(athena_ctree_drag_motion), (athena_ctree_drag_data_received):
	Change to use AthenaList instead of GtkCList. Change to use
	pixbufs instead of pixmaps. Use set_cell_contents boolean to only
	redraw when cell has changed.
	
	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_marshal_POINTER__INT): Add new marshal needed for
	the pixbuf version of a AthenaList call.
	(athena_drag_set_icon_pixbuf): Helper to convert pixbuf to
	a pixmap and mask for GTK's sake.
	
	* libathena-extensions/athena-icon-dnd.c:
	(athena_icon_dnd_begin_drag): Use athena_drag_set_icon_pixbuf.
	
	* libathena-extensions/athena-list.h:
	* libathena-extensions/athena-list.c:
	(athena_list_initialize_class), (athena_list_initialize_dnd),
	(athena_list_initialize), (athena_list_destroy), (draw_cell),
	(athena_list_mark_cell_as_link),
	(athena_list_set_cell_contents), (set_list_cell),
	(get_list_cell), (athena_list_drag_start),
	(athena_list_receive_dropped_icons):
	Take advantage of the new changes in AthenaCList, which now uses
	pixmaps directly. Change drag signal to use a pixbuf, not a
	pixmap. Change so it doesn't do the DND stuff unless you
	explicitly call for it. Use set_cell_contents boolean to only
	redraw when cell has changed.
	
	* src/file-manager/fm-list-view.c: (fm_list_get_drag_pixbuf),
	(fm_list_get_sort_column_index), (create_list), (set_up_list):
	Change to use the new pixbuf signal instead of the old pixmap one.
	Make a call to ask AthenaList to do the DND stuff.

2001-03-27  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/clone/.cvsignore:
	More generated files.
	
2001-03-27  Ramiro Estrugo  <ramiro@eazel.com>

	* components/services/clone/.cvsignore:
	Ignore generated files.
	
Tue Mar 27 15:56:00 2001  George Lebl <jirka@5z.com>

	Reviewed by a bunch of people on bugzilla, and according to everyone
	it actually works, despite being written by me.

	* libathena-extensions/athena-icon-container.c
	  (athena_icon_container_update_scroll_region)
	  (lay_down_icons_horizontal) (lay_down_icons_tblr)
	  (athena_icon_container_set_margins)
	  libathena-extensions/athena-icon-container.h
	  libathena-extensions/athena-icon-private.h
	  src/file-manager/fm-desktop-icon-view.c (panel_desktop_area_changed)
	  (desktop_icon_view_property_filter) (fm_desktop_icon_view_destroy)
	  (fm_desktop_icon_view_initialize):  Reads GNOME_PANEL_DESKTOP_AREA
	  hint from the root window, which the panel sets to give the area
	  not covered by panels.  Then set margins on the icon container so
	  that the icons are shifted away from the panels.  Also when
	  relaying out icons the new size is taken into account.
	  Fix #1447, the infamous showstopper uber bug.

2001-03-27  Gene Z. Ragan  <gzr@eazel.com>

	Use the proper automake defined conditional to
	enable audio cd mounting.
	
	* libathena-extensions/athena-volume-monitor.c:
	(get_removable_volumes), (get_current_mount_list):
	
2001-03-27  Eskil Heyn Olsen  <eskil@eazel.com>

	Clone now basically works. It will however almost always crash
	since ORBit can't transfer big buffers.
	
	* components/services/clone/eazel-clone.c:
	(eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal),
	(eazel_download_progress_signal), (eazel_install_progress_signal),
	(eazel_uninstall_progress_signal), (download_failed),
	(install_failed), (uninstall_failed),
	(eazel_preflight_check_signal), (dep_check), (md5_check_failed),
	(done), (get_password_dude), (do_clone):
	Added --downgrade.
	Added "I: "'s and \n's to a lot of printfs.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_preflight_check),
	(eazel_install_emit_save_transaction):
	Code to "circumvent" the ORBit buffersize bug.
	
	* components/services/install/lib/eazel-softcat.c:
	(split_by_multiple):
	Fixed bug that caused packages searched for by name but with
	version to be slammed into one huge query.

2001-03-27  John Sullivan  <sullivan@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 2328 (No way to go to a specific URI if location
	bar is hidden)

	Fixed by adding a new item "Location ..." to the Go menu,
	with control-L as keyboard shortcut. ("Create Link", formerly
	control-L, is now "Make Link", control-M.) Choosing "Location ..."
	makes the location bar visible if necessary and selects the
	location text field's contents so you can start typing to replace
	it. If the location bar had been hidden, it will hide itself again
	when you hit Return.

	At the same time, made the "Find" menu item (control-F) always
	show the Find controls and move the focus there, instead of
	toggling between Find & Browse. The Find toolbar button remains
	a toggle button.


	Fixed bug 3590 (Remove workaround for Bonobo design flaw)
	Fixed bug 7303 (Conflicts on menu item underline accelerators)

	Fixed these incidentally when working on 2328.


	* src/file-manager/fm-directory-view.c: (real_update_menus):
	* src/file-manager/athena-directory-view-ui.xml:
	Changed Create Link(s) to Make Link(s), and changed its
	accelerator to Control-M.
	
	* src/athena-location-bar.c: 
	(real_activate): select all text when activating (used to
	just grab focus)
	(athena_location_bar_initialize): Changed definition
	of entry to be a AthenaEntry.

	
	* src/athena-shell-ui.xml: added "Location ..." item in
	Go menu; renamed some commands and items for clarity; 
	moved a couple of accelerators into verbs.
	
	* src/athena-switchable-navigation-bar.h:
	* src/athena-switchable-navigation-bar.c:
	(athena_switchable_navigation_bar_activate),
	(athena_switchable_navigation_bar_set_mode):
	Broke _activate out of _set_mode and made it
	public; tweaked _set_mode a little.
	
	* src/athena-window-private.h: Added temporary_navigation_bar
	boolean to details struct.

	* src/athena-window-menus.c:
	(athena_window_show_location_bar_temporarily): New function,
	shows location bar and sets the flag to hide it after it
	signals for a location change.
	(file_menu_find_callback): New function, switches to find mode,
	showing location bar temporarily if necessary.
	(toolbar_toggle_find_mode_callback): renamed from file_menu_xxx
	now that it's only used by the toolbar, toggles Find mode,
	showing location bar temporarily if necessary.
	(go_menu_location_callback): New function, switches to browse mode,
	showing location bar temporarily if necessary.
	(athena_window_initialize_menus_part_1): futz with verbs for
	these menu items.
	(athena_window_update_find_menu_item): Remove this call since
	the menu item is no longer dynamic.
	(athena_window_remove_go_menu_items): Remove call to
	athena_window_update_find_menu_item.
	
	* src/athena-window.c: 
	(go_to_callback): Cleaned up style a little.
	(navigation_bar_location_changed_callback): New function, called
	when location bar says "hey, here's a new location for you".
	Hides the location bar if it was temporarily showing.
	(navigation_bar_mode_changed_callback): Remove call to
	athena_window_update_find_item.
	(athena_window_constructed): Wire up 
	navigation_bar_location_changed_callback.
	(athena_window_hide_location_bar): Clear the 
	temporary_navigation_bar flag.

	* components/text/athena-text-view-ui.xml: Change _Fonts to
	F_onts to avoid conflict with _File.

Tue Mar 27 02:25:31 2001  George Lebl <jirka@5z.com>

	* components/help/hyperbola-nav-tree.c (ensure_italic_style)
	  (set_node_style) (reset_style_for_node) (reset_styles)
	  (ensure_pixmap_and_mask) (ensure_icons) (get_node_icons)
	  (ctree_populate_subnode) (ctree_populate)
	  (hyperbola_navigation_tree_new) (pixmap_unref_and_null)
	  (bitmap_unref_and_null) (hyperbola_navigation_tree_destroy):
	  Remove the italic stuff and replace with icons.  There's a
	  different icon for folders, different for books and different for
	  sections.  The one for sections is the one used for man and info
	  pages, but we could also have a separate one for those.  I suppose
	  that's up to Arlo.  This should fix #6911, though I suppose I'll
	  leave it open to get further feedback.

	* icons/Makefile.am, hyperbola-book-closed.png,
	  hyperbola-book-open.png, hyperbola-folder-closed.png,
	  hyperbola-folder-open.png, hyperbola-section-closed.png,
	  hyperbola-section-open.png:  Add some testing icons, stolen
	  from the GTK+ testing program.

Tue Mar 27 00:45:02 2001  George Lebl <jirka@5z.com>

	* components/help/hyperbola-filefmt.c
	  (fmt_scrollkeeper_parse_toc_section)
	  (fmt_scrollkeeper_parse_document) (fmt_toplevel_add_doc):
	  Properly set BOOK and SECTION types instead of making everything
	  FOLDER.  No wonder my original patch to #6911 didn't all work.
	  This makes it work, though apparently icons are involved now, so
	  it's still not fixed.

	* components/help/hyperbola-nav-tree.c (set_node_style):
	  Also set italic style for SECTIONs which are now set correctly
	  in the above fix.

2001-03-26  Gene Z. Ragan  <gzr@eazel.com>
	
	* libathena-extensions/athena-audio-player.c:
	* libathena-extensions/athena-audio-player.h:
 	(player_thread),
	(athena_audio_player_play), (athena_audio_player_stop),
	(esdout_init), (esdout_write), (get_latency), (esd_stou8),
	(esd_utos16sw), (esd_utos16), (esd_16sw):
	New code to add support for an audio player thread. This is
	a first step to avoid the use of external binaries from
	within athena to preview audio. This will hopefully allow
	us to use a more flexible preview mechanism in the future.
	The new code currently uses the audiofile library from
	gnome cvs.
			
	* libathena-extensions/Makefile.am:
	Add new files to build.

	* src/file-manager/fm-icon-view.c: (fm_icon_view_destroy),
	(fm_icon_view_begin_loading), (play_file), (preview_audio),
	(icon_container_preview_callback), (fm_icon_view_initialize):
	Add a conditional to allow the use of the new audio preview
	code.  The conditional is currently set to use the old code,
	not the new mechanism.

2001-03-26  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-directory-async.c:
	(is_anyone_waiting_for_metafile), (call_ready_callbacks),
	(start_or_stop_io), (athena_directory_cancel):
	* libathena-extensions/athena-directory-metafile-monitor.c:
	(corba_metafile_ready):
	* libathena-extensions/athena-directory-metafile.c:
	(get_metafile), (athena_directory_rename_file_metadata),
	(athena_directory_rename_directory_metadata):
	* libathena-extensions/athena-directory-metafile.h:
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory.c:
	(athena_directory_initialize), (athena_directory_destroy),
	(set_directory_uri), (change_directory_uri),
	(athena_self_check_directory):
	* libathena-extensions/athena-directory.h:
	* libathena-extensions/athena-file-utilities.c:
	(athena_file_name_matches_backup_pattern),
	(athena_file_name_matches_metafile_pattern):
	* libathena-extensions/athena-file-utilities.h:
	* libathena-extensions/athena-file.c:
	(athena_file_is_metafile):
	* libathena-extensions/athena-file.h:
	* libathena-extensions/athena-metafile-factory.c: (corba_open):
	* libathena-extensions/athena-metafile-server.idl:
	* libathena-extensions/athena-metafile.c:
	(athena_metafile_class_init), (athena_metafile_init),
	(destroy), (construct_private_metafile_vfs_uri),
	(athena_metafile_set_directory_uri), (athena_metafile_new),
	(athena_metafile_get), (schedule_next_read), (async_read_start),
	(async_read_done), (async_read_cancel), (corba_is_read),
	(corba_get), (corba_get_list), (corba_set), (corba_set_list),
	(corba_copy), (corba_remove), (corba_rename),
	(corba_rename_directory), (corba_register_monitor),
	(corba_unregister_monitor),
	(athena_metafile_notify_metafile_ready), (call_metafile_changed),
	(call_metafile_changed_for_all_files_mentioned_in_metafile),
	(call_metafile_changed_for_one_file), (create_metafile_root),
	(get_file_node), (get_metadata_string_from_metafile),
	(get_metadata_list_from_metafile),
	(set_metadata_string_in_metafile), (set_metadata_list_in_metafile),
	(set_metadata_in_metafile), (get_metadata_string_from_table),
	(get_metadata_list_from_table), (set_metadata_eat_value),
	(metafile_free_metadata), (get_file_metadata),
	(get_file_metadata_list), (set_file_metadata),
	(set_file_metadata_list), (metafile_get_file_uri),
	(rename_file_metadata), (apply_one_change), (apply_file_changes),
	(athena_metafile_apply_pending_changes), (copy_file_metadata),
	(remove_file_metadata), (athena_metafile_set_metafile_contents),
	(metafile_read_cancel), (can_use_public_metafile),
	(metafile_read_mark_done), (metafile_read_done),
	(metafile_read_try_public_metafile),
	(metafile_read_check_for_directory_callback),
	(metafile_read_check_for_directory), (metafile_read_failed),
	(metafile_read_done_callback), (metafile_read_restart),
	(allow_metafile), (metafile_read_start), (metafile_write_done),
	(metafile_write_failed), (metafile_write_failure_close_callback),
	(metafile_write_success_close_callback), (metafile_write_callback),
	(metafile_write_create_callback), (metafile_write_start),
	(metafile_write), (metafile_write_idle_callback),
	(directory_request_write_metafile):
	* libathena-extensions/athena-metafile.h:
	* libathena-extensions/athena-vfs-directory.c:
	(vfs_is_not_empty):
	Factored the metadata reading/writing code out of athena-directory
	- bug 6661.

2001-03-26  Eskil Heyn Olsen  <eskil@eazel.com>

	Initial commit of machine cloning.
	
	* components/services/Makefile.am:
	* components/services/clone/Makefile.am:
	* configure.in:
	The usual makefile trickery etc.
	
	* components/services/clone/eazel-clone-lib.h:
	* components/services/clone/eazel-clone-lib.c:
	(eazel_install_clone_load_inventory),
	(eazel_install_clone_check_existing),
	(eazel_install_clone_compare_inventory),
	(eazel_install_clone_create_inventory):
	The lib that generates an inventory and does inventory compare.
	
	* components/services/clone/eazel-clone.c:
	(set_parameters_from_command_line),
	(eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal),
	(eazel_download_progress_signal), (eazel_install_progress_signal),
	(eazel_uninstall_progress_signal), (download_failed),
	(install_failed), (uninstall_failed),
	(eazel_preflight_check_signal), (eazel_save_transaction_signal),
	(dep_check), (md5_check_failed), (delete_files), (done),
	(get_password_dude), (set_root_client), (do_clone), (main):
	Rehack of eazel-alt-install-corba.c to act as cli clone util.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c:
	Reenabled --revert...
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_shared), (eazel_install_packagedata_to_xml_int):
	Tighter FILESIZE and BYTESIZE in xml.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_implementation):
	Spew root and DB when starting.
	
	* components/services/install/lib/eazel-package-system-types.c:
	* components/services/install/lib/eazel-package-system-types.h:	
	Authors stuff.
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_suggest_id):
	Committed patch from fcrozat@mandrakesoft.com to correctly set
	RPM4 for Mandrake 8.0

Mon Mar 26 01:39:43 2001  George Lebl <jirka@5z.com>

	This patch killed two people, but Seth says it's not that bad

	* components/help/hyperbola-nav-tree.c
	  (hyperbola_navigation_tree_new):  replace gtk_clist_columns_autosize
	  with gtk_clist_set_column_auto_resize.  The former is a one time
	  thing, whereas we want to do this all the time.  Fixes #7424

Sun Mar 25 17:02:17 2001  George Lebl <jirka@5z.com>

	Review dude: Maciej

	* components/music/id3_frame.c (id3_read_frame)
	  components/music/id3_frame_text.c (id3_get_text)
	  components/music/id3_frame_url.c (id3_get_url)
	  components/music/athena-music-view.c (sort_list)
	  (click_column_callback)
	  components/services/trilobite/libtrilobite/trilobite-root-helper.c
	  (trilobite_root_helper_destroy) (trilobite_root_helper_start)
	  libathena-extensions/athena-file.c
	  (athena_file_list_filter_hidden_and_bac):
	  Use GINT_TO_POINTER and GPOINTER_TO_INT when casting ints to/from
	  pointers to fix 64 bit issues

2001-03-24  Rebecca Schulman  <rebecka@eazel.com>

	* libathena-extensions/athena-medusa-support.c:
	(athena_medusa_check_cron_is_enabled):
	Add check for "cron" as well as "crond" so that cron will
	also be recognized on Debian.

2001-03-23  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 2968 (Control-O insufficient for keyboard activation
	of selected files)

	Fixed bug 5688 (Context menu on the desktop shouldn't have
	"Open in New Window")

	In the new design, "Open" is always sensitive. It follows the user's
	preference, except if the user's preference is "use same window" and
	there are multiple items selected. "Open in New Window" is only
	available when the preference is "use same window". If the preference
	is "use new window", "Open in New Window" is replaced by "Open in
	This Window", which is enabled only if there is exactly one item
	selected (and which never launches an external application).

	"Open in New Window" and "Open in This Window" both have 
	Control-Shift-O as a keyboard equivalent (only one of them
	is visible at a time, of course).

	The desktop right-click menu only has "Open", which behaves the
	same way it does currently.

	I think the only slightly useful behavior that has been lost is
	the ability to specifically open an item in a new window via the
	menu item as opposed to opening it in a way that will find an
	existing window if there is one. Them's the breaks.

	* src/file-manager/athena-directory-view-ui.xml:
	Changed "OpenNew" to "OpenAlternate" for clarity;
	added Control-Shift-O as accelerator for OpenAlternate.
	
	* src/file-manager/athena-desktop-icon-view-ui.xml:
	Set hidden attribute on OpenAlternate command.

	* src/file-manager/fm-directory-view.c: 
	(open_callback): Changed to call the same code that hitting
	Enter calls, instead of only activating a single selected item.
	(open_alternate_callback): Renamed from open_in_new_window_callback, 
	checks new-window preference and handles selected items accordingly.
	(fm_directory_view_initialize): add preferences callback to update
	menus when new-window preference changes.
	(fm_directory_view_destroy): remove preferences callback.
	(real_merge_menus): updated for name changes.
	(real_update_menus): rework sensitivity and label logic for Open
	and Open in New/This Window menu items.

	(filtering_changed_callback): Check whether the filtering preferences
	have actually changed before deciding to reload the directory; this
	reduces redrawing when switching user levels. The preference callbacks
	are called when the user level changes even if the preference value
	hasn't actually changed. Other places could use similar checks, some of
	which I may do later if Ramiro doesn't fix the preference mechanism
	itself first.

2001-03-23  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	More loose ends of the file copy and paste feature.

	* libathena-extensions/athena-directory-notify.h:
	Rename AthenaFileChangesQueuePositionSetting to
	AthenaFileChangesQueuePosition. Add a field so it can
	be used to set or remove a position. Rename
	athena_directory_schedule_position_setting to
	athena_directory_schedule_position_set.
	
	* libathena-extensions/athena-directory.c:
	(athena_directory_schedule_position_set): Change name and also
	make it handle the case where we want to remove a position rather
	than setting it.
	
	* libathena-extensions/athena-file-changes-queue.h:
	* libathena-extensions/athena-file-changes-queue.c:
	(athena_file_changes_queue_schedule_position_set): Name change.
	(athena_file_changes_queue_schedule_position_remove): New
	function used to remove a position.
	(position_set_list_free): Name changes, added the new remove
	flavor where needed.
	(athena_file_changes_consume_changes): Updated SET case,
	added case for REMOVE.
	
	* libathena-extensions/athena-file-operations.c:
	(icon_position_iterator_get_next): New function, used to extract
	the next position out of the iterator.
	(apply_one_position): Simplified by using
	icon_position_iterator_get_next, and also changed so that the
	position is always either removed or set.

	* libathena-extensions/athena-file-operations.h: Fixed header.
	
	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-extensions.c:
	(event_get_time), (athena_get_current_event_time): Add new
	function to get the current event time. This is available in GTK
	2.0, so we can remove it when we move up.
	
	* libathena-extensions/athena-link.c:
	(athena_link_local_create): Updated for change to notify API.
	
	* libathena-extensions/athena-program-choosing.c:
	(athena_launch_application_from_command): Added FIXME.
	
	* src/file-manager/fm-directory-view.c: (copy_or_cut_files): Use
	new athena_get_current_event_time function. Put up a status
	string about the cut or copy. Since there's no other feedback this
	is especially important.
	(paste_files_callback): Use new athena_get_current_event_time
	function.
	(real_selection_clear_event): Erase the status string.
	(real_selection_received): Put up a status string if the paste
	does nothing. Since we can't desensitize the Paste Files command,
	this is the next best thing.

2001-03-23  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/file-manager/fm-directory-view.c: (real_update_menus):
	* src/file-manager/athena-directory-view-ui.xml:
	Added underscore accelerator for Delete command (when it's
	visible) and put Cut/Copy/Paste into the right-click menu for
	files.

2001-03-23  John Sullivan  <sullivan@eazel.com>

	At Andy and Arlo's request, removed the icon from the
	Preferences menu and moved the Help menu after it. Andy
	is investigating another way for the current user level
	symbol to appear onscreen somewhere.

	* src/athena-shell-ui.xml: Moved Preferences submenu
	before Help; removed 'pixtype="filename"'
	
	* src/athena-window-menus.c: 
	(switch_to_user_level): Removed code to set menu title icon.
	(user_level_changed_callback), (update_user_level_menu_items):
	Removed these functions, which were only setting the menu title icon.
	(athena_window_initialize_menus_part_1): removed call to
	update_user_level_menu_items and callback setup for 
	user_level_changed_callback.

2001-03-23  John Sullivan  <sullivan@eazel.com>

	Fixed bug 7846: crash removing only bookmark in Bookmarks window.

	GtkCList is emitting a select_row signal on a non-existent row, 
	which caused a Athena parameter check to fail. Worked around 
	this in Athena. I don't know when this started happening in GTK,
	but I'm sure it didn't crash here when the bookmarks window
	was last tested. I've sent mail to gtk-devel-list about the
	GtkCList issue.

	* src/athena-bookmarks-window.c: (on_select_row):
	Bail out without doing anything if selected row is not
	a valid row number.

2001-03-23  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Make properties window show link target path for
	symbolic links (not for AthenaLinks yet; I'll do
	that separately). This shows "unknown" with old gnome-vfs;
	but will show the right result with the latest gnome-vfs
	(well, it will after Pavel checks in, which will be very
	soon).

	* libathena-extensions/athena-file.c:
	(athena_file_get_string_attribute): Add support
	for "link_target"
	
	* src/file-manager/fm-properties-window.c:
	(should_show_link_target): returns TRUE if file is a
	symbolic link.
	(create_basic_page): Add "Link Target" field.

2001-03-22  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 6613 (no way to delete files without using trash) by
	integrating Maciej's patch to add an optional Delete command (with
	some fixes to the patch). There may still be some loose ends.
	
	Fix bug 2206 (No way to move or copy a file to a different
	directory from keyboard) by implementing Cut, Copy, and Paste for
	files, in a way that will be familiar to Windows users. The
	positioning of the new files is not right yet (they inherit their
	position from the old files), there is no feedback when you have
	cut some files (Arlo's idea, which I might implement, is to make
	them translucent to show they are "on the way out") or when you
	have copied some files, and I think there are some other loose
	ends.

	Fixed cut, copy, and paste within the file names when you do a
	rename. This wasn't working at all.

	Got rid of configure-time checks that were looking at the
	existence of some special system files.

	Fixed a few minor bugs discovered by code inspection.
	
	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog): Add expert preference to add a
	Delete command that bypasses the Trash.
	* src/file-manager/athena-directory-view-ui.xml: Add Delete, Cut
	Files, Copy Files, and Paste Files.
	* src/file-manager/fm-directory-view.c: (confirm_delete_directly),
	(delete_callback): Add delete code.
	(bonobo_menu_empty_trash_callback): Get rid of extraneous cast.
	(fm_directory_view_initialize): Track the delete preference. Set
	the flags properly to indicate we have our own X window. Add a
	target so GTK knows that we accept pastes of copied files.
	(forget_clipboard_contents): Helper for when we are no longer the
	clipboard owner.
	(fm_directory_view_destroy): Remove the delete preference
	callback. Free the clipboard contents.
	(offset_drop_points): Change so it handles NULL for the list of
	points.
	(trash_or_delete_files_common): Remove unneeded parameters.
	(get_current_event_time): New function, placeholder that just
	returned GDK_CURRENT_TIME. Perhaps we should get the real event
	time here for use in clipboard manipulation calls.
	(copy_or_cut_files): New function. Save the selection for later
	use in a paste.
	(copy_files_callback), (cut_files_callback): Call the new
	copy_or_cut_files function.
	(paste_files_callback): Do the clipboard convert that results in
	the paste operation.
	(real_selection_clear_event): Forget the clipboard contents.
	(real_selection_get): Convert the selection into the appropriate
	format and put it on the clipboard.
	(convert_lines_to_str_list): Helper function for decoding incoming
	pasted files.
	(real_selection_received): Handle pasted files by parsing and then
	triggering a file copy operation.
	(real_merge_menus): Add verbs for cut, copy, and paste.
	(enable_delete_changed_callback): Keep track of delete command
	status in a boolean.
	(real_update_menus): Show delete command if the preference is on
	and we are not showing "Delete from Trash". Update names of the
	Cut and Copy command depending on how many files are selected.
	Also desensitize them when none are selected.
	(fm_directory_view_select_file): Initialize an uninitialized field.
	(fm_directory_view_move_copy_items): Allow relative_item_points to
	be NULL.
	(real_realize): Create our own X window.
	(real_size_allocate): Trick GtkScrolledWindow into doing the right
	thing despite the fact that we have our own X window.
	(fm_directory_view_initialize_class): Moved down to the bottom so
	we don't need so many forward declaractions. Added code to set up
	some needed atoms and new default handlers.
	
	* libathena-extensions/athena-icon-text-item.c:
	(send_focus_event), (iti_stop_editing), (iti_start_editing): Add
	code to send the appropriate focus events to the fake off-screen
	GtkEntry. This makes the clipboard code that tracks focus-related
	signals work properly with this entry.
	(iti_event): Tweak the sequence and simplify the code a bit.
	* libathena/athena-clipboard.c:
	(set_paste_sensitive_if_clipboard_contains_data): Add more
	FIXMEs. This function is very far from useful, and it's not clear
	that it can be implemented efficiently under X.
	(athena_clipboard_set_up_editable): Get rid of silly
	"grab_focus" hack that was an attempt to address the problems with
	the AthenaIconTextItem. The real solution was to do focusing for
	that item too.
	(athena_clipboard_set_up_editable_in_control): Fix this so it
	works when called on an editable that is already focused.
	* src/file-manager/fm-icon-view.c: (renaming_icon_callback): Get
	rid of "grab_focus" workaround, which wasn't working.

	* acconfig.h:
	* configure.in:
	Remove all configure checks that were checking the existence of
	files.
	* libathena-extensions/athena-medusa-support.c:
	(athena_medusa_check_cron_is_enabled): Simplify logic so there's
	less room for confusion (I did this as a fix for the bug that was
	reported on the mailing list, but Rebecka checked in the small
	patch first). Also change it so we don't need a configure-time
	check for the existence of the process directory and fix it so we
	won't get a core dump if the file doesn't have a space character
	in it. Also change the logic so we don't leave the directory open
	when we do find the cron process.
	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_initialize_class),
	(has_removable_mntent_options),	(get_removable_volumes),
	(volume_is_removable), (volume_is_read_only),
	(mount_volume_get_cdrom_name), (mount_volume_activate_cdda),
	(mount_volume_activate_cdrom), (build_volume_list_delta),
	(get_current_mount_list), (mount_lists_are_identical),
	(verify_current_mount_state), (mount_volume_floppy_add),
	(get_cdrom_type_solaris), (mount_volume_iso9660_add),
	(display_mount_status), (close_error_pipe),
	(athena_volume_monitor_mount_unmount_removable),
	(mount_volume_add_filesystem): Make changes throughout to get rid
	of dependence on configure-time file checks and do things at
	runtime instead. Also use typedefs to make less code conditional.
	Also fix the Solaris CD-ROM code which was casting a GString to
	a (char *) before, so it used absurd file names, and failed to open
	and returned FALSE all the time.
	
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_start_renaming_selected_item): Send the
	renaming signal before setting up the rest of the icon. This
	change is not really needed, but it's a better order to do things.
		
	* libathena/athena-clipboard-ui.xml: Move tips into the
	commands instead of the menu items (for style mostly, no practical
	implications at the moment).
	* src/athena-shell-ui.xml: Remove tips from Cut, Copy, and Paste,
	since tips from insensitive items aren't used, and if we had tips,
	we'd put them on the command, not the menu item, anyway.
	
2001-03-22  John Harper  <jsh@eazel.com>

	Fixed bug 7366 (Smooth text layout cache checks take too long):

	* libathena-extensions/athena-smooth-text-layout-cache.c
	(athena_self_check_smooth_text_layout_cache): only do a small
	number of iterations by default. The
	ATHENA_LAYOUT_CACHE_TESTS environment variable can be used to
	set a larger value. Also, don't print any progress messages

2001-03-22  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7843 (Name changes to Home icon are lost when 
	user level changes)

	* src/file-manager/fm-desktop-icon-view.c:
	(update_link_and_delete_copies): Made name parameter of NULL
	mean "don't require name to match"; added comment.
	(update_home_link_and_delete_copies): pass NULL for name
	to update_link_and_delete_copies.

2001-03-22  Eskil Olsen  <eskil@eazel.com

	reviewed by: a donkey

	* components/services/install/lib/eazel-install-logic2.c:
	(get_package_info):
	changed a g_file_test into a access.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(err_monitor_func),
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(monitor_subcommand_pipe), (manual_rpm_command),
	(eazel_package_system_rpm3_execute):
	Read and flush stderr from rpm, should fix some of the RH70 glibc 2.1.9x problems.
	
	* athena-installer/src/installer.c: (check_system),
	(eazel_install_get_depends), (find_old_tmpdir),
	(eazel_installer_initialize):
	* athena-installer/src/main.c:
	Fixed so it compiles again.
	
	* athena-installer/src/prescript:
	Warn about the glibc, but don' exit

2001-03-22  John Harper  <jsh@eazel.com>

	reviewed by: Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: require freetype version 2.0.1, library version
	6.1.0

2001-03-22  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* src/athena-shell-ui.xml: Added underline accelerators 
	to items in Preferences menu; Changed "Preferences..." to
	"Edit Preferences..." so it has a different name than menu;
	improved tips for user level items.

2001-03-22  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 1853 (Want preference for always sorting folders first)

	For now, this is a global preference. Making it
	per-window later is a possibility. Arlo is working on
	a design for directory view defaults that may incorporate
	this.

	* libathena-extensions/athena-file.h:
	* libathena-extensions/athena-file.c:
	(athena_file_compare_for_sort_reversed): Eliminated this in
	favor of a parameter to athena_file_compare_for_sort.
	(athena_file_compare_for_sort): Add a parameter for reversed,
	and another for directories_first.
	(athena_file_compare_for_sort_internal): Former guts of
	athena_file_compare_for_sort moved here.
	(athena_self_check_file): Update compare_for_sort self-checks.

	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog): Install an "Always list
	folders before files" preference in the Icon and List Views
	section.
	
	* src/file-manager/fm-directory-view.h:
	(sort_directories_first_changed): New function pointer for
	subclasses to override.
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_should_sort_directories_first): New function 
	for subclasses to call.
	(sort_directories_first_changed_callback): Call virtual function
	when preference changes.
	(fm_directory_view_initialize): Store initial value of preference;
	install preference callback.
	(fm_directory_view_destroy): Remove preference callback.
	
	* src/file-manager/fm-desktop-icon-view.c:
	(desktop_icons_compare_callback): Respect preference
	setting.

	* src/file-manager/fm-icon-view.c:
	(icon_container_compare_icons_callback): Update to respect
	directories_first setting.
	(icon_container_compare_icons_by_name_callback): Update for API
	change only.
	(fm_icon_view_sort_directories_first_changed): Override virtual
	function; re-sort icon container if in auto-layout mode.
	(fm_icon_view_initialize_class): Install virtual function override.
	
	* src/file-manager/fm-list-view.c: 
	(fm_list_view_initialize_class): Install virtual function override.
	(list_view_compare_files_for_sort): New function, broken out of
	fm_list_view_compare_rows, and changed to respect directories_first
	setting.
	(fm_list_view_compare_rows): Break out list_view_compare_files_for_sort.
	(compare_rows_by_name): Update for API change only.
	(real_sort_directories_first_changed): Override virtual function;
	re-sort list.
	(fm_list_view_display_pending_files): Update code that sorts
	pending items before adding them to list.
	(fm_list_view_sort_items): Add comment.

2001-03-22  Ramiro Estrugo  <ramiro@eazel.com>

	* configure.in: Make the configure report a little easier to read
	and modify.

2001-03-21  Rebecca Schulman  <rebecka@eazel.com>
	Commit patch from Gianni Tedesco <gianni@ecsc.co.uk>

	* libathena-extensions/athena-medusa-support.c:
	(athena_medusa_check_cron_is_enabled):
	Fix possible infinite loop in the case where
	parts of proc may not be readable.

2001-03-21  Eskil Heyn Olsen  <eskil@eazel.com>

	This implements feature for bug 6960 - queries to softcat are now
	done for a variable number of packages at a time, radically
	speeding up dependency resolution.
	
	Also did a s/DistributionInfo/TrilobiteDistributionInfo/ for the
	Less Namespace Pollution Compaign 2001.

	* components/services/install/command-line/eazel-test-softcat.c:
	(main):
	Added a --funk=<int> which uses the new get_info_plural methods.

	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages_helper), (post_check), (get_package_info),
	(dedupe_foreach_depends), (check_tree_helper),
	(check_no_two_packages_has_same_file), (install_packages):
	Moved a lot of code around to use the new
	eazel_softcat_get_info_plural  feature.

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize):
	Set packages pr query to a sane value (50 pr query)

	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(eazel_install_package_provides_compare),
	(eazel_install_package_feature_compare),
	(eazel_install_package_name_compare),
	(eazel_install_package_id_compare):
	Added package_id_compare and package_feature_compare.
	Removed some debug output.
	
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_initialize), (eazel_softcat_set_packages_pr_query),
	(get_search_url_for_package), (warn_about_packages_failing),
	(eazel_softcat_query), (eazel_softcat_get_info),
	(split_by_multiple), (eazel_softcat_get_info_plural_helper),
	(eazel_softcat_get_info_plural):
	Added a packages_pr_query field to softcat->private.
	Voodoo to do the multiple packages pr. query. Pseudokode and
	stuff in comments.

	* components/services/install/lib/eazel-softcat.h:
	* components/services/inventory/eazel-inventory-collect-software.c:
	(eazel_inventory_collect_software):
	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.c: (determine_turbolinux_version),
	(determine_mandrake_version), (determine_suse_version),
	(determine_debian_version), (determine_redhat_version),
	(trilobite_get_distribution), (trilobite_get_distribution_name),
	(trilobite_get_distribution_arch),
	(trilobite_distribution_compare):
	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_suggest_id):
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata):
	s/DistributionInfo/TrilobiteDistributionInfo/	

2001-03-21  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7506 (Font preference has silly, overly-specific
	label)

	Fixed bug 4049 ("Other Application" is bad terminology when
	there are no applications listed)
	
	Fixed bug 6193 (Users confused by lack of title on "ski" menu)

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions): Changed wording
	for font choices.	

	* src/file-manager/fm-directory-view.c:
	(reset_bonobo_open_with_menu): Changed "Other Application..."
	to "An Application..." if there aren't any listed.
	
	* src/athena-shell-ui.xml: Add "Preferences" title to Preferences
	menu.


	Other changes

	* src/file-manager/fm-directory-view.h: Moved some #defines
	only used in fm-directory-view.c into that file.
	
	* src/athena-first-time-druid.c: (set_up_cron_information_page):
	Removed obsolete comment.	

2001-03-20  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	* Makefile.am, configure.in, athena-config.in, athena.spec.in,
	athenaConf.sh.in, .cvsignore: Add athena-config and
	athenaConf.sh so other modules can sensibly depend on
	libathena (this fix should make it into 1.0.2, I guess I should
	file a bug at some point).

2001-03-20  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fix a bunch of font bugs that dropped of the 1.0 plate.
	
	7371 - Fonts in font pickers are in no particular order 
	7387 - Font selection defaults to bold for some fonts 
	7421 - Font option menu in "Appearances" too long for screen
	7473 - Switching off "smooth graphics" leaves font family grouping
	7486 - Font style menu disabled when it shouldn't be
	7487 - Would be nice if font styles were submenus 
	7718 - 'cursor' font doesn't display 
	
	* libathena-extensions/athena-art-gtk-extensions.h:
	* libathena-extensions/athena-art-gtk-extensions.c:
	(athena_screen_get_dimensions): Fix a really silly typo.
	(athena_gtk_widget_get_dimensions): Make the documentation a
	little better.
	(athena_gtk_widget_get_preferred_dimensions): New function to
	get a widget's preferred dimensions.

	* libathena-extensions/athena-font-manager.c:
	(font_description_new): Use consistent variable names.  Set a
	'is_ignored' flag if the font is ignored.
	(font_description_free): Use consistent variable names.
	(font_description_table_find): Ignore black listed fonts.
	(font_description_table_for_each): Ignore black listed fonts.
	(font_directory_is_ignored): Put constants on top of file.
	(font_foundry_is_ignored), (font_family_is_ignored): New functions
	to check for specific black listed font foundries and/or families.
	(ensure_local_font_table): Rename to 'local' from 'global' - this
	is something i need for a future change where the font manager
	will be able to handle both 'local' and 'server' fonts.
	Move the font ignoring code from athena-font-picker.c here so
	that it is in one place.

	* libathena-extensions/athena-font-picker.h:
	Subclass it from GtkHBox instead of GtkVBox now that it is not as
	wide.
	* libathena-extensions/athena-font-picker.c:
	(option_menu_button_press_event), (menu_deactivate),
	(athena_font_picker_initialize), (athena_font_picker_destroy),
	(style_menu_item_activate_callback),
	(style_menu_item_button_release_event), (font_picker_add_item),
	(font_picker_populate), (font_make_name), (font_make_style_name),
	(font_slant_string_to_enum), (font_set_width_string_to_enum),
	(font_style_entry_new), (font_style_entry_free),
	(compare_font_entry), (global_font_list_get), (compare_int),
	(compare_style), (global_font_list_populate_callback),
	(athena_gtk_menu_shell_get_num_items),
	(font_picker_get_selected_style_entry),
	(font_picker_find_entries_for_font),
	(font_picker_get_index_for_entry), (athena_font_picker_new),
	(athena_font_picker_get_selected_font),
	(athena_font_picker_set_selected_font):
	Move the black listed font code into the font manager.  Use option
	menus directly instead of AthenaStringPickers.  Put the style
	choices in cascading submenus.  Deal with the case when too many
	choices dont fit on the screen.

	* test/test-athena-font-manager.c:
	* test/test-athena-font-picker.c:
	Update for font picker changes.
	
2001-03-20  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/Makefile.am:
	Readded the rpmview
	
	* components/rpmview/Makefile.am:
	Added XML_LDFLAGS/CFLAGS
	
	
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree), (prune_failed_packages_helper),
	(prune_failed_packages), (add_to_dedupe_hash),
	(post_get_softcat_info), (get_softcat_info),
	(get_package_info_foreach), (get_package_info),
	(dedupe_foreach_depends), (dedupe_foreach), (dedupe),
	(is_satisfied_from_package_list), (check_dependencies_foreach),
	(check_dependencies), (do_dep_check_internal),
	(check_if_related_package),
	(check_update_for_no_more_file_conflicts),
	(check_for_no_more_missing_features), (check_tree_helper),
	(clean_up_dedupe_hash), (get_packages_with_mod_flag):
	Made a lot of changes so the packageslists carried around can
	contain both PackageData and PackageDependencies mixed up. This
	makes the softcat queries have the version/sense flags that the
	packages require.

	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach):
	Ported some changes from the 1.0 branch
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedependency_finalize), (packagedependency_class_initialize),
	(packagedependency_initialize), (packagedependency_get_type),
	(packagedependency_new), (packagedependency_copy),
	(packagedata_finalize), (packagedata_fill_in_missing),
	(flatten_packagedata_dependency_tree):
	Turned PackageDependency into a proper gtk+ object

	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package):
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header):
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_query), (eazel_softcat_get_info):
	(also imported the xml spam from 1.0)
	* components/services/install/lib/eazel-install-corba-types.c:
	(packagedata_tree_from_corba_packagedatastructlist):
	Changes to use PackageDependency as a gtk+ object

2001-03-20  John Sullivan  <sullivan@eazel.com>

	Fixed bug 4355: Built-in bookmarks icons change after first view

	Also reduced the number of times that refresh_bookmarks_menu
	is called since it was showing up in some profiling.

	* libathena-extensions/athena-bookmark.h:
	* libathena-extensions/athena-bookmark.c:
	(athena_bookmark_initialize_class), (athena_bookmark_set_name),
	(bookmark_file_changed_callback): Split the "changed" signal into
	"appearance_changed" and "content_changed". "appearance_changed" is
	emitted only if the name or icon change. "content_changed" is emitted
	if the URI changes.

	* src/athena-bookmark-list.c: (insert_bookmark_internal):
	Connect to both appearance_changed and content_changed.
	
	* src/athena-window-menus.c: (bookmark_holder_new):
	Refresh menu only on appearance_changed, not content_changed.

	* data/static_bookmarks.xml: Added "i-web" as icon name for
	all the built-in bookmarks, since this is the icon they will
	end up with after being visited. (Now, visiting a built-in
	bookmark will not cause a refresh of the bookmarks menu.)
	
2001-03-20  John Sullivan  <sullivan@eazel.com>

	* src/file-manager/fm-directory-view.c: (run_script_callback):
	shell-quote the script name. Fixes bug Robin found where scripts
	with spaces in their names didn't work.

2001-03-20  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Finished bug 4875 (design for running arbitrary scripts on
	selected items)

	There are lots of ways this could be improved, but I've
	finished the first pass at this feature. We'll need to get
	feedback before deciding how to improve it later. Please
	play with it -- hopefully it is self-explanatory. Start by
	selecting Scripts > Open Scripts Folder.

	* libathena-extensions/athena-file.h:
	* libathena-extensions/athena-file.c: 
	(compare_by_name_cover): Simple cover for compare_by_name
	that casts parameters.
	(athena_file_list_sort_by_name): New public function.

	* src/file-manager/athena-directory-view-ui.xml: Added name to
	separators before "Open Scripts Folder" so they can be referred
	to in code (shown/hidden)

	* src/file-manager/fm-directory-view.c: 
	(get_scripts_directory): Create Scripts directory if it doesn't 
	exist; mark name of scripts directory for localization.
	(add_numbered_menu_item): Add pixbuf parameter.
	(add_application_to_bonobo_menu),
	(add_component_to_bonobo_menu): pass NULL for pixbuf
	(get_file_names_as_parameter_string): Changed name from
	get_selected_file_names..., now takes file list as parameter.
	(get_file_paths_or_uris_as_newline_delimited_string): New function.
	(get_file_paths_as_newline_delimited_string),
	(get_file_uris_as_newline_delimited_string): New functions, simple
	covers for get_file_paths_or_uris...
	(set_script_environment_variables): New function, sets some environment
	variables up so scripts can use them.
	(unset_script_environment_variables): New function, unsets those same
	environment variables.
	(run_script_callback): set/unset environment variables around calling
	script.
	(add_script_to_menus): add pixbufs for files
	(reset_scripts_menu): sort scripts by name; hide separator after scripts
	if there are no scripts
	(notify_user_if_no_scripts_callback): Explain script behavior and
	special environment variables in Details part of dialog.
	(call_when_ready_on_scripts_directory): include attributes required to
	get icon for file.
	(open_scripts_folder_callback): Change error message for unexpected
	case where scripts folder is nonexistent.

2001-03-20  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: upped version 1.0.0 

2001-03-19  John Sullivan  <sullivan@eazel.com>
	
	More work on bug 4875 (design for running arbitrary
	scripts on selected items). 

	Mostly done with this first pass. I still need to 
	set a few environment variables for the scripts' sake, 
	and I still need to add	code to create the scripts folder 
	if it's missing. (To test at this point, create your own 
	directory named "scripts" in ~/Athena.)

	* src/file-manager/athena-directory-view-ui.xml: Renamed
	Run Script submenu to Scripts; added Open Scripts Folder to
	Scripts submenu.

	* src/file-manager/fm-directory-view.c:
	(get_scripts_directory): returns NULL if directory doesn't exist.
	(scripts_added_or_changed_callback): New function, marks
	scripts menu invalid and schedules menu update.
	(connect_script_handlers): new function, monitor scripts
	directory and connect to files_added and files_changed signals
	so we can notice when scripts have changed.
	(fm_directory_view_initialize): Call connect_script_handlers.
	(get_selected_file_names_as_parameter_string): New function,
	returns string of selected file names, each shell-quoted.
	(run_script_callback): Pass selected file names if directory
	is local (else pass nothing); add FIXMEs
	(reset_scripts_menu): Don't change sensitivity based on script
	non-zero count since there's always the Open Scripts Folder item.
	(any_valid_scripts): New helper routine to see if scripts folder
	contains any executables.
	(notify_user_if_no_scripts_callback): New function, puts up
	informative message if there are no executables in scripts folder.
	(call_when_ready_on_scripts_directory): New helper function,
	slightly generalized from schedule_reset_scripts_menu.
	(schedule_reset_scripts_menu): Now calls new helper function.
	(open_scripts_folder_callback): New function, displays the contents
	of the scripts folder and also presents informative message if
	it contains no executables.
	(real_merge_menus): Add open_scripts_folder_callback for verb; mark
	scripts submenu invalid rather than updating it here.
	(real_update_menus): reset scripts menu if it's marked invalid.
	(disconnect_scripts_directory_handler): New helper function to
	disconnect a signal handler on the scripts directory.
	(disconnect_script_handlers): disconnect all the stuff we connected.
	
2001-03-19  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* libathena-extensions/athena-glyph.c:
	(athena_glyph_draw_to_pixbuf):
	Speed up drag-selection a whole bunch by making this call
	4 x faster in the anti-aliased mode.

2001-03-19  Robin * Slomkowski  <rslomkow@eazel.com>

	* components/music/Makefile.am: added non-i386 files
	  to EXTRA_DISTS

2001-03-19  John Sullivan  <sullivan@eazel.com>

	Fixed bug 7817 (Launching mp3 files with mpg123 fails)

	* libathena-extensions/athena-program-choosing.c:
	(athena_launch_application): Code was comparing the
	uri-scheme to "file:" instead of "file".

2001-03-16  Gene Z. Ragan  <gzr@eazel.com>

	* libathena-extensions/Makefile.am:
	One final tweak to get the cdparanoia checks right.
		
2001-03-16  Gene Z. Ragan  <gzr@eazel.com>

	* configure.in:	
	* libathena-extensions/Makefile.am:
	Add checks for cdparanoia to allow enabling of
	cd audio mounting on the desktop.
	
	* libathena-extensions/athena-volume-monitor.c:
	* libathena-extensions/athena-volume-monitor.h:
	Clean up build conditional audio CD handling and
	centralize the allocation of AthenaVolume structures.

2001-03-16  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 610, a small per-window storage leak.

	* src/athena-window.c: (unref_mini_icon): Free icon at quit
	time for leak checking purposes.
	(athena_window_initialize_class): Create the mini-icon here.
	(athena_window_realize): Use it here, instead of re-making
	it each time.

2001-03-16  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	First batch of work for bug 4875 (design for running arbitrary
	scripts on selected items). Only works locally, doesn't notice
	changes to scripts directory, doesn't pass selected items as
	parameters, many other details unfinished.

	* src/file-manager/athena-directory-view-ui.xml: Add "Run Script"
	submenus to File and context menus; add missing tip I happened to
	notice to Open With submenu.

	* src/file-manager/fm-directory-view.c:
	(script_launch_parameters_new), (script_launch_parameters_free):
	New helper functions to manage lifetime of parameters for script
	menu items.
	(get_scripts_directory): New function, returns AthenaDirectory
	object (or NULL) representing scripts directory.
	(fm_directory_view_initialize): Remember scripts directory in
	details struct.
	(fm_directory_view_destroy): clean up scripts directory stuff.
	(add_numbered_menu_item): renamed from add_open_with_program_menu_item
	with no other changes, since it was already exactly general enough
	for my new use.
	(add_application_to_bonobo_menu), (add_component_to_bonobo_menu):
	Update for name change.
	(change_to_view_directory): New function to change working
	directory to the one displayed.
	(run_script_callback): New function to actually execute the script;
	temporarily changes the working directory.
	(add_script_to_menus): New function, adds one script to the two
	Run Script menus.
	(reset_scripts_menu): New function, fills in the two Run Script
	menus from scratch.
	(reset_scripts_menu_callback): New call_when_ready callback, calls
	reset_scripts_menu.
	(disconnect_script_handlers): New function, cleans up pending callbacks.
	(schedule_reset_scripts_menu): New function, sets up a callback when
	the files in the scripts directory are sufficiently known.
	(real_merge_menus): Call schedule_reset_scripts_menu.
	

	Fixed bug 7232 (vague error message and console spam when
	refreshing a directory deleted outside of Athena)

	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_loading_directory): Handle the NOT_FOUND
	case explicitly.

2001-03-16  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7778 (Trash directory state not saved properly).

	* libathena-extensions/athena-trash-file.c:
	(is_delegated_attribute): Function that returns TRUE if it's passed
	one of the attributes that needs to be delegated to the individual
	directories that make up the trash.
	(is_delegated_attribute_predicate): Cover to use partition call on.
	(partition_attributes): Helper that partitions a list into a list
	of the delegated and non-delegated attributes.
	(real_monitor_add), (real_monitor_remove),
	(real_call_when_ready), (real_cancel_call_when_ready),
	(real_check_if_ready): Calls to be used for the trash itself for
	the non-delegated attributes.
	(trash_callback_destroy): Destroy both attribute lists.
	(monitor_add_file): Only monitor delegated attributes here.
	(trash_file_call_when_ready): Wait for the delegated attributes
	on the other files, the non-delegated attributes on this file.
	(trash_file_cancel_call_when_ready): Cancel the wait for both
	the main file and the other files.
	(trash_file_check_if_ready): Check for the delegated attributes
	on the other files, the non-delegated attributes on this file.
	(trash_file_monitor_add): Monitor the delegated attributes
	on the other files, the non-delegated attributes on this file.
	(trash_file_monitor_remove): Remove the monitor from both the
	main file and the other files.
	
	* libathena-extensions/athena-vfs-file.c: Formatting tweaks.

2001-03-16  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 6495 (Emacs-style keybindings not working in location bar
	and other AthenaEntry fields) by adding an expert preference to
	control whether the Emacs shortcuts or the ones in the menu bar
	take precedence. I started with Maciej's patch and did many
	refinements.

	Fix bug 1788 ("Select All" needs to be implemented for text): I
	had to add Select All so it won't do the icon view's Select All
	when you do a select all with the location bar focused.

	Fix bug 5612 (clicking to deselect causes incorrect menu
	sensitivity) by adding another signal handler for button clicks.

	Fix bug 7581 (When trying to restart Athena after crash from bug
	7579 I get a Segmentation Fault). I was just lucky enough to run
	into the problem on my machine.

	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog): Added the new Emacs-shortcut
	preference with the wording requested in the bug report.
	
	* libathena-extensions/athena-entry.h:
	* libathena-extensions/athena-entry.c:
	(emacs_shortcuts_preference_changed_callback): Track the
	preference.
	(athena_entry_initialize): Set up the callback to track the
	preference.
	(athena_entry_destroy): Tear down the callback to track the
	preference.
	(athena_entry_key_press): Allow the emacs shortcuts built into
	GtkEntry to work if the preference is set that way. Also, only
	emit the selection_changed signal if the key is actually handled.
	(athena_entry_motion_notify): Simplify the logic, since it's
	OK to send the selection_changed signal a little too often.
	(select_all_at_idle): Handle the case where the object is
	destroyed.
	(athena_entry_select_all_at_idle): Ref the object to handle the
	case where the object is destroyed before the idle happens.
	(athena_entry_button_press): Send a selection_changed message,
	since pressing the button can cause a selection change.
	(athena_entry_button_release): Send a selection_changed message,
	since pressing the button can cause a selection change.
	(athena_entry_initialize_class): Add new default handlers. Also,
	move to bottom of file so we don't need so many forward
	declarations.

	* libathena/athena-clipboard-ui.xml: Add a Select All Text
	command.
	* libathena/athena-clipboard.c: (select_all): New function to
	select all the text in a GtkEditable. Sadly it needs a special
	case for GtkText.
	(select_all_idle_callback): Callback used to select the text from
	idle.
	(select_all_callback): Callback that sets up the idle. Called from
	the bonobo verb.
	(initialize_clipboard_component_with_callback_data): Add the
	callback for Select All.
	
	* librsvg/rsvg.c: (rsvg_state_init): Initialize more fields,
	including font_size.
	(rsvg_text_handler_characters): Don't try to draw if the font
	size is 0 or negative.
	* librsvg/art_render_mask.c: (art_render_mask_render): Handle
	cases where x1 < x0. The old code would seg. fault. This was the
	reason we got a crash in bug 7581.
	
	* configure.in: Upped the required version of gnome-vfs.

2001-03-16  Robey Pointer  <robey@eazel.com>

	* athena-installer/src/main.c: (main):

	Fixed the old "--help" bug in the installer, finally.

2001-03-15  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7763 (Makefile.am used to install xml data is wrong):
	
	* data/Makefile.am: Integrate build fix from fcrozat. Don't use
	the magic "info" name since it is used for special purposes on
	Mandrake and other systems.

	Other strings:
	
	* THANKS: Added some people who made recent contributions.
	* check-THANKS.pl: Add some more alternate names.

	* components/help/hyperbola-filefmt.c: (locale_score): Fix legal
	code that doesn't compile with some versions of gcc by adding a
	cast.
	
	* help/athena-user-manual/es/.cvsignore: Add
	athena-user-manual.junk.
	
	* libathena-extensions/athena-directory-async.c:
	(metafile_read_check_for_directory_callback),
	(metafile_read_done_callback),
	(metafile_write_failure_close_callback),
	(metafile_write_success_close_callback),
	(metafile_write_create_callback), (directory_load_callback),
	(directory_count_callback), (new_files_callback), (has_problem),
	(deep_count_callback), (mime_list_callback),
	(top_left_read_callback), (get_info_callback),
	(activation_uri_athena_link_read_callback),
	(activation_uri_gmc_link_read_callback),
	(cancel_activation_uri_for_file): Add ref/unref pairs that we need
	in callbacks that use AthenaDirectory objects but that also send
	out signals which might end up unref'ing them.
	
	* libathena-extensions/athena-file-operations.c:
	(athena_self_check_file_operations): Add tests to demonstrate
	bug 7701.
	
	* libathena-extensions/athena-smooth-text-layout-cache.c:
	(athena_self_check_smooth_text_layout_cache): Fix some destroys
	that should have been unrefs.
	
	* libathena-extensions/athena-string.c:
	(athena_self_check_string): Added tests for
	athena_str_get_after_prefix.

2001-03-14  Gene Z. Ragan  <gzr@eazel.com>

	* libathena-extensions/athena-icon-dnd.c:
	(drag_data_received_callback):
	Handle a case where Netscape submits duplicate drag data
	before the first instance of the data has been freed.
		
2001-03-14  Gene Z. Ragan  <gzr@eazel.com>

	* libathena-extensions/athena-icon-container.c:
	(icon_set_position):
	Fixed a minor annoying layout bug on the desktop. When icons were placed
	near the bottom of the desktop, they would sometimes jump
	partially offscreen.
	
2001-03-14  John Sullivan  <sullivan@eazel.com>

	Fixed bug 7696 ("Find" does nothing if location bar hidden)

	* src/athena-window-menus.c:
	(file_menu_toggle_find_mode_callback): Show location bar
	if it had been hidden. This is used by both Find/Browse menu
	item and Find button.

2001-03-14  John Sullivan  <sullivan@eazel.com>

	Fixed bug 7597 (Cut Text's underline accelerator changes
	to conflict with Copy Text's when a text field is focussed)

	* libathena/athena-clipboard-ui.xml: Changed _Cut Text
	to Cut _Text here, to match what it is when no text field
	is focussed.

2001-03-14  Ramiro Estrugo  <ramiro@eazel.com>

	* helper-scripts/athena-restore-settings-to-default.sh:
	Dont clobber any fonts that the user might have installed in
	~/.athena.  This is a bit of hack, but its very inconvenient to
	have these fonts be trashed when testing Athena in a "from
	scratch" environment.
	
	* athena.spec.in:
	Add the "restore settings to default" script to the package.
	
2001-03-13  Gene Z. Ragan  <gzr@eazel.com>

	I have been itching to check some code in for 1.2,
	so now I am doing it!
	
	This will enable drag support from Netscape to Athena.
	Only the desktop handles the drags for now. When I complete
	the async calls in AthenaFile, it will be safe to have the signal
	handled by other views such as FMDirectoryView.
	
	* libathena-extensions/athena-icon-container.c:
	* libathena-extensions/athena-icon-container.h:
	(athena_icon_container_initialize_class):
	Change name of signal create_athena_links
	to handle_uri_list.
		
	* libathena-extensions/athena-icon-dnd.c:
	(drag_data_received_callback), (receive_dropped_uri_list),
	(athena_icon_container_get_drop_action):
	Add more general logic to handle a drop of a list of URIs.
	Don't expect them to only contain only the paths to
	gmc desktop entries.
		
	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_initialize):
	Connect to changed signal name handle_uri_list.
	
	(icon_view_handle_uri_list):
	Use more generalized logic to handle a drop of a URI list.
	Determine what the list element contains and either convert from
	a DesktopEntry or create a link that contains a URI.

2001-03-13  Jason Leach  <jasonleach@usa.net>

	reviewed by: Darin Adler <darin@eazel.com>
	
	* libathena-extensions/athena-metafile-factory.h: builddir !=
	srcdir fix.

2001-03-12  Robey Pointer  <robey@eazel.com>

	reviewed by: Robin * Slomkowski  <rslomkow@eazel.com>

	* athena-installer/src/prescript:

	Tell RH70 users who don't have glibc 2.2 that they need to
	upgrade, and tell them a hacky way to do it.

2001-03-12  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>

	* athena-installer/src/Makefile.am:
	* athena-installer/src/installer.c: (add_bullet_point_to_vbox),
	(is_toplevel_package), (report_unusual_errors), (install_failed):
	* athena-installer/src/main.c:

	Turn off the SEGV handlers, make --debug no longer the default,
	and point the installer at the production servers again.  Add a
	special-case error message to be displayed when Athena is
	already installed.

2001-03-12  Robin * Slomkowski  <rslomkow@eazel.com>

	* components/help/topleveldocs.xml: updated with 
	  changes from http://bugzilla/show_bug.cgi?id=7663

2001-03-12  Eric Fischer  <eric@eazel.com>

	Merge from 1.0 branch:

	reviewed by: Robin * Slomkowski <rslomkow@eazel.com>

	* configure.in:
	Change ammonite version checking to use the same logic as
	other version number checks, to fix the broken tinderbox

	* athena.spec.in:
	Inherit the required ammonite version number from configure.in

2001-03-12  John Sullivan  <sullivan@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>

	Fixed bug 7666 (default user level should be Intermediate)

	* libathena-extensions/athena-preferences.c:
	(athena_preferences_get_user_level): Reworked function a
	little to support explicit default; made Intermediate the
	default.

2001-03-10  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(add_to_dedupe_hash), (post_get_softcat_info),
	(dedupe_foreach_depends), (check_if_related_package),
	(check_tree_helper), (clean_up_dedupe_hash):
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach):

	Backport Eskil's dedupe changes to head, so we can build the
	installer here.  This fixes the "softcat is updating" bug (which
	turned out to have nothing to do with softcat).

2001-03-10  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>
	(implicitly)

	Backport a few patches that appear to have only made it to the 1.0
	branch, so we can start building the installer on CVS head.

	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages_helper):	

	That cancelled vs. already-installed bug, plus the "not deduping
	myself" patch.
	
	* components/services/install-view/callbacks.c:
	(athena_service_install_done):

	Remove the spurious "panic" warning.

2001-03-09  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>
	             Eskil Heyn Olsen  <eskil@eazel.com>
		     Robey Pointer  <robey@eazel.com>
	
	Fixed bugs 7411 (installer crashes, but successfully installs),
	7510 (tinderbox installer crashes 3 lines into gnome init) and
	7123 (Installer uses a question mark on black background in
	dialogs). These were all caused by the fact that Imlib is
	completely unusable linked statically. So to fix them I removed
	all dependency on imlib and gnome-libs from the bootstrap
	installer (since so many parts of gnome-libs, including
	gnome_init, make imlib calls).

	* components/services/install/lib/eazel-install-logic2.c:
	(get_softcat_info),
	(check_conflicts_against_already_installed_packages):
	* components/services/install/lib/eazel-install-metadata.c:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_is_dir), (eazel_install_save_transaction_report):
	* components/services/install/lib/eazel-install-problem.c:
	* components/services/install/lib/eazel-install-protocols.c:
	(eazel_install_fetch_file):
	* components/services/install/lib/eazel-install-tests.c:
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(generate_xml_package_list):
	* components/services/install/lib/eazel-package-system-rpm3.c:
	* components/services/install/lib/eazel-package-system-rpm4.c:
	* components/services/install/lib/eazel-package-system-types.c:
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system.c:
	* components/services/install/lib/eazel-softcat.c:
	* components/services/trilobite/libtrilobite/Makefile.am:
	* components/services/trilobite/libtrilobite/trilobite-core-distribution.c: 
	(trilobite_get_distribution):
	* components/services/trilobite/libtrilobite/trilobite-core-distribution.h:
	* components/services/trilobite/libtrilobite/trilobite-core-network-slim.c:
	* components/services/trilobite/libtrilobite/trilobite-core-network.h:
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c:
	* components/services/trilobite/libtrilobite/trilobite-i18n.h:
	* athena-installer/install-lib/Makefile.am:
	* athena-installer/libtrilobite/Makefile.am:
	Avoid depending on libgnome or libgnomeui in libeazelinstall or
	libtrilobite when building in static minimal mode.

	* athena-installer/src/Makefile.am: Don't link against gnome
	libraries or imlib.

	* athena-installer/src/callbacks.c,
	athena-installer/src/callbacks.h,
	athena-installer/src/installer.c,
	athena-installer/src/installer.h, athena-installer/src/main.c
	athena-installer/src/gtk-hackery.c: Minor tweaks to avoid GNOME
	and Imlib dependencies.

	* athena-installer/src/fake-stock.h,
	athena-installer/src/fake-stock.c:
	(fake_stock_pixmap_new_from_xpm_data, fake_stock_pixmap_button,
	fake_stock_or_ordinary_button): Some hacky code to allow replacing
	the real stock code.

	* athena-installer/src/gnome-dialog-util.c,
	athena-installer/src/gnome-dialog-util.h,
	athena-installer/src/gnome-dialog.c,
	athena-installer/src/gnome-dialog.h,
	athena-installer/src/gnome-druid-page.c,
	athena-installer/src/gnome-druid-page.h,
	athena-installer/src/gnome-druid.c,
	athena-installer/src/gnome-druid.h,
	athena-installer/src/gnome-messagebox.c,
	athena-installer/src/gnome-messagebox.h,
	athena-installer/src/gnome-types.h: Replace reliance on
	gnome-stock (and therefore imlib) with fake-stock calls.

	* athena-installer/src/athena-druid-page-eazel.h,
	athena-installer/src/athena-druid-page-eazel.c: Pruned and
	massively hacked to avoid depending on the canvas, etc.

	* athena-installer/src/package-tree.c, 
	athena-installer/src/athena-druid.c,
	athena-installer/src/athena-druid.h: Avoid GNOME and imlib
	dependencies.

2001-03-10  Mike Fleming  <mfleming@eazel.com>

	reviewed by: <rslomkow@eazel.com>

	Bug 6826: 

	Added --with-build-message to ./configure.  A build message will
	display in the about box if no EAZEL_TIMESTAMP (used by hourly builds)
	has been set.

	The default build message for CVS builds "Development Version"

	* acconfig.h:
	* configure.in:
	* libathena-extensions/athena-file-utilities.c:
	(athena_get_build_message):
	* libathena-extensions/athena-file-utilities.h:
	* src/athena-window-menus.c: (help_menu_about_athena_callback):

2001-03-09  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>
                     Pavel Cisler <pavel@eazel.com>

	Fix bug 7609 (closing Show Properties window when new name
	conflicts leads to crash):

	* libathena-extensions/athena-stock-dialogs.c:
	(athena_run_simple_dialog), (create_message_box): Don't use
	an already-destroyed window as a parent.

2001-03-09  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7587 (Copying text in Notes with menu item kills Notes
	[also Text viewer, etc]):

	* libathena/athena-clipboard.c: (do_with_fake_current_event):
	Function to set up a non-NULL event so the code in GtkEditable
	won't die.
	(cut_callback), (copy_callback), (paste_callback): Use the new
	function.

2001-03-09  John Sullivan  <sullivan@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>
	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7615 (searching for "    " crashes)

	* src/athena-simple-search-bar.c:
	(athena_simple_search_criteria_to_search_uri):
	Change code that counts characters in search URI
	to use the same math as the code that appends
	to string.

2001-03-09  Dan Mueth  <dan@eazel.com>

	Updates to translated docs:

	Christian Rose <menthos@menthos.com>:	
	* help/athena-quick-reference/sv/index.html:

	Pablo del Campo <pablodc@mapfre.com.ar>:
	* help/athena-user-manual/es/athena-user-manual.sgml:

2001-03-09  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	Fix bug 7547 - Multi byte locales should default to non smooth
	graphics mode
	
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_defaults):
	Make multi byte locales default to non smooth mode, so that it
	works for more Japanese user most of the time.  Japanese users can
	still select smooth mode if they have the right scalable font in
	their system.

2001-03-09  Dan Mueth  <dan@eazel.com>

	reviewed by: Don Melton <don@eazel.com>

	Putting in Vera's updated Release Notes.
	Bug #: 7559, 7588

	* help/athena-release-notes/C/athena-release-notes.sgml:

	Putting in Vera's updated User Manual. (See TRACKED_CHANGES
	for details on what has changed.)
	Bug #: 7559, 7589

	* help/athena-user-manual/C/athena-user-manual.sgml:
	* help/athena-user-manual/C/TRACKED_CHANGES:

2001-03-08  John Sullivan  <sullivan@eazel.com>

	fix by: Andy Hertzfeld <andy@eazel.com>
	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 7580 (Throbber flashing constantly when animating)

	* components/throbber/athena-throbber.c: (draw_throbber_image):
	Only clear the gdk window once per cycle, instead of for every frame.

2001-03-08  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>

	* athena-installer/src/installer.c: (start_logging):

	Revert earlier logfile breakage by changing the perms check to
	match the perms mjs is using later on.

2001-03-08  John Harper  <jsh@eazel.com>

	reviewed by: Seth Nickell  <seth@eazel.com>

	Fixed bug 7557 (Athena does not automatically start on GNOME
	startup after installation):

	* src/athena-first-time-druid.c (set_up_gmc_transition_page):
	don't display the `add athena to session' option
	
2001-03-08  John Harper  <jsh@eazel.com>

	reviewed by: Robin * Slomkowski <rslomkow@eazel.com>

	Fixed bug 7550 (SOLARIS: text drawn incorrectly in anti-aliased
	mode): 

	* configure.in: added `AC_C_BIGENDIAN' check - this means that
	the WORDS_BIGENDIAN macro gets defined on big-endian systems.
	This is required by at least the librsvg/arg_rgba.c file

2001-03-08  Eric Fischer  <eric@eazel.com>

	reviewed by: Don Melton <don@eazel.com>

	* src/run-athena:
	Change ps options to something that should work on any POSIX system,
	and add workaround for 4.4BSD systems' incompatible ps.

2001-03-08  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed and checked in by: Darin Adler <darin@eazel.com>

	Fix bug 7549 - Should block bookman and symbols fonts in older
	RedHat systems
	
	* libathena-extensions/athena-font-picker.c:
	Add 2 more fonts to the black list.  There were already in the
	list, but older RedHat systems name these fonts differently.

2001-03-08  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Tried to fix bug 7018 (Irreproducible segfaults in
	athena_tree_node_get_file): 

	* components/tree/athena-tree-view.c: add a reference to each
	AthenaTreeNode while in the unparented_tree_nodes lists
	(athena_tree_view_should_skip_file): skip the file if
	athena_file_is_gone () returns true

2001-03-08  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed 7500 (Dragging WebDAV file to Trash has no effect.)
	
	* libathena-extensions/athena-file-operations.c:
	* libathena-extensions/athena-file-operations.h:
	(athena_file_operations_move_to_trash):
	Got rid of the call.	

	* src/file-manager/fm-directory-view.c: (trash_callback),
	(fm_directory_view_can_move_uri_to_trash),
	(trash_or_delete_files_common),
	(fm_directory_view_trash_or_delete_files),
	(report_broken_symbolic_link),
	Got rid of callers to the eliminated athena_file_operations_move_to_trash,
	Rework the trash and move calls to all operate on uri strings rather than
	AthenaFile objects.
	
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_move_copy_items):
	Detect a move to Trash, handle it with trash_or_delete_files_common.
	
	* libathena-extensions/athena-file-operations.c:
	(athena_file_operations_copy_move),
	Added a FIXME.

2001-03-08  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Adam Elman  <aelman@eazel.com>

	* athena-installer/package-list.xml.in: Put in some line breaks
	to fix bug 7543 (Text on installer does not wrap in completion
	window).

2001-03-08  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix another part of bug 7494 (History sidebar component spews
	assertions when closing athena window [and sometimes crashes]):
	
	* libathena/athena-idle-queue.c: (execute_queued_functions):
	Change logic so that queued functions no longer execute once the
	caller destroys the queue.

	Fix bug 7564 (opening and quickly closing window in list view
	leads to core dump):

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_destroy): Remove code to empty lists now that
	stop handles that.
	(load_error_callback): Added a FIXME about the fact that we throw
	away some pending files on an error.
	(fm_directory_view_stop): Don't display pending files any more.
	This is a problem when trying to destroy, and also the old code
	displayed only one "batch" of pending files, so it wasn't really
	making sure all the files were displayed anyway. If we re-add the
	code to display pending files here, we'll have to make sure it
	doesn't do this for the destroy case.
	* src/file-manager/fm-list-view.c: Added FIXME asking why the "add
	100 items at a time" logic is only needed for list view, and not
	for icon view. If both kinds of views had it, it could be done
	more simply at the FMDirectoryView level.

	* libathena-extensions/athena-icon-factory.c:
	(athena_get_icon_size_for_zoom_level): Fix this code so that it
	doesn't do a core dump if it gets a bad size. This is not the
	cause of the problem, but it's good to fix this too, because a
	core dump is overreacting to a bad parameter.

2001-03-08  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* athena-installer/src/installer.c (start_logging): After
	creating log file and verifying safety (to avoid /tmp races), make
	it world-readable to fix bug 7544 (eazel-install.log created with
	read-only perms for root).

2001-03-08  Dan Mueth  <dan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Updated required version of ScrollKeeper to 0.1.4

	* configure.in:

	Added Vera's new version of Athena Quick Reference doc text.
	- Updated info on fast searching
	- layout improvements	
	Bug #: 7532,7439 

	* help/athena-quick-reference/C/index.html:

	Added Vera's Athena 1.0 Release Notes document.
	Bug #: 6257, 5825

	* help/athena-release-notes/C/athena-release-notes.sgml:

	Adding Vera's new version of Athena User Manual text.
	- Remove mention of RPM view since it isn't in this release
	Bug #: 7442 

	* help/athena-user-manual/C/athena-user-manual.sgml:

2001-03-07  John Harper  <jsh@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 7511 (Athena sometimes uses wrong home directory
	after going through druid):

	* src/athena-first-time-druid.c (druid_finished): move the
	call to set the user level preference to before the call that
	asks for the user's home URI

2001-03-07  Ramiro Estrugo  <ramiro@eazel.com>
 
 	reviewed by: John Sullivan <sullivan@eazel.com>
 
 	Fix bugs:
 
 	7349 - Sidebar tabs no longer display in a bold font
 	7477 - Sidebar tab labels don't update to new font when font is
 	changed
 	7492 - Font style regression on Sidebar title
 	
 	* libathena-extensions/athena-global-preferences.h:
 	* libathena-extensions/athena-global-preferences.c:
 	(athena_global_preferences_get_smooth_font): Add documentation
 	to clarify the fact that the result needs to be unrefed.
 	(athena_global_preferences_get_smooth_bold_font): New function
 	that returns a bold version of the user's preferred font.
 
 	* src/athena-sidebar-tabs.c:
 	(athena_sidebar_tabs_load_theme_data): Use the user's bold
 	preffered font instead of the default font. (bug 7349)
 	(smooth_font_changed_callback), (athena_sidebar_tabs_initialize),
 	(athena_sidebar_tabs_destroy): Listen for changes in the user's
 	preferred font and update the tabs accordingly (bug 7477)
 
 	* src/athena-sidebar-title.c: (smooth_font_changed_callback):
 	Use the user's bold preferred font instead of the plain one.  Also
 	unref the font when done to plug a tiny leak. (bug 7492)

2001-03-07  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7494 (History sidebar component spews assertions when
	closing athena window (and sometimes crashes)):

	* components/history/athena-history-view.c: (update_history):
	Don't try to update the history list widget if it's already
	destroyed. Also handle the case where it's destroyed by an unref
	call coming in through CORBA inside the athena_bookmark_new
	function. This is a larger design problem, but this handles the
	case that's actually occurring.
	(athena_history_view_initialize): Ref the history list widget.
	(athena_history_view_destroy): Set the "destroyed" boolean if
	someone has connected one. Unref the history list widget.  Also,
	don't bother clearing it since it is going to be destroyed anyway.

	Fix bug 7514 (Intel/AMD branding on Hardware View CPU picture is
	not something we're authorized to use):

	* components/hardware/icons/cpu.png: Updated with new image from
	Arlo.
	
2001-03-07  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 7479 (Text for Intro Panel must be updated for 1.0):

	* src/athena-first-time-druid.c
	(athena_first_time_druid_show): updated the text on the first
	page

2001-03-07  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* components/services/summary/athena-summary-view.c:
	(update_header), (generate_eazel_news_entry_row): Update title
	from services page and remove date stamp and icon per marketing
	requirements (bug 7476).

2001-03-07  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 7472 (Athena behavior after leaving first run
	druid):

	* src/athena-first-time-druid.c (http_is_known_to_work): new
	global variable - only ever set true if we know for sure that
	http connections will work

	(finished_label, update_finished_label,
	athena_first_time_druid_show): since we only launch the
	services window when http requests are known to work, make the
	text in the `Finished' page be conditional on that

	(next_update_page_callback, download_callback): call update
	finished_label

	(download_callback): set http_is_known_to_work to true if the
	connection succeeded

2001-03-06  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com> 

	* components/services/install-view/athena-service-install-view.c:
	(athena_install_service_add_menu_launchers):
	Fix bug 7429 - don't try to print the menu path if one does not
	exist.

Wed Mar 07 00:35:04 2001  George Lebl <jirka@5z.com>

	Ramiro Estrugo <ramiro@eazel.com> said without this patch
	life as we know it will cease to exist.

	* libathena-extensions/athena-preferences-box.c
	  (category_list_select_row_callback):  When getting the
	  category name, get it out of the correct row.
	  Fixes #7482

2001-03-06  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: reviewed by: Darin Adler <darin@eazel.com>

	Workaround hack for the following bugs:

	7352 - Theme selector description labels missing in ja_JP locale.
	7354 - First time druid title doesnt properly display in the ja_JP
	locale.
	
	* libathena-extensions/athena-gdk-font-extensions.c:
	(athena_gdk_font_get_italic), (athena_gdk_font_get_bold),
	(athena_gdk_font_get_larger),
	(athena_gdk_font_get_largest_fitting):
	For multibyte locales, always return the source font.  This is a
	workaround for bug 7350.  We will fix 7350 properly in 1.2.

	* libathena-extensions/athena-glib-extensions.h:
	* libathena-extensions/athena-glib-extensions.c:
	(athena_dumb_down_for_multi_byte_locale_hack):
	New function to determine if we need to dumb down some things for
	multi byte locales.  Currently this is only limited to bold text
	and possible larger text in the sidebar, first time wizard and
	theme selector.

	* src/athena-first-time-druid.c: (new_title_label):
	For multibyte locales, dont force the label to be smooth so that
	it works in more systems.

2001-03-06  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7400 - Assertions in NON smooth font picker, and font
	doesn't change.
	
	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_create_font_family),
	(font_family_item_changed_callback):
	Replace text_item_changed_callback with
	font_family_item_changed_callback and have the new callback deal
	with the string picker properly.  Im not sure where
	text_item_changed_callback came from, but it was assuming that the
	target was a AthenaCaption and not a AthenaStringPicker.

2001-03-06  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7475 (No applications are offered in sidebar for local
	files):

	* libathena-extensions/athena-mime-actions.c:
	(application_supports_uri_scheme_strcmp_style): Renamed
	function so it's more clear how it relates to the existing
	one and share code with the existing one, because that
	one handles the "file" special case (and this one needs to).
	(athena_mime_has_any_applications_for_file): Change to
	use function by new name.
	(application_supports_uri_scheme): Use case-insensitive
	comparisons since URI schemes are case insensitive.

2001-03-06  John Harper  <jsh@eazel.com>

	Merged change from `athena-1' branch:

	reviewed by: Pavel Cisler <pavel@eazel.com>
	
	Fix 7455 (Intermittent crash when opening trash folder):

	* libathena-extensions/athena-trash-file.c:
	(trash_callback_check_done), (trash_file_call_when_ready):

	Added an "initializing" field to TrashCallback object. This
	is set while connecting the call_when_ready callbacks in
	trash_file_call_when_ready (). trash_callback_check_done ()
	checks this flag and only succeeds when it's false.

2001-03-06  Eric Fischer  <eric@eazel.com>

	reviewed by: Robin * Slomkowski <rslomkow@eazel.com>

	* athena-installer.spec.in:
	Also include uncompressed, unstripped eazel-installer.

	* athena-installer/src/Makefile.am:
	Install uncompressed, unstripped eazel-installer rather than
	discarding it.

	* athena-installer/src/create-eazel-installer.sh:
	Only strip the copy of the installer that is to be compressed.

2001-03-06  Pavel Cisler  <pavel@eazel.com>

	reviewed by: John Harper <jsh@eazel.com>

	Fix 7471 (Crash when drag selecting)
	* libathena-extensions/athena-icon-container.c:
	(rubberband_timeout_callback):
	Make the selection rectangle never be less than 1 pixel
	high and 1 pixel wide. This fixes the crash and looks better.

2001-03-06  Eskil Heyn Olsen  <eskil@eazel.com>	


	reviewed by: Robey Pointer <robey@eazel.com>

	Fixes 7215 (in the HEAD)
	
	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages_helper):
	Fixed a logic error from yesterday (doh, need rest) that would
	cause unwanted pruning of packages. I should be spanked.
	
2001-03-06  Darin Adler  <darin@eazel.com>

	* README: Note that we now use gnome-vfs HEAD, not a branch
	any more.

2001-03-06  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 7328 (info pages no longer work):
	
	* components/help/converters/gnome-info2html2/main.c: (main):
	Fixed broken logic for handling both bzip and gzip.

	Fixed case when you change "View As" before the view change is
	complete.
	
	* src/athena-window-manage-views.c:
	(athena_window_set_content_view): Stop the view change if you
	make a change with the "View As" menu.

Tue Mar 06 12:24:24 2001  George Lebl <jirka@5z.com>

	Darin <darin@eazel.com> said that while this patch causes fungal
	growth between the toes, it is ok to apply.

	* components/tree/athena-tree-view-dnd.c (do_get_data)
	  (athena_tree_view_drag_drop)
	  (athena_tree_view_ensure_drag_data)
	  libathena-extensions/athena-icon-dnd.c (do_get_data)
	  (athena_icon_container_ensure_drag_data)
	  (drag_drop_callback)
	  libathena-extensions/athena-list.c (do_get_data)
	  (athena_list_ensure_drag_data)
	  (athena_list_drag_drop):
	  When doing gtk_drag_get_data, first find a target we support rather
	  then just grabbing the first one.  We need to make a target list
	  and do some gtk voodoo.  At some later date, this should be more
	  generalized and stuffed somewhere in libathena-extentions.
	  Fixes #7312

	* libathena-extensions/athena-file-operations.c
	  (parse_previous_duplicate_name):  s/strdup/g_strdup/ as the
	  string will be later g_free'd
	  Fixes #7440

2001-03-06  Eric Fischer  <eric@eazel.com>

	reviewed by: Christian Meyer <chrisime@gnome.org>

	(Bug 7315.  Thanks to Christian Meyer for tracking down
	places where this needed to be fixed.)

	* components/help/converters/gnome-db2html2/Makefile.am:
	* components/help/converters/gnome-info2html2/Makefile.am:
	* cut-n-paste-code/widgets/e-paned/Makefile.am:
	* cut-n-paste-code/widgets/gimphwrapbox/Makefile.am:
	* cut-n-paste-code/widgets/athenaclist/Makefile.am:
	* libathena-extensions/Makefile.am:
	In all of these, change GNOME_CFLAGS to GNOMEUI_CFLAGS so that
	they get the correct #include path for the GTK headers.

2001-03-06  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-bonobo-extensions.h:
	Added ATHENA_BONOBO_X_BOILERPLATE.

	* libathena-extensions/athena-directory-metafile-monitor.c:
	(athena_metafile_monitor_class_init),
	(athena_metafile_monitor_init):
	* libathena-extensions/athena-directory-metafile-monitor.h:
	* libathena-extensions/athena-metafile-factory.c:
	(athena_metafile_factory_class_init),
	(athena_metafile_factory_init):
	* libathena-extensions/athena-metafile-factory.h:
	* libathena-extensions/athena-metafile.c:
	(athena_metafile_class_init), (athena_metafile_init):
	* libathena-extensions/athena-metafile.h:
	Switched AthenaMetafile, MetafileMonitor, and Metafile factory
	to be based on BonoboXObject - this causes our corba object to
	get freed properly - bug 7335.

2001-03-06  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 7435 (text view spews complaints whenever a text view is
	destroyed):

	* components/text/athena-text-view.c:
	(athena_text_view_initialize): Ref the widget that gets text so
	that we can notice if it's destroyed.
	(detach_file): Get rid of unneeded NULL check.
	(athena_text_view_destroy): Unref the widget.
	(file_read_callback): Don't insert any text if the widget is
	already destroyed. The widget can be destroyed before the
	AthenaView object is.
	(handle_service_menu_item): Add FIXME about sync. I/O.
	(athena_text_view_set_font): Add FIXME about strange font
	handling.

2001-03-06  Dan Mueth  <dan@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com> 

	Updating data file which determines which documents appear
	in the "Introductory Documents" section of the help sidebar.
	It now includes all locales of each doc.
	Bug#: 7267

	* components/help/topleveldocs.xml:

	Fixing font problem for titles.
	Bug#: 7210

	* help/athena-quick-reference/es/index.html:
	* help/athena-quick-reference/no/index.html:

	Fixing screenshots in Swedish version of Athena
	Quick Reference.  Now the links aren't broken at least.
	They still aren't localized though.
	Bug#: 7422

	* help/athena-quick-reference/sv/Makefile.am:
	* help/athena-quick-reference/sv/figures/colors_small.png:
	* help/athena-quick-reference/sv/figures/emblems.png:
	* help/athena-quick-reference/sv/figures/emblems_small.png:
	* help/athena-quick-reference/sv/figures/ff_small.png:
	* help/athena-quick-reference/sv/figures/find.png:
	* help/athena-quick-reference/sv/figures/find_small.png:
	* help/athena-quick-reference/sv/figures/full.png:
	* help/athena-quick-reference/sv/figures/full_small.png:
	* help/athena-quick-reference/sv/figures/locbar.png:
	* help/athena-quick-reference/sv/figures/locbar_small.png:
	* help/athena-quick-reference/sv/figures/menubar.png:
	* help/athena-quick-reference/sv/figures/menubar_small.png:
	* help/athena-quick-reference/sv/figures/music.png:
	* help/athena-quick-reference/sv/figures/music_small.png:
	* help/athena-quick-reference/sv/figures/navbar.png:
	* help/athena-quick-reference/sv/figures/navbar_small.png:
	* help/athena-quick-reference/sv/figures/patterns.png:
	* help/athena-quick-reference/sv/figures/sidebar.png:
	* help/athena-quick-reference/sv/figures/sidebar_small.png:
	* help/athena-quick-reference/sv/figures/themes.png:
	* help/athena-quick-reference/sv/figures/themes_small.png:
	* help/athena-quick-reference/sv/figures/viewmenu.png:

	--- end of what mjs reviewed

	Fixing these screenshots so they render correctly in some
	browsers.  Replacing a screenshot in a doc with another can't break
	Athena :)
	Bug#: 7434

	* help/athena-quick-reference/C/figures/music.png:
	* help/athena-quick-reference/C/figures/navbar.png:
	* help/athena-quick-reference/C/figures/softcat.png:
	* help/athena-quick-reference/C/figures/storage.png:

	Change one line of a doc to make it more correct.  Again,
	there is no way this can break anything, so I'm taking responsibility
	for this.

	* help/athena-quick-reference/sv/index.html:

2001-03-06  Darin Adler  <darin@eazel.com>

	* athena.spec.in: RPM view also has to be removed from the RPM
	spec file.

2001-03-06  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	* po/POTFILES.in:
	Woops, forgot to remove the rpmview from potfiles.

2001-03-05  Ian McKellar  <ian@eazel.com>

	* components/services/inventory/eazel-inventory-collect-software.c:
	(eazel_inventory_collect_software):
	Use shorter distribution name. (Fixing urgent stuff for the update
	service)

2001-03-05  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com> who isn't even here or
	online...

	* components/services/inventory/eazel-inventory-utils.c:
	(eazel_create_configuration_metafile):
	Disable hardware inventory collection for 1.0. This fixes bug 7305.

2001-03-05  George Lebl <jirka@5z.com>

	Ian McKellar <ian@eazel.com> said this patch will end global
	hunger and bring about world peace.

	* components/help/hyperbola-filefmt.c (fmt_toplevel_add_doc):
	  g_strdup and not strdup if we're going to g_free.
	  Fixes #7414 

	* components/help/hyperbola-filefmt.c (locale_score)
	  (is_new_locale_better) (fmt_toplevel_parse_xml_tree)
	  (fmt_toplevel_populate_tree) (get_path_from_node):
	  When looking at the toplevels documents XML tree, score different
	  paths for a document according to the position of the locale in the
	  language list that was gotten from gnome_i18n_get_language_list.
	  fmt_toplevel_parse_xml_tree now returns TRUE/FALSE for better
	  detection of unparsable files then before.  Also check if the file
	  exists and is readable before adding it to the tree.
	  Fixes #7311, #7314

	* components/help/converters/gnome-info2html2/main.c (main):
	  the "bz" integer is only used when HAVE_LIBBZ2 is on, and it's
	  not for me, so put it into the HAVE_LIBBZ2 define protected code.
	  Fixes #7417

2001-03-05  Eskil Olsen  <eskil@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com> who almost feels
	bad about it...

	"Fixes" bug 7413
	
	* components/Makefile.am:
	Removed the rpmview from build.

2001-03-05  Eskil Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer <robey@eazel.com> who sez "yup".

	Fixed bug 7070.
	
	* components/rpmview/athena-rpm-view-install.c:
	(get_detailed_errors), 
	Flipped the meaning of the third argument.
	(athena_rpm_view_install_failed),
	s/TRUE/FALSE
	(athena_rpm_view_uninstall_failed),
	s/FALSE/TRUE
	(athena_rpm_view_dependency_check):
	use packagedata_get_readable_name instead of doing it myself.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages_helper):
	
	Ugh, I did not traverse down down into ALREADY_INSTALLED packages,
	and I had flipped the change of status for suite_ids. So I added
	some enum logic so ALREADY_INSTALLED (hence also suite_id's) get
	their dependencies pruned.

	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_uninstall_messages_foreach):
	I committed the sin of changing an i18n string..

2001-03-05  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>
	
	Fix 7404: Clicking on "Install" in Eazel services fails.

	* libathena-extensions/athena-font-manager.c:
	(gnome_vfs_init_if_needed), (athena_font_manager_for_each_font),
	(athena_font_manager_file_is_scalable_font):
	Add lazy GnomeVFS initialization because the athena font manager
	code now makes GnomeVFS calls.

2001-03-05  Brian Frank  <bfrank@eazel.com>

	* data/static_bookmarks.xml:

	Changed LWN.net bookmark to Linux Weekly News

2001-03-05  Andy Hertzfeld  <andy@eazel.com>

	* components/throbber/athena-throbber.c:
	(athena_throbber_initialize), (draw_throbber_image),
	(athena_throbber_size_allocate),
	(athena_throbber_size_request):

	fixed bug 5640, toolbar area below throbber drawn different from theme
	for some gtk themes.  Fixed by having the throbber clear its 
	entire gdk window to the background.
	
2001-03-05  Eric Fischer  <eric@eazel.com>

	reviewed by: Robin * Slomkowski <rslomkow@eazel.com>

	* configure.in:
	Explicitly run gtk-config to get GTK's cflags, because
	$GNOMEUI_CFLAGS aren't enough for people who've upgraded
	to GTK 1.2.9.  (Bug 7315)

2001-03-05  Rebecca Schulman  <rebecka@eazel.com>
	Complete work for 5520, that cron should be running
	for medusa to work.

	reviewed by: <delete if not using a buddy>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_use_fast_search_changed_callback):
	Change the text to Vera's final copy.
	* src/athena-first-time-druid.c: (druid_finished),
	(back_update_page_callback), (set_up_medusa_page),
	(next_medusa_page_callback), (set_up_cron_information_page),
	(athena_first_time_druid_show):
	Change the text to Vera's final copies, make medusa update
	correctly when medusa is turned on in the first time druid

2001-03-05  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	Fix bug 7391 (The logon dialog box for services has input boxes
	larger that the dialog can contain)

	* components/services/summary/athena-summary-dialogs.c
	(athena_summary_show_login_dialog): Remove the line that was
	setting a hardcoded width.

2001-03-05  Eric Fischer  <eric@eazel.com>

	reviewed by: Don Melton <don@eazel.com>

	* athena.spec.in:
	Add share/pixmaps/athena/crux_eggplant/throbber/*.png
	to the list of files to be put in the RPM (Bug 7383).

2001-03-05  John Harper  <jsh@eazel.com>

	Fixed bug 7402 (Fonts that don't define ` ' cause assertions
	and squash words together):

	* librsvg/rsvg-ft.c (rsvg_ft_measure_or_render_string): force
	the width of the returned glyph to be at least one pixel

	* librsvg/rsvg-ft.c (rsvg_ft_get_glyph_cached): added extra
	arg `cache_ix'. Used when accessing the glyph cache. The old
	`glyph_ix' arg is only used when accessing the physical font
	(this allows a cached glyph to be created from a different
	physical glyph)

	(rsvg_ft_measure_or_render_string): if the character is a ` '
	and has a glyph index but doesn't have an actual glyph
	definition, create one by caching the glyph for `-' as ` ' and
	zeroing its pixel buffer

2001-03-05  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>
	who said it was "most excellent"

	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_get_info):

	When parsing softcat responses, check if we were doing a suite
	lookup even if only one package was returned.  (Suites consisting
	of only one package were getting returned as if it was a toplevel
	package with both suite_id and rpm_id set.)

2001-03-05  Arik Devens  <arik@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>

	Fixed bug 7377, Hit a g_return_val_if_fail when selecting "Marlet"
	font.
	
	* libathena-extensions/athena-font-picker.c: Added Marlett to
	the list of black listed font families.

2001-03-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 7363 (change to smooth font choice doesn't affect
	sidebar in currently open windows)

	* src/athena-sidebar-title.c: 
	(smooth_font_changed_callback): New callback, gets the smooth
	font preference and tells the two AthenaLabels to use it.
	(athena_sidebar_title_initialize): Register callbacks
	for the anti-aliased and non-anti-aliased fonts changing.
	(athena_sidebar_title_destroy): Remove new callbacks.
	(update_all_cover): Renamed from smooth_graphics_mode_changed_callback
	since it's now used for more than just that.

2001-03-05  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	* libathena-extensions/athena-font-picker.c:
	More black listed fonts.  Fixes bug 7384.
	
2001-03-05  John Harper  <jsh@eazel.com>

	reviewed by: Ramiro Estrugo <ramiro@eazel.com>

	Fixed bug 7380 (Athena crashes when I choose "Microsoft Sans
	Serif" font):

	* librsvg/rsvg-ft.c (rsvg_ft_measure_or_render_string):
	initialize y components of bbox. Don't call
	rsvg_ft_get_glyph_cached with a zero index (non-existent
	glyph). Use `n_glyphs' to index `glyph_xy' array instead of
	`i' (this is what fixes the bug - when one or more glyphs don't
	exist `i' points too far into the array)

2001-03-03  Rebecca Schulman  <rebecka@eazel.com>
	Complete most of bug 5520, that turning medusa on when cron
	isn't running should tell the user this, and, if possible,
	how to start cron.

	reviewed by: Mike Engber <engber@eazel.com>

	
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_use_fast_search_changed_callback):
	Add dialog that comes up if the fast search preference is 
	enabled in the preference dialog when cron is off.
	The dialog will tell the user about cron and how to
	turn it on on linux systems.

	* libathena-extensions/athena-medusa-support.c:
	(athena_medusa_add_system_state_changed_callback),
	(athena_medusa_check_cron_is_enabled):
	* libathena-extensions/athena-medusa-support.h:
	Add hack to check if cron is actually running using cron.
	* acconfig.h:
	* configure.in:
	Add HAVE_PROC_PROCESS_FILES, so we know whether we can
	check proc files for whether cron is running

	* src/athena-first-time-druid.c: (back_update_page_callback),
	(set_up_medusa_page), (next_medusa_page_callback),
	(set_up_cron_information_page), (athena_first_time_druid_show):
	Add cron interface to the first time druid that tells users how to
	turn on cron if necessary, as per Arlo's design.
	Final text still needs to be added here.


	* libathena-extensions/athena-mime-actions.c:
	(application_can_handle_uri),
	(athena_mime_has_any_applications_for_file),
	(athena_mime_has_any_applications_for_file_type):
	* libathena-extensions/athena-mime-actions.h:
	* libathena-extensions/athena-program-choosing.c:
	(choose_application_callback), (application_cannot_open_location):
	Old change that never got committed, reviewed by Darin Adler 
	<darin@eazel.com>
	

2001-03-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 7348 (duplicate styles in some fonts)

	* libathena-extensions/athena-font-picker.c:
	(font_style_entry_free): New function (extracted from
	global_font_list_free).
	(global_font_list_free): Use extracted function.
	(list_contains_style): New function, looks for matching
	font_file_name.
	(global_font_list_populate_callback): free style rather
	than appending to list if an equivalent is already in list.

2001-03-05  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fix for bugs 7375 and 7370.
	
	* libathena-extensions/athena-font-manager.c:
	(font_ignore_directory): Black list the ISO8859-2 and ISO8859-7
	encoded fonts which it turns out are missing all kinds of glyphs.
	Also add another instance of the same Abisource fonts, but from an
	older package that had a slightly different name.
	
	* libathena-extensions/athena-font-picker.c:
	Black list the Bookmark URW font which causes crashes on old
	version of the urw package.
	
2001-03-05  John Harper  <jsh@eazel.com>

	reviewed & checked in by: Darin Adler <darin@eazel.com>

	Fix bug 7389 (crash when starting athena):

	* libathena-extensions/athena-directory-background.c
	(athena_background_get_desktop_background_window): check if
	the `icon_container' object data (a GtkLayout widget) is
	non-null before dereferencing it

	(image_loading_done_callback): only pass result of
	athena_background_get_desktop_background_window to
	gdk_window_set_back_pixmap if it's non-null

2001-03-05  Arik Devens  <arik@eazel.com>

	reviewed by: Robin * Slomkowski  <rslomkow@eazel.com>

	Fixed bug 6616, foot menu icon does not launch athena on some
	users' systems.
	
	* athena.spec.in: Fix to the userid and groupid we install our
	help files as to cause --verify to stop failing.

2001-03-05  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7381 (warning every time I start Athena because my
	/usr/share/fonts/default/Type1/fonts.dir has no fonts in it):
	
	* libathena-extensions/athena-font-manager.c:
	(font_description_table_new): Tolerate files with 0 fonts in them,
	but don't tolerate files where the count is > than the number of
	lines in the file.

	Fix bug 7362 (two font menus appear in preferences in non-smooth
	mode):
	
	* libathena-extensions/athena-global-preferences.c:
	(appearance_pane_update): Fix spelling error.
	(global_preferences_create_font_group): Fix wrong variable name
	and spelling error.
	
	* libathena-extensions/athena-string-list.c:
	Fix spelling error ("supress" -> "suppress").

2001-03-05  John Harper  <jsh@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fixed bug 7374 (Crash in font cache code after changing fonts
	many times):

	* librsvg/rsvg-ft.c (rsvg_ft_font_evict): check if victim->font
	is null before freeing it

2001-03-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 7303 (some menu items use duplicate, thus
	non-working, underline accelerators)

	* src/file-manager/athena-directory-view-ui.xml:
	New _Folder -> _New Folder to avoid conflict with _Find.
	_Open in New Window -> Open _in New Window to avoid conflict
	with _Open.
	Open With -> Open Wit_h
	_Select All Files -> Select _All Files to avoid conflict with
	_Stretch Icon
	
	* src/athena-shell-ui.xml:
	_New Window -> New _Window to avoid conflict with _New Folder.
	_Web Search -> We_b Search to avoid conflict with New _Window.
	_Select All -> Select _All to avoid conflict with _Stretch Icon
	Hide Sidebar -> Hide _Sidebar
	Hide Toolbar -> Hide _Toolbar
	Hide Location Bar -> Hide Location _Bar
	Hide Status Bar -> Hide St_atus Bar

	* src/file-manager/fm-directory-view.c: (real_update_menus):
	Open in <n> _New Window(s) -> Open _in <n> New Windows to match xml.
	
	* src/athena-window-menus.c:
	(athena_window_update_show_hide_menu_items):
	Add Show/Hide xxx accelerators to match xml.

2001-03-05  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/athena-font-manager.c:
	(athena_self_check_font_manager):
	Comment out the font manager checks out again!  Tinderbox wins
	this round, but ill be back with a fix for bug 7343 and fix the
	problem properly once and for all.
	
2001-03-05  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Glynn Foster  <glynn.foster@ireland.sun.com>

	No significant code changes.  Just adding bug numbers to FIXMEs.
	The only real code change (which happens to be a commenting out of
	something) is a workaround for a tinderbox problem.
	
	* libathena-extensions/athena-font-factory.c:
	(athena_font_factory_get_font_by_family):
	Bug number for FIXME.
	
	* libathena-extensions/athena-font-manager.c:
	(athena_font_manager_get_default_font),
	(athena_font_manager_get_default_bold_font):
	Bug number for FIXME.
	Comment out the SOURCE_DATADIR font hack until it works better.
	Fixes broken tinderbox checks.  Checks will still run even if not
	with the optimal setup.  I have an idea how to fix this later
	using a configure.in hack.  Added FIXME and bug number for this
	issue.
	
	* libathena-extensions/athena-glyph.c:
	(athena_glyph_draw_to_pixbuf):
	Bug number for FIXME.

	* libathena-extensions/athena-icon-container.c:
	Bug number for FIXME and reworked FIXME blurb to match bug report.

	(athena_icon_container_initialize):
	* libathena-extensions/athena-scalable-font.c:
	(athena_scalable_font_get_default_font),
	(athena_scalable_font_get_default_bold_font):
	Bug number for FIXMEs.

2001-03-05  Dan Mueth  <dan@eazel.com>

	Removed Eazel logo from screenshot.

	* help/athena-quick-reference/C/figures/music.png:

2001-03-05  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fix bug 5813 - Remove workaround for bug 5712 when both GTK+ 1.2.9
	and the new gdk-pixbuf are released and required by configure.in
	and RPM spec file
	
	* libathena-extensions/Makefile.am:
	* libathena-extensions/bug-5712-pr3-workaround--gdk-pixbuf-drawable.c:
	* libathena-extensions/bug-5712-pr3-workaround--gdk-pixbuf-private.h:
	* libathena-extensions/bug-5712-pr3-workaround--gdkimage.c:
	Retire these workaround cut n pasted code.
	
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(athena_gdk_pixbuf_get_from_window_safe):
	Remove the workaround, we can safely call the gdk and gdk-pixbuf
	calls now that bugs in there have been fixed.
	
2001-03-04  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: George Lebl  <jirka@5z.com>
	             Ramiro Estrugo  <ramiro@eazel.com>

	Fixed bug 7336 ("View as Text" not a choice for remote web pages)

	* components/text/Athena_View_text.oaf.in: Removed attribute
	limiting this view's applicability to the "file:" URI scheme, thus
	fixing bug 7336.

	* components/text/athena-text-view.c (file_read_callback):
	Remove some incorrect checks that made this component only load
	the first chunk of text for remote files; this bug was uncovered
	in the process of fixing 7336.

2001-03-05  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>
		     Maciej Stachowiak  <mjs@eazel.com>

	Bugs:

	6368 - Multibyte font handling in non smooth mode.
	2673 - Need to hook up the new font picker to athena
	1274 - Add support for picking a custom font
	
	* components/history/Makefile.am:
	* components/history/athena-history-view.c: (main):
	Initialize gettext for the history component so it can display
	localized strings.

	* components/notes/athena-notes.c: (make_notes_view):
	Set the notes widget font from preferences so it can be properly
	localized.
	
	* components/text/athena-text-view.c:
	(athena_text_view_set_font):
	Use the localized font name to make this work in locales other
	than the default.
	
	* libathena-extensions/Makefile.am:
	Add a macro for finding data on the source tree for the situation
	when 'make install' has not be run.
	
	* libathena-extensions/athena-font-factory.c:
	(athena_font_factory_get_font_by_family): Workaround the problem
	that fully qualified localized fonts were being processed
	incorrectly.  We simply leave them alone now.
	(athena_font_factory_get_font_from_preferences): Use the
	localized font string to make this work on more locales.

	* libathena-extensions/athena-font-manager.h:
	* libathena-extensions/athena-font-manager.c:
	(font_description_table_find): New function to find a description
	in a table.
	(font_description_table_for_each): Change the return value to a
	boolean to indicate whether to stop the iteration or not.  Switch
	the order of an assert and assigned.
	(collect_fonts_from_directory): Use macros for the mime type
	strings.
	(font_ignore_directory): Add more directories to ignore.
	(font_manager_collect_font_tables): Change prepend to append to
	get fonts in a better order (fallback and user fonts first)
	, (font_table_list_find),
	(free_font_tables), (ensure_global_font_table),
	(athena_font_manager_for_each_font): Use just one global table
	for all fonts instead of 3.
	(athena_font_manager_get_default_font): Compute the default
	dynamically to take user choices into account.  Make it work on
	non installed athena builds.
	(athena_font_manager_get_default_bold_font): Same as above for a
	bold font.
	(athena_font_manager_file_is_scalable_font): New function to
	check that a file is really a scalable font:
	(font_list_find_bold_callback), (athena_font_manager_get_bold),
	(athena_font_manager_weight_is_bold): New functions to find a
	bold font in the global tables.
	(athena_self_check_font_manager): Make it work on not installed
	athena builds and remove the hack where checks would on run for
	the "ramiro" user.

	* libathena-extensions/athena-font-picker.c:
	(athena_font_picker_initialize), (font_list_find),
	(font_picker_update_styles), (font_picker_populate),
	(font_picker_font_changed_callback),
	(font_picker_style_changed_callback), (font_find_style),
	(ignore_font), (font_make_name), (font_make_style),
	(global_font_list_free), (font_list_count_families),
	(global_font_list_get), (global_font_list_populate_callback),
	(athena_font_picker_get_selected_font),
	(athena_font_picker_set_selected_font):
	Make the font list global and not per widget instance.  Use better
	labels for the font styles.  Use better labels for font names
	(foundry and family vs just family depending on how many families
	of the same font are found)

	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_font_defaults): Add new smooth font
	preference for the icon container.
	(athena_global_preferences_get_smooth_font): New function to
	safely get a smooth font out of preferences.
	
	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_initialize): Use the localized version of
	the font strings and add a FIXME for the problem of checking these
	in many disparate places in athena.

	* libathena-extensions/athena-program-chooser.c:
	(program_file_pair_get_program_name_for_display): Use the
	localized version of the application name strings.

	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-scalable-font.c:
	(athena_scalable_font_initialize_class),
	(athena_scalable_font_initialize),
	(athena_scalable_font_destroy), (athena_scalable_font_new),
	(athena_scalable_font_make_bold),
	(athena_scalable_font_get_default_font),
	(athena_scalable_font_get_default_bold_font),
	(free_global_font_handle_table),
	(initialize_global_stuff_if_needed),
	(athena_scalable_font_get_rsvg_handle):
	Simplify this class a lot by using the font manager.  No longer
	need to manage font lookup and queries.
	
	* libathena-extensions/athena-smooth-text-layout-cache.c:
	(athena_self_check_smooth_text_layout_cache): Fix a comment.
	Dont hardcode the font family.  Use the default font.  Remove the
	#ifdef hacker for "before make install fonts broken" problem which
	is now fixed.

	* src/file-manager/fm-directory-view.h:
	* src/file-manager/fm-directory-view.c:
	(directory_view_smooth_font_changed_callback),
	(fm_directory_view_initialize), (fm_directory_view_destroy):
	Add method for responding to changes in the smooth font for AA
	mode of the icon container.
	
	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_smooth_font_changed),
	(fm_icon_view_initialize_class),
	(fm_icon_view_update_icon_container_smooth_font),
	(create_icon_container):
	Add support for responding to change in the smooth font.  Update
	the icon container's smooth font on such changes.
	
	* src/athena-about.c: (athena_about_draw_info):
	Change the offset of the "Athena" title which broken when jsh
	make glyphs render properly taking the baseline into account.
	
	* src/athena-sidebar-title.c: (update_font):
	Use the localized font name.
	
	* src/athena-sidebar.c: (athena_sidebar_add_panel),
	(athena_sidebar_remove_panel):
	Use the localized sidebar tabs descriptions.
	
	* src/athena-window.c: (create_view_as_menu_item):
	Use the localized "View as" labels.
	
	* test/test-athena-font-manager.c: (font_iterator_callback):
	* test/test-athena-font-picker.c: (update_font),
	(font_changed_update_label_callback),
	(font_changed_update_file_name_callback),
	(use_defalt_font_callback), (use_defalt_bold_font_callback),
	(use_defalt_font_update_picker_callback),
	(use_defalt_bold_font_update_picker_callback), (main):
	* test/test.c: (test_quit):
	Updates for changes in font manager and font picker.
	
2001-03-05  Dan Mueth  <dan@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>

	Updating contents of "Introductory Documents" at top of
	help sidebar to include the GNOME User Guide.
	Bug#: 7267

	* components/help/topleveldocs.xml:

	Adding version 1.0 of Vera's Athena Quick Reference.
	Bug#: 7210

	* help/athena-quick-reference/C/Makefile.am:
	* help/athena-quick-reference/C/figures/colors_small.png:
	* help/athena-quick-reference/C/figures/emblems.png:
	* help/athena-quick-reference/C/figures/emblems_small.png:
	* help/athena-quick-reference/C/figures/ff_small.png:
	* help/athena-quick-reference/C/figures/find.png:
	* help/athena-quick-reference/C/figures/find_small.png:
	* help/athena-quick-reference/C/figures/full.png:
	* help/athena-quick-reference/C/figures/full_small.png:
	* help/athena-quick-reference/C/figures/locbar.png:
	* help/athena-quick-reference/C/figures/locbar_small.png:
	* help/athena-quick-reference/C/figures/menubar.png:
	* help/athena-quick-reference/C/figures/menubar_small.png:
	* help/athena-quick-reference/C/figures/music.png:
	* help/athena-quick-reference/C/figures/music_small.png:
	* help/athena-quick-reference/C/figures/navbar.png:
	* help/athena-quick-reference/C/figures/navbar_small.png:
	* help/athena-quick-reference/C/figures/patterns.png:
	* help/athena-quick-reference/C/figures/sidebar.png:
	* help/athena-quick-reference/C/figures/sidebar_small.png:
	* help/athena-quick-reference/C/figures/themes.png:
	* help/athena-quick-reference/C/figures/themes_small.png:
	* help/athena-quick-reference/C/figures/viewmenu.png:
	* help/athena-quick-reference/C/index.html:

	Changing so that ownership of $(prefix)/share/omf/athena
	is Athena - ie. it doesn't hang around after Athena
	is removed.

	* athena.spec.in:

2001-03-04  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(add_to_dedupe_hash), (post_get_softcat_info),
	(dedupe_foreach_depends), (check_if_modification_is_ok),
	(do_requirement_consistency_check_package),
	(do_requirement_consistency_check_internal),
	(check_if_related_package), (check_if_modified_related_package),
	(check_tree_helper), (add_file_conflict),
	(check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency), (do_file_conflict_check),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_check_for_install):

	Mark packages that have had check-existing done on them, so we can
	check them on each round and not miss any packages or check any
	twice.  Dedupe packages even if they don't have softcat info yet
	(their dupe might).  During consistency checking, don't bother to
	check packages that are elsewhere in the tree -- assume we handled
	them correctly already.  Split check_if_related_package into two
	pieces, so we can re-use the first half when adding file
	conflicts.  This way, we can avoid marking file conflicts between
	two related packages (rpm4 allows this, for better or worse).
	Prune dead packages after the file conflict checks.  Make a
	passing reference to an unused softcat flag just to annoy Robey.
	Automatically add related packages to the tree during uninstall.
	This fixes bug 7245 and at least one other bug.

2001-03-04  Dan Mueth  <dan@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Updated the Athena User Manual from v0.9 to v1.0.
	Note that the file TRACKED_CHANGES details the changes
	between the two versions, for use by translators.
	There are some new screenshots.

	Bug#:7271

	* help/athena-user-manual/C/Makefile.am:
	* help/athena-user-manual/C/TRACKED_CHANGES:
	* help/athena-user-manual/C/figures/custicon.png:
	* help/athena-user-manual/C/figures/full-1.png:
	* help/athena-user-manual/C/figures/full-2.png:
	* help/athena-user-manual/C/figures/full-3.png:
	* help/athena-user-manual/C/figures/full-4.png:
	* help/athena-user-manual/C/figures/full-5.png:
	* help/athena-user-manual/C/figures/full-6.png:
	* help/athena-user-manual/C/figures/full.png:
	* help/athena-user-manual/C/figures/locbar.png:
	* help/athena-user-manual/C/figures/part-1.png:
	* help/athena-user-manual/C/figures/part-2.png:
	* help/athena-user-manual/C/figures/part-3.png:
	* help/athena-user-manual/C/figures/part.png:
	* help/athena-user-manual/C/figures/player-1.png:
	* help/athena-user-manual/C/figures/player-2.png:
	* help/athena-user-manual/C/figures/player-3.png:
	* help/athena-user-manual/C/figures/player-4.png:
	* help/athena-user-manual/C/figures/player.png:
	* help/athena-user-manual/C/figures/prefmenu.png:
	* help/athena-user-manual/C/figures/sidebar.png:
	* help/athena-user-manual/C/figures/viewmenu.png:
	* help/athena-user-manual/C/athena-user-manual.sgml:

	Suppressed terminal spew every time an info page is viewed
	and pretty'd up the error page when the info page does not
	exist.  Note - info page viewing is now broken completely.
	This is not due to this patch.  I wrote this patch on a 
	working build of Athena and somebody else has since
	broken it in Athena CVS.

	Bug#: 7299

	* components/help/converters/gnome-info2html2/main.c:
	(file_exists), (main):

2001-03-04  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fix bug 6967 (if you double click on a package in the icon view
	and the while it's loading double click on it again athena may
	segfault).

	* src/athena-view-frame.c
	(athena_view_frame_queue_incoming_call): If the destroy callback
	is NULL, do not attempt to call it. With this change, I can
	turbo-click an rpm and the package view will still come up cleanly
	without crashing Athena or itself.

2001-03-04  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-preferences.c:
	(preferences_key_make_for_visibility):

	Fix a leak by adding a missing g_free.
	
2001-03-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-font-manager.c:
	(athena_font_manager_get_fallback_font):
	Add workaround for tinderbox lack of 'make install' problem.  Ill
	fix this better tommorow.
	
2001-03-02  Seth Nickell  <seth@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-volume-monitor.c:

	Add UFS detection code to make Trash work on Solaris. Basically
	a cut and paste of the equivalent ReiserFS code added earlier.
	
2001-03-02  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* libathena-extensions/athena-volume-monitor.c:
	Turn off spew about unknown file systems.

2001-03-02  Eskil Heyn Olsen  <eskil@eazel.com>

	written by: Robey Pointer  <robey@eazel.com>
	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	This is a patch to debug output only.
	
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_dump_tree_helper), (packagedata_dump_tree_int),
	(packagedata_dump_tree):
	Don't log dependencies for broken packages in debug output.

2001-03-02  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com> who sez "that's
	nice..."

	Fixed 7245.

	* components/rpmview/athena-rpm-view-install.c:
	(get_detailed_errors), (athena_rpm_view_install_failed),
	(athena_rpm_view_uninstall_failed),
	(athena_rpm_view_install_done),
	(athena_rpm_view_install_package_callback),
	(athena_rpm_view_uninstall_package_callback):
	Fixed 7245, install view uses EazelInstallProblem to generate
	error strings.
	No longer call load_failed when done.
	Do gnome_dialog_run instead of gnome_dialog_run_and_close and lets
	hope it's not fatal...
	
	* components/services/install/command-line/Makefile.am:
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_download_progress_signal),
	(eazel_install_progress_signal), (main):
	Fixed some math stuff that could cause arithmetic coredumps.
	Added i18n initialization code.

2001-03-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Bug 2673 - Need to hook up the new font picker to athena .
	
	* configure.in:
	Remove an old font setup hack that never really worked.

	* data/fonts/urw/fonts.dir:
	Rename the fonts to "Helvetica Default" in order not to clash with
	system fonts.

	* libathena-extensions/athena-font-manager.h:
	* libathena-extensions/athena-font-manager.c:
	(font_description_new): Add a font type parameter.
	(font_lists_total_num_fonts): New function to count the total
	number of scalable fonts detetected.
	(font_description_table_add): Pass in the detected font lists to
	do reality checks.
	(font_get_font_type): New function.
	(font_description_table_get_length),
	(font_description_table_peek_nth),
	(font_description_table_get_nth_file_name): Name the parameters
	more consistently.
	(font_description_table_for_each): Add font type parameter
	(font_description_table_new): Rework to not require storing the
	detected font list.  We now use that only for the duration of the
	constructor.  Lost the install_font_lists dumbness.
	(font_server_for_each_font_directory_internal): Use g_warning
	instead of g_print.
	(font_ignore_directory): New function to determine whether we
	should ignore a directory - makes things much faster. 
	(font_manager_collect_font_tables): New function to handle all the
	work of collecting font directories into tables.
	(font_server_for_each_callback), (font_table_list_free),
	(font_table_list_for_each), (free_font_tables),
	(ensure_at_exit_handler), (ensure_fallback_font_table),
	(ensure_user_font_table), (ensure_system_font_tables): Add 3
	tables for fallback, system and users fonts.  These are populated
	as needed.
	(athena_font_manager_for_each_font): Iterate the 3 font talbles.
	(athena_font_manager_get_fallback_font) : New function to obtain
	a fallback font quickly without having to check the system.
	(call_chop_off_comments), (athena_self_check_font_manager):
	Rework the checks to not create a temp directory.  Unfortunately
	they now only run for me.

	* libathena-extensions/athena-font-picker.h:
	* libathena-extensions/athena-font-picker.c:
	(athena_font_picker_initialize_class),
	(athena_font_picker_initialize), (athena_font_picker_destroy),
	(font_entry_list_find), (font_picker_update),
	(font_name_picker_changed_callback),
	(style_picker_changed_callback), (ignore_font),
	(font_manager_callback), (style_list_for_each_callback),
	(font_entry_list_for_each_callback),
	(athena_font_picker_get_selected_font),
	(athena_font_picker_set_selected_font),
	(athena_font_picker_set_title_label):
	Use the new font manager.

	* libathena-extensions/athena-global-preferences.h:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_create_dialog), (appearnace_pane_update),
	(global_preferences_create_font_group),
	(global_preferences_install_home_location_defaults),
	(global_preferences_install_font_defaults):
	Add a new preference for the smooth font.
	Factor our the default font code to its own function.  Setup the
	font pickers items to be mutually exclusive according to the
	smooth graphics mode preference value.
	
	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_widget_set_shown):
	New function to show or hide a widget in one go.
	
	* libathena-extensions/athena-preferences-group.c:
	(athena_preferences_group_update):
	Dont show the widget if a controlling preference prevents it.
	
	* libathena-extensions/athena-preferences-item.h:
	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_update_smooth_font),
	(preferences_smooth_font_changed_callback),
	(preferences_item_create_smooth_font): Add support for a smooth
	font picker.
	(preferences_item_destroy), (preferences_item_construct),
	(athena_preferences_item_set_control_preference),
	(athena_preferences_item_set_control_action),
	(athena_preferences_item_get_control_showing): Add support for
	using a controlling preference which can force the widget to be
	shown or hidden depending on its value.

	* libathena-extensions/athena-preferences-pane.c:
	(athena_preferences_pane_update):
	Use new gtk extension to show or hide the widget in one go.

	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-scalable-font.c:
	(font_family_string_map_new): Update fallback font name.
	(athena_scalable_font_new_from_file_name): New function to
	create a font directly from a font file name.
	(athena_scalable_font_get_default_font): Update fallback font name.
	(athena_scalable_font_get_default_bold_font): New function to
	get a fallback bold font.
	Remove some unsed functions.  Remove the font setup hack, the font
	manager takes care of that now.
	
	* libathena-extensions/athena-string-picker.h:
	* libathena-extensions/athena-string-picker.c:
	(athena_string_picker_clear):
	New function to clear the string picker.
	
	* libathena-extensions/athena-tabs.c:
	(athena_tabs_initialize):
	Fix the hard coded font name.

	* src/athena-first-time-druid.c: (new_title_label):
	Fix the hard coded font name.

	* src/athena-sidebar-tabs.c:
	(athena_sidebar_tabs_load_theme_data):
	Fix the hard coded font name.

	* test/Makefile.am:
	* test/test-athena-font-manager.c: (font_type_to_string),
	(font_iterator_callback), (font_table_for_each_callback), (main):
	* test/test-athena-font-picker.c: (font_picker_changed_callback),
	(main):
	* test/test-athena-glyph-simple.c: (main):
	* test/test-athena-label.c: (main):
	Update for new font picker and font manager changes.

2001-03-02  Darin Adler  <darin@eazel.com>

	reviewed by: Arik Devens <arik@eazel.com>

	Fix bug 7190 (Typing / in location moves cursor to end of line).

	* src/athena-location-bar.c: (try_to_expand_path): Fix a bunch
	of storage leaks, including calls to
	gnome_vfs_expand_initial_tilde that do nothing. Remove code to
	expand the initial tilde in here. That can all be handled below
	(and need not be deferred until idle time).
	(get_editable_length): New helper function.
	(has_exactly_one_slash): New helper function.
	(set_position_and_selection_to_end): New helper function.
	(position_and_selection_are_at_end): New helper function.
	(editable_key_press_callback): Fix logic so we only try to do
	completion of any kind when the user is typing at the end of the
	text. Also only do the tilde expansion when the path has exactly
	one slash, and do it right away rather than waiting for idle the
	way the file name expansion does. Finally, cancel the file name
	expansion if you are no longer at the end of the text.

	Other change.
	
	* src/athena-property-browser.c:
	(athena_property_browser_initialize),
	(athena_property_browser_update_contents):
	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize):
	Add FIXMEs for uses of spaces to make buttons look right.

2001-03-02  Pavel Cisler  <pavel@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	Fix 7297: Segmentation fault when rapidly pressing refresh twice.
	
	* src/file-manager/fm-directory-view.c: (fm_directory_view_stop):
	Need to set pending_files_added and pending_files_changed to NULL
	after freeing them.

2001-03-02  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7264 (Athena crashing regularly when browsing
	folders with .svg files with text in them):

	* librsvg/rsvg-ft.c (rsvg_ft_measure_or_render_string): in the
	returned `dimensions' array, return the actual height of the
	glyph buffer, not the height of the text bounding box. This
	appears to fix bug 7264

	* librsvg/rsvg-ft.c (rsvg_ft_measure_or_render_string):
	subtract the last element of the glyph affine transformation
	(the vertical offset) from the position at which it's rendered.
	This fixes the test-ft-gtk test program


	reviewed by: Pavel Cisler  <pavel@eazel.com>

	* src/athena-window.c (athena_window_realize): modified my
	last change to use gnome_pixmap_file () instead of
	athena_pixmap_file () (since the athena-launch-icon.png
	image gets installed in $prefix/share/pixmaps instead of
	$pixmap/share/athena/pixmaps, I had an old icon lying around
	which made me not see this..)

2001-03-02  John Harper  <jsh@eazel.com>

	* libathena-extensions/athena-smooth-text-layout-cache.c:
	disabled self check for now, since it won't work without make
	install having been run

2001-03-02  John Harper  <jsh@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	Fixed bug 6740 (GNOME Panel mini-icon is used in Sawfish, large
	version needs to be there.):

	* src/athena-window.c (athena_window_realize): call
	gnome_window_icon_set_from_file () on the window, with the
	image file whose base is `athena-launch-icon.png'

2001-03-02  Pavel Cisler  <pavel@eazel.com>

	Fix 7225 (emblem sorting locks up entire system for extended
		  period of time)
		  
	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-file-private.h:
	* libathena-extensions/athena-file.c: 
	(fill_emblem_cache_if_needed), (compare_by_emblems):
	Implement a simple cache for automatic and keyword emblems.

	* libathena-extensions/athena-file.c:
	(destroy), (athena_file_set_keywords),
	(athena_file_emit_changed):
	Nuke the cache when keywords change.

2001-03-02  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 558, Items don't show up in trash: when dropped.
		
	* libathena-extensions/athena-volume-monitor.c:
	* libathena-extensions/athena-volume-monitor.h:
	Added detection for ReiserFS.  ReiserFS is now a
	supported type for the trash folder creation and
	detection code.
	
2001-03-02  Frederic Crozat <fcrozat@mandrakesoft.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>
	
	Fixed bug 7276, No support for bzipped man and info pages
	-- problem for Mandrake
	
	Note that the coding style of these files is not the same
	as the rest of the Athena source code.
		
	* components/help/converters/gnome-info2html2/Makefile.am:
	* components/help/converters/gnome-info2html2/main.c: (main):
	* components/help/converters/gnome-man2html2/Makefile.am:
	* components/help/converters/gnome-man2html2/gnome-man2html.c:
	(read_man_page):
	* components/help/hyperbola-filefmt.c:
	(extract_secnum_from_filename), (man_name_without_suffix),
	(fmt_man_populate_tree_for_subdir):
			
2001-03-02  Ian McKellar  <ian@eazel.com>

	reviewed by: <robey@eazel.com>

	* components/services/install-view/callbacks.c:
	(athena_service_install_done):
	* components/services/install-view/athena-service-install-view.c:
	(athena_install_service_describe_menu_entry), (describe_dentry),
	(drag_data_get), (drag_data_delete), (launcher_clicked_callback),
	(make_dragable_icon_well),
	(athena_install_service_add_menu_launchers):
	* components/services/install-view/athena-service-install-view.h:
	Added launchers to the congratulations page.
	This fixes 5513.

	* components/services/inventory/eazel-inventory-utils.c:
	(eazel_inventory_clear_md5):
	Fixed a crasher in the inventory upload.

	* libathena-extensions/athena-clickable-image.c:
	(ancestor_button_release_event):
	Fixed AthenaClickableImage so that it doesn't generate click events
	when you d-n-d from it.

2001-03-02  Eric Fischer  <eric@eazel.com>

	reviewed by: Robin * Slomkowski <rslomkow@eazel.com>

	(Fixes Bug 6927)

	* Makefile.am:
	Add eazel-logos installation and distribution rules, conditional
	upon the presence of the eazel-logos directory.  Remove eazel-logos
	from SUBDIRS.

	* configure.in:
	Add check for presence of eazel-logos directory.  Remove eazel-logos
	Makefiles from list of files to be generated.

	* eazel-logos/Makefile.am:
	* eazel-logos/throbber/Makefile.am:
	Removed.  Now takes place in main Makefile.am.

	* athena.spec.in:
	Only install eazel-logos files if the eazel-logos directory was
	present at build time.

2001-03-03  Kjartan Maraas  <kmaraas@gnome.org>

	* help/athena-quick-reference/no/index.html: Tweaks.
	
2001-03-02  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Work to cache smooth-text-layout objects. This increases the
	speed of aa rendering so that there's no noticeable difference
	when compared with non-aa mode (e.g. when dragging windows over
	the top of the athena window)

	* libathena-extensions/athena-smooth-text-layout-cache.c,
	libathena-extensions/athena-smooth-text-layout-cache.h: new
	class, a cache for the AthenaSmoothTextLayout objects

	* libathena-extensions/athena-icon-canvas-item.c
	(athena_icon_canvas_item_initialize_class): allocate a
	AthenaSmoothTextLayoutCache for all canvas items. It will be
	freed on program exit

	(draw_or_measure_label_text_aa): use the layout cache when
	rendering text

	* libathena-extensions/Makefile.am: added layout cache files

	* libathena-extensions/athena-glyph.c,
	libathena-extensions/athena-glyph.c,
	libathena-extensions/athena-smooth-text-layout.c,
	libathena-extensions/athena-smooth-text-layout.c
	(athena_glyph_compare, athena_smooth_text_layout_compare):
	new functions, only defined when ATHENA_OMIT_SELF_CHECK isn't
	#define'd. Used by the cache's self test code

	* libathena-extensions/athena-lib-self-check-functions.h:
	added athena_self_check_smooth_text_layout_cache to the list

2001-03-02  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 7247, Web Search and Services toolbar icons missing in
	GNOME theme; fixed by tweaking the toolbar theming logic to
	deal with icons that don't have stock equivalents, and adding images
	for the gnome theme to use
	
	* icons/gnome/Makefile.am:
	* icons/gnome/SearchWeb.png:
	* icons/gnome/Services.png:	
	* src/athena-window-toolbars.c: (get_file_name_from_icon_name),
	(set_up_standard_bonobo_button), (set_up_special_bonobo_button),
	(set_up_toolbar_images):

	* icons/Services.png:
	stopgap fix for bug 7289, services toolbar icon in default theme
	doesn't fit in the rest of the toolbar icons.  I replaced it with
	an earlier one that is still consistent with the other services icons,
	but it's still not good enough; Arlo will keep working on a better
	one.
	
2001-03-02  Dan Mueth  <dan@eazel.com>

	reviewed by: John Fleck <jfleck@inkstain.net> 

	(Patch was written by Laszlo Kovacs  <laszlo.kovacs@sun.com>)
	
	Fix problem where use of <anchor> messes up entire document
	rendering.

	Bug #:6827

	* components/help/converters/gnome-db2html2/gdb3html.c:
	(start_element):

2001-03-02  Dan Mueth  <dan@eazel.com>

	reviewed by: Don Melton <don@eazel.com>

	Doing build stuff so that new files regarding
	the distribution license of the Eazel trademarks 
	contained in eazel-logos/ are properly included
	in tarballs and RPM's.

	Bug #: 7275 and 7274

	* Makefile.am: Added TRADEMARK_NOTICE to EXTRA_DIST
	* eazel-logos/Makefile.am: Added LICENSE to icon_DATA
	* athena.spec.in: Added eazel-logos/LICENSE and 
	  TRADEMARK_NOTICE

	Fixed a small problem for "es_ES" locale missing
	a doc.

	* components/help/topleveldocs.xml:

2001-03-02  Michael Engber  <engber@eazel.com>

	reviewed by: George Lebl <jirka@5z.org>

	* components/help/hyperbola-filefmt.c:
	(fmt_scrollkeeper_populate_tree), (fmt_toplevel_populate_tree):
	Switch to using gnome_i18n_get_language_list instead of grabbing
	the language straight from the "LANG" environment variable - 7109.

2001-03-02  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c:
	(athena_property_browser_update_contents):
	fixed bug 7283, wrong pattern dragged when property browser is
	scrolled, by revert yesterday's border box change that caused it.
	
2001-03-02  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Refixed bug 5863 (Opening folder triggers recalculation
	of deep count in Properties window)

	The deep count was being invalidated by the directory
	loading mechanism, which is legal and should be
	harmless. Taught the properties window not to do the
	visible recount whenever deep count is invalidated.

	* src/file-manager/fm-properties-window.c:
	(directory_contents_value_field_update): Set new
	deep_count_finished variable when the deep count is
	done. Afterwards, only update the display if a new
	deep count is completed (don't show future count-ups).

2001-03-01  Eric Fischer  <eric@eazel.com>

	reviewed by: Michael Engber <engber@eazel.com>

	* configure.in:
	Fix tinderbox breakage by adding missing AC_SUBST lines for
	version number dependencies that got moved from the spec file
	to the configure file.

2001-03-01  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 7156 (Opening multiple folders with tree view on causes
	timed wait dialogs for all but the first (folders never open)):

	* libathena-extensions/athena-directory-async.c:
	(async_job_start), (async_job_end): Added some debug code (turned
	off).
	(dequeue_pending_idle_callback): Fix problem where in the cancel
	case we did not do a athena_directory_async_state_changed. This
	didn't actually cause the bug.
	(athena_directory_stop_monitoring_file_list): The actual bug
	fix. Use the correct cancel function here. The old one didn't do
	all the cancelling work.
	(cancel_loading_attributes),
	(athena_directory_cancel_loading_file_attributes): Two more
	cases where we needed a call to
	athena_directory_async_state_changed. These didn't actually
	cause the bug.

2001-03-02  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Seth Nickell  <seth@eazel.com>

	* components/services/inventory-view/Makefile.am: Add missing file
	to sources to fix tinderbox.

2001-03-02  Laszlo Kovacs  <laszlo.kovacs@sun.com>

	reviewed by Seth Nickell:

	* components/help/hyperbola-filefmt.c:
	fixed bug 7248, two warnings commented out

2001-03-01  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Eskil Heinous Olsen <eskil@eazel.com>

	* libathena-extensions/athena-string-list.h:
	* libathena-extensions/athena-string-list.c:
	(athena_string_list_nth_as_integer),
	(athena_self_check_string_list):
	New function to get the nth string as an integer - and checks.

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-font-manager.h:
	* libathena-extensions/athena-font-manager.c:
	* libathena-extensions/athena-lib-self-check-functions.h:
	New files.  Support for collecting information about the scalable
	fonts installed on the system.  Parts written by Pavel Cisler.
	
	* components/text/athena-text-view.c:
	(athena_text_view_initialize):
	Mark a string for translation.

	* libathena-extensions/athena-font-factory.c:
	(athena_font_factory_get_font_by_family):
	Take fontsets into account.  Patch submitted by
	eungkyu@sparcs.kaist.ac.kr.

	* libathena-extensions/athena-preferences-item.h:
	* libathena-extensions/athena-preferences-item.c:
	(athena_preferences_item_initialize_class),
	(athena_preferences_item_initialize), (preferences_item_destroy),
	(preferences_item_construct), (preferences_item_update_enum),
	(preferences_item_create_enum),
	(preferences_item_update_short_enum),
	(preferences_item_create_short_enum),
	(preferences_item_update_boolean),
	(preferences_item_create_boolean),
	(preferences_item_update_editable_string),
	(preferences_item_create_editable_string),
	(preferences_item_update_integer),
	(preferences_item_create_integer),
	(preferences_item_update_font_family),
	(preferences_item_create_font_family),
	(athena_preferences_item_new),
	(enum_radio_group_changed_callback),
	(athena_preferences_item_update_displayed_value),
	(update_text_settings_at_idle):
	Clean this up a bit.  Follow athena coding conventions more.
	Remove long unused theme picker.
	Remove unused GtkArg stuff.

	* libathena-extensions/athena-preferences-pane.c:
	(athena_preferences_pane_new):
	* libathena-extensions/athena-preferences-pane.h:
	Remove unused pane description.

	* libathena-extensions/athena-preferences-box.c:
	(athena_preferences_box_add_pane):
	* libathena-extensions/athena-preferences-box.h:
	Remove unused pane description.

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_defaults): Mark font name for
	translation.
	(global_preferences_create_dialog),
	(global_preferences_create_search_pane): Remove unused pane
	description.

	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-athena-glyph-simple.c: (main):
	* test/test-athena-glyph.c: (main):
	* test/test-athena-labeled-image.c: (main):
	* test/test-athena-smooth-text-layout.c: (main):
	* test/test-athena-font-manager.c: (main):
	* test/test.c: (test_quit):
	* test/test.h:
	Some minor changes.  New test for font manager.

2001-03-02  Arlo Rose  <arlo@eazel.com>

	reviewed by: Josh Barrow <josh@eazel.com>

	* icons/ardmore/theme_preview.png:
	* icons/arlo/theme_preview.png:
	* icons/crux_eggplant/backgrounds/window_pattern.png:
	* icons/crux_eggplant/theme_preview.png:
	* icons/gnome/theme_preview.png:
	* icons/athena-mini-logo.png:
	* icons/theme_preview.png:
	* icons/villanova/theme_preview.png:
	New theme previews for the smaller size, and 1bit alpha.
	Also, a couple of other tweaks.

2001-03-02  Arlo Rose  <arlo@eazel.com>

	* icons/gnome/gnome.xml:
	* icons/gnome/throbber/008.png:
	Fixed an old bug in the GNOME throbber (frame 8) that was 
	reintroduced at some point

2001-03-02  Arlo Rose  <arlo@eazel.com>

	reviewed by: Josh Barrow <josh@eazel.com>

	* configure.in:
	* icons/arlo/arlo.xml:
	* icons/arlo/throbber/001.png:
	* icons/arlo/throbber/002.png:
	* icons/arlo/throbber/003.png:
	* icons/arlo/throbber/004.png:
	* icons/arlo/throbber/005.png:
	* icons/arlo/throbber/006.png:
	* icons/arlo/throbber/007.png:
	* icons/arlo/throbber/008.png:
	* icons/arlo/throbber/009.png:
	* icons/arlo/throbber/010.png:
	* icons/arlo/throbber/011.png:
	* icons/arlo/throbber/012.png:
	* icons/arlo/throbber/013.png:
	* icons/arlo/throbber/014.png:
	* icons/arlo/throbber/015.png:
	* icons/arlo/throbber/016.png:
	* icons/arlo/throbber/017.png:
	* icons/arlo/throbber/018.png:
	* icons/arlo/throbber/019.png:
	* icons/arlo/throbber/020.png:
	* icons/arlo/throbber/021.png:
	* icons/arlo/throbber/022.png:
	* icons/arlo/throbber/023.png:
	* icons/arlo/throbber/024.png:
	* icons/arlo/throbber/025.png:
	* icons/arlo/throbber/026.png:
	* icons/arlo/throbber/027.png:
	* icons/arlo/throbber/028.png:
	* icons/arlo/throbber/029.png:
	* icons/arlo/throbber/030.png:
	* icons/arlo/throbber/Makefile.am:
	* icons/arlo/throbber/rest.png:
	* icons/crux_eggplant/Makefile.am:
	* icons/crux_eggplant/crux_eggplant.xml:
	* icons/crux_eggplant/throbber/001.png:
	* icons/crux_eggplant/throbber/002.png:
	* icons/crux_eggplant/throbber/003.png:
	* icons/crux_eggplant/throbber/004.png:
	* icons/crux_eggplant/throbber/005.png:
	* icons/crux_eggplant/throbber/006.png:
	* icons/crux_eggplant/throbber/007.png:
	* icons/crux_eggplant/throbber/008.png:
	* icons/crux_eggplant/throbber/009.png:
	* icons/crux_eggplant/throbber/010.png:
	* icons/crux_eggplant/throbber/011.png:
	* icons/crux_eggplant/throbber/012.png:
	* icons/crux_eggplant/throbber/013.png:
	* icons/crux_eggplant/throbber/014.png:
	* icons/crux_eggplant/throbber/015.png:
	* icons/crux_eggplant/throbber/016.png:
	* icons/crux_eggplant/throbber/017.png:
	* icons/crux_eggplant/throbber/018.png:
	* icons/crux_eggplant/throbber/019.png:
	* icons/crux_eggplant/throbber/020.png:
	* icons/crux_eggplant/throbber/021.png:
	* icons/crux_eggplant/throbber/022.png:
	* icons/crux_eggplant/throbber/023.png:
	* icons/crux_eggplant/throbber/024.png:
	* icons/crux_eggplant/throbber/025.png:
	* icons/crux_eggplant/throbber/026.png:
	* icons/crux_eggplant/throbber/027.png:
	* icons/crux_eggplant/throbber/028.png:
	* icons/crux_eggplant/throbber/029.png:
	* icons/crux_eggplant/throbber/030.png:
	* icons/crux_eggplant/throbber/Makefile.am:
	* icons/crux_eggplant/throbber/rest.png:
	Yee Ha!  New throbbers for everyone!
	Added new throbbers for Crux Teal and Eggplant.

2001-03-01  Ian McKellar <ian@eazel.com>

	reviewed by: John "I'll review that" Harper.

	* components/services/inventory-view/athena-inventory-view-private.h:
	Added file that Mike forgot.

2001-03-01  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	Fixed bug 7254 (Remove Featured Downloads tab from svcs summary
	page)

	* components/services/summary/athena-summary-view.c:
	(append_hseparator_to_vbox), (generate_eazel_news_entry_row),
	(summary_view_update_pane), (generate_service_entry_row): Minor
	spacing tweaks to match Arlo's screenshot.
	(create_summary_form): ifdef out the code that shows the featured
	donwloads pane. Don't entirely remove it for now to avoid major
	code changes this late in the game.
 
2001-03-01  John Harper  <jsh@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 7238 ("View as EOG Image" adds toolbar icons that
	don't go away):

	* components/adapter/athena-adapter.c
	(athena_adapter_destroy): when the adapter has a non-null
	embedding strategy, deactivate it before destroying

	I think there may be a refcounting problem in EOG that caused
	the original problem, but the above should always be safe, and
	will protect athena from misbehaving components

2001-03-01  Mike Fleming  <mfleming@eazel.com>

	reviewed by: <ian@eazel.com>

	Part of bug 5575: Polish up inventory view.

	Makes "enable" and "disable" views look reasonable and 
	adds a optional ? arg for the next URI.

	* components/services/inventory-view/athena-inventory-disable-page.c:
	(disable_inventory_callback),
	(athena_inventory_disable_page_initialize),
	(athena_inventory_disable_page_new),
	(athena_inventory_disable_page_destroy),
	(athena_inventory_disable_page_run):
	* components/services/inventory-view/athena-inventory-disable-page.h:
	* components/services/inventory-view/athena-inventory-enable-page.c:
	(callback_progress_update),
	(athena_inventory_enable_page_initialize),
	(athena_inventory_enable_page_new),
	(callback_timeout_error_navigate), (callback_eazel_inventory),
	(athena_inventory_enable_page_run),
	(athena_inventory_enable_page_destroy):
	* components/services/inventory-view/athena-inventory-enable-page.h:
	* components/services/inventory-view/athena-inventory-view.c:
	(athena_inventory_view_initialize), (get_finish_uri),
	(inventory_load_location_callback):
	* libathena-extensions/athena-file-utilities.c:
	(athena_self_check_file_utilities):

2001-03-01  Arlo Rose  <arlo@eazel.com>

	* icons/crux_eggplant/crux_eggplant.xml:
	List view color tweak.

2001-03-01  Rebecca Schulman  <rebecka@eazel.com>

	Some leak checks that showed up on the top of the
	leak checker profile. (bugzilla.eazel.com 7253)
	These changes reduce leakage in a short session
	by 100,000 bytes

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-preferences.c:
	(athena_preferences_get_user_level):
	Remove leak of a string every time we checked user level
	* libathena-extensions/athena-smooth-text-layout.c:
	(athena_smooth_text_layout_destroy),
	(smooth_text_layout_clear_lines):
	Remove a leak of the text and some other characters every time
	we created and used a text layout object, which was about 6000
	times for a short run for me
	* libathena-extensions/athena-volume-monitor.c:
	Stop strdup'ing a string where we would have leaked the original.

2001-03-01  Arik Devens  <arik@eazel.com>

	reviewed by: Robin * Slomkowski  <rslomkow@eazel.com>
	
	* configure.in: Changing our dependency on control center back to
	1.2.3 after being browbeaten on irc by people who know more than
	me.

2001-03-01  Eric Fischer  <eric@eazel.com>

	reviewed by: Arik Devens <arik@eazel.com>

	* configure.in:
	Remove -F- flag to awk in control-center check, since gnomecc
	separates name from version with spaces, not dashes.

2001-03-01  Arlo Rose  <arlo@eazel.com>

	* icons/Services.png:
	Made the toolbar icon match the rest of the services icons.

2001-03-01  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>

	* athena-installer/src/installer.c: (install_failed):

	No longer need to throw away install_failed signals since we'll
	only get them for the toplevel package now.  Need to report this
	error so that redundant installs won't be reported as servers
	being down.

2001-03-01  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* components/services/athena-dependent-shared/icons/eazel-logo-right-side-logo.png:
	* icons/about_background.png:
	* icons/druid_header.png:
	* icons/throbber/001.png:
	* icons/throbber/002.png:
	* icons/throbber/003.png:
	* icons/throbber/004.png:
	* icons/throbber/005.png:
	* icons/throbber/006.png:
	* icons/throbber/007.png:
	* icons/throbber/008.png:
	* icons/throbber/009.png:
	* icons/throbber/010.png:
	* icons/throbber/011.png:
	* icons/throbber/012.png:
	* icons/throbber/013.png:
	* icons/throbber/014.png:
	* icons/throbber/015.png:
	* icons/throbber/016.png:
	* icons/throbber/017.png:
	* icons/throbber/018.png:
	* icons/throbber/019.png:
	* icons/throbber/020.png:
	* icons/throbber/021.png:
	* icons/throbber/022.png:
	* icons/throbber/023.png:
	* icons/throbber/024.png:
	* icons/throbber/025.png:
	* icons/throbber/026.png:
	* icons/throbber/027.png:
	* icons/throbber/028.png:
	* icons/throbber/029.png:
	* icons/throbber/030.png:
	* icons/throbber/rest.png:
	Checked in uncorrupted png files.

2001-03-01  Arik Devens  <arik@eazel.com>

	reviewed by: Robin * Slomkowski  <rslomkow@eazel.com>

	Fixed bug 7032, File Types & Programs capplet not installed on
	GNOME 1.2.
	Fixed bug 7240, require the new version of gtk-pixbuf in both
	configure.in and spec.in.
	
	* configure.in: Added requirements for both the new control center
	and the new gdk-pixbuf, both using eric's new macros.
	* athena.spec.in: Moved everything over to the new macros.

2001-03-01  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com> who sighed heavily
	and went back to today batch of installer bugs...

	This fixes bug 7196.
	
	* components/rpmview/athena-rpm-view-install.c:
	(save_transaction), (athena_rpm_view_install_package_callback),
	(athena_rpm_view_uninstall_package_callback):
	Added a save_transaction callback that returns FALSE.
	Setup the save_transaction callback signals.
	
	* components/services/install-view/callbacks.h:
	* components/services/install-view/callbacks.c:
	(athena_service_install_save_transaction):
	Added a save_transaction callback that returns FALSE.
	
	* components/services/install-view/athena-service-install-view.c:
	(athena_service_install_view_update_from_uri_finish):
	Setup the save_transaction callback signals.

	* components/services/install-view/forms.c:
	Reverted the " " to "" since bug 7198 was fixed.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_save_transaction_signal), (main):
	Added a save_transaction callback that asks the user y/n.
	Fixed I18N comment
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	Added the save_transaction callback.
	
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_save_transaction), (eazel_install_callback_get_epv),
	(eazel_install_callback_class_initialize):
	Added the save_transaction callback.
	Added missing g_list_free's

	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied_features), (execute), (get_packages_with_mod_flag):
	Changed a comment.
	Call emit_save_transaction prior to saving transaction.
	
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_class_initialize), (eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_emit_preflight_check_default),
	(eazel_install_emit_save_transaction),
	(eazel_install_emit_save_transaction_default):
	All the insane code to setup the save_transaction thingy.
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(eazel_install_gtk_marshal_BOOL__ENUM_POINTER):
	And a special handcarved from a raw metal ore gtk marshal function
	for the save_transaction signal.
	
2001-03-01  Eric Fischer  <eric@eazel.com>

	reviewed by: Arik Devens <arik@eazel.com>

	* configure.in:
	Improve the process of checking for required versions of other
	software by moving the version numbers out of the spec file and
	the body of the configure script and into their own section of
	the script.

	Also add a couple of autoconf macros that will reduce the amount
	of boilerplate that needs to get written for each version check.

	* athena.spec.in:
	Change some of the requirements to get their version numbers from
	the configure script rather than hardwiring them here.

	(Bug 7229)

2001-03-01  Arlo Rose  <arlo@eazel.com>

	* icons/About_Image.png:
	Added the non-Eazel version; it looks pretty cool.


2001-03-01  Dan Mueth  <dan@eazel.com>

	reviewed by: Eric Fischer <eric@eazel.com>

	Adding Swedish translation of Athena Quick Reference:

	* configure.in:
	* help/athena-quick-reference/Makefile.am:
	* help/athena-quick-reference/sv/.cvsignore:
	* help/athena-quick-reference/sv/Makefile.am:
	* help/athena-quick-reference/sv/figures/colors_small.png:
	* help/athena-quick-reference/sv/figures/emblems_small.png:
	* help/athena-quick-reference/sv/figures/ff_small.png:
	* help/athena-quick-reference/sv/figures/find_small.png:
	* help/athena-quick-reference/sv/figures/full_small.png:
	* help/athena-quick-reference/sv/figures/locbar_small.png:
	* help/athena-quick-reference/sv/figures/menubar_small.png:
	* help/athena-quick-reference/sv/figures/music_small.png:
	* help/athena-quick-reference/sv/figures/navbar_small.png:
	* help/athena-quick-reference/sv/figures/sidebar_small.png:
	* help/athena-quick-reference/sv/figures/softcat.png:
	* help/athena-quick-reference/sv/figures/storage.png:
	* help/athena-quick-reference/sv/figures/themes_small.png:
	* help/athena-quick-reference/sv/index.html:
	* help/athena-quick-reference/sv/athena-quick-reference-sv.omf:

	Updating a .cvsignore file:

	* help/athena-quick-reference/no/.cvsignore:

	Fixing l10n of About dialog... Returns are hard coded into the
	po file and were placed such that text on left side collided
	with names on the right side.  I reformatted the text for locales
	which were translated and appeared correctly in the locale for me.
	Bug #: 7117

	* po/de.po:
	* po/fr.po:
	* po/no.po:
	* po/pt_BR.po:
	* po/sk.po:
	* po/sl.po:
	* po/tr.po:

2001-03-01  Arik Devens  <arik@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7190, Typing / in location moves cursor to end of line.
	
	* src/athena-location-bar.c: (editable_key_press_callback): Made
	the location bar check to see if the entry has changed on a slash
	so that we aren't expanding stuff that doesn't need to be
	expanded.

2001-03-01  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c:
	(athena_property_browser_update_contents):
	fixed bug 7143, increased borders in property browser to Arlo's
	taste; fixed by adding a box with an 8 pixel border width.
	
	* src/athena-sidebar-tabs.c:
	fixed bug 7226, sidebar tabs are too small in Sierra theme; fixed by
	increasing the tab height constant by three pixels.
	
2001-03-01  Mike Fleming  <mfleming@eazel.com>

	reviewed by: <rslomkow@eazel.com>

	Bug 2926: Improve check for ammonite with --enable-eazel-services
	
	* configure.in:

2001-03-01  Michael Engber  <engber@eazel.com>

	reviewed by: George Lebl <jirka@5z.org>

	* components/help/hyperbola-nav-tree.c:
	* components/help/hyperbola-types.h:
	Included the appropriate headers to define the
	internationalization string macros.

2001-03-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7164 (infinite redrawing in particular layout case)

	* libathena-extensions/athena-icon-container.c:
	(lay_down_icons_horizontal): Fixed the math for determining
	whether the current icon fits on the current row; added a
	FIXME about a questionable design choice.
	(size_allocate): Added a FIXME.

2001-03-01  Arik Devens  <arik@eazel.com>

	reviewed by: Mike Fleming  <mfleming@eazel.com>

	Fixed bug 6756, Clicking on anchor links in info: pages causes
	page to reload.
	
	* components/help/converters/gnome-info2html2/html.c:
	(form_info_tag_href): Changed so that info anchor tag uri's are
	always local.

2001-03-01  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 7168, change name of first time druid flag so 1.0 users
	will get to see the new options in the druid.

	reviewed by: Michael Engber <engber@eazel.com>
	
	* src/athena-application.c: (need_to_show_first_time_druid):
	* src/athena-first-time-druid.c:
	(druid_set_first_time_file_flag):

2001-03-01  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7208 (History and Notes panels intermittently die at
	startup or window launch). The bug turned out to be a logic error
	at the shell level, not a panel crashing as I had been assuming.
	
	* src/athena-view-frame.c: (athena_view_frame_stop),
	(athena_view_frame_selection_changed),
	(athena_view_frame_title_changed), (send_history): Check whether
	the CORBA view object is NIL instead of looking at state. The view
	will be NIL at all the right times, and it's a simpler and more
	reliable check. In particular, it's correct during the early
	loading stage, when the state does not reflect whether the view is
	present yet or not.

	* libathena-extensions/athena-glib-extensions.c:
	(athena_g_hash_table_new_free_at_exit): Only complain on systems
	where ATHENA_DEBUG is set, because this could confuse real users
	(the message doesn't really represent a bug).

2001-03-01  Eric Fischer  <eric@eazel.com>

	reviewed by: Robin * Slomkowski <rslomkow@eazel.com>

	* athena.spec.in:
	Add dependency for libpng (fixed Bug 7162)
	Also change dependency for gnome-libs to 1.2.11, because
	Robin says anything built against that version (as on the
	build servers) will break if run with an older release.

2001-03-01  Eric Fischer  <eric@eazel.com>

	reviewed by: Laszlo Kovacs <laszlo.kovacs@sun.com>

	Fixes Bug 7128 (Organization of "Manual" in Help sidebar is bizarre)

	* components/help/hyperbola-filefmt.c:
	(fmt_man_populate_tree_for_dir):
	Put man pages in sections corresponding more closely to traditional
	Unix manual organization.

	(fmt_man_populate_tree):
	Add translate_array() and make_treesection() calls for the added
	manual sections.

2001-03-01  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 7155 - Athena dies trying to get bold font at startup if
	using Finish locale. 
	
	Many bulletproofing fixes to make sure Athena doesnt crash in
	systems with broken or limited font setups.
	
	* libathena-extensions/athena-gdk-font-extensions.c:
	(athena_gdk_font_get_italic): Use the cached font list as we do
	for bold fonts.  Make sure the slant_pattern is valid.  If its
	not, then return the source font.  Remove some not needed casts.
	(font_scalable_get_by_size): Bulletproof.  Dont assert that the
	font load always works - it doesnt.  
	(font_bitmap_get_by_size): Bulletproof.  Dont do any work if a
	valid larger_font pattern cant be determined - simply return NULL
	in this case, the callers should deal with that case.  Make sure
	we actually found a matching (or close) font size.  Before we were
	assuming that there would be at least one match.  Not so for
	really broken font setups.
	(athena_gdk_font_get_larger): Remove some not needed casts.
	(athena_gdk_font_get_largest_fitting): Check that the candidate
	font is not NULL before proceeding to check that it matches.
	(font_get_bold): Use the cached font lists to make bold font
	queries.  Remove some not needed casts.
	(font_get_size_in_pixels):  Check for invalid XLFD names and
	return 0 (not found indicator) for such cases.

	Also added a FIXME for an improvement for the fallback font
	strategy.

	Fix two tiny regressions:

	7206 - Sidebar title does not properly center justify
	7198 - Zero length AthenaLabel doens't draw background tile

	* libathena-extensions/athena-label.c: 
	(paint_label_smooth): We need to draw the background tile even if
	the string has zero length.
	(label_force_cached_requisition_flush): Remove the broken "phony
	justification" hack.  Replace it with a simpler "phony pattern"
	hack that works.
	
2001-03-01  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>
	who pronounced it his 2nd favorite patch, ever.

	* components/services/install-view/callbacks.c:
	(inventory_service_callback):

	Remove mispelled spam that crept back in during Ian's checkin.

	* athena-installer/src/gtk-hackery.c: (gtk_label_new_with_font):
	* athena-installer/src/main.c: (main):

	Don't explode if the font we want isn't available.  Don't try to
	localize text in the bootstrap installer because it just leads to
	trouble.

2001-03-01  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>
	who hummed the twilight zone theme while reviewing...

	Fixes bug 7197 "install view's ``messages'' 
	header doesn't reach across the window"

	* components/services/install-view/forms.c:
	(generate_install_form):
	s/""/" "/ in eazel_services_header_middle_new,
	fixes bug 7197

2001-03-01  Dan Mueth  <dan@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Added Spanish version of Athena Quick Reference:

	* configure.in:
	* help/Makefile.am:
	* help/athena-quick-reference/Makefile.am:
	* help/athena-quick-reference/es/.cvsignore:
	* help/athena-quick-reference/es/Makefile.am:
	* help/athena-quick-reference/es/figures/colors_small.png:
	* help/athena-quick-reference/es/figures/emblems_small.png:
	* help/athena-quick-reference/es/figures/ff_small.png:
	* help/athena-quick-reference/es/figures/find_small.png:
	* help/athena-quick-reference/es/figures/full_small.png:
	* help/athena-quick-reference/es/figures/locbar_small.png:
	* help/athena-quick-reference/es/figures/menubar_small.png:
	* help/athena-quick-reference/es/figures/music_small.png:
	* help/athena-quick-reference/es/figures/navbar_small.png:
	* help/athena-quick-reference/es/figures/sidebar_small.png:
	* help/athena-quick-reference/es/figures/softcat.png:
	* help/athena-quick-reference/es/figures/storage.png:
	* help/athena-quick-reference/es/figures/themes_small.png:
	* help/athena-quick-reference/es/index.html:
	* help/athena-quick-reference/es/athena-quick-reference-es.omf:

	Added placeholder for Athena Release Notes, to be filled in
	by Vera later:
	Bug #: 6969

	* help/athena-release-notes/.cvsignore:
	* help/athena-release-notes/C/.cvsignore:
	* help/athena-release-notes/C/Makefile.am:
	* help/athena-release-notes/C/athena-release-notes-C.omf:
	* help/athena-release-notes/C/athena-release-notes.sgml:
	* help/athena-release-notes/Makefile.am:

	Fixed Athena spec file w/r/t documentation.  It is now simpler,
	gives the right permissions to figures, and doesn't need to be
	updated every time somebody adds a new doc or translation.
	Bug #: 7002

	* athena.spec.in:

2001-02-28  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>
	"the most beautiful patch I've ever seen"

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (something_failed), (eazel_preflight_check_signal):
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree):
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_dump_tree_helper), (packagedata_dump_tree_int),
	(packagedata_dump_tree), (dump_package_deplist):

	Move the package-tree dumper from the command-line util into the
	install lib, and remove the redundant copies.  This cleans up the
	debug output to fix bug 7127.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header):
	* components/services/install/lib/eazel-package-system-types.h:

	Someone mispelled PACKAGE as PACAKGE fairly consistently.  It was
	probably me.
	
	* components/services/trilobite/libtrilobite/trilobite-core-messagi
	ng.c: (trilobite_add_log):

	Handle multi-line debug output without spazzing.

2001-02-28  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	This patch fixes bug 7122 and reduces flicker in the install-view.
	
	* components/services/docs/installer-rpm-cases:
	Corrected the description of a case.
	
	* components/services/install-view/forms.c: (install_message_new):
	Reduced flicker by no longer forcing a redraw.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c:
	Disabled force since it doesn't work (and really shouldn't).
	
	* components/services/install/lib/eazel-install-corba-callback.c:
	(eazel_install_callback_initialize),
	(eazel_install_callback_get_type):
	Removed commented out debug stuff.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages_helper), 
	Added more spam to the debug output.
	(post_get_softcat_info),
	Moved code from get_softcat_info here
	(get_softcat_info), (check_tree_helper):
	Call post_get_softcat_info, this fixes bug 7122.
	
	* components/services/install/lib/eazel-softcat.c:
	(get_search_url_for_package), (eazel_softcat_query):
	s/provides/features/
	
	* components/services/install/server/main.c: (main):
	Spellfix.

2001-02-28  Brian Frank  <bfrank@eazel.com>

	Added MandrakeSoft to bookmarks, and fixed Sun Wah link to default to "non-flash" page.
	
	* data/static_bookmarks.xml

2001-02-28  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-directory-metafile-monitor.c:
	(corba_metafile_ready):
	Add newline at end of file to make redhat7 compiler happy.  Fix
	emacs header blurb.
	
2001-02-28  Arik Devens  <arik@eazel.com>

	reviewed by: Robin * Slomkowski  <rslomkow@rslomkow.org>

	Fixed bug 6836, Add scrollkeeper as a dependency of Athena in
	configure.in.
	
	* configure.in: Added checking for scrollkeeper install.
	* ChangeLog: Forgot to commit ChangeLog for last checkin. Sorry to
	all about that.

2001-02-28  Arik Devens  <arik@eazel.com>

	reviewed by: Robin * Slomkowski  <rslomkow@rslomkow.org>

	Fixed bug 7161, change both configure.in and RPM to require gtk
	1.2.9 or newer.
	
	* configure.in: Updated our GTK+ dep to 1.2.9.
	* athena.spec.in: Updated our GTK+ dep to 1.2.9.

2001-02-28  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Found and fixed as many untranslated things as possible. John
	Sullivan found them and I fixed them. This takes care of much of
	bug 6977.

	* check-strings-functions:
	* check-strings-patterns:
	More things to ignore and fixes to bad patterns done while John
	and I did our pass over all the code.
	
	* check-strings.pl: Fix comment.

	* applets/preferences-applet/athena-preferences-applet.c: (main):
	* components/hardware/athena-hardware-view.c: (setup_CPU_form),
	(setup_RAM_form), (setup_IDE_form):
	* components/rpmview/athena-rpm-verify-window.c:
	(athena_rpm_verify_window_initialize):
	* components/services/inventory-view/athena-inventory-config-page.c:
	(athena_inventory_config_page_initialize),
	(athena_inventory_config_page_destroy):
	* components/services/inventory-view/athena-inventory-disable-page.c:
	(athena_inventory_disable_page_initialize):
	* helper-utilities/authenticate/athena-authenticate.c: (main):
	* libathena-extensions/athena-password-dialog.c:
	(athena_password_dialog_new):
	* libathena-extensions/athena-program-chooser.c:
	(athena_program_chooser_show_no_choices_message):
	Mark additional strings for translation.
	
	* components/adapter/athena-adapter-embed-strategy.c:
	(athena_adapter_embed_strategy_initialize_class): Fix misspelling
	of signal names.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new): Fix a typo.
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_error_string): Write comment about why these strings
	don't need translation.
	
	* libathena-extensions/athena-gtk-extensions.c: Tweak formatting.
	
	* libathena-extensions/athena-preferences-dialog.c:
	(athena_preferences_dialog_construct): Use stock button instead of
	hard-coded OK for translation purposes.

2001-02-28  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-directory-async.c:
	(metafile_read_mark_done):
	* libathena-extensions/athena-directory-metafile-monitor.c:
	(athena_metafile_monitor_get_epv), (corba_metafile_changed),
	(corba_metafile_ready):
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory.c:
	(athena_directory_find_file_by_relative_uri),
	(athena_directory_find_file_by_internal_uri):
	* libathena-extensions/athena-metafile-server.idl:
	* libathena-extensions/athena-metafile.c: (corba_set),
	(corba_set_list),
	(athena_metafile_notify_metafile_ready),
	(call_metafile_changed),
	(call_metafile_changed_for_all_files_mentioned_in_metafile),
	(call_metafile_changed_for_one_file):
	* libathena-extensions/athena-metafile.h:
	When a metafile is read in - change signals are sent to all
	files rather than just the ones with metadata. Also fixed
	it so change notifications to the "." file will happen. Bug 7044.

2001-02-28  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 7138, non-ASCII characters in author's names causes
	the Japanese version to crash.  Fixed by removing the accented
	'i' from Pavel's name
	
	* src/athena-window-menus.c: (help_menu_about_athena_callback):
	replaced the accented 'i' in Pavel's name with a plain one
	* check-THANKS.pl:
	fixed mapping in check-THANKS.pl as requested by Darin
	* AUTHORS:
	removed from AUTHORS, too, for consistency

2001-02-28  Mike Fleming  <mfleming@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Bug 7157: Reloads can cause crash; reloads to redirected URI's can
	cause error dialog to appear
	
	* src/athena-window-manage-views.c: (athena_window_reload):

2001-02-28  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fix bug 6368 - Multibyte font handling.
	
	* librsvg/rsvg-ft.c: (rsvg_ft_get_glyph),
	(rsvg_ft_measure_or_render_string):
	Tell freetype to never load bitmaps when loading glyphs.  We only
	use the outlines of scalable fonts.  This means our code will work
	even for glyphs that have embedded bitmaps.

	Add support for multi byte characters.  We do this by allocate a
	wide character array and converting the source string to wide
	chars.  If no wide characters are found in the source string, then
	we fill in the wide char array with the regular single byte chars.

	This changes are based on a patch contributed by Yukihiro Nakai
	<nakai@gnome.gr.jp> - thanks much.


	Unrelated change.
	
	* libathena-extensions/athena-labeled-image.c:
	(athena_labeled_image_initialize):
	Remove a extraneous '+' that sneaked in here.

2001-03-01  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Added Makefile generation for the below.
	* help/athena-quick-reference/Makefile.am: Added no subdir
	* help/athena-quick-reference/no/*: Added Norwegian translation.
	
2001-02-28  Darin Adler  <darin@eazel.com>

	* check-strings.pl: Fixed error in script that John noticed
	when he tried it. The regular expression for matching
	function names was matching way too many.

2001-02-28  Darin Adler  <darin@eazel.com>

	* check-strings-functions:
	* check-strings.pl: Tweaks to just-checked-in stuff.

	* src/athena-first-time-druid.c: Fix build by
	getting rid of incorrect use of stringize macro.

2001-02-28  John Harper  <jsh@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6988 (Athena consumes CPU for 5 mins on startup) by
	reverting my fix to bug 6820 (directory sort order is different
	in tree view):

	* components/tree/athena-tree-view.c
	(athena_tree_view_initialize): commented out the call to
	gtk_clist_set_compare_func - revert to using the default clist
	comparison function (basically strcmp)

	(ctree_compare_rows): commented out this function

2001-02-28  Fatih Demir	<kabalak@gtranslator.org>

	* THANKS: Corrected the translator entry from me to
	Görkem Cetin who translated Athena now.

2001-02-28  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* check-strings.pl:
	* check-strings-functions:
	* check-strings-patterns:
	New script and correspoinding config files to help us find
	untranslated strings. It's going to take some effort to make
	this an easy-to-use tool.
	
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize): Fixed string that would not
	get translated properly since it was using N_ and nothing
	was going to use _() on it.
	(athena_rpm_view_update_from_uri): Marked strings for
	translation as requested in bug report 7149.
	(athena_rpm_view_verify_files): Format tweak.
	(athena_rpm_view_drag_data_received): Remove old dead code.
	
	* libathena-extensions/athena-tabs.c: (draw_tab_piece_aa):
	Change to use C-style comments, not C++.
	
	* src/athena-application.c: (check_required_directories): Mark
	strings for translation that we had missed before.
	* src/athena-first-time-druid.c: Fix port string define so it
	doesn't have to be repeated twice (and doesn't show up as an
	"untranslated string").

	* src/athena-about.c: Formatting tweak.
	* src/athena-location-bar.c: Fix typo.

2001-02-28  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 7141, gconf entry "show_directory_item_counts"
	stored in "preferencees" directory
	
	* libathena-extensions/athena-global-preferences.h:
	Corrected a typographical error.
	
2001-02-28  Kjartan Maraas  <kmaraas@gnome.org>

	* components/services/install/command-line/eazel-alt-install-corba.c:
	Fix typo Unnstalling -> Uninstalling
	
2001-02-28  John Harper  <jsh@eazel.com>

	reviewed by Ramiro Estrugo <ramiro@eazel.com>

	Fixed bug 7111 (Icons appear in formation, then shift, when
	page first loads). This also fixed bugs 4174 (AthenaLabel
	needs to handle text with descenders better.) and 2865 (Text
	underlining should honor the rendered string's baseline):

	* librsvg/rsvg-ft.c (rsvg_ft_measure_or_render_string): don't
	use the union of the bounding boxes of the glyphs to find the
	overall bounding box, for the vertical component use the actual
	font metrics. Also set the underline_position and
	underline_thickness fields of the returned glyph structure

	* librsvg/rsvg-ft.h (struct _RsvgFTGlyph): added two new
	fields: underline_position and underline_thickness

	* libathena-extensions/athena-smooth-text-layout.c
	(smooth_text_layout_line_list_draw_to_pixbuf): don't just draw
	the underline under the glyph's rectangle, draw it where the
	glyph object wants it to be (using
	athena_glyph_get_underline_rectangle (), which for text uses
	the actual underline information from the font)

	* libathena-extensions/athena-glyph.h,
	libathena-extensions/athena-glyph.c
	(athena_glyph_get_underline_rectangle): new function, fills
	in an ArtIRect corresponding to the underline of the given
	glyph object

	* components/services/athena-dependent-shared/eazel-services-header.c: 
	* libathena-extensions/athena-tabs.c,
	libathena-extensions/athena-smooth-text-layout.c,
	libathena-extensions/athena-icon-canvas-item.c
	* src/athena-sidebar-title.c, src/athena-sidebar-tabs.c

	Tweaked a few hardcoded constants to fix minor changes in font
	layout (this part was checked by Arlo)

2001-02-27  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Oslen <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper):

	Added debug info of packages modifies list, so the logging on
	upgrading packages isn't so confusing.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(eazel_install_packagelist_parse):

	Force the XML parser to ignore any <xmp> .. </xmp> tags, which may
	or may not fix some people's issues with the installer not being
	able to parse the server XML sometimes.
	
	* components/services/install/lib/eazel-package-system-types.h:

	Fix old reference to soft_depends.
	
	* components/services/install-view/Makefile.am:
	* components/services/install-view/athena-service-install.c:
	* components/services/install-view/athena-service-install.h:

	These files are useless.
	
	* athena-installer/src/installer.c: (collect_failure_info),
	(eazel_install_get_depends), (eazel_installer_initialize):

	Use the new path to the package-list.xml file.
	
	* athena-installer/src/main.c: (segv_handler):

	Spelling fix.

2001-02-27  Arlo Rose  <arlo@eazel.com>

	* icons/default.xml:
	Tiny tweak.

2001-02-27  Arlo Rose  <arlo@eazel.com>

	* icons/arlo/arlo.xml:
	* icons/crux_eggplant/crux_eggplant.xml:
	* icons/default.xml:
	Changed the default background color so that the list
	view looks better.

2001-02-27  Pavel  <pavel@eazel.com>

	reviewed by: Arlo Rose <arlo@eazel.com>

	Fix 1509: List view draws using incorrect design specification
	
	* libathena-extensions/athena-list.c:
	(athena_list_setup_style_colors):
	Tweak color shifting values with Arlo to get better color ranges
	for the list view grid.

2001-02-27  Mike Fleming  <mfleming@eazel.com>

	Bug 6965 -- move to using report_redirect.
	Commited so Darin can debug report_redirect.

	* components/mozilla/athena-mozilla-content-view.c:
	(view_load_location_callback), (mozilla_realize_callback),
	(mozilla_title_changed_callback), (mozilla_location_callback),
	(mozilla_net_start_callback), (mozilla_net_stop_callback),
	(mozilla_progress_callback), (mozilla_dom_mouse_click_callback),
	(vfs_open_callback), (navigate_mozilla_to_athena_uri),
	(update_athena_uri):


2001-02-27  Pavel Cisler  <pavel@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix 7116: (Location bar grows taller causing a re-layout
		   of the icon view)
	
	* src/athena-window.c: (set_dummy_initial_view_as_menu),
	(athena_window_constructed):
	Populate the "View as" menu the first time it is created with
	a dummy "View as ..." menu item to prevent it from comming up in
	a shrunken state that gets resized later and re-shuffles the window.

2001-02-26  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer <robey@eazel.com> sez "Looks
	good... Wow, I wonder how long the softcat lookup-by-feature thing
	was broken before? (doh!)"

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (something_failed):
	Moved a duplicate fprintf that caused problems to be printed
	twice.
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	Added a string sequence of features. Need this so the clients can
	print "package foo needs file libfoo.so" instead of "package foo
	needs another package".
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_string_sequence_to_glist),
	(g_list_to_corba_string_sequence),
	(corba_packagedatastruct_fill_from_packagedata),
	(corba_packagedatastruct_fill_deps),
	(packagedata_tree_from_corba_packagedatastructlist):
	Fill in and copy and convert and stuff the new features list.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), 
	Don't set force when epochs are involved, but set a majick
	datafield in the packsys object.
	(check_tree_helper), 
	After handling packagebreaks for package P, don't set P->status to
	partly resolved unless all the breaks have been fixed.
	(check_no_two_packages_has_same_file),
	Don't let force disable file conflict check, only
	ignore-file-conflicts.
	(check_conflicts_against_already_installed_packages),
	Removed the comments for bug 5720.
	(check_feature_consistency):
	Added package pointer and name to some debug output.

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(make_rpm_argument_list), 
	Check the majick epoch flag, and add --force if set.	
	(check_require_is_not_a_feature),
	Wrote a function that checks to see if a package requirement is
	also a provides of the same package.
	(eazel_package_system_rpm3_packagedata_fill_from_header):
	Use forementioned function (solves problem for badly made rpms)
	
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_get_readable_name):
	Changed to use ->features instead of ->provides
	
	* components/services/install/lib/eazel-softcat.c:
	(get_search_url_for_package):
	When querying for a feature, use ->features instead of ->provides.

2001-02-27  Ramiro Estrugo  <ramiro@eazel.com>

	* test/test-athena-label-flavorful.c:
	(increasing_label_window_new), (decreasing_label_window_new):
	Fix this so I can debug a font problem somewhere else.
	
2001-02-27  Robin * Slomkowski  <rslomkow@rslomkow.org>

	* configure.in: added rule for package-list.xml.in
	* athena-installer/package-list.xml.in: added file
	  to keep text for the installer.  This gets served by
	  the server but it is needed to provide text for the
	  installer. http://bugzilla.eazel.com/show_bug.cgi?id=3448

2001-02-27  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-icon-container.h:
	Fix incorrect class name in the GTK_CHECK_CLASS_CAST
	macro. We were using AthenaIconListView instead of
	AthenaIconContainerClass.
	
2001-02-27  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Finished bug 6950 (need new report_redirect call in addition to
	report_location_change).

	* src/athena-window-manage-views.c: (update_history): Split
	out this part of update_for_new_location, since it really was
	begging for a case statement. Added a redirect case, which does
	nothing (just like reload, but it needs a separate case to make
	sense anyway).
	(update_for_new_location): Use the new update_history.
	(report_redirect_callback): Do nothing if we are no longer at the
	"from" location of the redirect. In the case where we do redirect,
	make sure we update history properly, but don't update the back
	and forward lists at all.

	* src/athena-window-private.h:
	* src/athena-window.c: (remove_from_history_list): New function
	shared by the normal add case and the new remove call.
	(add_to_history_list): New name for athena_add_to_history_list
	to help emphasize it's a private function. Change to use
	remove_from_history_list.
	(athena_remove_from_history_list_no_notify): New call for use by
	the redirect code.
	(real_add_current_location_to_history_list),
	(athena_window_add_current_location_to_history_list): Moved
	these functions down to avoid adding a prototype for
	add_to_history_list.

2001-02-27  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fixed 6959: (Drag local items into Trash -> "You cannot copy items
		    into the Trash" error)

	* libathena-extensions/athena-drag.c:
	(athena_drag_default_drop_action_for_icons):
	Add a missing setup of the correct default and non-default drag&drop
	action when the target is "trash:".

2001-02-27  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7096 ("Open with Other" dialog doesn't truncate
	really long file names)

	Fixed bug 7108 (icon in sidebar vanishes & reappears at load time)

	* libathena-extensions/athena-program-chooser.c:
	(get_file_name_for_display): New function, returns a truncated
	copy of the file name.
	(program_file_pair_get_long_status_text),
	(run_program_configurator_callback),
	(athena_program_chooser_new),
	(athena_program_chooser_show_no_choices_message):
	Use truncated file name whenever file name is displayed.
	
	* src/athena-sidebar-title.c: 
	Added "determined_icon" boolean to Details struct.
	(athena_sidebar_title_set_file): set determined_icon to
	FALSE when new file comes along.
	(update_icon): set determined_icon to TRUE when any non-NULL
	pixbuf is determined for this file. Only check
	athena_icon_factory_icon_is_ready_for_file () if 
	determined_icon is FALSE, to avoid the icon vanishing
	temporarily because someone invalidated some AthenaFile
	attributes.

2001-02-27  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Did most of the work for bug 5779, separating out the Eazel logos
	so they won't be used by non-Eazel folks making changes to
	Athena if they choose to do "non-approved" changes (allowed by
	GPL of course).
	
	* athena.spec.in: Add new logos.
	* configure.in: Add eazel-logos and eazel-logos/throbber.
	* Makefile.am: Add the eazel-logos subdirectory.
	* eazel-logos/Makefile.am: Created.
	* eazel-logos/throbber/Makefile.am: Created.
	
	* components/services/athena-dependent-shared/icons/eazel-logo-right-side-logo.png:
	* icons/About_Image.png:
	* icons/about_background.png:
	* icons/default.xml:
	* icons/druid_header.png:
	* icons/throbber/001.png:
	* icons/throbber/002.png:
	* icons/throbber/003.png:
	* icons/throbber/004.png:
	* icons/throbber/005.png:
	* icons/throbber/006.png:
	* icons/throbber/007.png:
	* icons/throbber/008.png:
	* icons/throbber/009.png:
	* icons/throbber/010.png:
	* icons/throbber/011.png:
	* icons/throbber/012.png:
	* icons/throbber/013.png:
	* icons/throbber/014.png:
	* icons/throbber/015.png:
	* icons/throbber/016.png:
	* icons/throbber/017.png:
	* icons/throbber/018.png:
	* icons/throbber/019.png:
	* icons/throbber/020.png:
	* icons/throbber/021.png:
	* icons/throbber/022.png:
	* icons/throbber/023.png:
	* icons/throbber/024.png:
	* icons/throbber/025.png:
	* icons/throbber/026.png:
	* icons/throbber/027.png:
	* icons/throbber/028.png:
	* icons/throbber/029.png:
	* icons/throbber/030.png:
	* icons/throbber/Makefile.am:
	* icons/throbber/rest.png:
	Updated with non-logo versions.

	Did 90% of the work for bug 6950 (need new report_redirect call in
	addition to report_location_change). While working on that, I also
	moved the deferral of outgoing calls that is done in the Mozilla
	component so that it is done by the AthenaView class instead.

	* libathena/athena-view-component.idl: Added report_redirect.
	* libathena/athena-view.h: Added report_redirect.
	* libathena/athena-view.c: (queue_outgoing_call): Added
	queing for the outgoing side.
	(athena_view_initialize): Allocate queue.
	(athena_view_destroy): Deallocate queue.
	(str_list_copy): Utility needed here because we can't use
	libathena-extensions.
	(list_free_deep_callback): New. Used in queuing code.
	(free_location_plus_callback): New. Used in queueing code.
	(call_open_location_in_this_window),
	(call_open_location_prefer_existing_window),
	(call_open_location_force_new_window),
	(call_report_location_change), (call_report_redirect),
	(call_report_selection_change), (call_report_status),
	(call_report_load_underway), (call_report_load_progress),
	(call_report_load_complete), (call_report_load_failed),
	(call_set_title), (call_go_back): Functions that get queued.
	These have the bulk of the code to do work.
	(athena_view_open_location_in_this_window),
	(athena_view_open_location_prefer_existing_window),
	(athena_view_open_location_force_new_window),
	(athena_view_report_location_change),
	(athena_view_report_redirect),
	(athena_view_report_selection_change),
	(athena_view_report_status),
	(athena_view_report_load_underway),
	(athena_view_report_load_progress),
	(athena_view_report_load_complete),
	(athena_view_report_load_failed), (athena_view_set_title),
	(athena_view_go_back): These functions now simply queue the work
	that needs to be done.
	
	* src/athena-view-frame-corba.c: (free_location_plus_callback):
	Add a new field for the "from_location" needed for redirect.
	(report_redirect): The actual function to do the work.
	(impl_Athena_ViewFrame_report_redirect): Queue function.
	* src/athena-view-frame.h:
	* src/athena-view-frame-private.h:
	* src/athena-view-frame.c:
	(athena_view_frame_initialize_class): Create report_redirect
	signal.
	(athena_view_frame_report_redirect): Emit the signal.
	* src/athena-window-manage-views.c: (report_redirect_callback):
	Code to implement the redirect. For now this does the exact same
	thing as report_location_change. This is where all the remaining
	work to fix the bug goes.

	* components/mozilla/athena-mozilla-content-view.c:
	(view_load_location_callback), (mozilla_title_changed_callback),
	(mozilla_net_start_callback), (mozilla_net_stop_callback),
	(mozilla_link_message_callback), (mozilla_progress_callback),
	(mozilla_dom_mouse_click_callback),
	(navigate_mozilla_to_athena_uri), (update_athena_uri),
	(eazel_services_scheme_from_http): Remove the "async" calls that
	defer calls until timeout time now that AthenaView itself does
	that for all components.

	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-extensions.c:
	(athena_gtk_marshal_NONE__POINTER_POINTER_POINTER_POINTER):
	Added new marshal function needed for report_redirect.
	
	Other changes.
	
	* THANKS: Add some more contributors, after running the script
	to detect new ChangeLog entries.
	
2001-02-27  John Harper  <jsh@eazel.com>

	* cut-n-paste-code/widgets/e-paned/README.changes: updated this
	file to list previous changes to e-paned, as well as the fix I
	just made

2001-02-27  John Harper  <jsh@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 6294 (Sidebar gets smaller each time you open a new
	Window) and probably 6499 (Sidebar grows each time a window is
	opened):

	* cut-n-paste-code/widgets/e-paned/e-paned.c
	(e_paned_compute_position): fixed a bug in when it stores the
	last allocation of the widget. This in turn causes the widget
	not to do the annoying scaled resizing if the position of the
	splitter was set before the first size_allocate invocation

	* cut-n-paste-code/widgets/e-paned/README.changes: added this
	file describing the changes I had to make to the widget

	I'm also going to submit this patch to the gal maintainers

2001-02-27  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 7019, emblem names are not aligned vertically in
	show properties or the property browser.  Fixed by adding
	a "fixed image height" attribute to athena-labeled-image, and
	set it in the properties window and properties browser.
	
	* libathena-extensions/athena-labeled-image.c:
	(athena_labeled_image_initialize), (is_fixed_height),
	(labeled_image_get_image_dimensions),
	(athena_labeled_image_get_image_bounds),
	(athena_labeled_image_get_show_image),
	(athena_labeled_image_set_fixed_image_height):
	added a fixed_image_height instance variable, and used it
	when appropriate
	* libathena-extensions/athena-labeled-image.h:
	added setter for the fixed image height attribute
	
	* src/file-manager/fm-properties-window.c: (create_emblems_page):
	set the fixed image height attribute on the emblems
	* src/athena-property-browser.c:
	(make_properties_from_directories),
	(property_browser_category_button_new):
	set the fixed image height attribute for the emblems and also
	the category buttons
	
	fixed bug 7022, users are confused by the "shared" and "secret"
	emblems; fixed by removing them.

	* data/browser.xml:
	removed secret and shared emblem references
	* data/emblems/Makefile.am:
	removed the emblem .pngs from the makefile
	* data/emblems/secret.png:
	* data/emblems/shared.png:
	removed the emblem .pngs
	* icons/Makefile.am:
	removed the emblem .svgs from the makefile
	* icons/emblem-secret.svg:
	* icons/emblem-shared.svg:
	removed the .svgs

2001-02-27  Robin * Slomkowski  <rslomkow@rslomkow.org>

	* athena.spec.in: bug 7106, updated mozilla to
		            require to 0.8 version or higher.  and
			    added conflicts for old M releases

2001-02-27  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 7086 (Hitting cntl - F will switch to search, then
	back to location bar.):

	* src/athena-window.c (ui_idle_handler,
	nautilu_window_ui_update): set the updating_bonobo_state flag
	in the window details structure while sync'ing the UI

2001-02-27  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 6725 (Crash on Refresh if viewed file/folder is deleted
	outside of Athena):

	* src/athena-window-manage-views.c: (free_location_change):
	Reorder so we cancel the callbacks before more I/O has the chance
	to happen.
	* libathena-extensions/athena-directory-async.c:
	(athena_directory_async_state_changed): Don't do any I/O for a
	AthenaDirectory object once it's destroyed. Unfortunately, it's
	still possible for destroying one AthenaDirectory object to
	cause I/O to happen on another, so this doesn't fix the bug (which
	is why we also need the change above).

	Fixed bug 7080 (Athena build failure on Red Hat 7.)

	* libathena-extensions/athena-medusa-support.c: Fixed the bad
	#endif with non-comment text after it.

	Worked on bug 6928 (create fallback mechanism so eazel-logos
	version of each graphic is found if present). We still need a
	separate fallback mechanism for the theme XML file, since the
	throbber has a different number of frames.

	* libathena-extensions/athena-file-utilities.c:
	(athena_get_pixmap_directory): Simplify.
	(athena_pixmap_file): Look in eazel-logos directory first, so we
	will pick up logo graphics if there, and non-logo graphics otherwise.
	* test/test-athena-image-simple.c: (main): Remove a reference to
	a logo graphic.

	* eazel-logos/.cvsignore:
	* eazel-logos/About_Image.png:
	* eazel-logos/about_background.png:
	* eazel-logos/druid_header.png:
	* eazel-logos/eazel-logo-right-side-logo.png:
	* eazel-logos/throbber/.cvsignore:
	* eazel-logos/throbber/001.png:
	* eazel-logos/throbber/002.png:
	* eazel-logos/throbber/003.png:
	* eazel-logos/throbber/004.png:
	* eazel-logos/throbber/005.png:
	* eazel-logos/throbber/006.png:
	* eazel-logos/throbber/007.png:
	* eazel-logos/throbber/008.png:
	* eazel-logos/throbber/009.png:
	* eazel-logos/throbber/010.png:
	* eazel-logos/throbber/011.png:
	* eazel-logos/throbber/012.png:
	* eazel-logos/throbber/013.png:
	* eazel-logos/throbber/014.png:
	* eazel-logos/throbber/015.png:
	* eazel-logos/throbber/rest.png:
	* eazel-logos/default.xml:
	Added a new directory with copies of all graphics with the Eazel
	logo in them. Next we have to make this directory actually build
	and install these logos. Then Non-Eazel-logo'd graphics suitable
	for GPL will replace the original copies and these will keep the
	Eazel logo versions. The directory also contains the XML file for
	the default theme, since we need to change the throbber frames for
	the logo vs. non-logo version of the throbber.
	
	* components/services/athena-dependent-shared/icons/Makefile.am:
	* components/services/athena-dependent-shared/icons/eazel-cloud-logo.png:
	* components/services/athena-dependent-shared/icons/eazel-services-logo.png:
	* components/services/athena-dependent-shared/icons/service-summary-logo-top.png:
	* components/services/athena-dependent-shared/icons/startup-logo.png:
	* icons/Makefile.am:
	* icons/eazel-logo.gif:
	* icons/athena-logo.png:
	Removed unused graphics with the Eazel logo in them. There are a
	lot more unused graphics and someone should go through and remove
	them. I'm thinking of writing a script to do it.
	
	Other changes.

	* components/services/install/athena-view/.cvsignore:
	* components/services/vault/.cvsignore:
	* components/services/vault/command-line/.cvsignore:
	* data/top/.cvsignore:
	Re-removed .cvsignore files for empty directories.

	* THANKS: Corrected one email address.
	* check-THANKS.pl: Updated for the latest ChangeLog typos.
	
2001-02-27  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 7068 (Icon View lags behind changes to
	Icon Captions window)

	The correct behavior depended on the order in which
	preferences callbacks were processed, which is not
	something upon which one should rely.

	* src/file-manager/fm-icon-text-window.h:
	* src/file-manager/fm-icon-text-window.c:
	(icon_captions_changed_callback): Removed this function.
	(fm_get_text_attribute_names_preference): Changed name
	from fm_get_text_attribute_names_preference_or_default;
	now reads preference as well as returning latest well-formed
	version of preference (formerly the preference-reading code
	and preference-returning code were separated, with tragic
	consequences).
	(synch_menus_with_preference): Updated for name change.

	* src/file-manager/fm-icon-view.c:
	(fm_icon_view_get_icon_text_attribute_names): Updated
	for name change.

2001-02-27  Eric Fischer <eric@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* athena.spec.in:
	Fix mozilla dependency to want version >= 0.7 instead of
	exactly 0.7.

2001-02-27  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Seth Nickell  <snickell@stanford.edu>

	Fix bug 7012 - Space underneath some text lines shrunk.  This was
	an unfortunate regression due to smooth text rendering
	optimizations.
	
	* libathena-extensions/athena-icon-canvas-item.c:
	(draw_or_measure_label_text_aa): Restore the 2 pixel line spacing
	in icon text.

	* src/athena-sidebar-title.c:
	(athena_sidebar_title_initialize): Add a 2 pixel line spacing
	offset between label widgets in the sidebar title.
	
2001-02-27  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fix bug 7001 - CRITICAL received when dragging icons to sidebar
	icon.  The problem was that the AthenaLabel text with a drop
	shadow offset (such that 2 labels draw) was being clipped as one
	single text layout.  So, some parts of the code assumed that the
	whole content area (the union of the 2 text layouts) was available
	for drawing and thus bad dimenstions were fed to the smooth text
	layout drawing functsions.

	* libathena-extensions/athena-smooth-text-layout.h:
	* libathena-extensions/athena-smooth-text-layout.c:
	(athena_smooth_text_layout_draw_to_pixbuf),
	(athena_smooth_text_layout_draw_to_pixbuf_shadow): New function
	to draw the layout text with a shadow.
	
	* libathena-extensions/athena-label.c:
	(athena_label_size_request), (label_paint_pixbuf_callback): Pass
	in the dirty area instead of the event.  Do this to make it clear
	that the only thing we care about in this function is the dirty
	area and no other event attributes.
	change that I happened to make while fixing the bug.
	(label_composite_text_callback)
	(label_composite_text_and_shadow_callback): Factor out the code to
	draw text and "text and shadow" into 2 callbacks.  
	(label_composite_text_callback_cached): Factor out the code to
	draw the cached label (for the solid background case)
	(label_paint) (paint_label_smooth): Split up the expose event code
	into 2 pieces to make it easier to grok.
	(athena_label_expose_event): Split out the code from here into
	two functions.
	(label_get_text_dimensions): Return only the text dimensions
	without the drop shadow text offset.  (label_get_text_bounds):
	Return the bounds only for the text.
	(label_get_content_dimensions):  New function to get the full
	content dimension.  (label_get_content_bounds): New function to
	get the content bounds; the content bounds is the union of the
	text and drop shadow text bounds.

2001-02-27  Dan Mueth  <dan@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>

	Bug #6908: Activating ScrollKeeper dependency and
	update of database upon installation

	* athena.spec.in:

2001-02-27  Dan Mueth  <dan@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Purpose: fix tinderbox death

	Commenting out scrollkeeper stuff until we get scrollkeeper
	> 0.1.0 on tinderbox.
	* athena.spec.in:

2001-02-26  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Rebecca Schulman <rebecka@eazel.com>

	Fix bug 7051 (Login dialog mis-capitalizes "Services")

	* components/services/summary/athena-summary-dialogs.c
	(athena_summary_show_login_dialog): Change "Eazel services" to
	"Eazel Services".

	* components/services/trilobite/helper/eazel-helper.c: *
	configure.in: * athena-installer/src/installer.c:
	(eazel_installer_setup_texts), (eazel_install_get_depends): *
	athena.spec.in: Fixed other references I found to "Eazel
	services" by grepping,

2001-02-27  Mike Fleming  <mfleming@eazel.com>

	reviewed by: Eskil Olsen <eskil@eazel.com>

	Bug 7008: Navigation to anchors inside a document opened through
	gnome-vfs does not work.

	Fixed by manually navigating to anchors inside those documents.

	Note that this means anchor links only work inside the same document;
	external anchor links to gnome-vfs pages still do not work.

	* components/mozilla/mozilla-events.cpp:
	* components/mozilla/mozilla-events.h:
	* components/mozilla/athena-mozilla-content-view.c:
	(mozilla_dom_mouse_click_callback)

2001-02-26  Mike Fleming  <mfleming@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>
	
	Bug 6958: Calling gtk_moz_embed_open_stream before control has realized
	will eventually cause crash, so all opens are postponed until after the
	stream has realized.

	Also changed "reload" code to eliminate case where the component and
	mozilla could get out of sync

	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize),
	(mozilla_realize_callback), (mozilla_dom_mouse_click_callback),
	(vfs_open_callback), (navigate_mozilla_to_athena_uri):

2001-02-26  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: upped version to 0.8.3 for development

2001-02-26  Robin * Slomkowski  <rslomkow@eazel.com>

	* configure.in: upped version to 0.8.2 for release

2001-02-26  John Harper  <jsh@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 7073 (Alt-vs-Control, Sawfish-vs-Athena, arrow key
	bindings problems.) - I also changed sawfish to use control by
	default again.

	* libathena-extensions/athena-list.c
	(athena_list_keyboard_move_to, athena_list_keyboard_space):
	changed GDK_CONTROL_MASK to GDK_MOD1_MASK to be consistent with
	the icon container

2001-02-26  John Harper  <jsh@eazel.com>

	* components/services/install/athena-view/.cvsignore: 
	* components/services/vault/.cvsignore: 
	* components/services/vault/command-line/.cvsignore: 
	* data/top/.cvsignore: 
	* help/athena-quick-reference/C/.cvsignore: 
	* help/athena-user-manual/C/.cvsignore: 
	* help/athena-user-manual/es/.cvsignore: 
	* helper-utilities/xml-migrate/.cvsignore:

	Added and updated .cvsignore files to shut up cvs update

2001-02-26  Eric Fischer <eric@eazel.com>

	reviewed by: Robin Slomkoswki <rslomkow@eazel.com>

	* athena.spec.in:
	Remove athena-xml-migrate.1 from list of files to include
	in RPM, because it's breaking the build and I'm too brain-dead
	right now to figure out what I did wrong.

2001-02-26  Eric Fischer <eric@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* athena-installer/src/installer.c: (eazel_install_progress),
	(eazel_install_preflight):
	Fix printf() format specifiers for installer->total_mb so
	gcc -Wall will stop complaning that a long int is being
	printed with a %d specifier.

2001-02-26  John Harper  <jsh@eazel.com>

	Fixed bug 6825 (nesting indent in tree panel too large,
	requires excessive scrolling):

	* components/tree/athena-tree-view.c
	(athena_tree_view_initialize): call gtk_ctree_set_indent to
	set the indent size of the tree view to 12 pixels (instead of
	the default 20)

	Fixed a couple of memory leaks:

	* components/tree/athena-tree-view.c
	(athena_tree_view_destroy): remember to free the
	unparented_tree_nodes list
	* components/tree/athena-tree-model.c
	(athena_tree_model_destroy, remove_all_nodes): remember to
	free the unparented_nodes list

	Try to find more information about bug 7018:

	* components/tree/athena-tree-view.c,
	components/tree/athena-tree-model.c,
	components/tree/athena-tree-node.c: added a lot of error
	checking (i.e. g_return_if_fail, etc)

2001-02-26  Dan Mueth  <dan@eazel.com>

	reviewed by: Eric Fischer <eric@eazel.com>

	Added a timestamp file so that OMF files only get
	built at build time and not at install time.
	* help/docs.make: 
	* help/htmldocs.make:

	Added explicit dependency on ScrollKeeper and added
	"make -k ; make test" in place of "make -k test".
	* athena.spec.in:

2001-02-26  Andy Hertzfeld  <andy@eazel.com>

	* data/linksets/home.xml:
	fixed bug 7067, on clean install, services icon is missing. Arlo
	recently removed the old services hand icon, but didn't update
	the image reference in the linkset; fixed by updating it.
	
2001-02-26  Ramiro Estrugo  <ramiro@eazel.com>

	* helper-utilities/xml-migrate/.cvsignore:
	Ignore generated files.

2001-02-26  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	* libathena-extensions/athena-gdk-font-extensions.c:
	(athena_gdk_font_get_italic), (bold_font_table_free_one_node),
	(bold_font_table_free), (athena_gdk_font_get_bold),
	(font_bitmap_get_by_size), (athena_gdk_font_get_larger),
	(athena_gdk_font_get_largest_fitting), (font_get_bold),
	(font_list_fonts), (font_list_table_free_one_node),
	(font_list_table_free), (font_list_fonts_cached), (font_get_name),
	(font_get_size_in_pixels),
	(xlfd_string_could_be_scalable_non_bitmap):
	Rename some private files (remove the athena_ prefix) to make it
	clear they are not public.
	Add caching of the expensive list_fonts () call.  Also cache the
	results of get_bold_font ().
	Always return a valid font for get_bold_font() even if a bold font
	is not found.
	
2001-02-26  Arlo Rose  <arlo@eazel.com>

	* icons/arlo/Makefile.am:
	* icons/arlo/i-directory-12-aa.png:
	* icons/arlo/i-directory-12.png:
	* icons/arlo/i-directory-192.png:
	* icons/arlo/i-directory-20-aa.png:
	* icons/arlo/i-directory-20.png:
	* icons/arlo/i-directory-24-aa.png:
	* icons/arlo/i-directory-24.png:
	* icons/arlo/i-directory-36-aa.png:
	* icons/arlo/i-directory-36.png:
	* icons/arlo/i-directory-96.png:
	* icons/arlo/i-directory.xml:
	* icons/crux_eggplant/Makefile.am:
	* icons/crux_eggplant/i-directory-12-aa.png:
	* icons/crux_eggplant/i-directory-12.png:
	* icons/crux_eggplant/i-directory-192.png:
	* icons/crux_eggplant/i-directory-20-aa.png:
	* icons/crux_eggplant/i-directory-20.png:
	* icons/crux_eggplant/i-directory-24-aa.png:
	* icons/crux_eggplant/i-directory-24.png:
	* icons/crux_eggplant/i-directory-36-aa.png:
	* icons/crux_eggplant/i-directory-36.png:
	* icons/crux_eggplant/i-directory-96.png:
	* icons/crux_eggplant/i-directory.xml:
	Lots of folder stuff...

2001-02-26  J Shane Culpepper  <pepper@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* README:
	Reflecting the need for minimum Mozilla version of 0.8

	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize),
	(mozilla_new_window_callback):

	Fixed spelling of Javascript to JavaScript.  Removed the
	js_status callback because it was only added for debugging
	and Ramiro found a bug in it.  Finish bug #6885.


	* configure.in: Athena mozilla component now requires
	0.8.  Fix for bug #7042.

2001-02-26  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7023 (Multi-window mode opens second instance of same
	window.)

	* src/athena-window-manage-views.c:
	(open_location_prefer_existing_window_callback): For windows that
	are changing locations, we want to reuse them if the pending
	location is the one we are trying to open.

2001-02-26  John Harper  <jsh@eazel.com>

	reviewed by: Michael Engber <engber@eazel.com>

	Fixed bug 6898 (Tree view initialization may be slower than in
	PR3). Instead of instantiating and destroying Athena_Metafile
	bonobo objects each time metadata is queried, cache an object
	for each directory:

	* libathena-extensions/athena-directory-metafile.c
	(corba_object_is_local, corba_object_get_servant): new
	functions. These are ORBit dependent hacks

	(get_metafile): cache the Athena_Metafile object in the
	AthenaDirectory. Use the above ORBit hacks to break the
	circular reference when both client and servant are in the same
	process (the servant has always referenced the directory,
	caching the metafile in the directory introduces the cycle)

	* libathena-extensions/athena-directory-private.h
	(AthenaDirectoryDetails): added field metafile_corba_object

	* libathena-extensions/athena-directory.c
	(athena_directory_destroy): unref the cached
	Athena_Metafile object if its non-nil

	* libathena-extensions/athena-metafile.c,
	libathena-extensions/athena-metafile.h
	(AthenaMetafileDetails): temporarily moved to
	athena-metafile.h

	* libathena-extensions/athena-metafile.c (destroy): only
	unref the metafile's AthenaDirectory if the
	directory_ref_is_gone flag isn't set (set by the get_metafile
	method of athena-directory-metafile.c when it breaks the
	cycle)

2001-02-26  John Harper  <jsh@eazel.com>

	reviewed by Darin Adler <darin@eazel.com>

	Moved much of the BonoboUI overhead to the idle handler. This
	should decrease latency when opening new windows.

	* src/athena-window-private.h: added fields to
	AthenaWindowDetails structure: ui_change_depth, ui_idle_id,
	ui_is_frozen, ui_pending_menu_initialize

	* src/athena-window.c, src/athena-window.h
	(athena_window_ui_freeze, athena_window_ui_thaw): new
	functions. Used to intelligently freeze and thaw the
	BonoboUIEngine associated with the window's container. The
	thawing (and thus the updating) is done in an idle handler

	(athena_window_ui_update): used to defeat the UI deferral,
	and update immediately

	(athena_window_constructed): moved part of the menu bar
	initialization to the idle handler

	* src/athena-window-manage-views.c,
	src/athena-window-menus.c, src/athena-window-toolbar.c,
	src/athena-window.c: call athena_window_ui_freeze before
	doing any UI changes, and athena_window_ui_thaw afterwards

	* src/athena-window-menus.c
	(athena_window_initialize_menus): split into two functions:
	athena_window_initialize_menus_part_1 and _part_2. Part two
	populates the `Go' and `Bookmarks' menus (and is deferred until
	the idle loop)

2001-02-26  Eric Fischer <eric@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com> (code)
	reviewed by: Robin Slomkowski <rslomkow@eazel.com> (Makefile, etc.)

	Fix bug 6197 (write script to convert metafiles and links to
	ower-case XML):

	* configure.in:
	Add helper-utilities/xml-migrate/Makefile to the list of files to
	be created.

	* helper-utilities/Makefile.am:
	Add xml-migrate to the list of subdirectories to be built.

	* helper-utilities/xml-migrate/Makefile.am:
	New Makefile: compile athena-xml-migrate and install its manpage.

	* helper-utilities/xml-migrate/xml-migrate.c:
	New program: searches a directory for the old uppercase XML files
	and turns them into lowercase ones.

	* helper-utilities/xml-migrate/athena-xml-migrate.1:
	New manpage: for the aforementioned program.

	* athena.spec.in:
	Include athena-xml-migrate and its manpage in the RPMs.

2001-02-26  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-directory-async.c:
	(activation_uri_done):
	activation_uri_done (athena-directory-async.c) was not
	calling athena_file_changed - bug 7044.

2001-02-26  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 7023 (Multi-window mode opens second instance of same
	window.)

	* src/athena-window-manage-views.c:
	(open_location_prefer_existing_window_callback): For windows that
	are changing locations, we want to reuse them if the pending
	location is the one we are trying to open.

2001-02-26  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 5812 (Some preferences widgets don't display correct
	values when Preferences dialog first displayed at Beginner level)

	The bug here was that all the widgets only had their state set
	when they were created. They are created when the Preferences
	dialog is first shown, even for the preferences that aren't
	displayed at this user level. So changing the user level to a
	higher one where there preference now appears but has a different
	value would leave the widget displaying the "hidden" value instead
	of the correct value. Fixed by making the code that updates the
	visibility also update the displayed values.

	* libathena-extensions/athena-preferences-item.h:
	Public prototype for athena_preferences_item_update_displayed_value.

	* libathena-extensions/athena-preferences-item.c:
	Added change_signal_ID to Details struct.
	
	(preferences_item_construct): Store the item type in the
	Details. Surprisingly, this wasn't being done before. Also,
	call athena_preferences_item_update_displayed_value after
	creating the item.

	(preferences_item_update_enum),
	(preferences_item_create_enum),
	(preferences_item_update_short_enum),
	(preferences_item_create_short_enum),
	(preferences_item_update_boolean),
	(preferences_item_create_boolean),
	(preferences_item_update_editable_string),
	(preferences_item_create_editable_string),
	(preferences_item_update_integer),
	(preferences_item_create_integer),
	(preferences_item_update_font_family),
	(preferences_item_create_font_family),
	(preferences_item_update_theme), 
	(preferences_item_create_theme): Extract the code that sets
	the displayed widget value from _create_ to new function
	_update_. It's now called at the end of preferences_item_construct
	instead of in each _create_ function. Also, store the ID for each
	signal handler that monitors widget changes in Details.
	
	(athena_preferences_item_update_displayed_value): Call appropriate
	update function for item type. Block "change" signal handler while
	updating widgetry to avoid redundant preference changed notices.

	* libathena-extensions/athena-preferences-group.c:
	(athena_preferences_group_update): Call
	athena_preferences_item_update_displayed_value


	Other changes:
	
	* src/athena-shell-ui.xml: Return of the ellipsis in "About Athena...",
	by popular demand.

2001-02-26  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Laszlo Kovacs  <laszlo.kovacs@sun.com>

	* components/help/hyperbola-filefmt.c:
	(fmt_scrollkeeper_tree_empty):
	Fix missing braces that hid a bug which 
	was exposed by the "may be used uninitialized"
	error in C.  

2001-02-26  Laszlo Kovacs  <laszlo.kovacs@sun.com>

	reviewed by Ramiro Estrugo

	* components/help/hyperbola-filefmt.c:
	fixed bug 7030
	I added the fallback to the English (C) tree in the
	sidebar if the current locale tree is empty. This is 
	only about tree fallback, not document fallback, ie 
	the docs will not individually fallback to English 
	(this has to be implemented later on after Athena
	1.0).

2001-02-26  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-property-browser.c: (add_reset_property):
	fixed bug 7021, reset in colors pane messed up, by adding a call
	to turn the raw pixbuf into a property chit.
	
2001-02-26  Ramiro Estrugo  <ramiro@eazel.com>

	* .cvsignore:
	* help/athena-user-manual/es/.cvsignore:
	* omf-install/.cvsignore:
	* test/.cvsignore:
	* user-guide/C/.cvsignore:
	Ignore generated files.
	
2001-02-26  Eskil Heyn Olsen  <eskil@eazel.com>

	sleepy reviewer: Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(check_no_two_packages_has_same_file), (install_packages):
	when adding extrapackges to main packageslist, check that we're
	not adding duplicates.
	
	* components/services/install/lib/eazel-package-system-types.c:
	(eazel_install_package_compare):
	remopved debug outpu

2001-02-26  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>

	* components/services/install-view/callbacks.c:
	(athena_service_install_preflight_check):
	* components/services/install-view/forms.c: (add_padding_to_box),
	(generate_install_form), (make_query_box):
	* components/services/install-view/athena-service-install-view.c:
	* components/services/install-view/athena-service-install-view.h:

	Put the preflight query into a pane so it can be made scrollable
	if the list of packages gets too long.
	
	* athena-installer/src/installer.c: (eazel_install_progress),
	(eazel_download_progress), (install_failed),
	(eazel_install_preflight):
	* athena-installer/src/installer.h:

	Fix the progress bars to make sense.  The fact that they even
	looked like they were 90% working before is just a bizarre
	coincidence.

2001-02-26  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 7009, view as pkg lists inaccurate rpm filesize.
	
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize): Changed Size to Installed Size to
	more accurately reflect the information we are attempting to
	convey.

2001-02-26  Dan Mueth  <dan@eazel.com>

	reviewed by: Tux

	Fixing bug: 6983 by changing "help:athena" to
	"help:athena-user-manual".

	* src/athena-window-menus.c:

2001-02-25  Eskil Heyn Olsen  <eskil@eazel.com>

	glanced at by: Ian McKellar  <ian@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_download_progress_signal),
	(eazel_install_progress_signal):
	Fixed bug 6985, no mo're \r's in the translated strings
	Fixed bug 7003
	
	* components/services/install/lib/eazel-install-logic2.c:
	(check_tree_helper),

	(check_no_two_packages_has_same_file),
	indent fixed
	Nicer output in the non-debug output mode (use readable packagename)
	Removed call to add_file_conflict untill SoftCat db is rebuild.
	
	(check_conflicts_against_already_installed_packages),
	Test for file existance, if present, do the proper check.
	Nicer output in the non-debug ouptut mode (use readable packagename)

	(check_feature_consistency), 
	Set a integer datafield to not recheck consistency for packages
	when doing a revive cycle.
	Added check to avoid noting certain updates as breaks.
	Added check to avoid renoting revived breaks (fixes bug 6811)

	(do_file_conflict_check),
	Call check_tree_for_conflicts after feature_consistency_check to
	revive FeatureBreaks (fixes bug 6811)
	
	(eazel_uninstall_globber):
	Removed a c++ commented out debug call.

	Also added I18N tags to all g_message output and revamped some
	output to be more translator friendly. Ensured that debugless
	output still makes sense.

	Fixed a bug in uninstall where it would report too many packages.

	Removed add_to_breaks_if_new, replaced it with the "normal"
	g_list_find_custom call.
	
	* components/services/install/lib/eazel-package-system-types.h:
	Changed packagedata->obsolotes into a GList *

	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_finalize), (packagedata_copy),
	(packagedata_fill_in_missing), (packagedata_get_readable_name),
	(eazel_install_package_compare), (packagedata_dump_int):
	treat packagedata->obsolotes as a GList* and not a char*.

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header):
	Correctly read the RPMTAG_OBSOLETES and put into the packagedata object.
	
2001-02-26  Arik Devens  <arik@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com

	Partial fix for bug 5701, Icon stretching is slow and
	CPU-intensive.
		
	* libathena-extensions/athena-icon-container.c:
	(update_stretch_at_idle), (continue_stretching): Moved the
	stretching code to an idle handler to speed it up and remove
	blocking.  
	* libathena-extensions/athena-icon-private.h: Added three new
	members to the IconContainerDetails struct for the idle handler.

2001-02-26  Dan Mueth  <dan@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* help/docs.make: Small fix.  Won't take effect until
	athena.spec.in stops explicitly setting $prefix to
	hold RPM_BUILD_ROOT.  When that is fixed, this will
	allow OMF files to hold the correct path to the docs.
	* athena.spec.in: Removed a line referring to an image
	which Arlo removed earlier.

2001-02-26  Arlo Rose  <arlo@eazel.com>

	* icons/arlo/Makefile.am:
	* icons/arlo/i-regular-20-aa.png:
	* icons/arlo/i-regular-20.png:
	Added a 20 pixel version for the Tree view and menus.

2001-02-26  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: John Harper <jsh@eazel.com>

	Fixed bug 3898, selection in icon view extremely slow
	
	I increased the performance of drag selection of icons in a few ways.
	First, I avoid unneeded, repeated transforms of coordinates from
	world coordinates to canvas coordinates.  I also cached three freqeuently
	calculated dimensions; the icons bounds in canvas coordinates, the icons
	text bounds and canvas coordinates and the bounding rect of all emblems
	in canvas coordinates.  Instead of repeatedly calculating these values,
	have functions refer to the cached values.  In hit_test, I then do a
	quick intersection check of the drag rect with the cached values before
	proceeding to the more expensive intersection detection routines.
	
	* libathena-extensions/athena-icon-canvas-item.c:
	* libathena-extensions/athena-icon-canvas-item.h:
	(athena_icon_canvas_item_set_image), (compute_text_rectangle),
	(athena_icon_canvas_item_draw),
	(athena_icon_canvas_item_render), 
	(athena_icon_canvas_item_bounds), (get_icon_canvas_rectangle),
	Set up the various places that we need to update our cached items.

	(athena_icon_canvas_item_update_bounds):
	Update our cached values.
	
	(hit_test), (hit_test_stretch_handle):
	Perform quick interesection checks before doing more expensive checks.
	
	(athena_icon_canvas_item_hit_test_rectangle):
	Change function to use canvas coordinates. The caller is responsible
	to do the conversion form world to canvas. This provides a large
	optimization if this routine is caled in a loop.	
	
	* libathena-extensions/athena-icon-container.c:
	* libathena-extensions/athena-icon-container.h:
	(rubberband_select):
	Do transform of drag rect from world coordiantes to canvas canvas
	coordinates onlty once. There is no need to do this for every canvas
	item that is visted during list traversal.
	
	* libathena-extensions/athena-icon-dnd.c:
	(athena_icon_container_item_at):
	Call athena_icon_canvas_item_hit_test_rectangle() using coordinate
	converted to canvas coordinates.
	
Mon Feb 26 03:00:03 2001  George Lebl <jirka@5z.com>

	Gene Z. Ragan  <gzr@eazel.com> was subjected to this patch and
	survived.

	* components/help/hyperbola-nav-tree.c (set_node_style):  Also
	  set HYP_TREE_NODE_BOOK type nodes to italic, which should finally
	  completely fix #6911

2001-02-26  Arlo Rose  <arlo@eazel.com>

	* icons/crux_eggplant/crux_eggplant.xml:
	A mistake in the xml file (and ChangeLog!) oops.	


	* configure.in:
	* icons/arlo/Makefile.am:
	* icons/arlo/i-regular-12-aa.png:
	* icons/arlo/i-regular-12.png:
	* icons/arlo/i-regular-192-aa.png:
	* icons/arlo/i-regular-192.png:
	* icons/arlo/i-regular-24-aa.png:
	* icons/arlo/i-regular-24.png:
	* icons/arlo/i-regular-36-aa.png:
	* icons/arlo/i-regular-36.png:
	* icons/arlo/i-regular-72-aa.png:
	* icons/arlo/i-regular-72.png:
	* icons/arlo/i-regular-96-aa.png:
	* icons/arlo/i-regular-96.png:
	* icons/arlo/i-regular-aa.png:
	* icons/arlo/i-regular.png:
	* icons/arlo/i-regular.xml:
	Changed the design of the Crux documents to have 8.5 x 11
	aspect ratio, and removed the torn out of a sprial notebook
	visual appearance.

	I also added all the sizes that Athena needs in both 8 bit
	and 1 bit mask mode.

	* icons/crux_eggplant/Makefile.am:
	* icons/crux_eggplant/crux_eggplant.xml:
	* icons/crux_eggplant/i-regular-192-aa.png:
	* icons/crux_eggplant/i-regular-192.png:
	* icons/crux_eggplant/i-regular-72-aa.png:
	* icons/crux_eggplant/i-regular-72.png:
	* icons/crux_eggplant/i-regular-96-aa.png:
	* icons/crux_eggplant/i-regular-96.png:
	* icons/crux_eggplant/i-regular-aa.png:
	* icons/crux_eggplant/i-regular.png:
	* icons/crux_eggplant/i-regular.xml:
	Removed the throbber and the document icons out of Crux Eggplant
	and made them point to the ones in Crux teal.

2001-02-26 Dan Mueth  <dan@eazel.com>

	reviewed by: Seth Nickell  <snickell@stanford.edu>

	Updating spec file to fix breakage... mjs removed this program.

	* athena.spec.in: Removed %{prefix}/bin/eazel-vault

2001-02-25  Dan Mueth  <dan@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* po/POTFILES.in: Fixed breakage caused by mjs moving some
	files around and forgetting to update this file.

2001-02-24  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(packagedata_add_to_breaks_if_new),
	(do_requirement_consistency_check_package),
	(do_requirement_consistency_check_internal),
	(do_requirement_consistency_check), (check_tree_helper):

	Trying to make the new consistency-check stuff work, so that the
	RH62 install will succeed.  This seems to do it for me.  First,
	flatten the dep-tree before doing consistency checks, to make sure
	everything gets checked.  Second, only add a package to the breaks
	list if that package isn't already there.
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_breaks_foreach):

	Clean up one of the messages a little bit so it's less
	nonsensical.
	
	* components/services/install/lib/eazel-package-system-types.c:
	(dump_package_break_list):

	The names of these (debug messages) appeared to be reversed, which
	might have caused someone unneeded heartbreak someday.
	
	* athena-installer/src/installer.c: (eazel_install_preflight):

	If any packages failed before the preflight, give up.

2001-02-25 John Fleck <jfleck@inkstain.net>

	reviewed by: George Lebl <jirka@5z.org>

	* components/help/converters/gnome-db2html2/toc-elements.c
	adding code to toc_glossterm_start_elemen and
	toc_glossterm_end_element to set and unset boolean
	variable in_printed_title that determines whether we're in a
	printed title in the table of contents

2001-02-25  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Michael K. Fleming  <mfleming@eazel.com>

	* components/services/install/athena-view/.cvsignore:
	* components/services/install/athena-view/Makefile.am:
	* components/services/install/athena-view/Athena_View_install.oaf.in:
	* components/services/install/athena-view/callbacks.c:
	* components/services/install/athena-view/callbacks.h:
	* components/services/install/athena-view/forms.c:
	* components/services/install/athena-view/forms.h:
	* components/services/install/athena-view/main.c:
	* components/services/install/athena-view/athena-service-install-view.c:
	* components/services/install/athena-view/athena-service-install-view.h:
	* components/services/install/athena-view/athena-service-install.c:
	* components/services/install/athena-view/athena-service-install.h:
	Move it all to components/services/install-view

	* components/services/install
	/Makefile.am: Don't build athena-view subdir.

	* components/services/Makefile.am: Build insall-view subdir.
	
	* components/services/install-view/Makefile.am: Don't do evil hack
	to build inventory dir.

	* components/services/vault/.cvsignore:
	* components/services/vault/Makefile.am:
	* components/services/vault/command-line/.cvsignore:
	* components/services/vault/command-line/Makefile.am:
	* components/services/vault/command-line/main.c:
	* components/services/vault/command-line/vault-operations.c:
	* components/services/vault/command-line/vault-operations.h:
	Remove old cruft.

	* configure.in: Adjust for above changes.

2001-02-25  arik devens  <arik@eazel.com

	reviewed by: John Harper  <jsh@eazel.com>

	* src/athena-first-time-druid.c: (download_callback): Moving the
	rest of the gtk_widget_set_sensitive calls to
	gnome_druid_set_buttons_sensitive so our choices don't get
	clobered.

2001-02-25  Michael K. Fleming  <mfleming@eazel.com>

	Bug 3887: Mozilla view only recognizes first change to proxy setting.
	Oops: the wrong integer for "network.proxy.type" being "disabled" was being
	used.
 
	* components/mozilla/main.c:
	* components/mozilla/mozilla-preferences.cpp:

Sun Feb 25 17:58:57 2001  George Lebl <jirka@5z.com>

	bored by this patch: Mike Fleming  <mfleming@eazel.com>

	Fixes #6973

	* components/help/converters/gnome-db2html2/Makefile.am: define
	  GNOMELOCALEDIR

	* components/help/converters/gnome-db2html2/gdb3html.c (main):
	  do the gettext dance as jfleck so rightly pointed out

2001-02-25  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.c: 
	(set_parameters_from_command_line): Fixed bug 7000.

	* components/services/summary/athena-summary-view-private.h,
	components/services/summary/athena-summary-view.c: changed
	things to properly internationalize strings in #defines to fix bug
	6997 (Defined "More Info" message does not end up in translation).

2001-02-25  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Seth Nickell  <snickell@stanford.edu>

	Fixed bug 6822 (Need to be able to support services that run a
	program instead of launching a URI).

	* components/services/summary/athena-summary-view.c:
	(summary_view_button_callback, summary_view_update_pane,
	program_uri_for_nonexistent_program, generate_service_entry_row):
	Add support for special "command:" URIs in the summary view. If
	the program specified does not exist, leave the service out of the
	listing.

2001-02-24  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fix bug 5462 ("View as %s" and "%s Viewer" composed messages hard
	to translate) by making Athena view oafinfo files provide the
	full messages.

	* libathena-extensions/athena-view-identifier.h,
	libathena-extensions/athena-view-identifier.c:
	athena_view_identifier_new, athena_view_identifier_copy,
	athena_view_identifier_new_from_oaf_server_info,
	athena_view_identifier_free): Add `view_as_label' and
	`viewer_label' fields; determine them from either special new oaf
	attributes or compose them from `view_as_name'.

	* libathena-extensions/athena-program-chooser.c
	(program_file_pair_get_program_name_for_display): Use new
	identifier fields.
	* src/file-manager/fm-directory-view.c
	(add_component_to_bonobo_menu): Use new identifier fields.
	* src/athena-window.c (create_view_as_menu_item): Use new
	identifier fields.

	* components/hardware/Athena_View_hardware.oaf.in,
	components/image-viewer/Athena_View_image.oaf.in,
	components/loser/content/Athena_View_content-loser.oaf.in,
	components/mozilla/Athena_View_mozilla.oaf.in,
	components/music/Athena_View_music.oaf.in,
	components/rpmview/Athena_View_rpm.oaf.in,
	components/sample/Athena_View_sample.oaf.in,
	components/services/install/athena-view/Athena_View_install.oaf.in,
	components/services/inventory-view/Athena_View_inventory.oaf.in,
	components/services/login/athena-view/Athena_View_change-password.oaf.in,
	components/services/summary/Athena_View_services-summary.oaf.in,
	components/services/trilobite/sample/athena-view/Athena_View_service-sample.oaf.in,
	components/shell/Athena_View_shell.oaf.in,
	components/text/Athena_View_text.oaf.in,
	src/Athena_shell.oaf.in: Add `athena:view_as_label' and
	`athena:viewer_label' properties.

	* components/services/trilobite/libtrilobite/trilobite-file-utilities.c:
	Fix author line.

2001-02-24  Eskil Heyn Olsen  <eskil@eazel.com>

	Not reviewed, as this just contains some comments for translators.

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (delete_files):
	Added I18n comments about the (y/n) strings.

Sat Feb 24 19:50:16 2001  George Lebl <jirka@5z.com>

	Gene Z. Ragan <gzr@eazel.com> said "Groovy", so I suppose that means
	he approves of the patch.

	* components/help/hyperbola-nav-tree.c (set_node_style)
	  (ctree_populate_subnode) (reset_style_for_node) (reset_styles)
	  (hyperbola_navigation_tree_new):  Nodes of type HYP_TREE_NODE_PAGE
	  made italic to differentiate them from sections and categories,
	  fixes #6911.

	* libathena-extensions/athena-gdk-font-extensions.[ch]
	  (font_entry_has_italic_slant_test) (athena_gdk_font_get_italic):
	  Add a function for getting an italic font.  Mostly a cut and paste
	  the the _get_bold function.

2001-02-24  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: George Lebl <jirka@5z.com>

	Fixed bug 3546, Athena fails if MP3 previews in rapid succession
	
	Fixed bug 5105, Preview sound file during MP3 playback
	-> "/dev/dsp: Device or resource busy"
	
	* libathena-extensions/athena-global-preferences.h:
	Add a preference that that tracks the result of an intial
	audio output capability check during athena_sound_initialize().
	
	* libathena-extensions/athena-sound.c:
	(athena_sound_initialize):
	Check audio output capability and save the result of the check in
	a preference.
	
	(athena_sound_can_play_sound):
	Check saved preference instead of opening and closing esd as a
	way to check if sound output is available.  The constant opening
	and closing creating a latency problem withing esd and was
	affecting the audio preview mechanism.
	
2001-02-24  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Seth Nickell  <seth@eazel.com>
	
	Fixed bug 6944, "Move here"/"Copy here"/"Link here" popup
	menu is untranslated
	
	* libathena-extensions/athena-drag.c:
	Wrap text in N_ so that it will be properly
	localized.
	
	* po/ChangeLog:
	* po/POTFILES.in:
	Add libathena-extensions/athena-drag.c

Sat Feb 24 12:49:43 2001  George Lebl <jirka@5z.com>

	Gene Z. Ragan  <gzr@eazel.com> says it won't cause global warming if
	this is applied.

	* components/help/converters/gnome-db2html2/sect-elements.c
	  (sect_sect_start_element) (sect_sect_end_element)
	  (sect_legalnotice_start_element) (sect_legalnotice_end_element)
	  (sect_legalnotice_characters):
	  Use g_strcasecmp to compare "legalnotice" and section id's.  This
	  Fixes the bug where panel help would not be displayed at all.
	  Since the HTML sections have been converted to uppercase and thus
	  going back to sgml wouldn't work

2001-02-24  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* po/POTFILES.in:
	removed components/music/configure.c and
	components/music/fileinfo.c to fix tinderkill.

2001-02-24  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/services/inventory/eazel-inventory-service.c:
	(http_post_simple), (http_post_simple_ammonite),
	(impl_Trilobite_Eazel_Inventory_upload):
	Moved the HTTP/ammonite code out into separate functions.

	(impl_Trilobite_Eazel_Inventory__set_enabled):
	Implemented the delete-inventory server call.
	This relates to bug 6184.

	* components/services/inventory/eazel-inventory-utils.c:
	(get_software_inventory), (get_digest_from_gconf),
	(update_gconf_inventory_digest), (eazel_inventory_update_md5):
	Cleanups.

	(eazel_inventory_clear_md5):
	* components/services/inventory/eazel-inventory-utils.h:
	Added function to clear the md5.

2001-02-24  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Partially fixed bug 939, help URIs should display something nice
	for the "not found" case.
	Fixed bug 3112, Help URIs need design for "not found" case.
	
	* components/help/converters/gnome-info2html2/main.c:
	(file_exists), (main): Added default text to be printed out if the
	info page cannot be found.
	* components/help/converters/gnome-man2html2/gnome-man2html.c:
	(main): Added default text to be printed out if the man page
	cannot be found.

2001-02-24  Eskil Heyn Olsen  <eskil@eazel.com>

	tired reviewer was: Robey Pointer  <robey@eazel.com>

	Fixes bug 6903 6913 and 6972

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line),
	(eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal),
	(eazel_download_progress_signal):
	Marked strings for i18n.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied), (do_dep_check_internal), (do_dep_check),
	(check_if_modification_is_ok),
	(do_requirement_consistency_check_package),
	(do_requirement_consistency_check_internal),
	(do_requirement_consistency_check), (check_tree_helper),
	(check_conflicts_against_already_installed_packages),
	(do_file_conflict_check), (install_packages_helper),
	(install_packages):

	Swapped the check of a requirements features and if it's installed
	(in the case where there is no sense/version)

	Added a vast amount of logic to check if modification of packages
	(update/downgrade) breaks other packages. This also includes a
	move of a huge block of code.

	Try to revive on both FILE_CONFLICT and BREAKS_DEPENDENCY.

	Don't ignore file-conflicts on force (since we set it when epochs
	are involved)

	Do do_requirement_consistency_check before
	check_tree_for_conflicts, so we try and revive any upgrades that
	causes a BREAK_DEPENDENCY

	Large section of code moved  upwards...	

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(make_rpm_argument_list):
	Use -U for both up and downgrade.
	Load obsoletes tag.

2001-02-24  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/services/inventory-view/Makefile.am:
	* components/services/inventory-view/athena-inventory-disable-pag
	e.c: (athena_inventory_disable_page_initialize_class),
	(yes_callback), (no_callback),
	(athena_inventory_disable_page_initialize),
	(athena_inventory_disable_page_new),
	(athena_inventory_disable_page_run),
	(athena_inventory_disable_page_destroy):
	* components/services/inventory-view/athena-inventory-disable-pag
	e.h:
	* components/services/inventory-view/athena-inventory-view.c:
	(athena_inventory_view_initialize),
	(inventory_load_location_callback):
	Added inventory disable page.

	* components/services/summary/athena-summary-view.c:
	(inventory_load_callback):
	Don't pop up a dialog if the inventory upload fails.

2001-02-04  Robey Pointer  <robey@eazel.com>
	
	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>

	* athena/components/rpmview/athena-rpm-view-install.c:

	Fix Tinderbox bustage (oops).

2001-02-24  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (create_package):

	Add '--package-version' (-V) option for installing a specific
	version of a package (labs request).
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), (download_packages):
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach),
	(get_detailed_uninstall_messages_foreach),
	(get_detailed_cases_foreach),
	(get_detailed_uninstall_cases_foreach):
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_status_enum_to_str), (packagedata_status_str_to_enum):
	* components/services/install/lib/eazel-package-system-types.h:

	Add PACKSYS_FAILURE error code for reporting the ominous "failed
	to lock rpmdb" errors.
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(corba_packagedatastructlist_from_packagedata_tree),
	(packagedata_from_corba_packagedatastruct),
	(packagedata_tree_from_corba_packagedatastructlist):

	Fix corba package-tree flattening and inflating by leaving the
	toplevel field intact, and using a corba-only "anchor" field to
	mark which packages should be anchored to the top list of the
	package-tree after re-inflation.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_implementation), (osd_parse_softpkg):

	Check for the new ACTION="Unresolved" in softcat dependency
	responses, and (for now) treat packages with unresolved deps as if
	softcat didn't return that package at all.  Any packages that
	softcat doesn't have deps for are errors right now, anyway.
	
	* athena-installer/src/prescript:

	Fix the annoying "user is 8888" bug by working around a bug in
	popt and passing the --user flag with an "=" instead of a space.
	Very dumb but it works.

2001-02-24  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	Fixed bug 6924, User level strings not properly translated in
	first time druid.
	
	* libathena-extensions/athena-preferences.c:
	(athena_preferences_get_user_level_name_for_display): Added a
	gettext call to translate the N_'d user level strings.

2001-02-24  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 4567, Druid does not desensitize "next" button when
	checking the network connection.
	
	* src/athena-first-time-druid.c: (initiate_file_download):
	Changed to using gnome_druid_set_sensitive instead of
	gtk_widget_set_sensitive to stop the druid from clobering our
	sensitivity preference.

2001-02-24  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* components/rpmview/Makefile.am:
	* components/rpmview/athena-rpm-view-install.c:
	(inventory_service_callback), (athena_rpm_view_install_done):
	Added inventory hooks. Finishing bug 6186.

	* components/services/install/Makefile.am:
	* components/services/install/athena-view/Makefile.am:
	* components/services/install/athena-view/callbacks.c:
	(inventory_service_callback), (athena_service_install_done):
	Fixed an evil build problem and did some little code fixes.

2001-02-24  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 6974, the verify button is currently non functional and
	should be disabled.
	
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize),
	(athena_rpm_view_update_from_uri): Removed the widget->show code
	for the verify button because it was deemed to buggy for 1.0.

2001-02-23  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	* src/athena-window-manage-views.c (cancel_location_change):
	Remove freshly unused variable to unbreak the build.

2001-02-24  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 4853, in eazel-package-system-suggest-id ensure
	distro-to-system.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_suggest_id): Added distro to package system
	mappings for the rest of the distro's trilobyte can detect.

2001-02-23  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Eskil Olsen  <eskil@eazel.com>

	Fix bug 6856 (if you click on the services button and then on the
	stop button athena crashes)
	
	* components/services/trilobite/libtrilobite/trilobite-file-utilities.c:
	(read_file_open_callback): If we get a callback on a cancelled
	open, ignore it rather than dieing on a failed assertion.

	* src/athena-window-manage-views.c (cancel_location_change):
	Instead of avoiding telling the old view of the location change
	back if it is the same as the new view, avoid telling the new view
	ever. Either it will be told through the old view pointer or it
	the very change we want to cancel.

2001-02-24  Dan Mueth  <dan@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	Added 1.0 version of Vera's Quick Reference document.
	Note that the screenshots are not finalized, but the text
	is.  Added Spanish version of Athena User Manual.
	Updated toplevel docs, removing Session Properties, and
	adding Spanish translation of NUM. Tried to remove most of
	the annoying warnings which show up in tinderbox due to
	silly Makefile problems. Updated spec for Spanish doc.

	* components/help/topleveldocs.xml:
	* configure.in:
	* help/docs.make:
	* help/athena-quick-reference/C/figures/full_small.png:
	* help/athena-quick-reference/C/figures/navbar_small.png:
	* help/athena-quick-reference/C/index.html:
	* help/athena-user-manual/Makefile.am:
	* help/athena-user-manual/es/Makefile.am:
	* help/athena-user-manual/es/figures/custicon.png:
	* help/athena-user-manual/es/figures/full.png:
	* help/athena-user-manual/es/figures/link.png:
	* help/athena-user-manual/es/figures/locbar.png:
	* help/athena-user-manual/es/figures/noread.png:
	* help/athena-user-manual/es/figures/nowrite.png:
	* help/athena-user-manual/es/figures/part.png:
	* help/athena-user-manual/es/figures/player.png:
	* help/athena-user-manual/es/figures/prefmenu.png:
	* help/athena-user-manual/es/figures/sidebar.png:
	* help/athena-user-manual/es/figures/viewmenu.png:
	* help/athena-user-manual/es/figures/viewmusic.png:
	* help/athena-user-manual/es/athena-user-manual-es.omf:
	* help/athena-user-manual/es/athena-user-manual.sgml:
	* athena.spec.in:

2001-02-24  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* components/services/install/athena-view/Makefile.am:
	* components/services/install/athena-view/callbacks.c:
	(inventory_service_callback), (athena_service_install_done):
	* components/services/summary/Makefile.am:
	* components/services/summary/athena-summary-view.c:
	(fetch_summary_data), (inventory_load_callback),
	(redirect_fetch_callback):

	Add rpm-dependant hooks into the inventory upload from the summary view
	and the install view. This fixes bug 6186.

2001-02-24  Eskil Heyn Olsen  <eskil@eazel.com>

	review wanker: Arik The Intern

	* helper-scripts/Makefile.am:
	This should be better, hope it works

2001-02-23  Mike Fleming  <mfleming@eazel.com>

	reviewed by: Eskil Olsen  <eskil@eazel.com>

	Bug 6480: extranous history items due to redirects
	Bug 6736: (as a side-effect) "throbber cuts out early because of redirects"

	I ifdef'd out the busy cursor stuff since it seems to interact
	poorly with Mozilla 0.8.  Actually, even when I took it out, I still
	saw a busy cursor at the wrong times.

	changed many gtk_signal_connect_while_alive's to gtk_signal_connect's
	per Darin feedback

	Made some URI scheme comparisons case-insensitive, added FIXME
	on remaining one

	* components/mozilla/mozilla-events.cpp:

	mozilla_events_get_href_for_event now gets href's from AREA tags
	and form submits.
	
	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize),
	(try_transform_athena_uri_to_file_scheme),
	(view_load_location_callback), (mozilla_location_callback),
	(mozilla_net_state_callback), (mozilla_link_message_callback),
	(mozilla_dom_mouse_click_callback), (is_uri_relative),
	(make_full_uri_from_relative), (uris_identical),
	(string_list_get_index_of_string):

2001-02-23  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	Fix bug 6881 (Non-translated strings in services).

	* components/services/summary/athena-summary-view.c:
	(localize_items), (update_header), (update_footer),
	(create_footer), (summary_load_location_callback): Call gettext on
	the strings marked with N_.

	* components/services/trilobite/libtrilobite/trilobite-file-utilities.c:
	(trilobite_read_entire_file, read_file_succeeded): Realloc to
	include an extra byte at the end to make it safe to NULL-terminate
	the file contents if desired.

2001-02-23  Dan Mueth  <dan@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	Applied several build system bug fixes and updated
	spec file.

	* help/Makefile.am: Fix bug with broken rpm install: Added 
	docs.make and htmldocs.make to EXTRA_DIST
	* help/docs.make: Have omf processed for install-data-am
	* help/htmldocs.make: Have omf processed for install-data-am
	* athena.spec.in: Added post install and post uninstall
	calls to scrollkeeper-update. Added scrollkeeper as a 
	requirement, but commented out because it isn't in the
	software map.  Uncommented OMF file b/c bug fixes above
	now install the OMF files properly.

2001-02-23  John Harper  <jsh@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* src/athena-first-time-druid.c: updated the text for the
	Medusa screen in the first time druid

2001-02-23  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:

	Close dangling parentheses.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(check_tree_helper), (check_feature_consistency):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_set_debug):
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(display_arguments):

	Remove excess logging from the install, but add a final
	package-tree dump at the end for double-checking logs.
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_breaks_foreach),
	(get_detailed_messages_foreach), (get_detailed_cases_foreach):

	Fix logging of file conflict problems.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_shared):

	Don't log softcat db revision when it's not given.
	
	* athena-installer/install-lib/Makefile.am:
	* athena-installer/libtrilobite/Makefile.am:
	* athena-installer/src/Makefile.am:

	Use softlinks in the bootstrap installer fake directories, so that
	coders can edit the files and still get clean builds.
	
	* athena-installer/src/installer.c: (add_bullet_point_to_vbox),
	(eazel_install_progress), (eazel_download_progress):

	More sanity checks in the download progress, and fix up more text
	to Vera standards.

2001-02-23  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* helper-scripts/Makefile.am: Added installing of my new helper
	script to let users and testers restore their settings.

2001-02-23  John Harper  <jsh@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 6932 (Athena Crashes with 'intermittent tree view
	bug'):

	* components/tree/athena-tree-view.c
	(athena_tree_view_insert_model_node): don't call
	athena_tree_view_find_parent_node () to find the parent view
	node.

	This can fail if the model has already removed the node we're
	trying to add giving the `intermittent' assertion (since we run
	in the idle handler, asynchronously to the model).

	Instead just try to grab the parent of the node and find it's
	view node directly. If either of these don't exist, the
	usual unparented node logic will handle it

	(athena_tree_view_find_parent_node): deleted this function

2001-02-23  Arik Devens  <arik@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	Fixed bug 6797, GConf errors after updating Athena, and removing
	.gconf and .gconfd directories.
	
	* helper-scripts/athena-restore-settings-to-default.sh: Initial
	version of a script to let testers reset their preferences. The
	script shutsdown athena and gconf then removes the .athena,
	.gconf, and .gconfd directories. There are various other features
	that can be added later.

2001-02-23  Arik Devens  <arik@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com>

	Fixed bug 6847, if you delete the text in the homedir preference
	by holding down the backspace key athena freezes and eventually
	crashes.
	
	* libathena-extensions/athena-preferences-item.c:
	(text_item_changed_callback), (editable_string_changed_callback),
	(integer_changed_callback), (athena_preferences_item_get_name),
	(update_text_settings_at_idle),
	(preferences_item_update_text_settings_at_idle),
	(update_integer_settings_at_idle),
	(preferences_item_update_integer_settings_at_idle): Added using
	idle handlers to set preferences instead of setting the directly
	on changed.

	* libathena-extensions/athena-preferences.c:
	(athena_preferences_set_integer), (athena_preferences_set):
	Added checking whether the new value has changed from the current
	value before setting it.

2001-02-23  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	Ubnbrkeak the build.

	* components/services/inventory-view/athena-inventory-enable-page
	.c: (athena_inventory_enable_page_destroy):
	* components/services/inventory/eazel-inventory-upload-callback.c:
	(eazel_inventory_upload_callback_initialize_class),
	(eazel_inventory_upload_callback_initialize),
	(eazel_inventory_upload_callback_destroy),
	(eazel_inventory_upload_callback_new),
	(impl_Trilobite_Eazel_InventoryUploadCallback_done_uploading),
	(impl_Trilobite_Eazel_InventoryUploadCallback__destroy),
	(impl_Trilobite_Eazel_InventoryUploadCallback__create):
	* components/services/inventory/eazel-inventory-upload-callback.h:

2001-02-23  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	Fixed bug 6185 (Inventory collection and upload is slow, blocks UI)
	
	* components/services/inventory-view/Makefile.am,
	* components/services/inventory-view/athena-inventory-config-page.c,
	* components/services/inventory-view/athena-inventory-config-page.h:

	* components/services/inventory-view/athena-inventory-enable-page.c:
	(athena_inventory_enable_page_initialize_class,
	athena_inventory_enable_page_initialize,
	athena_inventory_enable_page_new, callback,
	athena_inventory_enable_page_run,
	athena_inventory_enable_page_destroy):

	* components/services/inventory-view/athena-inventory-enable-page.h:

	* components/services/inventory-view/athena-inventory-view.c:
	(athena_inventory_view_initialize,
	inventory_load_location_callback):

	* components/services/inventory/Makefile.am:
	* components/services/inventory/eazel-inventory-client.c:
	(callback, main):

	* components/services/inventory/eazel-inventory-collect-hardware.c:
	(eazel_inventory_collect_scsi):

	* components/services/inventory/eazel-inventory-service-interface.idl:

	* components/services/inventory/eazel-inventory-service.c:
	(impl_Trilobite_Eazel_Inventory__get_enabled,
	impl_Trilobite_Eazel_Inventory__set_enabled,
	impl_Trilobite_Eazel_Inventory__get_machine_id,
	impl_Trilobite_Eazel_Inventory_upload),
	eazel_inventory_service_get_epv):

	* libathena-extensions/athena-clickable-image.c: (label_enter),
	(athena_clickable_image_set_up_pixbufs):

2001-02-21  Maciej Stachowiak  <mjs@eazel.com>

	pair programmed with: Ian McKellar  <ian@eazel.com>
	
	* components/services/inventory-view/athena-inventory-config-page.c,
	components/services/inventory-view/athena-inventory-config-page.h:
	Removed.
	* components/services/inventory-view/athena-inventory-enable-page.h,
	components/services/inventory-view/athena-inventory-enable-page.c:
	This view will have enable and disable pages.
	* components/services/inventory-view/athena-inventory-view.c
	(athena_inventory_view_initialize,
	inventory_load_location_callback): Now there are enable and
	disable pages (the latter not yet implemented), no config page.
	* components/services/inventory-view/Makefile.am: Add new files,
	remove old files.

	* components/services/inventory/eazel-inventory-client.c (main):
	Adjust to new changes.

	* components/services/inventory/eazel-inventory-collect-hardware.c
	(eazel_inventory_collect_scsi): Fix for non-SCSI case. 
	
	* components/services/inventory/eazel-inventory-service-interface.idl:
	Remove warn_before_upload attribute, make machine ID readonly
	attribute (and rename from machine name).

	* components/services/inventory/eazel-inventory-service.c:
	(impl_Trilobite_Eazel_Inventory__get_machine_id,
	impl_Trilobite_Eazel_Inventory_upload,
	eazel_inventory_service_get_epv): get machine ID from ammonite;
	remove dead methods.

	* libathena-extensions/athena-clickable-image.c
	(athena_clickable_image_set_up_pixbufs): Don't die if pixbuf is
	NULL (which happens of a failed image load).

2001-02-23  Eric Fischer <eric@eazel.com>

	reviewed by: Robin Slomkowski <rslomkow@eazel.com>

	* configure.in:
	Create athena-installer.spec; remove gibberish that I had
	accidentally left in from testing.

	* athena-installer.spec.in:
	Create RPM of athena-installer separately from main athena RPM

	* athena.spec.in:
	Separate athena-installer from main athena build

2001-02-23  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 6933 (Assertions & crash after renaming
	open folder)

	* libathena-extensions/athena-directory.c:
	(athena_directory_moved): Added a missing
	athena_file_ref in the code that runs when a
	directory is renamed.

2001-02-23  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 6738 (View as Web Page window closes if user follows bad
	link). The shell was closing the window as part of its feature to
	close windows when the underlying item is deleted.

	* libathena-extensions/athena-file.h:
	* libathena-extensions/athena-file.c:
	(athena_file_is_not_yet_confirmed): Added new function so we can
	tell a file that's never been seen from one that we already have
	information about.
	
	* src/athena-window-private.h:
	* src/athena-window-manage-views.c:
	(viewed_file_changed_callback): Keep track of whether we have ever
	seen the file for real, and only close the window if it was here
	before and is now gone, rather than if it was never there. This is
	a roundabout way to fix the problem reported, but seems like a
	nice rule in any case. Also added FIXMEs to some questionable code
	I found here.
	(update_for_new_location): Set up the variable that is used to
	check if we have ever seen the file for real.

	* src/athena-about.c: Formatting tweaks.
	
2001-02-23  Eric Fischer <eric@eazel.com>

	reviewed by: Robin Slomkowski <rslomkow@eazel.com>

	* athena.spec.in:
	Spell out /usr/bin/*.sh (athena-clean.sh, athena-verify-rpm.sh)
	to keep eazel-installer.sh from ending up in the main athena RPM

2001-02-23  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Ramiro Estrugo <ramiro@eazel.com>

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_move_copy_items):
	Special case activation of "command:" links, executing the
	command and passing it uris.
	
	* libathena-extensions/athena-drag.c:
	(athena_drag_default_drop_action_for_icons):
	Special case "command:" to always do a move.

2001-02-23  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	This patch removes the const on PackageData objects in the
	callbacks. The const was needed back when the objects were new'ed
	and deleted, but now that they're refcounted, the signalemitter in
	eazel-install-corba-callback.c can just unref and the signal
	handler can get a non-const object. And since the objects are
	created on the fly, the signal handler can cause any harm.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line), (tree_helper_helper),
	(tree_helper), (something_failed), (eazel_preflight_check_signal),
	(main):
	Removed const of packagedata objects in handlers.
	s/update/upgrade/
	Added a GList** param too tree_helper to check for recursiveness.
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	s/update/upgrade/
	
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install__set_upgrade),
	(impl_Eazel_Install__get_upgrade), (eazel_install_get_epv):
	s/update/upgrade/

	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), (get_softcat_info),
	(check_tree_helper), (do_file_conflict_check), (execute),
	(install_packages), (revert_transaction):
	s/update/upgrade/
	Removed const of packagedata objects in handlers.
	If modifying a package which has an epoch set, set force to TRUE.
	Fixed a bad boolean bug in get_info, where I did a & comparsion
	and not a ==, which caused packages added due to conflicts to not
	get dependency checked.
	Correctly use service object upgrade/downgrade flags.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_set_arg), (eazel_install_class_initialize),
	(eazel_install_new_with_config), (eazel_install_install_packages):
	s/update/upgrade/

	* components/services/install/lib/eazel-install-problem.h:
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_cases_foreach), (eazel_install_problem_tree_to_case),
	(eazel_install_problem_handle_cases):
	Fixed a g_message in the circular dep case.
	Fixed constness of PackageData objects

	* components/services/install/lib/eazel-install-public.h:
	s/update/upgrade/

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(display_arguments):
	One more time, the rpmlib(...) check
	Fixed display_arguments truncation
	
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_dump_int):
	Nicer output of Epoch
	
	* components/services/install/athena-view/callbacks.c:
	(athena_service_install_failed):
	* components/services/install/athena-view/callbacks.h:
	* athena-installer/src/installer.c: (collect_failure_info),
	(install_failed), (uninstall_failed), (eazel_installer_do_install),
	(eazel_installer_initialize):
	Removed const of packagedata objects in handlers.
	s/update/upgrade/

2001-02-23  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-smooth-text-layout.c:
	(athena_smooth_text_layout_draw_to_pixbuf):
	Ignore empty rectangles rather than asserting on them.
	FIxes bug 6945.
	
2001-02-23  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6931, "floppy" and "cdrom" in Disks menu
	should be "Floppy" and "CD-ROM"
	
	Fixed bug 5600, Desktop context menu "Disks" options
	not translated
	
	* libathena-extensions/athena-volume-monitor.c:
	* libathena-extensions/athena-volume-monitor.h:
	(athena_volume_monitor_initialize),
	(athena_volume_monitor_destroy):
	Create a hash table of readable names to represent the
	less legible name that is present in /etc/fstab.
	
	* src/file-manager/fm-desktop-icon-view.c:
	(update_disks_menu):
	Call new athena_volume_monitor_get_mount_name_for_display()
	function to get a legible name for placement in the mount menu.
	
2001-02-23  John Sullivan  <sullivan@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	More work on the never-ending 1 hour bug 3321
	(Finalize items in Help menu).

	* src/athena-shell-ui.xml:
	Changed underscore accelerator for Athena User
	Manual from N to M, since the N is needed for
	Athena Release Notes; add Athena Release Notes;
	add separator before Customer Support; remove all
	ellipses.
	* src/athena-window-menus.c:
	* src/athena-window-menus.c:
	(help_menu_athena_manual_callback),
	(help_menu_athena_quick_reference_callback),
	(help_menu_athena_release_notes_callback), (help_menu_support),
	(help_menu_athena_feedback_callback),
	(athena_window_initialize_menus): Add callback
	for Athena Release Notes item (which doesn't work yet;
	that's Dan's job). Also add #defines for the various help 
	menu URIs instead of hardcoding them in-line.

	Other text tweaks:

	* src/athena-property-browser.c:
	(athena_property_browser_update_contents):
	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize): Use initial caps style
	on Add & Remove buttons here, per Vera.

2001-02-23  Arik Devens  <arik@eazel.com>

	reviewed by: John Sullivan  <sullivan@eazel.com>

	* src/athena-application.c: (athena_application_startup):
	Rewriting of the "Reboot" dialog so as to also suggest trying
	athena-clean.sh -x.

2001-02-23  Seth Nickell  <seth@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* libathena-extensions/athena-volume-monitor.c:

	Fixed use of #if so constant is set not just defined.
	
2001-02-23  Josh Barrow  <josh@eazel.com>

	reviewed by: <kenny@whitecape.org>

	* src/athena-first-time-druid.c:
	(athena_first_time_druid_show):
	Change instance of "directory" to "folder".  This fixes bug
	6492.

2001-02-23  Darin Adler  <darin@eazel.com>

	reviewed by: J Shane Culpepper <pepper@eazel.com>

	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_initialize): Fix some signal handlers that
	were persisting after the desktop view itself was gone by using
	gtk_signal_connect_while_alive.

2001-02-23  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Bug fixes for regression introduced in my last checkin.
	
	6926 - Line spacing of multi-line icon names is inconsistent & look 
	6923 - Underline of mouse over is to close to text on icons 

	* libathena-extensions/athena-smooth-text-layout.c:
	(smooth_text_layout_clear_lines): Clear the total line height.
	(smooth_text_layout_line_list_draw_to_pixbuf): Dont use the max
	line height to place the glyph vertically.  Use just the given y.
	(smooth_text_layout_line_list_new_wrapped): Replace a string split
	and strcpy operation with an iteration of the text.  We need to do
	this to catch empty lines.  The string split function was
	coalescing empty lines.
	(smooth_text_layout_get_total_line_height),
	(athena_smooth_text_layout_draw_to_pixbuf): Place the underline
	rect right at the bottom edge of the glyph.
	(athena_smooth_text_layout_get_dimensions): Add up the line
	heights for the layout height.  Dont use the max line height
	because that make the line spacing look strange.  If we had
	working baseline support then this would be better.  For now,
	space the glyph using their heights.
	Lose the max_line_height member and getter, no longer needed.

2001-02-23  Brian Frank  <bfrank@eazel.com>

	Updating default bookmarks for Athena 1.0.
	
	* data/static_bookmarks.xml
	
2001-02-23  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6915 (installer no longer has text):

	* libathena-extensions/athena-druid-page-eazel.c
	(athena_druid_page_eazel_configure_size): if the embedded
	widget isn't a GtkEventBox, set the width and height of any
	widget item to the size of the canvas less the widget origin

	(This may be too restrictive, but I've verified that event
	boxes don't need the size set whereas at least some other
	widgets do - this may be related to whether they have their own
	window or not, but I'm not sure, so it seems better to be
	cautious. This at least lets both the first time druid and the
	installer work correctly, and these are currently the only
	users of this widget)

2001-02-23  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-icon-container.c: (destroy),
	(athena_icon_container_start_renaming_selected_item),
	(end_renaming_mode):
	* libathena-extensions/athena-icon-text-item.c:
	(iti_stop_editing), (iti_start_editing), (iti_destroy):
	Keep the rename widget around so that it will continue to
	work with the clipboard after the rename is over - bug 690.

2001-02-23  J Shane Culpepper  <pepper@eazel.com>

	reviewed by: vera@eazel.com

	* components/mozilla/athena-mozilla-content-view.c:
	(mozilla_new_window_callback):
	Adding the new wording to the popup warning dialog.

2001-02-23  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* components/image-viewer/athena-image-view.c: (main):
	* components/music/main.c: (create_function), (main):
	* components/text/main.c: (create_function), (main):
	Fix bug 6922 - Make sure components setup gettext bindings.  These
	3 components had localized strings in them but did not setup
	gettext.
	
2001-02-23  Seth Nickell  <snickell@stanford.edu> 
	    
	reviewed by: Pavel Císler <pavel@eazel.com>

	patch from: Louise Miller <Louise.Miller@ireland.sun.com>
	
	* libathena-extensions/athena-volume-monitor.c:

	Use volrmmount on Solaris for dealing with such operations,
	to get ejecting and properly unmounting removable volumes.
	
2001-02-23  Seth Nickell  <snickell@stanford.edu>

	reviewed by: J Shane Culpepper <pepper@eazel.com>

	Fix problems with playing MP3s on Solaris due to our use of
	Linux/x86-only code pillaged from mpg123. Continue pillaging
	from mpg123 to grab their generic decoding code for use when
	we are on non x86/Linux platforms.
	
	* configure.in:
	* components/music/Makefile.am:

	Check if we are on x86 and only build x86 optimized music
	components if we are. Otherwise use source & binary compatible
	generic code.
	
	* components/music/decode.c: (mpg123_synth_1to1_8bit),
	(mpg123_synth_1to1_8bit_mono),
	(mpg123_synth_1to1_8bit_mono2stereo), (mpg123_synth_1to1_mono),
	(mpg123_synth_1to1_mono2stereo), (mpg123_synth_1to1):

	Add decode.c as a generic replacement for decode_i386.c when
	on non-x86 hardware (dct64.c was already there, just not used),
	filched from mpg123 same as decode_i386.c.
	
	* components/music/mpg123.h:

	Add one #define to make decode.c happy.

	Thanks to Niall for nailing this bug :-)
	
2001-02-23  Laszlo Kovacs  <laszlo.kovacs@sun.com>
	* components/help/hyperbola-filefmt.c
	fixed bug 6866 - crash if the locale is set to NULL

2001-02-23  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Seth Nickel <seth@eazel.com>

	* libathena-extensions/athena-labeled-image.c:
	(athena_labeled_image_destroy):
	Fix bug 6590 - Segmentation fault when enabling smooth graphics
	while displaying background color chooser or emblems chooser.
	The problem was that we were leaking the image and label widgets
	of a labeled image.  The leakage meant that the widgets were not
	unregistered from the smooth widget machinery.  This caused them
	to be in limbo.  Half dead, but still receiving smooth graphics
	changed callbacks.  They tried to respon to the callbacks, the
	poor things.
	
2001-02-23  Laszlo Kovacs  <laszlo.kovacs@sun.com>
	* components/help/topleveldocs.xml:
	Athena User's Guide added

2001-02-23  Laszlo Kovacs  <laszlo.kovacs@sun.com>
	* README:
	Description about Scrollkeeper added.
	* athena.spec.in:
	$prefix/share/athena/components/hyperbola/*.xml added

2001-02-23  Robey Pointer  <robey@eazel.com>

	reviewed by: Mathieu Lacage <mathieu@gnome.org>

	* components/rpmview/athena-rpm-view-private.h:
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize), (file_activation_callback),
	(fill_filename_tree_int), (fill_filename_tree):

	Use AthenaCTree instead of GtkCTree.  Get rid of the "go to"
	button and just make a double-click do that.  Get rid of the
	leading / in directory names because it looked ugly, and add a top
	"/" to match the tree view.
	
	* libathena-extensions/athena-ctree.c:
	(athena_ctree_class_init), (athena_ctree_button_press),
	(row_delete), (real_tree_activate_row):
	* libathena-extensions/athena-ctree.h:

	Add a signal to be thrown when an item is "activated" (gets a
	double-click).

2001-02-23  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* libathena-extensions/athena-smooth-text-layout.c:
	(smooth_text_layout_line_list_draw_to_pixbuf):
	Restore the underlinig code missing from last checkin.

Fri Feb 23 04:09:54 2001  George Lebl <jirka@5z.com>

	Review sucker: Seth Nickel <seth@eazel.com>

	* src/athena-view-frame.c (athena_view_frame_destroy)
	  (view_frame_failed_callback) (queue_view_frame_failed)
	  (attach_view):  Avoid crashes by queueing the destruction of
	  the view into an idle from a "system_exception" signal, as 
	  the exception could have come in the middle of gtk voodoo, and
	  destroying the object then would be bad juju.

2001-02-23  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	* libathena-extensions/athena-icon-factory.c: (embed_text):
	Update for smooth text layout changes.
	
2001-02-22  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	Fix bugs:

	2784 - AthenaScalableFont text clipping is broken.
	2831 - Icon container redraw performance is poor in smooth mode.
	Optimized this case some.  Its still not as good as we
	would like it to be.  Thanks to the following changes, it
	is possible to optimize it even more - by caching the
	layouts of icons for example.  We need to profile with the
	new changes.
	
	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-icon-canvas-item.c:
	(measure_label_text), (draw_or_measure_label_text_aa),
	(draw_label_text_aa):
	* libathena-extensions/athena-icon-factory.c: (embed_text):
	Use AthenaSmoothTextLayout instead of AthenaTextLayout.

	* libathena-extensions/athena-label.h:
	* libathena-extensions/athena-label.c:
	(athena_label_initialize_class), (athena_label_initialize),
	(athena_label_destroy), (athena_label_set_arg),
	(athena_label_get_arg), (athena_label_size_allocate),
	(label_composite_pixbuf_callback), (label_get_text_dimensions),
	(label_smooth_text_ensure), (label_smooth_text_clear),
	(athena_label_set_smooth_font),
	(athena_label_set_smooth_font_size),
	(athena_label_set_is_smooth),
	(athena_label_set_smooth_line_wrap_width),
	(athena_label_set_smooth_drop_shadow_offset),
	(athena_label_set_text), (athena_label_set_wrap),
	(athena_label_new_solid), (athena_label_make_bold),
	(athena_label_make_larger), (athena_label_make_smaller),
	(athena_label_set_never_smooth):
	Simplified.  Use AthenaSmoothTextLayout to handle laying
	out the text.
	
	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-scalable-font.c:
	(athena_scalable_font_new),
	(athena_scalable_font_measure_text),
	(athena_scalable_font_draw_text),
	(initialize_global_stuff_if_needed),
	(athena_scalable_font_get_underline_height),
	(athena_scalable_font_get_baseline):
	Simplified.  Use AthenaSmoothTextLayout.  Remove no longer
	needed functions.

	* libathena-extensions/athena-smooth-text-layout.h:
	* libathena-extensions/athena-smooth-text-layout.c:
	New class to handle smooth text layout needs.  Layout details are
	private to make it easirt to fix bugs in the future.
	
	* libathena-extensions/athena-text-layout.c:
	* libathena-extensions/athena-text-layout.h:
	Retire.
	
	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-athena-font-simple.c: (main):
	* test/test-athena-font.c: (main):
	* test/test-athena-glyph-simple.c: (glyph_new), (main):
	* test/test-athena-label-simple.c: (main):
	* test/test-athena-label-wrapped.c: (create_athena_label),
	(main):
	* test/test-athena-smooth-text-layout.c: (main):
	New smooth text layout test.  Update test for smooth layout changes.

2001-02-23  John Harper  <jsh@eazel.com>

	reviewed by: Arik Devens  <arik@eazel.com>

	More tweaks to fix bug 1796 (Design a better First Time
	Walkthrough):

	* src/athena-first-time-druid.c: don't update the user-level
	preferences until immediately before exiting the druid - avoids
	possibly making the anti-aliased titles non-anti-aliased

	(set_up_update_feedback_page): put labels in hboxes to make
	them flush with the left side of the container

	(athena_first_time_druid_show): rearranged line breaks in
	body text slightly. Changed icon packing parameters to put them
	nearer to their ideal positions

2001-02-22  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* test/test-athena-viewport-constraint.c: (create_row), (main):
	Updated so that it uses to vbox's to test each of the constrain
	functions.

2001-02-22  Robey Pointer  <robey@eazel.com>

	reviewed by: Mike Fleming  <mfleming@eazel.com?

	* components/rpmview/athena-rpm-view-private.h:
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize), (file_selection_callback),
	(go_to_button_callback), (add_to_filename_tree),
	(fill_filename_tree_int), (fill_filename_tree),
	(filename_node_free), (athena_rpm_view_update_from_uri):

	Change the file list into an exploding tree.  Put the package
	description inside a viewport with opportunistic scrollbars, so
	that a long package description won't overwrite everything else.

	* components/services/install/athena-view/callbacks.c:
	(athena_service_install_done):
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_install_service_describe_menu_entry):
	* athena-installer/src/installer.c:
	* athena-installer/src/prescript:

	Text changes from Vera.

	* athena-installer/src/bootstrap-background.xpm:
	* athena-installer/src/error-symbol.xpm:

	Fix names in Arlo's new icons.

2001-02-22  John Harper  <jsh@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 6764 (Double-clicking a folder with an already-open
	window on another virtual desktop seems to do nothing):

	* libathena-extensions/athena-gtk-extensions.c
	(athena_gtk_window_present): ensure that the window is on the
	current desktop

2001-02-22  Rebecca Schulman  <rebecka@eazel.com>
 	Fix bugzilla.eazel.com bug 6290, that loading
 	a large directory in the list view hangs athena.
 	I've improved this aspect of performance, by 
 	sending the files to the list view in small chunks,
 	rather than as a whole, so that the ui can
 	be responsive between the times we are updating the
 	entries, rather than having to wait for the whole thing
 	to load.  I've avoided the problem of entries moving during
 	loading, by giving the list view the first 100 entries to
 	appear in the list, so the list fills up from top to bottom.
 
 	reviewed by: Pavel Cisler <pavel@eazel.com>
 
 	* src/file-manager/fm-directory-view.c:
 	(fm_directory_view_initialize_class),
 	(finish_displaying_pending_files), (display_pending_files),
 	(real_display_pending_files), (display_pending_timeout_callback),
 	(fm_directory_view_get_directory):
 	* src/file-manager/fm-directory-view.h:
 	Add display_pending_files as a method to the directory view.
 	Call it the method, and so the list view can override the
 	basic "give me all the files you have at once method" being
 	used in the directory view.
 	* src/file-manager/fm-list-view.c: (fm_list_view_initialize_class),
 	(fm_list_view_compare_rows), (fm_list_view_reveal_selection),
 	(g_list_split_off_first_n),
 	(fm_list_view_display_pending_files):
 	Add a display pending files method here that only sends the
 	first 100 items, and sorts the larger list.
 	* libathena-extensions/athena-glib-extensions.c:
 	(athena_g_list_sort_merge), (athena_g_list_is_already_sorted),
 	(athena_g_list_sort_custom), (compare_pointers),
 	(athena_g_lists_sort_and_check_for_intersection):
 	* libathena-extensions/athena-glib-extensions.h:
 	Add new sorting functions used by my changes, include
 	athena_g_list_sort_custom, which sorts a list using
 	a compare function that can also take data. This sort also
 	checks whether the list is sorted before beginning a merge
 	sort, which is a win for cases where you expect the list will

2001-02-22  Arlo Rose  <arlo@eazel.com>

	* athena-installer/src/error-symbol.xpm:
	Last tweak... making the error symbol fit with
	the new blue shade.

2001-02-22  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed 6131, new AthenaLabel does not support proper line wrap.
	
	* components/services/summary/athena-summary-view.c:
	(summary_view_create_pane): Add setting of
	athena_viewport_constrain_width to TRUE.
	* libathena-extensions/athena-viewport.c:
	(athena_viewport_initialize_class),
	(athena_viewport_size_allocate),
	(athena_viewport_get_is_smooth),
	(athena_viewport_set_constrain_width),
	(athena_viewport_get_constrain_width),
	(athena_viewport_set_constrain_height),
	(athena_viewport_get_constrain_height): Overrode the
	size_allocate method of GtkViewport to add the options of
	constraining the height or width of the viewports child to the
	same size as the viewport.
	* libathena-extensions/athena-viewport.h: Added function
	prototypes.
	* test/Makefile.am: Add building of a test case for the viewport
	constraining.

2001-02-22  Arlo Rose  <arlo@eazel.com>

	* athena-installer/src/bootstrap-background.xpm:
	Making the bootstrp installer look a little better.


2001-02-22  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header):
	Long the epoch in the right way.
	
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_dump_int):
	Display the epoch in the right way.
	
	* athena-installer/src/installer.c: (collect_failure_info):
	Const abuse to fix tinderbox build.

2001-02-22  Mike Fleming  <mfleming@eazel.com>

	reviewed by: <pavel@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(view_load_location_callback), (eazel_services_scheme_to_http):

	Bug 6810 -- Throbber keeps spinning on gnome-help URI's
	The mozilla wrapper was confusing athena by trying to be too clever--
	redirecting nauitilus while loading in mozilla.  Now it just pumps
	a new open_location request through athena.

	Bug 6902 -- Ammonite URI's wouldn't work if you weren't logged in,
	even if the specified user was "anonymous".

	Rather than trying to use the real ammonite login stuff, which is async
	and would be hard to integerate, just force the ammonite login dialog
	to pop up by performing a gnome-vfs operation.
	
2001-02-22  Rebecca Schulman  <rebecka@eazel.com>
	Fix bug 6058, that opening a file with a default
	application that cannot access a location (in the specific
	case of the bug, eazel-services) should explain the problem,
	and offer another application, rather than simply failing.

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-program-choosing.h:	
	* libathena-extensions/athena-program-choosing.c:
	(athena_choose_application_for_file),
	(application_can_handle_uri), (application_cannot_open_location),
	(athena_launch_application),	
	(launch_application_callback),
	(launch_parameters_new),
	(launch_parameters_free), (launch_application_callback):
	Change athena_launch_application to take a AthenaFile rather
	than a uri, so that we can find out whether other applications
	are available for the location, using the mime type as well
	as uri scheme.  Change the dialogs that come up when an application
	is not available for a particular location to explain more of what
	we know.  If another application is available to open the uri,
	open the program chooser dialog.

	* src/file-manager/fm-directory-view.c:
	(application_launch_parameters_new),
	(application_launch_parameters_free),
	(fm_directory_view_launch_application),
	(fm_directory_view_chose_application_callback), (choose_program),
	(bonobo_launch_application_callback),
	(add_application_to_bonobo_menu), (reset_bonobo_open_with_menu),
	(activate_callback):
	Change the parameters sent to athena_launch_application, and 
	so change data sent to callbacks used to later call 
	athena_launch_application
	
	* src/athena-sidebar.c: (command_button_callback),
	(athena_sidebar_chose_application_callback):
	Call athena_launch_application with the new arguments
	
2001-02-22  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 5729 ("Copying" label in progress dialog can be
	clipped if font is biggish)

	Fixed bug 5741 (File progress dialog uses fixed font for
	labels, slight clipping)

	* libathena-extensions/athena-file-operations-progress.c:
	Eliminated two hardwired widths; changed FIXME to comment for
	the third, legitimate, one.
	(set_text_unescaped_trimmed): Now uses athena_ellipsizing_label
	instead of a fixed width.
	(create_titled_label): Now use athena_ellipsizing_label and
	puts title & label in a table (with Clark Gable)
	(athena_file_operations_progress_initialize): Use table for
	titles & labels so they can line up without a hardwired width,
	set up spacings, change callers of create_titled_label.
	(athena_file_operations_progress_new_file): Change callers
	of set_text_unescaped_trimmed to not pass in a width.
	
	Fixed bug 6872 (Wording suggetions for preferences)

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_create_dialog),
	(global_preferences_create_search_pane): A few more
	wording tweaks in Preferences, some from Vera and some
	from this bug report and Vera-approved

	Fixed bug 6553 ("Where" in Properties Window is inconsistent)

	* src/file-manager/fm-properties-window.c: (create_basic_page):
	Changed "Where:" to "Location:" with Vera's approval.

2001-02-22  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Z. Ragan <gzr@eazel.com>

	Fix 5540 Dragging a group of files in zoomed icon view has
		 strange effect
	Fix 6461 Dropped icons in manual layout land at the wrong
		 coordinates at high zoom levels
	Fix 6845 Dropping multiple icons from list view to icon view
		 piles them on top of each other
		 
	* libathena-extensions/athena-icon-dnd.c:
	(create_selection_shadow),
	(icon_get_data_binder):
	Send outline rectangles for dragged icons off to a drag in a 100%
	zoom level scale.
	Scale outline rectangles in drag shadows using the scaling factor
	for the target view.
	
	* libathena-extensions/athena-list.h:
	* libathena-extensions/athena-list.c:
	(athena_list_get_cell_rectangle),
	(draw_cell), (athena_list_clear_from_row),
	(athena_list_set_drag_prelight_row),
	Make the call public, change the callers to pass AthenaList.
	
	* libathena-extensions/athena-list.c:
	(athena_list_each_selected_row):
	Add the row index parameter to the iteratee.
	
	* libathena-extensions/athena-list.c:
	(athena_list_get_initial_drag_offset):
	Add a way to get the intial mouse drag offset.
	
	* src/file-manager/fm-list-view.c: (row_get_data_binder),
	(each_icon_get_data_binder):
	Calculate outline rectangles for icons and pass them to the
	drag&drop machinery.

	* libathena-extensions/athena-list.c:
	(athena_list_dnd_initialize):
	Tweaks.
	
	* libathena-extensions/athena-art-extensions.h:
	* libathena-extensions/athena-art-extensions.c:
	(athena_art_irect_offset_by), (athena_art_irect_offset_to),
	(athena_art_irect_scale_by), (athena_art_irect_inset),
	(athena_art_drect_offset_by), (athena_art_drect_offset_to),
	(athena_art_irect_offset_by_point),
	(athena_art_irect_offset_to_point),
	(athena_art_drect_scale_by), (athena_art_drect_inset):
	Add a few convenience calls.

2001-02-22  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (something_failed), (install_failed), (uninstall_failed):
	Fixed output of Problem/Actions.
	
	* components/services/install/command-line/eazel-test-packsys.c:
	(test_database_mtime), (test_package_load), (main):
	Fixed a fatal free in test_database_mtime.
	Output first package loaded.
	Set the package load to be the first test.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages_helper), (fail_modified_packages),
	(get_softcat_info), (is_satisfied_from_package_list),
	(check_dependencies_foreach), (check_for_no_more_missing_features),
	(check_tree_helper), (execute), (install_packages),
	(uninstall_packages):
	If a package has suite_id set and no dependencies during pruning,
	fail by setting to ALREADY_INSTALLED.
	If  a package update/downgrades and isn't allowed to, set modified
	packages->status top CANCELLED.
	Ifdeffed out some code to always fail gnome-libs (for testing)
	Commented out some crack debug output (\t\t-->checking)
	Changed a status = CANCELLED to CIRCULAR_DEPENDENCY.
	Fixed bug 6811, need to find a possible test case.
	Fixed indentation in a fucktion.
	Added comments to the code that sets the infoblock for the
	progress signals.
	No longer set FORCE under any condition.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_progress_signal):
	Tried to fix the uninstall emits, but since bytesize is rarely
	set...
	
	* components/services/install/lib/eazel-install-private.h:
	Added a newline...

	* components/services/install/lib/eazel-install-problem.h:
	Removed some consts.
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_breaks_foreach),
	(get_detailed_messages_foreach),
	(get_detailed_uninstall_messages_foreach), (compare_problem_case),
	(add_force_install_both_case), (add_force_remove_case),
	(add_remove_case), (add_update_case), (add_cascade_remove),
	(get_detailed_cases_foreach),
	(get_detailed_uninstall_cases_foreach),
	(eazel_install_problem_case_to_string),
	(eazel_install_problem_tree_to_case),
	(eazel_install_problem_tree_to_string),
	(build_categories_from_problem_list):
	Eliminated the use of packagedata_copy
	Fixed generation of strings for errors, won't report bogus
	"already installed" cases.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_xfer_callback), (eazel_install_fetch_package):
	Fixed the extra download progress emission, which ocurred since
	the off-by-1k gnome-vfs bug has been fixed.
	Paranoia check to not download suite objects.

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header):
	Fixed the broken feature loading.
	Added code to load epoch *sigh*

	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_query_foreach):
	Added handler for QUERY_REQUIRES_FEATURE query enum.

	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_finalize), (packagedata_initialize),
	(packagedata_list_copy), (packagedata_copy),
	(packagedata_fill_in_missing),
	(flatten_packagedata_dependency_tree), (packagedata_dump_int):
	copy avoid duplicated objects in the new tree, fixes redundant
	problemhandler output.
	Flatten tree doesn't add suites.
	Added obsoletes and epoch to packagedata

2001-02-22  John Harper  <jsh@eazel.com>

	reviewed by: George Lebl <jirka@5z.com>

	Mostly fixed bug 1796 (Design a better First Time Walkthrough)
	by implementing Arlo's new design:

	* libathena-extensions/athena-druid-page-eazel.c: changed a
	lot of the Druid text

	(new_title_label, new_body_label): functions for creating the
	two types of labels used in the druid. Title labels are always
	anti-aliased in a hardcoded font, while body labels use the
	user's font choice and are never anti-aliased

	(set_up_service_signup_page): this page has been removed

	(make_title_page_icon_box): function to create an hbox
	containing the four icons displayed on the start page


	Fixed bugs 5625 (Bottom line of "Select User Level" dialog is
	out of view), 5901 (First-Time Druid dimensions hard-coded,
	text can be truncated) and 6496 (First-time Druid window clips
	some contents (with 100 dpi fonts)):

	* libathena-extensions/athena-druid-page-eazel.c: hacked
	this widget to scale correctly, the main change is _not_
	setting the width and height of the canvas widget item, to
	allow the normal size allocation mechanisms to work properly

	[ there are still a few minor things to tweak, but this is the
	bulk of the redesign done ]


	Fixed bug 6412 (Add option to disable medusa in the first time
	druid)
	
	* src/athena-first-time-druid.c: added `Launch Medusa' page,
	which is only displayed if the ATHENA_PREFERENCES_MEDUSA_BLOCKED
	option isn't set.


	Fix bug 6379 (Athena assumes http proxy is needed if
	updates.tgz doesn't exist)

	* src/athena-first-time-druid.c (download_callback): if
	result is GNOME_VFS_ERROR_NOT_FOUND, just print a message that
	there are no updates available, then continue as normal

	(instead of assuming a proxy error, and going into the proxy
	setup pane)


	Fixed bug 6528 (More explanation needed for GMC transistion
	stuff in the druid):

	* src/athena-first-time-druid.c (set_up_gmc_transition_page):
	added Vera's new text for this page of the druid


	Fixed illogical behaviour of show-desktop option in druid (the
	user's choice wasn't actually being applied, the saved value
	was always being used):

	* src/athena-first-time-druid.c (druid_finished): set
	ATHENA_PREFERENCE_SHOW_DESKTOP from the `draw_desktop'
	variable, not from `save_manage_desktop'

	* src/athena-first-time-druid.c (set_up_gmc_transition_page):
	don't default the `draw desktop' setting to true; instead set
	it to the `save_manage_desktop' value. Also, only display the
	`draw desktop' option when not in `beginner' mode


	Fixed bug 3060 (Font names marked for translation need
	comments):

	* libathena-extensions/athena-icon-factory.c,
	libathena-extensions/athena-gdk-font-extensions.c,
	libathena-extensions/athena-druid-page-eazel.c,
	src/athena-zoom-control.c, src/athena-first-time-druid.c:
	added comments before localized fonts and font components

2001-02-22  Andy Hertzfeld  <andy@eazel.com>

	* components/text/services/google.xml:
	* components/text/services/webster.xml:
	fixed bug 6889, add eazel redirect to the text services.
	
Thu Feb 22 21:22:58 2001  George Lebl <jirka@5z.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* src/athena-window-manage-views.c (change_selection)
	  (update_title) (load_new_location_in_sidebar_panels) 
	  (stop_loading_cover):  When traversing sidebar_panels and doing
	  things that could result in a sidebar_panels removal (failure),
	  copy the list first and then traverse the copy to avoid free list
	  corruption.

2001-02-22  John Harper  <jsh@eazel.com>

	reviewed by: Ramiro Estrugo <ramiro@eazel.com>

	* libathena-extensions/athena-gtk-extensions.c
	(athena_gtk_label_make_bold, athena_gtk_label_make_larger,
	athena_gtk_label_make_smaller): call gtk_widget_ensure_style
	() before trying to fetch the style

2001-02-22  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 6859 (GTK signal macros don't work in non-GCC compilers
	for void return types).

	* libathena-extensions/athena-gtk-macros.h:
	Replaced old macros that accidentally relied on gccisms with
	new ones that are portable to other compilers.

		ATHENA_CALL_PARENT_CLASS is replaced by
			ATHENA_CALL_PARENT
		    and ATHENA_CALL_PARENT_WITH_RETURN_VALUE.

		ATHENA_CALL_VIRTUAL is replaced by
			ATHENA_CALL_METHOD
		    and ATHENA_CALL_METHOD_WITH_RETURN_VALUE

	* components/adapter/athena-adapter-control-embed-strategy.c:
	(athena_adapter_control_embed_strategy_destroy):
	* components/adapter/athena-adapter-embed-strategy.c:
	(athena_adapter_embed_strategy_destroy),
	(athena_adapter_embed_strategy_get_widget),
	(athena_adapter_embed_strategy_get_zoomable):
	* components/adapter/athena-adapter-embeddable-embed-strategy.c:
	(athena_adapter_embeddable_embed_strategy_destroy):
	* components/adapter/athena-adapter-factory-server.c:
	(athena_adapter_factory_server_destroy):
	* components/adapter/athena-adapter-file-load-strategy.c:
	(athena_adapter_file_load_strategy_destroy):
	* components/adapter/athena-adapter-load-strategy.c:
	(athena_adapter_load_strategy_destroy),
	(athena_adapter_load_strategy_load_location),
	(athena_adapter_load_strategy_stop_loading):
	* components/adapter/athena-adapter-progressive-load-strategy.c:
	(athena_adapter_progressive_load_strategy_destroy):
	* components/adapter/athena-adapter-stream-load-strategy.c:
	(athena_adapter_stream_load_strategy_destroy):
	* components/adapter/athena-adapter.c:
	(athena_adapter_destroy):
	* components/hardware/athena-hardware-view.c:
	(athena_hardware_view_destroy):
	* components/history/athena-history-view.c:
	(athena_history_view_destroy):
	* components/loser/content/athena-content-loser.c:
	(athena_content_loser_destroy):
	* components/loser/sidebar/athena-sidebar-loser.c:
	(athena_sidebar_loser_destroy):
	* components/music/athena-music-view.c:
	(athena_music_view_destroy):
	* components/rpmview/athena-rpm-verify-window.c:
	(athena_rpm_verify_window_destroy):
	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_destroy):
	* components/sample/athena-sample-content-view.c:
	(athena_sample_content_view_destroy):
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_destroy),
	(athena_service_install_view_finalize):
	* components/services/inventory-view/athena-inventory-config-page
	.c: (athena_inventory_config_page_destroy):
	* components/services/inventory-view/athena-inventory-view.c:
	(athena_inventory_view_destroy):
	* components/services/login/athena-view/athena-change-password-
	view.c: (athena_change_password_view_destroy):
	* components/services/athena-dependent-shared/eazel-services-foot
	er.c: (footer_destroy):
	* components/services/athena-dependent-shared/eazel-services-head
	er.c: (header_destroy):
	* components/services/summary/athena-summary-view.c:
	(athena_summary_view_destroy):
	* components/services/time/athena-view/trilobite-eazel-time-view.
	c: (trilobite_eazel_time_view_destroy):
	* components/text/athena-text-view.c:
	(athena_text_view_destroy):
	* components/throbber/athena-throbber.c:
	(athena_throbber_destroy), (athena_throbber_map),
	(athena_throbber_size_allocate):
	* components/tree/athena-tree-change-queue.c:
	(athena_tree_change_queue_destroy):
	* components/tree/athena-tree-expansion-state.c:
	(athena_tree_expansion_state_destroy):
	* components/tree/athena-tree-model.c:
	(athena_tree_model_destroy):
	* components/tree/athena-tree-node.c:
	(athena_tree_node_destroy):
	* components/tree/athena-tree-view.c:
	(athena_tree_view_destroy):
	* help/athena-quick-reference/.cvsignore:
	* help/athena-quick-reference/C/.cvsignore:
	* libathena-extensions/athena-background-canvas-group.c:
	(athena_background_canvas_group_update),
	(athena_background_canvas_group_draw),
	(athena_background_canvas_group_render):
	* libathena-extensions/athena-background.c:
	(athena_background_destroy):
	* libathena-extensions/athena-bookmark.c:
	(athena_bookmark_destroy):
	* libathena-extensions/athena-caption.c:
	(athena_caption_destroy), (athena_font_picker_show_all):
	* libathena-extensions/athena-clickable-image.c:
	(athena_clickable_image_destroy),
	(athena_clickable_image_realize),
	(athena_clickable_image_expose_event):
	* libathena-extensions/athena-debug-drawing.c:
	(debug_pixbuf_viewer_destroy):
	* libathena-extensions/athena-directory-metafile-monitor.c:
	(destroy):
	* libathena-extensions/athena-directory.c:
	(athena_directory_destroy),
	(athena_directory_get_name_for_self_as_new_file),
	(athena_directory_are_all_files_seen),
	(athena_directory_contains_file),
	(athena_directory_call_when_ready),
	(athena_directory_cancel_callback),
	(athena_directory_file_monitor_add),
	(athena_directory_file_monitor_remove),
	(athena_directory_force_reload),
	(athena_directory_is_not_empty):
	* libathena-extensions/athena-druid-page-eazel.c:
	(athena_druid_page_eazel_destroy),
	(athena_druid_page_eazel_finalize),
	(athena_druid_page_eazel_size_allocate),
	(athena_druid_page_eazel_size_request):
	* libathena-extensions/athena-ellipsizing-label.c:
	(real_size_request), (real_size_allocate), (real_style_set):
	* libathena-extensions/athena-entry.c:
	(athena_entry_destroy), (athena_entry_key_press),
	(athena_entry_motion_notify), (athena_entry_set_selection),
	(athena_entry_insert_text), (athena_entry_delete_text),
	(athena_entry_selection_clear):
	* libathena-extensions/athena-file.c: (destroy),
	(athena_file_monitor_add), (athena_file_monitor_remove),
	(athena_file_get_date), (athena_file_get_where_string),
	(athena_file_get_directory_item_count),
	(athena_file_get_deep_counts), (athena_file_get_file_type),
	(athena_file_check_if_ready), (athena_file_call_when_ready),
	(athena_file_cancel_call_when_ready):
	* libathena-extensions/athena-font-factory.c: (destroy):
	* libathena-extensions/athena-font-picker.c:
	(athena_font_picker_destroy):
	* libathena-extensions/athena-horizontal-splitter.c:
	(athena_horizontal_splitter_destroy),
	(athena_horizontal_splitter_button_press):
	* libathena-extensions/athena-icon-canvas-item.c:
	(athena_icon_canvas_item_destroy),
	(athena_icon_canvas_item_update):
	* libathena-extensions/athena-icon-container.c: (destroy),
	(size_allocate), (realize), (unrealize), (button_press_event),
	(button_release_event), (motion_notify_event), (key_press_event):
	* libathena-extensions/athena-icon-factory.c:
	(athena_icon_factory_destroy):
	* libathena-extensions/athena-image-table.c:
	(athena_image_table_destroy),
	(athena_image_table_expose_event),
	(athena_image_table_realize), (athena_image_table_unrealize),
	(athena_image_table_remove):
	* libathena-extensions/athena-image.c:
	(athena_image_destroy):
	* libathena-extensions/athena-keep-last-vertical-box.c:
	(athena_keep_last_vertical_box_size_allocate):
	* libathena-extensions/athena-label.c:
	(athena_label_destroy), (athena_label_size_request),
	(athena_label_size_allocate), (label_paint_pixbuf_callback):
	* libathena-extensions/athena-labeled-image.c:
	(athena_labeled_image_destroy):
	* libathena-extensions/athena-list-column-title.c:
	(athena_list_column_title_finalize):
	* libathena-extensions/athena-list.c: (athena_list_destroy),
	(athena_list_button_press), (athena_list_button_release),
	(athena_list_key_press), (athena_list_style_set),
	(athena_list_realize), (athena_list_unrealize), (draw_rows),
	(draw_all), (athena_list_draw), (athena_list_expose),
	(athena_list_resize_column), (athena_list_set_cell_contents),
	(set_list_cell), (athena_list_track_new_column_width),
	(athena_list_motion), (athena_list_clear), (insert_row):
	* libathena-extensions/athena-merged-directory.c:
	(merged_destroy):
	* libathena-extensions/athena-metafile-factory.c: (destroy):
	* libathena-extensions/athena-metafile.c: (destroy):
	* libathena-extensions/athena-preferences-box.c:
	(athena_preferences_box_destroy):
	* libathena-extensions/athena-preferences-pane.c:
	(athena_preferences_pane_destroy):
	* libathena-extensions/athena-scalable-font.c:
	(athena_scalable_font_destroy):
	* libathena-extensions/athena-string-picker.c:
	(athena_string_picker_destroy):
	* libathena-extensions/athena-tabs.c: (athena_tabs_destroy):
	* libathena-extensions/athena-text-caption.c:
	(athena_text_caption_destroy):
	* libathena-extensions/athena-trash-directory.c:
	(trash_destroy):
	* libathena-extensions/athena-trash-file.c: (trash_destroy):
	* libathena-extensions/athena-undo-context.c: (destroy):
	* libathena-extensions/athena-undo-manager.c: (destroy):
	* libathena-extensions/athena-vfs-directory.c: (vfs_destroy):
	* libathena-extensions/athena-vfs-file.c: (vfs_destroy):
	* libathena-extensions/athena-viewport.c:
	(athena_viewport_destroy), (athena_viewport_realize):
	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_destroy):
	* libathena-extensions/athena-wrap-table.c:
	(athena_wrap_table_destroy):
	* libathena/athena-undo-transaction.c:
	(athena_undo_transaction_destroy):
	* libathena/athena-view.c: (athena_view_destroy):
	* src/file-manager/fm-desktop-icon-view.c:
	(fm_desktop_icon_view_destroy), (real_update_menus),
	(real_merge_menus):
	* src/file-manager/fm-directory-view.c:
	(text_attribute_names_changed_callback),
	(image_display_policy_changed_callback),
	(directory_view_font_family_changed_callback),
	(click_policy_changed_callback),
	(smooth_graphics_mode_changed_callback),
	(fm_directory_view_destroy),
	(fm_directory_view_file_limit_reached),
	(fm_directory_view_bump_zoom_level),
	(fm_directory_view_zoom_to_level),
	(fm_directory_view_restore_default_zoom_level),
	(fm_directory_view_can_zoom_in), (fm_directory_view_can_zoom_out),
	(fm_directory_view_get_background_widget),
	(fm_directory_view_get_selection), (reveal_newly_added_folder),
	(fm_directory_view_get_emblem_names_to_exclude),
	(fm_directory_view_merge_menus), (fm_directory_view_select_all),
	(fm_directory_view_set_selection),
	(fm_directory_get_selected_icon_locations),
	(fm_directory_view_reveal_selection),
	(fm_directory_view_is_read_only), (fm_directory_view_is_empty),
	(fm_directory_view_supports_creating_files),
	(fm_directory_view_accepts_dragged_files),
	(fm_directory_view_supports_properties),
	(fm_directory_view_supports_zooming),
	(fm_directory_view_update_menus):
	* src/file-manager/fm-icon-view.c: (fm_icon_view_destroy),
	(fm_icon_view_clean_up), (fm_icon_view_get_directory_sort_by),
	(fm_icon_view_set_directory_sort_by),
	(fm_icon_view_get_directory_sort_reversed),
	(fm_icon_view_set_directory_sort_reversed),
	(fm_icon_view_get_directory_auto_layout),
	(fm_icon_view_set_directory_auto_layout),
	(fm_icon_view_get_directory_tighter_layout),
	(fm_icon_view_set_directory_tighter_layout),
	(fm_icon_view_supports_auto_layout),
	(fm_icon_view_start_renaming_item), (fm_icon_view_merge_menus),
	(fm_icon_view_update_menus):
	* src/file-manager/fm-list-view.c: (fm_list_view_adding_file),
	(fm_list_view_removing_file), (fm_list_view_file_still_belongs),
	(get_number_of_columns), (get_link_column),
	(get_default_sort_attribute), (get_column_specification):
	* src/file-manager/fm-properties-window.c: (real_shutdown),
	(real_destroy), (real_finalize):
	* src/file-manager/fm-search-list-view.c: (real_destroy),
	(real_add_file), (real_adding_file), (real_removing_file),
	(real_merge_menus), (real_update_menus):
	* src/athena-about.c: (athena_about_destroy):
	* src/athena-application.c: (athena_application_destroy),
	(athena_application_startup):
	* src/athena-complex-search-bar.c:
	(athena_complex_search_bar_destroy):
	* src/athena-desktop-window.c: (destroy), (realize):
	* src/athena-location-bar.c: (destroy):
	* src/athena-navigation-bar.c:
	(athena_navigation_bar_get_location),
	(athena_navigation_bar_set_location):
	* src/athena-property-browser.c:
	(athena_property_browser_destroy):
	* src/athena-search-bar-criterion.c:
	(athena_search_bar_criterion_destroy):
	* src/athena-shell.c: (destroy):
	* src/athena-sidebar-tabs.c: (athena_sidebar_tabs_destroy),
	(athena_sidebar_tabs_size_allocate):
	* src/athena-sidebar-title.c: (athena_sidebar_title_destroy),
	(athena_sidebar_title_size_allocate):
	* src/athena-sidebar.c: (athena_sidebar_destroy),
	(athena_sidebar_size_allocate), (athena_sidebar_realize):
	* src/athena-simple-search-bar.c:
	(athena_simple_search_bar_destroy):
	* src/athena-switchable-navigation-bar.c:
	(athena_switchable_navigation_bar_destroy):
	* src/athena-switchable-search-bar.c:
	(athena_switchable_search_bar_destroy):
	* src/athena-theme-selector.c: (athena_theme_selector_destroy):
	* src/athena-view-frame.c: (athena_view_frame_destroy),
	(athena_view_frame_finalize), (athena_view_frame_map):
	* src/athena-window.c: (athena_window_destroy),
	(athena_window_realize), (athena_window_size_request),
	(athena_window_add_current_location_to_history_list),
	(athena_window_show):
	* src/athena-zoom-control.c: (athena_zoom_control_destroy),
	(athena_zoom_control_size_allocate):
	Use the macros by their new names.
	
	* RENAMING: Updated for some name changes and name change ideas.
	
	* user-guide/C/.cvsignore:
	* user-guide/C/html/.cvsignore:
	* user-guide/C/img/.cvsignore:
	* user-guide/C/sgml/.cvsignore:
	Added missing cvsignores.

2001-02-22  J Shane Culpepper  <pepper@eazel.com>

	* components/help/test-help-method.c: (main):

	Adding newline to make my compiler happy.

2001-02-22  Arik Devens  <arik@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 6391, athena crashes on certain strings set as home
	dir preference. This is actually only half the fix, for the "\"
	char i am waiting on pavel's input.
	
	* libathena-extensions/athena-entry.c:
	(athena_entry_initialize), (athena_entry_key_press): Removed
	tilde expand code.
	* libathena-extensions/athena-entry.h: Removed tilde_expand
	gboolean.
	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_create_editable_string): Cleanup to use
	ATHENA_PREFERENCES_HOME_URI instead of "preferences/home_uri" as
	per ramiro's advice.
	* libathena-extensions/athena-text-caption.c:
	(athena_text_caption_initialize), (entry_key_press_callback),
	(athena_text_caption_set_expand_tilde): Added tilde_expand code
	to the text-caption for use in the preferences dialog. Much
	smarter tilde code, should handle any corner case (at least any i
	could think of).
	* src/athena-location-bar.c: (try_to_expand_path),
	(editable_key_press_callback), (athena_location_bar_initialize):
	Added handling of the ~/ case directly to the location bar instead
	of going through the AthenaEntry.

2001-02-22  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Partially fixed bug 6863 (tree view slow to load):

	* libathena-extensions/athena-ctree.c (set_node_info):
	don't sort each node in auto-sort mode
	(athena_ctree_set_node_info): sort each node in auto-sort
	mode, but use the function that only sorts a single node, not
	the entire branch

	* components/tree/athena-tree-view.c
	(athena_tree_view_insert_model_node): temporarily turn off
	auto-sort mode while inserting nodes (do this by twiddling the
	bit by hand, since the function to set this flag automatically
	sorts the tree)

2001-02-22  Mike Fleming  <mfleming@eazel.com>

	Bug 6761: promote html help uris in the {gnome-,g,}help
	uri scheme to point to sgml files if they exist 

	* components/help/Makefile.am:
	* components/help/help-method.c: (string_ends_in),
	(strdup_string_to_substring_end), (check_sgml_promotion),
	(help_name_to_local_path), (transform_file), (help_do_transform):
	* components/help/test-help-method.c: (test_failed),
	(strcmp_tolerate_nulls), (test_uri_transform), (main):

2001-02-22  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_install_failed), (impl_uninstall_failed):

	Change direct casts to GtkObject-style casts.

	* components/services/install/athena-view/forms.c:
	(make_query_box):

	Vera'fy the installer text.
	
	* athena-installer/install-lib/Makefile.am:
	* athena-installer/src/Makefile.am:
	* athena-installer/src/create-eazel-installer.sh:

	Cause installer to be built with -g -O2, and to notice a debug
	build and not strip the binary.

	* athena-installer/src/installer.c: (report_unusual_errors),
	(install_failed), (uninstall_failed), (download_failed),
	(install_done):
	* athena-installer/src/installer.h:

	Remove crufted error-tree parsing code (install lib does this for
	us now).  Notice when any install or download fails, and treat
	that as an overall failure, even if install_done is called with
	success = TRUE.

	* athena-installer/src/main.c: (segv_handler), (main):

	Catch more signals, but only in debug mode.

	* athena-installer/src/package-tree.c:

	Remove references to nonexistent icons.
	
2001-02-22  Ian McKellar  <ian@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-test-packsys.c:
	(test_database_mtime), (main):
	* components/services/install/lib/eazel-package-system-dpkg.c:
	(load_package_callback), (query_callback),
	(eazel_package_system_dpkg_query),
	(eazel_package_system_dpkg_install),
	(eazel_package_system_dpkg_compare_version),
	(eazel_package_system_dpkg_database_mtime),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_database_mtime),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-skeleton.c:
	(eazel_package_system_skeleton_compare_version):
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_database_mtime):
	* components/services/install/lib/eazel-package-system.h:
	Added a function to retrieve the package database modification time.

	* components/services/inventory/eazel-inventory-collect-hardware.c:
	(eazel_inventory_collect_scsi), (eazel_inventory_collect_hardware):
	Cleanups, fixes...

	* components/services/inventory/eazel-inventory-utils.c:
	(get_software_inventory), (eazel_create_configuration_metafile):
	Cache the software inventory (because the RPM query is slow).

	* user-guide/C/Makefile.am:
	Build fix for systems without scrollkeeper.

2001-02-22  Mike Fleming  <mfleming@eazel.com>

	Embedded Mozilla User Agent string "Athena/1.0PR3" -> "Athena/1.0Final"
	Trilobite version "0.2.0" -> "0.3.0" (so Trilobite user agent string
	is now "Trilobite/0.3.0" 

	* components/mozilla/athena-mozilla-content-view.c:
	(post_widget_initialize):
	* components/services/trilobite/libtrilobite/Makefile.am:

2001-02-22  J Shane Culpepper  <pepper@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* components/mozilla/Makefile.am:
	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize),
	(mozilla_title_changed_callback), (mozilla_js_status_callback),
	(mozilla_get_containing_window), (mozilla_new_window_callback):

	Catch mozilla or javascript trying to open a new window and
	post a athena warning dialog that they are not supported.
	Fix for bug #3058.  Still needs better a  worded warning message.

2001-02-22  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 6312, information about translation in the about box,
	by adding a localizable string that is displayed in the lower
	left of the about box if it's changed from the default.
	
	fixed bug 6708, support link in help menu, by changing the uri to
	the real one we want to ship with, that currently points to a
	placeholder page.  Also, due to popular demand, renamed it back
	to "Support".
	
	* src/athena-about.c: (athena_about_new),
	(athena_about_draw_info):
	added a translators parameter, and used it to draw the translators
	credits if present.
	* src/athena-about.h:
	added translator parameter to athena_about_new
	* src/athena-shell-ui.xml:
	changed menu name to "support"
	* src/athena-window-menus.c: (help_menu_about_athena_callback),
	(help_menu_support), (athena_window_initialize_menus):
	renamed verb to support, changed link to point to intended support site.
	
2001-02-22  Michael Engber  <engber@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* components/notes/athena-notes.c:
	(on_text_field_focus_out_event), (make_notes_view):
	Save notes on focus out - bug 6851.

2001-02-22  Robin * Slomkowski  <rslomkow@eazel.com>

	reviewed by: Eric Fischer <eric@eazel.com>

	* athena.spec.in: updated text in refrence to BUG 6853

2001-02-22  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 3321 (Finalize contents of Help menu for 1.0).
	Actually there's still an open issue about the Customer
	Service item, which I've left in for now.

	* src/athena-shell-ui.xml: Added Quick Reference, removed
	License, put About last after a separator.

	* src/athena-window-menus.c:
	(help_menu_athena_quick_reference_callback): New callback.
	(help_menu_athena_license_callback): Removed this.
	(athena_window_initialize_menus): Install callback for
	Quick Reference, remove for License.


	Also removed the space from "tool bar" everywhere, per the
	final decision of Vera & Rhoda. I grepped and replaced
	everywhere for "tool bar", "Tool Bar", "TOOL_BAR", and
	"tool_bar".

	* components/loser/content/athena-content-loser-ui.xml:
	* components/loser/sidebar/athena-sidebar-loser-ui.xml:
	* components/mozilla/bonobo-extensions.c:
	* components/sample/athena-sample-content-view-ui.xml:
	* libathena-extensions/athena-bonobo-extensions.c:
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog):
	* libathena-extensions/athena-global-preferences.h:
	* src/athena-service-ui.xml:
	* src/athena-shell-ui.xml:
	* src/athena-window-menus.c:
	(view_menu_show_hide_toolbar_callback),
	(athena_window_update_show_hide_menu_items),
	(help_menu_athena_quick_reference_callback),
	(athena_window_initialize_menus):
	* src/athena-window-toolbars.c: (set_up_special_bonobo_button),
	(set_up_toolbar_images), (theme_changed_callback),
	(set_up_back_or_forward_toolbar_item),
	(athena_window_initialize_toolbars):
	* src/athena-window.c: (athena_window_constructed),
	(athena_window_hide_toolbar), (athena_window_show_toolbar),
	(athena_window_toolbar_showing), (athena_window_show):
	* src/athena-window.h:
	Made toolbar one word.

2001-02-22  Seth Nickell  <seth@eazel.com>

	reviewed by: Ramiro Estrugo <ramiro@eazel.com>

	* libathena-extensions/athena-volume-monitor.c:

	Fix performance issue on Solaris by not rescanning through the
	mounttable to discover if a volume is removable, etc, but 
	rather extracting all relevant attributes in a single pass.
	
2001-02-22  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* components/mozilla/athena-mozilla-encoding-tables.c:
	No need to have 2 strings.  Use an array of just one string.

	* components/mozilla/athena-mozilla-content-view.c:
	(mozilla_view_create_charset_encoding_submenu):
	Replace assertion with a more robust check for NULL.

	
	reviewed by: Seth Nickell <seth@eazel.com>

	* applets/preferences-applet/athena-preferences-applet.c:
	(quit_athena_button_clicked_callback),
	(start_athena_button_clicked_callback),
	(restart_athena_button_clicked_callback),
	(exit_button_clicked_callback), (main):
	Add a exit button for the applet itself.  Renamed athena remote
	callbacks to be clearer.
	
	* libathena-extensions/athena-art-extensions.h:
	* libathena-extensions/athena-art-extensions.c:
	(athena_art_irect_is_valid),
	(athena_self_check_art_extensions): New functions and tests for
	checking whether a rectangle is valid.

	* libathena-extensions/athena-glyph.h: Use int instead
	of guint everywhere.
	* libathena-extensions/athena-glyph.c: (athena_glyph_new),
	(athena_glyph_free), (glyph_get_width_space_safe): New functions
	to get dimensions that work with glyphs that are just empty space.
	(glyph_get_height_space_safe), (athena_glyph_get_width),
	(athena_glyph_get_height), (athena_glyph_get_dimensions): Make
	these work with empty spaces.
	(glyph_is_valid), (athena_glyph_draw_to_pixbuf): Use libart rgba
	functions instead of doing our own alpha blending.  Allow for
	rendering glyphs with just blank spaces (noop).  Remove debug code.
	(athena_glyph_intersect): New function to intersect a glyph at
	some coordinates with a rectangle.

	* test/test-athena-glyph-simple.c: (main):
	* test/test-athena-glyph.c: (glyph_new), (main):
	* test/test.c: (test_pixbuf_draw_rectangle_tiled):
	More glyph tests.

2001-02-22  Dan Mueth  <dan@eazel.com>

	reviewed by: Ramiro Estrugo  <ramiro@eazel.com>

	* athena.spec.in: Commenting out offensive line.
	I'm not sure where the breakage is now.  Hopefully
	I can track it down tomorrow and uncomment this.

2001-02-22  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com> (Post Mortem)

	Fix bug 6824 - Mozilla component charset encodings are not translated.
	
	* components/mozilla/Makefile.am:
	Add new encoding tables sources.  Add GNOMELOCALEDIR define to
	make gettext happy.
	* components/mozilla/main.c: (main):
	Add gettext binding setup.
	
	* components/mozilla/athena-mozilla-content-view.c:
	(mozilla_view_create_charset_encoding_submenu):
	Use the translated strings for menu labels.

	* components/mozilla/athena-mozilla-embed-extensions.h:
	* components/mozilla/athena-mozilla-embed-extensions.cpp:
	Simplified by using an stl vector instead of a GList.  Moved the
	encoding tables to their own place.   Added functions for
	obtaining the encoding titles and encoding groups as translated
	strings.
	
	* components/mozilla/athena-mozilla-encoding-tables.h:
	* components/mozilla/athena-mozilla-encoding-tables.c:
	Moved the encoding tables to their own place.

2001-02-22  Seth Nickell  <seth@eazel.com>
 
 	reviewed by: Gene Z. Ragan <gzr@eazel.com>
 
 	* acconfig.h:
 	* configure.in:
 
 	Add various mount system checks.
 	
 	* libathena-extensions/athena-cdrom-extensions.h:
 
 	Only do particular #defines for ioctl stuff if the system
 	doesn't already define them.
 	
 	* libathena-extensions/athena-volume-monitor.c:
 
 	Add Solaris compatible changes to the volume monitor, making
 	it build and function properly on Solaris.
 		
2001-02-22  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>
	
	Fixed bug 5681, Services icon on desktop may need
	better icon and text
	
	* src/athena-first-time-druid.c: (druid_finished):
	Change link icon to display hand.png

2001-02-22  Dan Mueth  <dan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Generally, I removed old cruft, added COPYING-DOCS, added
	a new HTML doc (athena-quick-reference), and updated
	the build stuff and spec file as necessary.

	* COPYING-DOCS: This is the GNU FDL, similar to COPYING.  It
	  should be installed with all modules with FDL'd docs.
	* Makefile.am: Added COPYING-DOCS to EXTRA_DIST
	* configure.in: Added athena-quick-reference 
	* help/Makefile.am: Added athena-quick-reference
	* help/htmldocs.make: Created this file.  This is the makefile
	  to suck in for html docs.  Be sure to use index.html as
	  your primary HTML file and put PNG images into figures/

	This stuff is Vera's new Athena Quick Reference doc in HTML
	format. <vera@eazel.com>  I purposefully left out two screenshots
	with the Eazel logo in them.
	* help/athena-quick-reference/C/Makefile.am: added
	* help/athena-quick-reference/C/figures/colors_small.png: added
	* help/athena-quick-reference/C/figures/emblems_small.png: added
	* help/athena-quick-reference/C/figures/ff_small.png:
	* help/athena-quick-reference/C/figures/find_small.png:
	* help/athena-quick-reference/C/figures/locbar_small.png:
	* help/athena-quick-reference/C/figures/menubar_small.png:
	* help/athena-quick-reference/C/figures/music_small.png:
	* help/athena-quick-reference/C/figures/sidebar_small.png:
	* help/athena-quick-reference/C/figures/softcat.png:
	* help/athena-quick-reference/C/figures/storage.png:
	* help/athena-quick-reference/C/figures/themes_small.png:
	* help/athena-quick-reference/C/index.html:
	* help/athena-quick-reference/C/athena-quick-reference-C.omf:
	* help/athena-quick-reference/Makefile.am:
	* help/athena-user-manual/C/athena-user-manual-C.omf: Updated
	* athena.spec.in: Added OMF files, Quick Ref, and COPYING-DOCS

	Removed this old stuff:
	* user-guide/C/Makefile.am: 
	* user-guide/C/html/license.html:
	* user-guide/C/img/custicon.png:
	* user-guide/C/img/full.png: removed
	* user-guide/C/img/locbar.png: 
	* user-guide/C/img/player.png:
	* user-guide/C/img/prefmenu.png:
	* user-guide/C/img/sidebar.png:
	* user-guide/C/img/viewmenu.png:
	* user-guide/C/athena-C.omf:
	* user-guide/C/sgml/athena.sgml:

	Added this notice so people don't add stuff in user-guide/
	* user-guide/NOTICE:

2001-02-22  Gene Z. Ragan  <gzr@eazel.com>
 
 	reviewed by: Pavel Cisler <pavel@eazel.com>
 
 	Fixed bug 4907, Can't drag from Athena to Netscape
 	
 	Fixed bug 5334, Can't drag file from Athena into
 	Netscape's attachment window
 	
 	Fixed bug 6563, Drag & Drop of files with non-alphanumeric
 	characters broken
 	
 	* libathena-extensions/athena-drag.c:
 	(add_one_netscape_url_list):
 	Make sure that only one item is added to the return
 	value. Netscape is only expecting one item and fails
 	if more than one item is in the list.
 	
 	(athena_drag_drag_data_get):
 	Rename add_one_url_list to add_one_netscape_url_list
 
 	(add_one_path_list):
 	Return a path, not a URI.
 	
2001-02-22  Arlo Rose  <arlo@eazel.com>

	* icons/hand.png:
	* icons/hand.svg:
	Added hand.png, deleted hand.svg

Thu Feb 22 04:13:13 2001  George Lebl <jirka@5z.com>

	Approval sucker: Maciej <mjs@eazel.com>

	* components/help/converters/gnome-man2html2/gnome-man2html.c
	  (scan_request): Fix bug #3334, by handling the ".' " troff request.

	* libathena-extensions/athena-directory-async.c
	  (athena_directory_async_state_changed): the unref could be
	  the last one, so don't access the directory afterwards.

2001-02-22  Arlo Rose  <arlo@eazel.com>

	* icons/Makefile.am:
	* icons/hand-72.png:
	* icons/hand-96.png:
	Trying to make the service icons consistent in Athena.
	Next stop, toolbar!

2001-02-22  Robey Pointer  <robey@eazel.com>

	reviewed by: Stephane Miller  <stephane@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (set_parameters_from_command_line), (main):

	Remove eazel-install's restrictions on doing an upgrade and
	downgrade at the same time, since it's perfectly capable of doing
	that (covering all bases) and it's useful to labs.

2001-02-22  Arlo Rose  <arlo@eazel.com>

	* icons/druid_header.png:
	* icons/druid_header_stretch.png:
	* icons/druid_sidebar.png:
	Tweaked images in druid to use my 3D logo, and
	blue shades rather than teal.

2001-02-21  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_create_dialog),
	(global_preferences_medusa_blocked_changed_callback),
	(global_preferences_create_search_pane),
	(global_preferences_medusa_state_changed_callback),
	(global_preferences_install_medusa_defaults):
	Fix bug 6415 - Change what appears in the medusa preference when
	medusa becomes blocked.
	Also made the default and actual value of the MEDUSA_BLOCKED be
	correct.  The boolean value was inverted.
	
	* libathena-extensions/athena-medusa-support.c:
	(athena_medusa_blocked): Call medusa to find out if its blocked.
	
2001-02-21  Darin Adler  <darin@eazel.com>

	reviewed by: Mike Engber <engber@eazel.com>

	Fixed bug 6839 (Athena crashes with a segmentation fault when
	clicking Edit->Athena Themes).
	
	* src/athena-theme-selector.c:
	(get_theme_description_and_display_name): Make a bad URI be
	non-fatal (not really needed for bug fix).
	(populate_list_with_themes): Pass the URI for the URI parameter,
	not the local path.

	Other stuff.

	* src/athena-sidebar.c: (athena_sidebar_update_buttons): Added
	a FIXME to some questionable code.

2001-02-21  John Harper  <jsh@eazel.com>

	* src/file-manager/fm-directory-view.c (activate_callback):
	deleted unused action_type variable

2001-02-21  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug I introduced in my last sorting change (sort order
	was incorrect when nodes are first inserted):

	* components/tree/athena-tree-view-private.h: added an
	`inserting_node' flag field to the view details. This is used
	to tell the sorting comparison function when the nodes it's
	trying to sort haven't yet been fully initialized

	* components/tree/athena-tree-view.c
	(athena_tree_view_insert_model_node): set the inserting_node
	flag around the call to athena_ctree_insert_node (). After
	the node is fully initialized, call
	athena_ctree_sort_single_node ()

	(ctree_compare_rows): when `inserting_node' is set, bail out
	with a nonsense value

	* libathena-extensions/athena-ctree.h,
	libathena-extensions/athena-ctree.c: reverted the change to
	insert_node
	(athena_ctree_sort_single_node): new function, reorders a
	given node, but no others

2001-02-21  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fix bug 6286 (get 3 directory loads instead of 1 when you activate
	file in directory view [as opposed to typing location]). This is
	mostly right, but there's still a relatively common case where we
	get a 2nd directory load. I'll have to write a bug report about
	that case, but it's no worse than before and quite a bit better.

	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_destroy): Stop monitoring. Also change the old
	monitoring code to use different "client" pointers so multiple
	monitors don't interfere with each other.
	(activate_callback): Stop monitoring when we get to the point of
	actually activating (unless we are opening through the shell).
	Also do some small cleanup to "command:" handling code and fix
	minor storage leak.
	(cancel_activate_callback): Stop monitoring if we cancel.
	(fm_directory_view_activate_file): Start monitoring so the load
	can be shared between all who need it. This is the same
	optimization done at the shell level.
	(load_directory): Use the new client pointer approach so multiple
	monitors don't interfere with each other.
	(finish_loading): Use the new client pointer approach so multiple
	monitors don't interfere with each other.
	(disconnect_model_handlers): Use the new client pointer approach
	so multiple monitors don't interfere with each other.
	(monitor_file_for_open_with): Use the new client pointer approach
	so multiple monitors don't interfere with each other.
	(monitor_file_for_activation): New function that monitors the
	file list so we don't get multiple directory loads.

	Fix tests now that gnome-vfs has a fix for bug 6798 (URI functions
	don't always treat domain names as case-insensitive) and fix bug
	6799 (athena_uris_match_ignore_fragments gives wrong result for
	URIs with trailing "/" characters).

	* libathena-extensions/athena-file-utilities.h:
	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_canonical_strip_fragment): New function.
	(uris_match): Use new function to handle fragments better.
	(athena_self_check_file_utilities): Update checks to
	expect fixes in gnome-vfs and here. Note that both bugs
	6798 and 6799 are now fixed.
	
	* help/.cvsignore:
	* help/athena-user-manual/.cvsignore:
	* help/athena-user-manual/C/.cvsignore:
	* omf-install/.cvsignore:
	Ignore generated files in some new directories.
	
2001-02-21  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* src/file-manager/fm-properties-window.c: (set_icon_callback):
	Property window now stores a uri (as opposed to a path) in
	metadata for custom icons - bug 6841.

2001-02-21  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>
	             John Sullivan <sullivan@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-directory-metafile-monitor.h:
	* libathena-extensions/athena-directory-metafile-monitor.c:
	(athena_metafile_monitor_initialize_class),
	(athena_metafile_monitor_get_epv),
	(athena_metafile_monitor_get_vepv),
	(athena_metafile_monitor_create_servant),
	(athena_metafile_monitor_initialize), (destroy),
	(athena_metafile_monitor_new), (corba_metafile_changed):
	Added implementation of monitors for directories to recieve
	notification when their metadata changes. This works across
	processes.

	* libathena-extensions/athena-directory.c:
	(athena_directory_destroy),
	(athena_directory_emit_change_signals):
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory-async.c:
	(metafile_read_mark_done), (metafile_read_start),
	(athena_directory_monitor_add_internal),
	(update_metadata_monitors),
	(athena_directory_monitor_remove_internal),
	(athena_directory_call_when_ready_internal),
	(athena_directory_cancel_callback_internal),
	(athena_async_destroying_file), (request_is_satisfied),
	(call_ready_callbacks):
	The state machine now uses monitors in the metadata server
	process.

	* libathena-extensions/athena-directory-metafile.c:
	(get_metafile), (athena_directory_is_metadata_read),
	(athena_directory_get_file_metadata),
	(athena_directory_get_file_metadata_list),
	(athena_directory_set_file_metadata),
	(athena_directory_set_file_metadata_list),
	(athena_directory_set_boolean_file_metadata),
	(athena_directory_set_integer_file_metadata),
	(athena_directory_copy_file_metadata),
	(athena_directory_remove_file_metadata),
	(athena_directory_rename_file_metadata),
	(athena_directory_register_metadata_monitor),
	(athena_directory_unregister_metadata_monitor):
	* libathena-extensions/athena-directory-metafile.h:
	-new calls for registering/unregistering monitors 
	-Metadata setters no longer return booleans.
	-misc cleanup of CORBA exception code (or lack thereof)

	* libathena-extensions/athena-file-private.h:
	* libathena-extensions/athena-file.c:
	(athena_file_is_self_owned), (destroy),
	(athena_file_get_parent_uri), (get_file_for_parent_directory),
	(athena_file_can_rename), (athena_file_get_gnome_vfs_uri),
	(rename_callback), (athena_file_rename),
	(athena_file_set_directory), (get_metadata_name),
	(athena_file_set_metadata), (athena_file_set_metadata_list),
	(athena_file_set_boolean_metadata),
	(athena_file_set_integer_metadata), (athena_file_get_uri),
	(athena_file_mark_gone), (athena_file_changed):
	-exposed (& renamed) is_self_owned in the private header.
	-metadata setters no longer emit changes (it's done by the server)

	* libathena-extensions/athena-metafile-server.idl:
	-metafile_changed now is passed a list of file names

	* libathena-extensions/athena-metafile.c:
	(athena_metafile_get_epv), (destroy), (corba_is_read),
	(corba_get), (corba_get_list), (corba_set), (corba_set_list),
	(corba_copy), (corba_remove), (corba_rename), (find_monitor_node),
	(corba_register_monitor), (corba_unregister_monitor),
	(call_metatfile_changed), (file_list_filler_ghfunc),
	(call_metafile_changed_for_all_files_mentioned_in_metafile),
	(call_metatfile_changed_for_one_file):
	* libathena-extensions/athena-metafile.h:
	- metafile setters now emit changes and do not return boolean values
	- added call_metafile_changed_for_all_files_mentioned_in_metafile

	* libathena-extensions/athena-stock-dialogs.c:
	(timed_wait_callback):
	Un-canelable timed wait dialogs now have an ok button
	which dismisses them.

	* libathena-extensions/athena-trash-directory.c:
	(find_directory_start):
	Slightly clarified the text in the infamous searching for text dialog.

2001-02-21  John Harper  <jsh@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6828 (Moving directories in tree view makes contents
	become top-level nodes):

	* components/tree/athena-tree-node.h,
	components/tree/athena-tree-node.c,
	components/tree/athena-tree-node-private.h

	(athena_tree_node_update_uri): new private function, updates
	the node's cached URI from its AthenaFile and updates the new
	is_toplevel flag

	(athena_tree_node_is_toplevel): new function, returns true if
	the node shouldn't have a parent node

	* components/tree/athena-tree-model.c: track nodes that have
	no parent but aren't top-level nodes. If suitable parents later
	appear the unparented nodes will be connected to them

	* components/tree/athena-tree-view.c,
	components/tree/athena-tree-view-private.h: do similar
	tracking of unparented nodes (but from the point of view of the
	view, not the model)

	[ Having both modules duplicate this similar functionality
	isn't ideal, but I don't see how to unify it ]


	Fixed bug 6820 (directory sort order is different in tree
	view):

	* components/tree/athena-tree-view.c (ctree_compare_rows):
	new function, set as the comparison function for tree views.
	It calls athena_file_compare_for_sort () on the files
	associated with the tree rows (with hardcoded type
	ATHENA_FILE_SORT_BY_NAME for now)

	* libathena-extensions/athena-ctree.c
	(athena_ctree_insert_node): for sorted insertions, link the
	inserted node into the tree before finding the correct place,
	then move it afterwards. This ensures that the comparison
	function is able to find the node pointers from the row
	pointers that it's given

2001-02-21  Rebecca Schulman  <rebecka@eazel.com>
	Remove the "backup unindexed search" preference for 1.0, which is
	bugzilla.eazel.com bug 6775.  We will not be doing backup
	searches, and with Ramiro's help redo preference changes more
	cleanly, and to be more compatible with his preference changes.

	reviewed by: Ramiro Estrugo <ramiro@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog),
	(global_preferences_install_home_location_defaults),
	(global_preferences_use_fast_search_changed_callback),
	(global_preferences_medusa_state_changed_callback),
	(global_preferences_install_medusa_defaults):
	* libathena-extensions/athena-global-preferences.h:
	Remove the old BACKUP_SEARCH preference, and add functions
	to install medusa preference defaults, and to synchronize
	the gconf value of the preference with the system configuration
	file used by medusa.
	
	* libathena-extensions/athena-preferences.c:
	(athena_preferences_set_boolean),
	(athena_preferences_get_boolean):
	Remove old system preferences calls

	* libathena-extensions/Makefile.am:	
	* libathena-extensions/athena-system-preferences.c:
	* libathena-extensions/athena-system-preferences.h:
	Remove these
	* libathena-extensions/athena-medusa-support.c:
	(athena_medusa_services_have_been_enabled_by_user),
	(athena_medusa_blocked), (athena_medusa_enable_services),
	(athena_medusa_add_system_state_changed_callback):
	* libathena-extensions/athena-medusa-support.h:
	Add this file to hide potentially ifdef'd out medusa 
	code.
	
	* src/file-manager/fm-search-list-view.c: (load_location_callback):
	* src/athena-complex-search-bar.c:
	(athena_complex_search_bar_get_location):
	Remove logic related to the BACKUP_SEARCH feature.

2001-02-21  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: moved documentation to
	%{prefix}/share/gnome/help/athena-user-manual/C/*
	and added gnugpl dir BUG 6837 

2001-02-21  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>
	
	Fixed bug 6465, Music view buttons stretch for songs
	with very long titles.
	
	* components/music/athena-music-view.c: (add_play_controls),
	(athena_music_view_set_album_image):
	Change the way that the play controls are added to the pack box
	so that they do not expand in strange ways or change their position
	when a custom image is added.
		
2001-02-21  Darin Adler  <darin@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>

	Busted the Tinderbox again! (Another attempt to fix it.)

	* libathena-extensions/athena-file-utilities.c:
	(athena_self_check_file_utilities): Changed the tests
	to match reality.

	* configure.in:
	* user-guide/Makefile.am:
	Turned the user guide off again. Dan explained that this
	is what he meant to do (I got it wrong).

2001-02-21  Eric Fischer <eric@eazel.com>

	* athena-installer/install-lib/Makefile.am:
	Use ln to make links into the real install/lib directory;
	add header file prerequisites

	* athena-installer/libtrilobite/Makefile.am:
	Use ln to make links into the real libtrilobite directory;
	fix header file prerequisites

	* athena.spec.in:
	Again, try to build the installer in tinderbox.  With luck,
	it'll actually work this time.

2001-02-21  Darin Adler  <darin@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	An attempt to fix the Tinderbox.

	* user-guide/Makefile.am: Add C subdir.

	Other changes.

	* libathena-extensions/athena-file-utilities.c:
	(athena_format_uri_for_display): Simplify to take advantage of
	the new gnome_vfs_get_local_path_from_uri, which rejects paths
	that have "#" characters in them.
	(athena_self_check_file_utilities): Add more test cases for
	host names that are case sensitive.

	* omf-install/.cvsignore: Ignore generated files in this new
	directory.

2001-02-21  Laszlo Kovacs <laszlo.kovacs@sun.com>
	* components/help/Makefile.am
	enabling Scrollkeeper to be the default help system

2001-02-21  Ramiro Estrugo  <ramiro@eazel.com>

	* README: Clarify the Mozilla version requirements.

2001-02-21 John Fleck <jfleck@inkstain.net>

	* components/help/converters/gnome-db2html2/sect-preparse.c
	add a test to gloss_term_append - if a glossentry has not id (a
	special case, but one that does on occasion occur) bail out of the
	function without trying to add it to the hash of glossentries
	fixes bug #6511
	
2001-02-20  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	* components/services/summary/eazel-summary-shared.c
	(parse_service), (parse_eazel_news_item),
	(parse_update_news_item),
	(build_services_glist_from_xml),
	(build_eazel_news_glist_from_xml),
	(build_update_news_glist_from_xml): Make this more robust against
	unusual data from the server. In particular, if the SERVICES list
	or other lists are emtpy, do not crash.

2001-02-21  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 5939, margins in text icons are weirdly proportioned.
	Fixed by distinguishing the rectangles for the anti-aliased and
	non-aa icon types
	
	* icons/i-regular.xml:
	added and tweaked both aa and non-aa text rectangles
	* libathena-extensions/athena-icon-factory.c:
	(get_themed_icon_file_path):
	get a separate text rectangle for anti-aliased mode if present
	
	fixed bug 6708, Change "support" link in menus, by moving and
	renamed the "support" item from the services menu to the help menu.
	This bug isn't finished yet, since we still have to rename the
	support uri, but it isn't ready on the service yet.
	
	* src/athena-service-ui.xml:
	removed support item
	* src/athena-shell-ui.xml:
	added customer service item
	* src/athena-window-menus.c: (help_menu_customer_service),
	(athena_window_initialize_menus):
	added code to handle the customer service command
	* src/athena-window-service-ui.c:
	(athena_window_install_service_ui):
	removed callback for the support command

2001-02-21  Dan Mueth  <dan@eazel.com>

	reviewed by: Mike Fleming  <mfleming@eazel.com>

	The old help tree, "user-guide/*", was broken in several ways.
	It assumed there was only one doc, called "user-guide", whereas
	we have multiple docs.  Plus it had odd subdirectories which
	are unusual and we don't want to use.  Plus the convention is
	to put all docs in a directory called "help" (modelled after
	$prefix/gnome/help) and figures in a subdir called "figures".
	So, I'm creating a new tree for this called "help" and installing
	the latest version of Vera's Athena User Manual with
	screenshots.  I also added a nifty makefile, help/docs.make,
	which we will use for all the SGML docs and translations
	to keep things tidy and working with low maintenance.

	* Makefile.am: Including help/
	* configure.in: Including help/ and subdirs
	* help/Makefile.am: added
	* help/docs.make: added nifty makefile to be used by all
	  SGML docs and translations of SGML docs
	* help/athena-user-manual/C/Makefile.am: added
	* help/athena-user-manual/C/figures/custicon.png: added
	* help/athena-user-manual/C/figures/full.png: added
	* help/athena-user-manual/C/figures/link.png: added
	* help/athena-user-manual/C/figures/locbar.png: added
	* help/athena-user-manual/C/figures/noread.png: added
	* help/athena-user-manual/C/figures/nowrite.png: added
	* help/athena-user-manual/C/figures/part.png: added
	* help/athena-user-manual/C/figures/player.png: added
	* help/athena-user-manual/C/figures/prefmenu.png: added
	* help/athena-user-manual/C/figures/sidebar.png: added
	* help/athena-user-manual/C/figures/viewmenu.png: added
	* help/athena-user-manual/C/figures/viewmusic.png: added 
	* help/athena-user-manual/C/athena-user-manual-C.omf: added
	* help/athena-user-manual/C/athena-user-manual.sgml: added
	* help/athena-user-manual/Makefile.am: added
	* user-guide/Makefile.am: turned off old user guide installation

2001-02-21  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/callbacks.c:
	(athena_service_install_download_progress):

	Workaround possible redundant 100% progress callback.

2001-02-21  Pavel Cisler <pavel@eazel.com>

	* components/help/help-method.c:

	Fix broken build - add the right includes that got dropped by
	GnomeVFS header file shuffle.

2001-02-20  John Harper  <jsh@eazel.com>

	reviewed by Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug where a renamed node in the tree view doesn't get
	resorted:

	* libathena-extensions/athena-ctree.c (set_node_info): if
	the ctree is in auto-sort mode, sort the branch containing the
	changed node


	Fixed a crash in the tree view when expanding nodes that have
	been moved across directories:

	* components/tree/athena-tree-node.c
	(athena_tree_node_remove_children): new function, unparents
	all children of the given node

	(athena_tree_node_destroy): emit a warning if the list of
	children is non-null (then call remove_children). Ideally the
	remove_children function should get called before the final
	unref of a directory node

	* components/tree/athena-tree-model.c
	(report_node_removed_internal): call
	athena_tree_node_remove_children before unref'ing the node


	Mostly fixed bug where expansion state hash table accumulates
	cruft over time (e.g. directories that no longer exist or got
	moved to locations where they can never be displayed):

	* components/tree/athena-tree-view.h
	(AthenaTreeViewDetails): added `view_node_to_uri_map' hash
	table. This is used to map view nodes to the URIs we believe
	they are displaying. This is necessary since by the time we
	find out about changes to nodes, the names of the underlying
	AthenaFile objects have often already been changed

	* components/tree/athena-tree-view.c
	(unlink_view_node_from_uri, link_view_node_with_uri,
	map_view_node_to_uri): functions accessing the new hash table

	(athena_tree_view_would_include_file): new function, returns
	true iff the given file may possibly appear in the tree view.
	Climbs through all parents of the file to do this

	(athena_tree_view_model_node_renamed_callback): only
	propagates the expansion state if the would_include function
	indicates that the new URI of the file would be included in the
	tree view

	* components/tree/athena-tree-model.c (report_node_changed):
	no need to suppress the `node_removed' signal when renaming the
	node (now that the view always deletes the expansion state of
	the correct URI)

	* libathena-extensions/athena-file.c,
	libathena-extensions/athena-file-private.h, 
	libathena-extensions/athena-file-utilities.c, 
	libathena-extensions/athena-file-utilities.h
	(athena_file_name_matches_hidden_pattern,
	athena_file_name_matches_backup_pattern): moved these
	functions from being private in athena-file to being public
	in athena-file-utilities


	Fixed tree view bug where moving nodes across directories still
	loses the expansion state: 

	* components/tree/athena-tree-model.c
	(athena_tree_model_directory_files_changed_callback):
	separated the cases of the file being deleted and it being
	moved across directories. In the move case emit the
	`being_renamed' signal so the expansion state gets propagated

	(athena_tree_view_remove_model_node, forget_view_node): moved
	the code to delete the expansion state from forget_view_node to
	athena_tree_view_remove_model_node - avoids deleting
	expansion state of nodes that will later be renamed. It may
	leave non-existent directories in the expansion state, but this
	is a lesser bug than losing the expansion state totally. Also,
	use the map_view_node_to_uri function to find the URI whose
	expansion state needs to be removed


	Fixed the bug where tree view icons often got chopped at top
	and bottom when they're drawn (if the icon height is greater
	than the font height). This means that fewer rows may fit in
	the same vertical space, but visually it's (imho) a huge
	improvement (I think this is bug 6085):

	* components/tree/athena-tree-view.c
	(athena_tree_view_initialize): call gtk_clist_set_row_height
	with the maximum of the font height and the icon height

	* libathena-extensions/athena-ctree.c (draw_row): always
	calculate row_center_offset locally, and do it in such a way
	that the text really is in the center of the row!


	Fixed bug 5165 - repeatedly expanding and collapsing an empty
	directory doesn't change how the node's icon is drawn after the
	first expansion:

	* libathena-extensions/athena-ctree.c (real_tree_expand,
	real_tree_collapse): before returning, call tree_draw_node on
	the node that changed state

2001-02-20  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/Makefile.am:
	* components/services/install/athena-view/callbacks.c:
	* components/services/install/athena-view/callbacks.h:
	* components/services/install/athena-view/forms.c:
	* components/services/install/athena-view/forms.h:

	Added callbacks.[ch] and forms.[ch] to split the ridiculously huge
	install view into smaller, more managable chunks.
	
	* components/services/install/athena-view/main.c: (quit_timer),
	(service_install_object_destroyed):
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (deps_destroy_foreach),
	(athena_service_install_view_destroy),
	(athena_service_install_view_finalize),
	(athena_service_install_view_initialize_class),
	(athena_service_install_view_initialize),
	(athena_service_install_view_update_from_uri_finish),
	(service_install_stop_loading_callback):
	* components/services/install/athena-view/athena-service-instal
	l-view.h:

	Turn the preflight dialog into a question asked inline.  Do some
	wacky hoop-jumping so that we do the right thing if the user
	leaves our view while we're waiting for a button press.  Turn off
	some of the distractions (progress bar, etc) while waiting for
	info and feedback.

2001-02-20  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-tabs.c: (draw_tab_label):
	fixed bug 6804, resizing sidebar crashes summary view.  Fixed by
	adding a check to not draw the label when it's position is past
	the right edge of the pixbuf.
		
2001-02-20  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed in part by: Robey Pointer  <robey@eazel.com>

	This patch fixes bug 6458, 5722, 6602, 6788 and 5826.
	Removed soft_depends from PacakgeData.

	This has some major changes in the logic, and (taaadaa) is fairly
	untestet because of the sorry state of the testservers these
	days. This will most likely no longer work with
	services.eazel.com, but only with the newest server code.
	
	* components/rpmview/athena-rpm-view-install.c:
	(get_detailed_errors_foreach), (get_detailed_errors):
	Fixed to parse PackageBreaks objects.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (prune_failed_packages_helper),
	(eazel_install_check_existing_packages), (get_softcat_info),
	(is_satisfied), (is_satisfied_from_package_list),
	(is_satisfied_features), (check_dependencies_foreach),
	(check_dependencies), (check_tree_helper),
	(check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency), (do_file_conflict_check),
	(do_dep_check_internal), (download_packages),
	(get_packages_with_mod_flag), (eazel_uninstall_upward_traverse),
	(eazel_uninstall_check_for_install), (eazel_uninstall_globber),
	(install_packages), (uninstall_packages):
	Ouput status in the tree dump.
	Improved the way I fail ALREADY_INSTALLED packages.
	Check the new package system error field in check_existing.
	Get_info don't check for fillflag to decide if softcat success was
	ok, since suites don't get the fillflag.
	Don't try and dedupe suite objects.
	Mark packages already installed with same version as CANCELLED.
	If a ALREADYINSTALLED package is cancelled due to install options
	(upgrade/downgrade), set a data field called "cancelled" to
	represent.
	Added a (currently not fully functional) check to see if a
	dependency is solved by the current work set (bug 6809).
	is_satisfied now uses is_satisfied_from_packages before checking
	if dependency is installed.
	Modified check_dependencies_foreach to pass around the package
	list.
	No longer do dependency check on cancelled packages (bug 6485).
	Don't package depcheck packages with suite_id, treat it's contents
	at comming toplevel packages.
	Output crack sentence when trying to revice PackageFeatureMissing
	breaks (file bug 6811)
	Don't file uniqueness or file conflict check suites.
	Fixed a bug in the feature_consistency, required a new query enum
	in eazelpackagesystem query call.
	Spewed out some comments.
	Always add children of a suite to K.
	Check download status (bug 5722)
	Commented out expand_package_suites.
	get_packages_with_mod_flag can now parse down into ->depends.
	Nicyfied debug output.
	
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_xfer_callback), (gnome_vfs_fetch_remote_file),
	(eazel_install_fetch_package):
	No longer use rpmvercmp.
	Define flag to make all downloads fail (to test failed downloads).
	Note when VFS is lying about bytes_copied.
	Removed some ancient code.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (eazel_install_packagedata_to_xml_int):
	Removed soft_depends.
	
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_db_locked),
	(eazel_package_system_rpm3_dbs_locked),
	(eazel_package_system_rpm3_open_dbs),
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(eazel_package_system_rpm3_query_foreach),
	(eazel_package_system_rpm3_query_requires_feature),
	(eazel_package_system_rpm3_query),
	(eazel_package_system_rpm3_verify):
	Did the db lock check voodoo.
	Added REQUIRES_FEATURE query enum.
	Loads features from a given file (bug 5826)
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_finalize), (packagedata_initialize),
	(packagedata_copy), (packagedata_fill_in_missing),
	(packagedata_remove_soft_dep), (packagedata_add_pack_to_depends),
	(eazel_install_package_name_compare), (packagedata_dump_int):
	Good bye soft_depends.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_load_implementation),
	(eazel_package_system_load_package), (eazel_package_system_query),
	(eazel_package_system_fail_all_packages),
	(eazel_package_system_install), (eazel_package_system_uninstall),
	(eazel_package_system_verify), (eazel_package_system_initialize),
	(eazel_package_system_new_with_id):
	Fixed 6788.
	Added REQUIRES_FEATURE query enum.

	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_get_info):
	Fixed some suite_id majick.

2001-02-20  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6029, No option to mount zip drive in desktop menu.
	Fixed bug 6751, Athena does not detect all of my removable disks.
	Fixed bug 6194, SCSI CD-ROM drives are not displayed on desktop.
	Fixed bug 6396, cd-rom not detected
	
	Special thanks to liblit@acm.org for persisting and looking at the
	code. The check permissions code is an artifact from when we were
	considering having a mount daemon.  I don't think it is needed at all
	because the volume monitor is not running as root.  I wil mark
	the bugs fixed and wait for status but I think this will work.
	
	* libathena-extensions/athena-volume-monitor.c:
	(mount_volume_ext2_add), (mount_volume_udf_add),
	(mount_volume_vfat_add), (mount_volume_msdos_add):
	Remove old check_permissions code.

2001-02-20  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6785 ("Trash" should be capitalized)

	I grepped Athena sources for "the trash" and replaced
	it with "the Trash". Let me know if you can think of
	any references to the Trash that don't start with "the".

	* libathena-extensions/athena-file-operations.c:
	(build_error_string), (confirm_empty_trash):
	* src/file-manager/fm-directory-view.c:
	(fm_directory_view_confirm_deletion), (confirm_delete_from_trash),
	(report_broken_symbolic_link):
	* src/file-manager/athena-desktop-icon-view-ui.xml:
	* src/file-manager/athena-directory-view-ui.xml:

2001-02-20  Dan Mueth  <dan@eazel.com>

	* user-guide/C/Makefile.am: Changed so only a warning is
	given if ScrollKeeper is not installed.

2001-02-20  Mike Fleming  <mfleming@eazel.com>

	reviewed by: <ian@eazel.com>

	Added "x-directory/webdav-prefer-directory" for bug 5325

	* components/mozilla/Athena_View_mozilla.oaf.in:
	* src/Athena_shell.oaf.in:

2001-02-15  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <darin@eazel.com>

	Part of 2057: URI's with fragments behave oddly

	* libathena-extensions/athena-file-utilities.c:
	(athena_format_uri_for_display), (uris_match),
	(athena_uris_match), (athena_uris_match_ignore_fragments),
	(athena_self_check_file_utilities):
	* libathena-extensions/athena-file-utilities.h:

	athena_format_uri_for_display returns "file:" URI's if the URI
	in question has a fragment, other file: URI's get translated into paths
	Also no longer calls the evil gnome_vfs_unescape_string_for_display (see
	bug 6694)

	Also fixes bug 6722: re-entering search query results in location bar
	results in error dialog

	Added athena_uris_match_ignore_fragments function which strips
	fragments before comparing.  Also added test cases.

	* components/tree/athena-tree-view.c:
	(got_activation_uri_callback):
	* src/athena-window-manage-views.c:
	(viewed_file_changed_callback):

	Fixed two locations that made the implicit assumption that
	athena_file_get_uri should return a URI that's directly comparable
	to the current navigation location.  Other cases may still lurk.

	* src/athena-window-menus.c:

	A few calls to gnome_vfs_get_local_path_from_uri that should have
	been gnome_vfs_get_uri_from_local_path.  Eliminating dumb behaviour
	in gnome_vfs_get_local_path_from_uri exposed them.

2001-02-20  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fixed bug 5676 (Moving a directory with multiple nested
	directories causes improper locations to be displayed):

	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory.c:
	(athena_directory_moved_internal): Made this build a list of the
	affected files.
	(athena_directory_moved): Send a changed notice to each affected
	file.
	(athena_directory_notify_files_moved): Send a changed notice to
	each affected file, but share code to avoid sending changed
	notices twice for any directory.
	
	Fixed some callers that were assuming a
	gnome_vfs_get_local_path_from_uri would return a non-NULL
	value. This is not safe to assume just because
	gnome_vfs_uri_get_local returns true.

	* components/music/athena-music-view.c: (read_id_tag): Use
	gnome_vfs_get_local_path_from_uri to define what a local path is.
	The old code used a mix.
	* libathena-extensions/athena-file.c:
	(athena_file_can_rename): Simplified code to use
	gnome_vfs_get_local_path_from_uri to define what a local path
	is. The old code used a mix.
	* libathena-extensions/athena-thumbnails.c: (make_thumbnails):
	Added NULL checks after calls to
	gnome_vfs_get_local_path_from_uri.
	* src/athena-sidebar.c: (uri_is_local_image): Took out redundant
	check. The definition of local image we want here is: "uses a
	standard file: URI".
	* src/file-manager/fm-directory-view.c:
	(fm_directory_link_type_in_selection): Fixed bug where it would
	only look at the first item in the selection. Simplified logic.
	(is_link_type_special): Added a new function.
	(special_link_in_selection): Instead of calling
	fm_directory_link_type_in_selection, copied it. The problem with
	the other approach is that it was reading each link file three
	time to rule out each of the three special link types.

	Other changes.

	* libathena-extensions/athena-volume-monitor.c:
	(athena_volume_monitor_get_volume_name),
	(modify_volume_name_for_display): Marked "Unknown" for
	localization.
	
	* libathena-extensions/athena-file-utilities.c:
	* libathena-extensions/athena-icon-factory.c:
	* src/file-manager/fm-icon-view.c:
	Added 2001 to the copyright since we modified these recently.

2001-02-20  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_renaming_file): Middle-truncate
	really long file names to avoid an error dialog
	that is much wider than the screen.

2001-02-20  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-location-bar.c: (try_to_expand_path):
	fixed bug 6717, problem editing a uri with a '#' in the middle,
	by adding a check to the auto-complete code to not substitute
	zero length strings.
	
2001-02-20  Andy Hertzfeld  <andy@eazel.com>

	* components/text/athena-text-view.c: (file_close_callback),
	(done_file_read):
	fixed bug 6732, can't unmount volumes after viewing text files;
	fixed by closing the file in done_file_read.
	
2001-02-20  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/file-manager/athena-indexing-info.c:
	(show_indexing_info_dialog):
	Complete fix for 6417, by swapping Vera's text into the
	new index status dialog

2001-02-20  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6384, Athena program chooser uses
	"athena-mime-type-capplet" to launch capplet
	
	* libathena-extensions/athena-program-chooser.c:
	(launch_mime_capplet):
	Rename capplet to "file-types-capplet"

2001-02-20  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fixed bug 5482 (If you've esc'd out of an icon stretch, change
	directories, then come back, the icon is the pre-esc'd stretched
	size)

	* libathena-extensions/athena-icon-container.c:
	(undo_stretching): Pass TRUE instead of FALSE so the "undone" size
	gets stored in metadata. Without this, we end up with the icon at
	the stretched size.

2001-02-20  Richard Boulton <richard@tartarus.org>

	reviewed by: Ali Abdin <aliabdin@aucegypt.edu>

	* components/help/converters/gnome-db2html2/*
	Fix to bug 6700; doesn't include config.h unless HAVE_CONFIG_H
	is defined, and has correct instructions for compiling standalone.

2001-02-20  Kjartan Maraas  <kmaraas@gnome.org>

	* components/services/summary/athena-summary-view.c: Fix some
	typos in strings.
	
2001-02-20  Maciej Stachowiak  <mjs@eazel.com>

	Assorted build twiddling.
	
	* components/services/install/command-line/Makefile.am: Remove
	-I/usr/include/rpm

	* components/services/install/athena-view/Makefile.am: Likewise.
	
	* components/services/install/athena-view/athena-service-install-view.c:
	Remove gratuitous include of rpm header.

	* components/services/inventory/Makefile.am: Formatting tweaks.
	
	* components/services/summary/*: flatten this whole directory:
	summary/lib => summary
	summary/athena-view => summary
	summary/athena-view/test => summary
	summary/athena-view/icons/gray_tab_pieces =>summary/athena-view/icons
	
	* configure.in: Adjust for flattening of
	components/services/summary
	
	* libathena-extensions/athena-clickable-image.c
	(adjust_coordinates_for_window): Formatting tweak.

	* user-guide/gnugpl/.cvsignore: Silence cvs.

2001-02-20  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/server/Makefile.am: Remove
	-I/usr/include/rpm

2001-02-19  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (install_message_new), (generate_install_form),
	(athena_service_install_preflight_check),
	(athena_service_install_done):

	Hide the install view's progress header until downloading begins.
	Try to use athena_view_go_back, though it appears to not be
	functional yet.
	
2001-02-20  Rebecca Schulman  <rebecka@eazel.com>
	Complete bug 6416, to add dialogs to explain
	that searches will be slow when medusa is disabled or 
	blocked.  The work was previously complete, but 
	I've swapped in Vera's text, and added an 
	info_dialog_with_details to the stock dialogs.

	reviewed by: Gene Ragan <gzr@eazel.com>

	* libathena-extensions/athena-stock-dialogs.c:
	(details_dialog_clicked_callback),
	(athena_show_info_dialog_with_details),
	(athena_show_error_dialog_with_details):
	* libathena-extensions/athena-stock-dialogs.h:
	* src/file-manager/fm-search-list-view.c:
	(display_system_services_are_blocked_dialog),
	(display_system_services_are_disabled_dialog):

2001-02-20  Rebecca Schulman  <rebecka@eazel.com>
	Fix bugzilla.eazel.com 6414 to add prefence to athena
	to enable/disable medusa

	* libathena-extensions/athena-global-preferences.h:	
	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_create_dialog):
	Add the fast search preference pane, visibility level,
	change SEARCH_METHOD -> BACKUP_SEARCH

	* libathena-extensions/athena-system-preferences.c:	
	* libathena-extensions/athena-system-preferences.h:
	* libathena-extensions/Makefile.am:
	(athena_is_system_preference),
	(athena_system_preference_get_boolean),
	(athena_system_preference_set_boolean):
	Add setters and getters for system preferences that are not
	managed by gconf.  The current set and get functions
	turn on and off medusa services

	* libathena-extensions/athena-preferences.c:
	(athena_preferences_set_boolean),
	(athena_preferences_get_boolean):
	Use the new system preference setters and getters instead of the standard
	ones if the preference is not managed by gconf
	
	* src/file-manager/fm-search-list-view.c: (load_location_callback),
	(display_system_services_are_blocked_dialog):
	* src/athena-complex-search-bar.c:
	(athena_complex_search_bar_get_location):
	change SEARCH_METHOD -> BACKUP_SEARCH

2001-02-19  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: John Harper  <jsh@eazel.com> 

	Fixed bugs 3743 (Summary view gives the same vague error message
	for many different causes), 3972 (If user can't connect to
	service, they end up with gray content view), 5973 (blank summary
	view after install view finishes) and 6166 (Summary Login dialog
	does not have initial focus) and 6018 (Athena returns to wrong
	directory if services are unavailable). Also did much code
	cleanup, and made the service and featured download icons in the
	summary view prelighting and clickable. Fixed many other nits as
	well.

	* components/services/athena-dependent-shared/eazel-services-extensions.h,
	components/services/athena-dependent-shared/eazel-services-extensions.c
	(eazel_services_clickable_image_new_from_uri): Convenience wrapper
	to make a new clickable image from a URI.
	* components/services/athena-dependent-shared/eazel-services-footer.c
	(eazel_services_footer_update): Clear the footer before updating,
	instead of just dumping the new items in along with the old ones.

	* components/services/trilobite/libtrilobite/trilobite-core-network.h,
	components/services/trilobite/libtrilobite/trilobite-core-network.c:
	Adjusted formatting, fixed headers.

	* components/services/trilobite/libtrilobite/trilobite-file-utilities.h,
	components/services/trilobite/libtrilobite/trilobite-file-utilities.c:
	Cut 'n' pasted some useful code from libathena-extensions to
	avoid depending on it, whee.
	* components/services/trilobite/libtrilobite/Makefile.am: Added
	above to the build.

	* components/services/trilobite/libtrilobite/trilobite-redirect.h,
	components/services/trilobite/libtrilobite/trilobite-redirect.c:
	(trilobite_redirect_fetch_table_async,
	trilobite_redirect_fetch_table_cancel): Asynchronous version of
	redirect fetching code.
	(redirect_fetch_callback): Helper function.
	(trilobite_redirect_parse_xml): Null terminate buffer properly or
	XML parsing code will get confused.
	(trilobite_redirect_fetch_table): Removed the old synchronous code
	since now no one is using it.

	* components/services/summary/lib/eazel-summary-shared.h,
	components/services/summary/lib/eazel-summary-shared.c:
	(eazel_summary_fetch_data_cancel, eazel_summary_fetch_data_async):
	Asynchronous version of summary fetching code.
	(summary_data_fetch_callback): Helper function.
	(eazel_summary_data_parse_xml): Same null termination trick as for
	redirects.
	(parse_summary_xml_file): Removed old synchronous code since now
	no one is unsing it.

	* components/services/summary/athena-view/main.c (main): Set
	user agent to trilobite user agent; intialize gnome-vfs.
	
	* components/services/summary/athena-view/athena-summary-dialogs.h,
	components/services/summary/athena-view/athena-summary-dialogs.c 
	(athena_summary_show_login_failure_dialog): Renamed from
	`athena_summary_login_failure_dialog'
	(athena_summary_show_error_dialog): Renamed from
	`generate_error_dialog'.
	(athena_summary_show_login_dialog): Renamed from
	`generate_login_dialog'.
	(error_dialog_cancel_cb): Go back instead of (incorrectly) trying
	to go back to the user's homedir.
	(set_dialog_parent): Do the magic coordinate adjustment like
	gnome_dialog_set_parent, but do not set it transient, or it will
	not get focus in click to focus mode.

	* components/services/summary/athena-view/athena-summary-callbacks.c:
	(authn_cb_failed): Adjust to above renaming.
	* components/services/summary/athena-view/athena-summary-footer.c 
	(footer_item_clicked_callback): Ditto.
	* components/services/summary/athena-view/athena-summary-menu-items.c: 
	(bonobo_login_callback): Ditto.

	* components/services/summary/athena-view/athena-summary-view-private.h:
	Removed unused fields. Added async handles for redirect and summary XML 
	fetch.

	* components/services/summary/athena-view/athena-summary-view.c:
	(services_button_callback_data_free, summary_view_button_callback,
	goto_uri_on_clicked, summary_view_button_new,
	summary_view_link_image_new): Cleaned up summary view button code,
	added code for the clickable icons and refactored a bit.
	(create_header): Start out saying "Connecting to Eazel
	Services..." instead of blank, and don't call `update_header' from
	here.
	(update_footer): fix incorrect polarity of offline and online.
	(create_footer): remove call to update_footer; leave offline items
	in place until connected.
	(create_news_pane, create_services_list_pane,
	create_featured_downloads_pane): Do not call corresponding update
	func, updating is now separate from creating.
	(generate_service_entry_row, generate_update_news_entry_row): Make
	icons clickable.
	(update_summary_form): New function to update the existing summary
	view with new data, to avoid recreating even the fixed widgets
	from scratch all the time.
	(create_summary_form): Do not destroy all widgets at the
	beginning. Remove some useless widgetry.
	(athena_summary_view_initialize): Create the widgetry but do not
	fill it with data.
	(athena_summary_view_destroy, summary_fetch_callback,
	redirect_fetch_callback, cancel_load_in_progress),
	athena_summary_view_load_uri, summary_load_location_callback):
	Change things around so loading of the summary data is
	asynchronous.
	(summary_stop_loading_callback): Handle "stop_loading".

2001-02-19  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Added auto-prelighting feature to AthenaClickableImage, and
	fixed a major bug that occurs for clickable images in scrolled
	areas.
	
	* libathena-extensions/athena-clickable-image.h,
	libathena-extensions/athena-clickable-image.c: 
	(athena_clickable_image_set_prelight): New public API call that
	allows for automatic prelight handling direct in
	AthenaClickableImage; made it settable because some users of
	this code want to manually prelight with an alternate image.
	(athena_clickable_image_set_up_pixbufs): helper function for the
	above that keeps track of the normal and prelit buffers.
	(label_enter, label_leave): When in prelight mode, switch images
	on enter and leave. Also, remove unnecessary queue_draw calls.

	(adjust_coordinates_for_window, ancestor_enter_notify_event,
	ancestor_leave_notify_event, ancestor_motion_notify_event): Do
	some coordinate adjustments so that if the AthenaClickableImage
	is in a scrolled area with NO_WINDOW widgets all the way in
	between, we do an appropriate coordinate adjustment. This should
	also handle other containers that put their children in a
	different window than their own. This was breaking for the summary
	view when I set it to use clickable images for the service icons.
	
	* libathena/athena-view-standard-main.c
	(athena_view_standard_main_multi): Do a g_thread_init to make
	views that use gnome-vfs happy.

2001-02-18  Ian McKellar  <ian@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* libathena-extensions/athena-mime-actions.c:
	* libathena-extensions/athena-mime-actions.h:
	* src/athena-window.c: (load_view_as_menu_callback):
	Removed all the code related to Gnome-VFS sub-methods in Athena.
	(Bug 5086)

2001-02-18  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	Fixed bug 6681 ; make eazel-install output more machine parseable
	by adding option and always return !0 on any failure.
	
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal),
	(eazel_download_progress_signal), (eazel_install_progress_signal),
	(download_failed), (something_failed),
	(eazel_preflight_check_signal), (dep_check), (md5_check_failed),

2001-02-19  Simos Xenitellis  <simos@hellug.gr>

	* configure.in: Added el to ALL_LINGUAS.

2001-02-18  Michael K. Fleming  <mfleming@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(try_transform_athena_uri_to_file_scheme),
	(view_load_location_callback),
	(should_uri_navigate_bypass_athena):

	Bug 4302: links in HTML help don't work.

	Now they do.  Since the "gnome-help:" scheme stuff doesn't know
	how to deal with files below the root and its to convoluted to fix,
	the Mozilla component discovers if a gnome-help scheme isgoing to be
	transformed into a file scheme and then redirects athena to that
	URI.  This means the full path to the HTML file appears in the location
	bar, just like in the old gnome help browser

2001-02-18  Darin Adler  <darin@eazel.com>

	* components/mozilla/athena-mozilla-embed-extensions.cpp:
	Get rid of initialization of nsString object to NULL
	to fix Tinderbox.

2001-02-17  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <ramiro@eazel.com>

	Misc Mozilla changes.

	Bug 6542 -- Throbber keeps spinning
	Pages without network activity would never report_load_complete.  Switched
	to using net_start and net_stop to control throbber like galeon (didn't
	I do this before?).  Note that bug 6736 means the throbber might
	cut out early.  Oh well, the stop button isn't really hooked up anyway.

	Bug 6544 -- Crash while navigating help

	Caused by make_full_uri_from_relative going beyond a buffer.  Also added
	test case.

	Also fixed up logic in mozilla_dom_mouse_click_callback related to
	translating URI's that we know how to handle ourself but can't
	be handled by mozilla directly without intervention (eg, eazel-services,
	help URI's)

	Also removed mistaken cancel_pending_vfs_operation in update_athena_uri

	Also did some cleanup/rearranging of the async athena_view wrappers

	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize),
	(mozilla_location_callback), (mozilla_net_start_callback),
	(mozilla_net_stop_callback), (mozilla_dom_mouse_click_callback),
	(vfs_open_callback), (update_athena_uri),
	(make_full_uri_from_relative), (test_make_full_uri_from_relative),
	(dispatch_report_location_change):

	* src/athena-sidebar.c: (add_command_buttons):
	Fixed improper assumption that athena_file_is_local being TRUE
	means gnome_vfs_get_local_path will return a file path.  The "local"
	concept seems to apply to expected latancy, not URI schemes.  This
	was causing assertion failures when browsing to help: schemes (as
	noted in the comments to bug 6544)
	

2001-02-17  Richard Boulton <richard@tartarus.org>

	reviewed by: Ali Abdin <aliabdin@aucegypt.edu>

	* components/help/converters/gnome-db2html2/gdb3html.c
	* components/help/converters/gnome-db2html2/sect-elements.c
	* components/help/converters/gnome-db2html2/toc-elements.c
	Fix format string vulnerabilities, see bug 6702.  Fixes
	segfault when % character occurs in input files.

2001-02-17  Dan Mueth  <dan@eazel.com>

	reviewed by: Eskil

	Updated toplevel docs data file. Updated and added FDL/GPL
	licenses. Added OMF file for Athena User Guide.

	* Makefile.am:  Adding omf-install/
	* components/help/topleveldocs.xml: Updated toplevel docs
	* configure.in: Adding omf-install and user-guide/gnugpl
	* omf-install/Makefile.am: Added for OMF files
	* user-guide/C/Makefile.am: Updated for OMF file
	* user-guide/C/athena-C.omf: Added this OMF file
	* user-guide/Makefile.am: Added gnufdl/
	* user-guide/gnufdl/gnufdl.sgml: Updated
	* user-guide/gnugpl/Makefile.am: Added this file
	* user-guide/gnugpl/gnugpl.sgml: Added this file, GPL

2001-02-17  Kjartan Maraas  <kmaraas@gnome.org>

	* src/file-manager/fm-search-list-view.c: Fix typo.
	
2001-02-16  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6689, Segmentation fault from volume_in_black_list after
	the death of the desktop.

	* src/file-manager/fm-desktop-icon-view.c: (volume_in_black_list):
	Add an assert to catch a NULL icon view being passed in.  We need to
	find out why this happens if it ever does.
	
	* src/athena-application.c: (window_can_be_closed),
	(is_last_closable_window), (volume_unmounted_callback):	
	Handle single window case in the code where we close the windows
	the are displaying the contents of the unmounted volume.  In the case
	of a single window, direct it back to the default home directory.

2001-02-16  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar-tabs.c: (draw_one_tab_themed),
	(draw_or_layout_all_tabs):
	fixed bug where the left edge of a sidebar tab wasn't
	prelighting correctly when the one before it was active.
	
2001-02-16  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fix bug 4070 (Repeated clicks of BACK cause core dump):
	
	* src/athena-window-manage-views.c:
	(viewed_file_changed_callback): Use end_location_change instead,
	since cancel_location_change just does extra "go back to old view"
	that we don't need.
	(cancel_location_change): A little more sanity checking. Not sure
	if it really helps. The other changes should fix the bug.
	(begin_location_change): Use end_location_change to get rid of any
	previous change in progress since cancel_location_change just does
	extra "go back to old view" that we don't need.
	(report_location_change_callback): Use end_location_change to get
	rid of any previous change in progress since
	cancel_location_change just does extra "go back to old view" that
	we don't need.

	* src/file-manager/fm-list-view.c: (get_list_if_exists),
	(fm_list_view_clear): Don't create a list just to clear it.
	Crashed here while I was trying to work on the other bug.
	
2001-02-16  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	Fixed bug 6724 (implement Vera's new text &
	organization for Preferences)

	There are a few open issues still, but they can be
	handled one at a time.

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_create_dialog),
	(global_preferences_install_sidebar_panel_descriptions):
	Tweak text, rework some comments, reorganize.

	* libathena-extensions/athena-program-chooser.c:
	(repopulate_program_list): Reinstated a one-line fix
	that was accidentally merged away earlier.

2001-02-16  Robey Pointer  <robey@eazel.com>

	* athena.spec.in:

	Don't reference the three files that used to be in top/.

2001-02-16  Andy Hertzfeld  <andy@eazel.com>

	* components/image-viewer/athena-image-view.c:
	(zoomable_zoom_to_fit_callback), (rezoom_control),
	(control_size_allocate_callback), (image_fits_in_container),
	(scrolled_window_size_allocate_callback),
	(scrollable_control_factory):
	fixed a bunch of problems in the image view, including making
	the initial shrink-to-fit feature work again, made unneccessary
	scroll bars go away by using GTK_POLICY_AUTOMATIC, improved the
	scaling to Arlo's taste by using GDK_INTERP_BILINEAR, and tweaked
	the scale factors, plus other clean-ups.
	
	* src/athena-zoom-control.c: (create_zoom_menu_item):
	fixed bug 6288, bogus zoom levels displayed in zoom control, by making
	the rounding algorithm used in the menu consistent with the one
	used in the control.
	
2001-02-16  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 6477 (no way for intall view to send user "back where
	they came from") by adding a "go back" command for views.
	
	* libathena/athena-view-component.idl: Add "go back".
	* libathena/athena-view.h:
	* libathena/athena-view.c: (athena_view_go_back): Add "go
	back".
	* src/athena-view-frame-private.h:
	* src/athena-view-frame-corba.c: (go_back),
	(impl_Athena_ViewFrame_go_back): Add "go back".
	* src/athena-view-frame.h:
	* src/athena-view-frame.c:
	(athena_view_frame_initialize_class),
	(athena_view_frame_go_back): Add "go back".
	* src/athena-window-manage-views.c: (go_back_callback): Add code
	to either go back or go home.
	
	* src/athena-window-toolbars.c:
	(back_or_forward_button_pressed_callback): Formatting tweak.

2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Mike Engber <engber@eazel.com>

	* libathena-extensions/athena-wrap-table.c:
	(wrap_table_get_content_dimensions):
	Fix bug 6683.  Bottom row is cut off in backgrounds/emblems dialog.
	
2001-02-16  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(check_no_two_packages_has_same_file):
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_file_list):
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_initialize),
	(remove_directories_from_provides_list), (eazel_softcat_get_info):

	Nobody wants to review my patch because everyone hates me.  This
	fixes the weird file/directory checks we were doing by using the
	new softcat fields to determine which ones are directories.  No
	more guesswork.  Also there's a softcat bug which causes the file
	list to sometimes contain repeated filenames, so this patch does a
	workaround for that too.

	* components/services/trilobite/doc/gconf.txt:

	Fix my dumb typo: jump-url is not a bool.
	
2001-02-16  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6606, only show user-mountable volumes in Disks menu
		
	* libathena-extensions/athena-volume-monitor.c:
	(has_removable_mntent_options):
	Utility function to check the mntent structure for options
	that we have determined will do the best job of guessing that
	a volume is removable.
	
	(get_removable_volumes),
	(volume_is_removable), (get_current_mount_list),
	(mount_volume_add_filesystem), (open_cdda_device):
	Did some code cleanup.

2001-02-16  Darin Adler  <darin@eazel.com>

	Fix bug 6435 (report_location_change does not record in history).
	
	* src/athena-window-manage-views.c:
	(report_location_change_callback): Use change type of STANDARD
	instead of RELOAD.
	
2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/athena-mozilla-embed-extensions.cpp:
	Restore the original cast and lose the const.  Remove an unused
	variable.
	
2001-02-16  Andy Hertzfeld  <andy@eazel.com>

	removed the translation text services from the build, since
	they are not ready for commercial release.  Also, made the
	google and webster services localizable.  This also fixes
	bug 6704, translation doesn't work with large files.

	* components/text/athena-text-view.c: (add_one_service):
	made it use the localization framework for the menu label and
	tooltip
	
	* components/text/services/Makefile.am:
	* components/text/services/english_to_french.xml:
	* components/text/services/french_to_english.xml:
	removed the translation services
	
	* components/text/services/google.xml:
	* components/text/services/webster.xml:
	made the selection-based services localizable
	
	* po/POTFILES.in:
	added the selection-based services
	
2001-02-16  Robey Pointer  <robey@eazel.com>

	* components/mozilla/athena-mozilla-embed-extensions.cpp:

	Fix build bustage by breaking cast into two pieces (weird C++ism).

2001-02-16  Josh Barrow  <josh@eazel.com>

	* docs/smoketests.html:
	Made a few corrections

2001-02-16  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Finish fixing bug 6286 (need to re-apply optimization where we do
	a single directory load):

	* src/athena-window-manage-views.c: (begin_location_change): Do
	the force_reload work in here. We want it on all 4 kinds of
	location change (forward, back, new location, reload). Other
	browsers don't do reload on back, so we may want to change this at
	some point.
	(athena_window_reload): Remove the old code to invalidate from
	here now that it's done in begin_location_change.

	* src/file-manager/fm-directory-view.c: (load_location_callback),
	(load_directory), (finish_loading), (filtering_changed_callback):
	Remove the old code to do force_reload. The AthenaDirectory part
	of triggering a reload is now handled by the shell.

	* libathena-extensions/athena-directory.h:
	* libathena-extensions/athena-directory.c:
	(athena_directory_file_monitor_add): No force_reload parameter
	any more.
	(athena_directory_force_reload): New separate call used to force
	a reload. A method call so subclasses can implement.
	(athena_self_check_directory): Removed the FALSE force_reload
	argument to file_monitor_add.
	* libathena-extensions/athena-vfs-directory.c:
	(vfs_file_monitor_add): No force_reload parameter any more.
	(vfs_force_reload): Call through to
	athena_directory_force_reload_internal to do the real work.
	(athena_vfs_directory_initialize_class): Install the new
	force_reload function.
	* libathena-extensions/athena-merged-directory.c:
	(merged_file_monitor_add): No force_reload parameter any more.
	(merged_force_reload): Tell all of the real directories to force a
	reload.
	(monitor_add_directory): No force_reload to track any more.
	(athena_merged_directory_initialize_class): Install the new
	force_reload function.
	
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory-async.c:
	(athena_directory_force_reload_internal): Change the name of
	this function, since there's now a public function that is named
	athena_directory_force_reload.
	
	* libathena-extensions/athena-file-private.h:
	* libathena-extensions/athena-file.c:
	(athena_file_get_all_attributes): Made a separate call so other
	parts of the framework can use it.
	(athena_file_invalidate_all_attributes): Use the new call.
	
	* components/tree/athena-tree-model.c:
	(athena_tree_model_monitor_add),
	(athena_tree_model_node_begin_monitoring_no_connect): Use the
	new force_reload call. The old one had more granularity and thus
	forced less to be reloaded, but it's OK to do a little more here.
	
	* libathena-extensions/athena-trash-monitor.c:
	(athena_trash_monitor_initialize): Removed the FALSE
	force_reload argument to file_monitor_add.

	Other stuff:
	
	* libathena-extensions/athena-directory-metafile.c:
	(get_metafile), (athena_directory_get_file_metadata),
	(athena_directory_get_file_metadata_list),
	(athena_directory_set_file_metadata),
	(athena_directory_set_file_metadata_list),
	(athena_directory_copy_file_metadata),
	(athena_directory_remove_file_metadata),
	(athena_directory_rename_file_metadata): Moved FIXMEs around.
	Pass NULL instead of &ev when calling bonobo_object_release_unref
	since we don't really want to do anything different if there's
	some kind of error.
	
	* athena-installer/install-lib/.cvsignore:
	* athena-installer/libtrilobite/.cvsignore:
	Gotta create these files when you make new directories.

	* README: Change xml-i18n-tools to mention the correct branch.

2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	* components/mozilla/Makefile.am:
	* components/mozilla/bonobo-extensions.c:
	* components/mozilla/bonobo-extensions.h:
	New files.  Cut and paste from athena-extensions to workaround
	licensing issues.
	
	* components/mozilla/main.c: (mozilla_object_destroyed):
	Mike Fleming added a nice feature that caches the mozilla process
	by delaying exit.  This makes jumping from web page to web page
	much faster.  However, it makes it harder to debug the mozilla
	component because it sticks around for a while and killing it by
	hand doesnt allow for clean shutdown.  So I added an debug
	environment variable that can be set to turn the delayed exit off.
	
	* components/mozilla/mozilla-events.cpp: Include the mozembed
	private header.  Im not quite sure why we were declaring the
	prototype found thre ourselves.
	* components/mozilla/athena-mozilla-content-view.c:
	(athena_mozilla_content_view_initialize),
	(charset_encoding_changed_callback),
	(encoding_menu_data_free_cover),
	(mozilla_view_create_charset_encoding_submenu),
	(mozilla_view_merge_menus), (bonobo_control_activate_callback),
	(mozilla_title_changed_callback), (mozilla_location_callback),
	(mozilla_net_state_callback), (mozilla_net_stop_callback),
	(mozilla_link_message_callback), (mozilla_progress_callback),
	(mozilla_dom_mouse_click_callback), (vfs_open_callback),
	(vfs_read_callback), (cancel_pending_vfs_operation),
	(navigate_mozilla_to_athena_uri):
	Add a charset encoding menu.  Also, changed the type of the
	mozilla member to be GtkMozEmbed instead of GtkWidget to reduce
	the amount of casting we did.

	* components/mozilla/athena-mozilla-embed-extensions.cpp:
	* components/mozilla/athena-mozilla-embed-extensions.h:
	New files.  Start of mozilla embed extensions.  Right now only
	charset encoding stuff.  Inspired somewhat by Galeon.
	* components/mozilla/athena-mozilla-ui.xml:
	Update for charset encoding menu support.

2001-02-16  Josh Barrow  <josh@eazel.com>

	* README:
	Added some text to explain the freetype fiasco.

2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	* README: Clarify the fact that Mozilla M18 no longer works.
	* components/mozilla/mozilla-components.cpp: Remove obsolete
	Mozilla M18 support.  M18 no longer works.

2001-02-16  Ramiro Estrugo  <ramiro@eazel.com>

	* README: Update Mozilla requirements.
	* configure.in: Update the Mozilla milestone names to match the
	current Mozilla naming scheme.  Add a flag indicating whether the
	version of Mozilla we use has profiles support.
	* components/mozilla/Makefile.am:
	* components/mozilla/athena-mozilla-content-view.c:
	(pre_widget_initialize): 
	Add better profile support ifdef hackery.

2001-02-15  Robey Pointer  <robey@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(corba_packagedatastruct_fill_deps),
	(packagedata_tree_from_corba_packagedatastructlist):

	Re-add 'provides' to the IDL so the install view can poke around
	for .desktop files.

	* athena-installer/src/installer.c:
	(get_detailed_errors_foreach), (get_detailed_errors):

	Speed up error checking by avoiding pieces of the graph we've
	already visited.

2001-02-15  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(check_dependencies_foreach),
	(check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages):

	Remove errant unref during dupe-file check.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_install_parse_uri),
	(athena_service_install_done), (athena_service_install_failed),
	(athena_service_need_password),
	(athena_service_install_view_update_from_uri_finish),
	(athena_service_install_view_load_uri):
	* components/services/install/athena-view/athena-service-instal
	l-view.h:

	Set password prompt to something semi-reasonable.  Fix up a few
	wrong behaviors in the case of having multiple toplevel packages.
	This still isn't working very well.
	
2001-02-15  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 5599, make objects in $USER/Athena localizable.  Fixed
	by creating a linkset to instead the Computer and Services icons,
	and removing the top directory and associated code, since it's no
	longer needed.
	
	* configure.in:
	removed data/top
	* data/Makefile.am:
	removed top directory
	* data/linksets/Makefile.am:
	* data/linksets/home.xml:
	added new home linkset
	
	* data/top/.cvsignore:
	* data/top/.athena-metafile.xml:
	* data/top/Computer:
	* data/top/Makefile.am:
	* data/top/Services:
	removed files from top
	
	* libathena-extensions/athena-file-utilities.c:
	(athena_get_user_main_directory):
	changed it to no longer copy the top directory; instead,
	install the new linkset
	
	* po/POTFILES.in:
	added home.xml to the files to be localized
	
2001-02-15  Eric Fischer  <eric@eazel.com>

	* athena.spec.in:
	Building the installer into RPMs doesn't work, because I got
	something in the Makefiles wrong.  Revert the changes to the
	spec file so tinderbox comes back to life.  Will try again
	once I think I have it right.

2001-02-15  Robey Pointer  <robey@eazel.com>

	reviewed by: Robin * Slomkowski  <rslomkow@eazel.com>

	* athena-installer/src/installer.c:

	For now, make the bootstrap installer always run in debug mode
	and point to checkpoint:8888.

2001-02-15  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/trilobite/libtrilobite/trilobite-root-helper.
	c: (discard_line), (eazel_helper_start):

	Add debug info to the roothelper so that we can debug failures
	better.

2001-02-15  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (dump_tree):

	Made dump_tree dump less redundant info (tries not to repeat
	sections of the graph it's already visited).
	
	* athena-installer/install-lib/Makefile.am:
	* athena-installer/libtrilobite/Makefile.am:

	Set LOG_DOMAIN to G_LOG_DOMAIN so our log catcher will actually
	work. :)

	* athena-installer/src/Makefile.am:

	Remove redundant object file.

	* athena-installer/src/create-eazel-installer.sh:

	By default, strip the installer binary before gzexe'ing it (this
	makes it much much smaller).  Eventually we'll want to add some
	sort of command-line option for deciding which kind to build.

	* athena-installer/src/installer.c: (conflict_check),
	(eazel_installer_initialize):

	Remember to nudge GTK+ after updating labels so they'll actually
	refresh.

	* athena-installer/src/link.sh:
	* athena-installer/src/main.c: (main):
	* athena-installer/src/prescript:

	Fix the prescript to work around a sad popt bug.

2001-02-15  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Engber <engber@eazel.com>

	Fixed bug 6670, Segmentation fault when trying to access mounted
	removable volume with no media.
	
	* src/file-manager/fm-desktop-icon-view.c:
	(create_unique_volume_name):
	Use the accessor function to access the volume name instead
	of accessing the structure directly.  The accessor protects
	us against NULL data.

2001-02-15  Eric Fischer  <eric@eazel.com>

	* athena.spec.in:
	Start building the eazel installer, and put it into its own RPM.
	(This should eventually be separate from building athena)

	* athena-installer/libtrilobite/Makefile.am:
	Add a dependency to create the .h files, since gmake complains
	otherwise.

2001-02-15  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 6589, athena crashes if a moderate sized text block
	is used for dictionary lookup.  Fixed by imposing sanity limits
	on both the selection size passed to services and the sidebar
	title.
	
	* components/text/athena-text-view.c: (handle_service_menu_item):
	truncate the selection if it's greater than a reasonable size.
	
	* src/athena-sidebar-title.c:
	(athena_sidebar_title_initialize),
	(athena_sidebar_title_set_text):
	truncate the sidebar title if it's longer than a reasonable limit.
	
2001-02-15  Michael Engber  <engber@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* src/file-manager/fm-icon-view.c: (fm_icon_view_bump_zoom_level):
	Change fm_icon_view_bump_zoom_level to ignore bumps to out
	of bounds values - bug 6347.

2001-02-15  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-directory-metafile.c:
	(get_metafile), (athena_directory_get_file_metadata),
	(athena_directory_get_file_metadata_list),
	(athena_directory_set_file_metadata),
	(athena_directory_set_file_metadata_list),
	(athena_directory_copy_file_metadata),
	(athena_directory_remove_file_metadata),
	(athena_directory_rename_file_metadata):
	Added FIXMEs.

2001-02-15  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-image-table.h:
	* libathena-extensions/athena-image-table.c:
	(athena_image_table_add_empty_image): New function to add an
	empty space into the table.

	* libathena-extensions/athena-wrap-table.h:
	* libathena-extensions/athena-wrap-table.c:
	(athena_wrap_table_destroy), (athena_wrap_table_expose_event),
	(athena_wrap_table_map), (athena_wrap_table_unmap),
	(athena_wrap_table_add), (athena_wrap_table_remove),
	(athena_wrap_table_forall), (wrap_table_layout),
	(wrap_table_get_max_child_dimensions),
	(wrap_table_get_content_dimensions),
	(wrap_table_find_child_at_point),
	(athena_wrap_table_reorder_child): Change 'items' to 'childern'
	(athena_wrap_table_get_num_children): New function to get the
	number of chilren.

	* src/athena-property-browser.c: (labeled_image_configure),
	(labeled_image_new), (make_properties_from_directories),
	(add_reset_property), (make_properties_from_xml_node),
	(athena_property_browser_update_contents):
	Modify some constants and add new ones for the image table
	layout.  Andy is going to tweak these later.
	Move the erase object back to the end of the table.

2001-02-15  J Shane Culpepper  <pepper@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* libathena-extensions/athena-file-operations.c:
	(handle_transfer_ok):

	Fix for Bug #1505, Cancelled copy operations leave partial
	files.  Athena now catches cancel and deletes the partial
	file.

2001-02-15  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>
                     Except for the self checks code.
	
	Change code that used a ArtIRect as a "frame" to use
	AthenaDimensions instead.  Change all foo_frame functions to
	foo_dimensions.

	* libathena-extensions/athena-art-extensions.h:
	Add a new structure to represent dimensions using signed integers.
	Retire athena_art_ipoint_assign.
	* libathena-extensions/athena-art-extensions.c:
	(athena_dimensions_empty): New function to check for empty
	dimensions.
	(athena_art_irect_assign_dimensions): New function to assign
	dimensions to a rectangle.
	(athena_self_check_art_extensions): New self checks.

	* libathena-extensions/athena-art-gtk-extensions.h:
	* libathena-extensions/athena-art-gtk-extensions.c:
	(athena_gdk_rectangle_to_art_irect),
	(athena_screen_get_dimensions), (athena_gdk_window_get_bounds),
	(athena_gdk_window_get_screen_relative_bounds),
	(athena_gtk_widget_get_bounds),
	(athena_gtk_widget_get_dimensions),
	(athena_gdk_window_clip_dirty_area_to_screen),
	(athena_art_irect_to_gdk_rectangle),
	(athena_gdk_window_get_dimensions): New function to get
	the dimensions of a GdkWindow.
	Update for frame to dimensions changes.  Change functions names to
	lose the "irect" sub-prefix.

	* libathena-extensions/athena-gdk-pixbuf-extensions.h:
	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(athena_gdk_pixbuf_get_dimensions),
	(athena_gdk_pixbuf_fill_rectangle_with_color),
	(athena_gdk_pixbuf_draw_to_drawable),
	(athena_gdk_pixbuf_draw_to_pixbuf),
	(athena_gdk_pixbuf_draw_to_pixbuf_alpha),
	(athena_gdk_pixbuf_new_from_pixbuf_sub_area),
	(pixbuf_draw_tiled), (athena_gdk_pixbuf_draw_to_pixbuf_tiled),
	(athena_gdk_pixbuf_draw_to_drawable_tiled),
	(athena_gdk_pixbuf_intersect): New functions 
	(athena_self_check_gdk_pixbuf_extensions): New self checks.
	Update for frame vs dimenensions changes.  Simplify clipping code
	by using athena_gdk_pixbuf_intersect.  Move
	athena_gdk_window_get_dimensions to
	athena_gdk_window_get_dimensions in art-gtk-extensions.

	* libathena-extensions/athena-debug-drawing.c:
	(debug_pixbuf_viewer_size_request),
	(athena_debug_pixbuf_draw_point),
	(athena_debug_pixbuf_draw_rectangle),
	(athena_debug_pixbuf_draw_rectangle_inset):
	Update for frame vs dimenensions changes.

	* libathena-extensions/athena-clickable-image.c:
	(label_handle_motion):
	Update for art-gtk extensions changes.
	
	* libathena-extensions/athena-glyph.h:
	* libathena-extensions/athena-glyph.c: (athena_glyph_new):
	Change order of parameters to match AthenaScalalbleFont.
	(athena_glyph_get_dimensions), (athena_glyph_draw_to_pixbuf):
	Update for frame vs dimenensions changes.

	* libathena-extensions/athena-lib-self-check-functions.h:
	New declaration for art_extensions and gdk_pixbuf_extensions.
	
	* libathena-extensions/athena-self-checks.c:
	(athena_check_rectangle_result),
	(athena_check_dimensions_result):
	* libathena-extensions/athena-self-checks.h:
	Add support for checking functions that return rectangles and
	dimensions.
	
	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-scalable-font.c:
	(athena_scalable_font_measure_text): Return
	AthenaDimensions instead of using pointer parameters.
	(athena_scalable_font_text_width): Simplify by calling
	scalable_font_measure_text.
	(athena_scalable_font_draw_text),
	(athena_scalable_font_measure_text_lines),
	(athena_scalable_font_draw_text_lines_with_dimensions),
	(athena_scalable_font_draw_text_lines):
	Update for frame vs dimenensions changes.  Use AthenaDimensions
	arrays instead of individial width and height arrays.  Change all
	function signatures to pass in only a font_size instead of both
	font_width and font_height.  Simplifies using these a bit.
	(athena_scalable_font_largest_fitting_font_size): Fix bug where
	we were always using the wrong font size to compute the largest
	fitting font.
	
	* libathena-extensions/athena-icon-factory.c: (embed_text):
	Update for scalable font font_size api changes.
	
	* libathena-extensions/athena-image-table.c:
	(image_table_clear_dirty_areas):
	Update for frame vs dimenensions changes.

	* libathena-extensions/athena-image.c:
	(athena_image_size_request), (image_get_pixbuf_dimensions),
	(image_get_pixbuf_bounds), (image_get_tile_dimensions):
	Update for frame vs dimenensions changes.

	* libathena-extensions/athena-label.h:
	* libathena-extensions/athena-label.c:
	(athena_label_initialize_class), (athena_label_set_arg),
	(athena_label_get_arg), (athena_label_size_request),
	(athena_label_size_allocate), (label_composite_pixbuf_callback),
	(label_draw_text_to_pixbuf): Fix a type.  Was using [x,x] instead
	of [x,y] to render the string.
	(label_get_text_dimensions), (label_get_text_bounds),
	(label_get_tile_dimensions), (label_line_geometries_clear),
	(label_line_geometries_recompute),
	Update for frame vs dimenensions changes.  Make the
	'smooth_line_wrap' attribute an int instead of a guint.  Use an
	array of AthenaDimensions to store text lines geometries instead
	of separete width and height arrays.
	(label_get_default_line_wrap_width),
	(athena_label_set_smooth_line_wrap_width),
	(athena_label_get_smooth_line_wrap_width):
	Change signature to return an int instead of a guint.
	
	* libathena-extensions/athena-labeled-image.c:
	(athena_labeled_image_size_request),
	(labeled_image_get_image_dimensions),
	(labeled_image_get_label_dimensions),
	(labeled_image_get_image_bounds_fill),
	(athena_labeled_image_get_image_bounds),
	(labeled_image_get_label_bounds_fill),
	(athena_labeled_image_get_label_bounds),
	(labeled_image_get_content_dimensions),
	(labeled_image_get_content_bounds):
	Update for frame vs dimenensions changes.

	* libathena-extensions/athena-smooth-widget.h:
	* libathena-extensions/athena-smooth-widget.c:
	(smooth_widget_paint_tile_transparent),
	(athena_smooth_widget_get_preferred_dimensions):
	Update for frame vs dimenensions changes.

	* libathena-extensions/athena-tabs.c: (measure_tab_name),
	(draw_tab_label):
	Update for font api changes.
	
	* libathena-extensions/athena-text-layout.c:
	(athena_text_layout_new), (athena_text_layout_paint):
	Update for frame vs dimenensions changes.

	* libathena-extensions/athena-wrap-table.c:
	(athena_wrap_table_size_request), (wrap_table_layout),
	(wrap_table_art_irect_max_dimensions),
	(wrap_table_get_max_child_dimensions),
	(wrap_table_get_content_dimensions):
	Update for frame vs dimenensions changes.

	* src/athena-about.c: (draw_aa_string):
	Update for frame vs dimenensions changes.

	* src/athena-sidebar-tabs.c: (draw_one_tab_plain),
	(draw_one_tab_themed), (get_tab_width):
	Update for frame vs dimenensions changes.

	* test/test-athena-font-simple.c: (main):
	* test/test-athena-font.c: (main):
	* test/test-athena-glyph-simple.c: (glyph_new):
	* test/test-athena-glyph.c: (glyph_new), (main):
	* test/test-athena-pixbuf-tile.c:
	* test/test.c: (test_pixbuf_draw_rectangle_tiled):
	Update test for frame vs dimenensions changes and font api
	changes.

2001-02-14  Mike Fleming  <mfleming@eazel.com>

	* components/mozilla/mozilla-preferences.cpp:

	Bug 6592 -- Embedded Mozilla defaults to port 8080 when HTTP
	proxy is enabled like everything else

2001-02-14  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_shared), (eazel_install_packagelist_parse):
	* components/services/install/lib/eazel-install-xml-package-list.h:
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_finalize), (eazel_softcat_initialize),
	(eazel_softcat_reset_server_update_flag), (eazel_softcat_query):

	Return the softcat DB revision with the parsed package list, and
	use that info to hook into Eskil's error trap.  Also free up the
	softcat private data when the object goes away.

2001-02-14  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6653, throwing away something with the desktop not on will
	bring up an empty trash if the desktop is later turned on
	
	* src/file-manager/fm-desktop-icon-view.c:
	(update_trash_link_and_delete_copies):
	Preflight state of trash icon when we are doing all of the other
	icon state validity checks.

2001-02-14  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-icon-factory.c:
	(is_supported_mime_type),
	(athena_icon_factory_get_icon_for_file):
	fixed bug 6623, .fig files cause warnings to spew, by checking for
	types that we don't support and excluding them from thumbnailing.
	
2001-02-14 John Fleck <jfleck@inkstain.net>

	reviewed by: Ali Abdin <aliabdin@aucegypt.edu>
	* components/help/converters/gnome-db2html2/toc-elements.c
	fix bug # 6551 - add test to see if article header has already
	been printed and don't print it a second time

2001-02-14  Rebecca Schulman  <rebecka@eazel.com>
	Fix bugzilla.eazel.com bug 6416, that the search results view
	needs to inform the user if indexing is disabled or blocked
	on their system.  I haven't added the final text yet, since
	it is not complete.  The final text will be swapped in.

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* src/file-manager/fm-search-list-view.c:
	(load_location_callback),
	(real_load_error), (display_indexed_search_problems_dialog),
	(display_system_services_are_blocked_dialog),
	(display_system_services_are_disabled_dialog): Add the dialogs for
	the cases when searches are enabled and disabled in the right
	cases.  Stop displaying an error dialog about a problem loading
	the location in the case where the directory load is cancelled.

	* src/file-manager/athena-indexing-info.c:
	(show_index_progress_dialog), (show_reindex_request_dialog),
	(show_indexing_info_dialog):
	Fix an obscure bug introduced in my last checkin by
	removing a reference to the index status that was kept by the
	medusa system state poller on destroy. If this reference was left around,
	enabling or disabling indexing could crash athena.

2001-02-14  Darin Adler  <darin@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	* src/athena-applicable-views.c:
	(got_minimum_file_info_callback),
	(athena_determine_initial_view),
	(athena_determine_initial_view_cancel): Get rid of the code to
	monitor the directory. It's now moved up one level to the
	manage-views.c code.
	* src/athena-window-private.h:
	* src/athena-window-manage-views.c: (free_location_change),
	(begin_location_change): Move the code that starts monitoring the
	directory up here instead.

	* src/athena-application.c: (volume_unmounted_callback): Rewrote
	this code to not use the viewed_file private field. There's a
	public call to get the current location that should work just as
	well. Also fix bug where it would ignore the scheme and just look
	at the path part.
	
	* libathena-extensions/athena-directory-metafile.c:
	(athena_directory_use_self_contained_metafile_factory): Added
	check to detect if this is called after using the factory.
	(free_factory): Simplified.
	(get_factory): New function to simplify get_metafile.
	(get_metafile): Simplified.

	* src/athena-location-bar.c: (try_to_expand_path): Fix storage
	leak.

	* libathena-extensions/athena-entry.c:
	(athena_entry_key_press): Added FIXME after noticing a
	particularly lame version of tilde expansion in here. I'm not sure
	this is even used to good effect, since the location bar now does
	its own tidle expansion.

	* README: Fixed many inaccuracies.
	
	* libathena-extensions/athena-stock-dialogs.c:
	(timed_wait_free): Formatting tweaks.
	* src/athena-theme-selector.c:
	(get_theme_description_and_display_name): Formatting tweaks.

2001-02-14  Michael Engber  <engber@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	* libathena-extensions/athena-stock-dialogs.c:
	(timed_wait_delayed_close_destroy_dialog_callback),
	(timed_wait_delayed_close_timeout_callback), (timed_wait_free),
	(timed_wait_dialog_destroy_callback), (timed_wait_callback),
	(athena_timed_wait_start_with_duration),
	(athena_timed_wait_stop):
	Non-cancellable timed wait dialogs do not free the timed wait
	when the dialog is dismissed - instead they wait for the call to
	timed_wait_stop to do it - otherwise the call to timed_wait_stop
	asserts. Removed superfluous argument in timed_wait_callback.
	When timed wait dialog remaining up due to minimum uptime feature
	are closed by the user, we now cancel the pending timeout that
	would close them without user intervention.

2001-02-14  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), 
	Final fix for 3511, if multiple packages with same name are
	already installed, and more than one passes verify, fail
	operation.
	(install_packages),
	(uninstall_packages):
	call softcat reset db update mjick.
	
	* components/services/install/lib/eazel-softcat.h:
	* components/services/install/lib/eazel-softcat-private.h:
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_initialize),
	(eazel_softcat_reset_server_update_flag),
	(eazel_softcat_error_string), (eazel_softcat_query):
	Code to make get_info return a enum indicating that the db was
	updated since last time.
	Also a code to reset the flag.

2001-02-14  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: added support for scrollkeeper
	this also requires having the scrollkeeper package
	to run, have not added that dependancy as it is not
	easily available.

2001-02-14  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Engber <engber@eazel.com>

	Fixed bug 6606, only show user-mountable volumes in Disks menu.
	
	Look for options "user" or "owner" instead of "noauto"
	to determine if volume if removable.

	* libathena-extensions/athena-volume-monitor.c:
	(volume_is_removable), (close_error_pipe):
		
2001-02-14  Eric Fischer <eric@eazel.com>

	* athena-installer/install-lib/Makefile.am:
	Gmake seems to have trouble recognizing .c -> .o dependencies
	when the .c files don't appear until after the make has begun,
	so explicitly add the rpm3 and rpm4 dependencies.

2001-02-13  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal), (something_failed),
	(eazel_preflight_check_signal), (dep_check), (md5_check_failed),
	(delete_files):
	Added --silent, suppresses random spewage.
	Added autocont, so if there was multiple problems, answering y to
	first "continue y/n ?" will answer y to all.
	Fixed for the modified preflight signal.
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(packagedata_from_corba_packagedatastruct):
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_preflight_check), (eazel_install_callback_class_initialize):
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/idl/trilobite-eazel-install.idl:
	Changed preflight to take the operation type as argument.
	Added modification status to the corba version of package data.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(prune_failed_packages_helper),
	(eazel_install_check_existing_packages), (get_softcat_info),
	(is_satisfied), (check_dependencies_foreach),
	(do_file_conflict_check), (execute),
	(eazel_uninstall_upward_traverse), (install_packages):
	Fixed bug 3511, 4502 (libeazelinstall part, view still needs
	stuff).
	
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_install_packages), (eazel_install_init_transaction),
	(eazel_install_emit_preflight_check_default):
	More debug spewage.
	Fixed cut'n'paste bug in init_transaction.
	Updated preflight signal.
	
	* components/rpmview/athena-rpm-view-install.c
	* components/services/install/athena-view/athena-service-install-view.c
	Updated preflight signal.

	* components/services/install/lib/eazel-install-problem.h:
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_breaks_foreach),
	(get_detailed_messages_foreach), (compare_problem_case),
	(add_continue_with_flag_case), (add_force_install_both_case),
	(add_force_remove_case), (get_detailed_cases_foreach),
	(eazel_install_problem_case_to_string),
	(eazel_install_problem_case_foreach_destroy),
	(build_categories_from_problem_list),
	(eazel_install_problem_step_problem), (eazel_install_problem_done),
	(eazel_install_problem_wait_for_completion),
	(eazel_install_problem_handle_cases):
	s/Fuckup/Feature dependency/
	Lots of improvement.
	Change some cases.
	Did stuff...
	Added cases of "cancelling package", "continue with flag",
	"invalid".
	Made EazelInstallProblem wait for the operation to complete, as
	not to confuse the service object by starting it and resetting
	values.
	
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_is_installed), (eazel_package_system_verify):
	* components/services/install/lib/eazel-package-system.h:
	* components/services/install/lib/eazel-package-system-private.h:
	* components/services/install/lib/eazel-package-system-rpm3-private
	.h:
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new), (eazel_package_system_rpm3_verify_impl),
	(eazel_package_system_rpm3_verify):
	* components/services/install/lib/eazel-package-system-skeleton.c:
	(eazel_package_system_skeleton_verify):
	Fixed 6494, also made verify return boolean, propageted change
	down throughout the hierachy.
	
	* components/services/install/lib/eazel-package-system-types.c:
	(eazel_install_gtk_marshal_BOOL__ENUM_POINTER_INT_INT):
	New signal for preflight.

2001-02-14  Eric Fischer <eric@eazel.com>

	This is a bunch of changes leading up to Bug 6515, so
	the installer can get built by just an extra flag to
	configure rather than its own script.

	* Makefile.am:
	Add athena-installer to SUBDIRS

	* acconfig.h:
	Add ENABLE_INSTALLER to things that can be configured

	* configure.in:
	Add --enable-installer command line flag.  Set PACKAGE_SYSTEM_OBJECT
	and PACKAGE_SYSTEM_SOURCE based on whether rpm 3 or 4 is installed.
	Create athena-installer Makefiles

	* athena-installer/Makefile.am:
	Remove things that Robey said were no longer used.  Add libtrilobite
	and install-lib to SUBDIRS that need to be built.

	* athena-installer/install-lib/Makefile.am:
	New Makefile that builds a second copy of the installer libraries
	with weird flags as needed by the installer.

	* athena-installer/libtrilobite/Makefile.am:
	New Makefile that builds a second copy of the trilobite libraries
	with weird flags as needed by the installer.
	
	* athena-installer/src/Makefile.am:
	Do in the Makefile what formerly had been done in link.sh (build
	the installer, and create a self-extracting version of it).

	* athena-installer/src/create-eazel-installer.sh:
	Script, adapted from what's in link.sh, to create a self-extracting
	installer.

2001-02-14  Josh Barrow  <josh@eazel.com>

	* README:
	Made a few changes to URLs and a couple of places where things wer
	worded in odd ways.

2001-02-14  John Sullivan  <sullivan@eazel.com>

	Fixed bug 2917 (Wrong capitalization in "Lay Out" menu)

	* src/file-manager/athena-icon-view-ui.xml:
	Verafied the capitalization.

2001-02-14  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6465, Music view buttons stretch for songs with
	very long titles.
	
	* components/music/athena-music-view.c: (add_play_controls):
	Set the pack box flag so that the buttons don't expand.
	
2001-02-14  Laszlo Kovacs <laszlo.kovacs@sun.com>
	* components/help/hyperbola_top_doc_tree_populate.h:
	  components/help/hyperbola-filefmt.c:
	  components/help/hyperbola-nav-tree.c:
	  (ctree_populate_subnode, ctree_populate,
	   hyperbola_navigation_tree_new,
	   hyperbola_navigation_tree_load_location,
	   hyperbola_navigation_tree_select_row):
	Toplevel docs put into a separate ctree in
	the GUI of the help sidebar if Scrollkeeper
	is enabled.
	Note that this is not the final GUI, only the widget
	layout is right, the look will be changed by somebody
	who knows more gtk than me. Dan Mueth tries to find the
	right person.

2001-02-14  Ramiro Estrugo  <ramiro@eazel.com>

	* librsvg/Makefile.am: Move $(FREETYPE2_CFLAGS) all the way to the
	top of $(INCLUDES), so that if there are multiple versions of
	freetype installed in the build machine, then we will catch only
	the one we are interested in.

2001-02-14  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Added Norwegian (nynorsk) to ALL_LINGUAS.
	
2001-02-14  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-viewport.c:
	(athena_viewport_set_never_smooth):
	Fix a very dumb typo with the last commit.  Thanks for 
	JP Rosevear <jpr@ximian.com> for spotting this.
	
2001-02-14  Ramiro Estrugo  <ramiro@eazel.com>

	* athena.spec.in:
	Require 'freetype >= 2.0' not 'freetype2 >= 2.0'
	
2001-02-14  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: JP Rosevear <jpr@ximian.com>

	* libathena-extensions/athena-viewport.c:
	(athena_viewport_initialize), (athena_viewport_realize),
	(athena_viewport_set_is_smooth),
	(athena_viewport_get_is_smooth),
	(athena_viewport_set_never_smooth):
	Make sure the "never_smooth" and "is_smooth" attributes work as
	advertised.  Make the "never_smooth" attribute default to TRUE,
	since that makes it work with more gtk widgets.
	
	* src/athena-property-browser.c:
	(athena_property_browser_initialize),
	(athena_property_browser_update_contents):
	Set the "never_smooth" attribute of the viewports to FALSE so that
	the can be smooth.

2001-02-13  Ramiro Estrugo  <ramiro@eazel.com>

	* test/test-athena-glyph.c: (main):
	* test/test-athena-label-simple.c: (main):
	Two very tiny tweaks to help debug clipping bugs.
	
2001-02-13  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	* libathena-extensions/athena-gdk-pixbuf-extensions.c:
	(athena_gdk_pixbuf_new_from_pixbuf_sub_area),
	(athena_gdk_pixbuf_new_from_existing_buffer):
	* libathena-extensions/athena-gdk-pixbuf-extensions.h:
	New function to create a pixbuf from an existing buffer and clip
	area.
	
2001-02-13  Robey Pointer  <robey@eazel.com>

	* Makefile.am:

	Add athena-installer to EXTRA_DIST to fix tinderbox breakage.
	
2001-02-13  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Seth Nickell <seth@eazel.com>

	Fix bugzilla.eazel.com bug 6417, that the indexing
	information dialog should not be shown if indexing is
	disabled or blocked.

	* src/file-manager/athena-indexing-info.c: (dialog_close_cover),
	(show_index_progress_dialog), (show_reindex_request_dialog),
	(show_indexing_info_dialog):
	Add new dialogs for the case when indexing is off,
	and close each dialog in the case where the status of indexing
	changes.

2001-02-13  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Arik Devens  <arik@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-label.c:
	* libathena-extensions/athena-icon-canvas-item.c:
	* libathena-extensions/athena-scalable-font.c:
	* libathena-extensions/athena-scalable-font.h:
	* libathena-extensions/athena-text-layout.c:
	* libathena-extensions/athena-text-layout.h:
	* test/test-athena-font.c:
	Move the text layout code to its own place.  No real code changes.

2001-02-13  Andy Hertzfeld  <andy@eazel.com>

	reviewed by: Arik Devens  <arik@eazel.com>

	* src/athena-property-browser.c: (add_pattern_to_browser):
	fixed bug 6554, typing random text into the background selector
	crashes, by adding a check for a valid path and displaying an
	error dialog if the path isn't valid.

2001-02-13  Arik Devens  <arik@eazel.com>

	reviewed by: Andy Hertzfeld  <andy@eazel.com>

	Fixed bug 6582, Editing location bar crashes Athena, leaves
	spurious text.
	Fixed duplicate bug 6585, Athena crashed if type "~/asdfasdf" in
	location bar.
	
	* src/athena-location-bar.c: (try_to_expand_path): Removed
	spurious g_free that was causing massive breakage.
	
2001-02-13  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6385 (Properties window doesn't set/display
	icon correctly for Athena link files)

	Now the Properties window keeps around an "original
	file" and a "target file", which are currently the
	same for all files except Athena links. The original
	file is used to display/set the icon & name. (So you
	can edit the name of your Home icon in the properties
	window now also.)

	* src/file-manager/fm-properties-window.c:
	Renamed details->file to details->target_file. Added
	details->original_file. Removed two details fields
	that were unused.
	
	(directory_contents_value_field_update),
	(attach_directory_contents_value_field),
	(update_visibility_of_item_count_fields),
	(should_show_custom_icon_buttons), (should_show_file_type),
	(should_show_accessed_date), (should_show_mime_type),
	(create_emblems_page),
	(append_special_execution_checkbox), (create_permissions_page),
	(should_show_emblems), (should_show_permissions),
	(real_shutdown):
	Updated for name change only.
	
	(create_basic_page): Use original file for icon & name widgetry.

	(startup_data_new), (startup_data_free): New functions used to
	manipulate the data needed before a Properties window object
	exists for a given file.

	(create_properties_window): Reworked to use StartupData and set up
	both target_file and original_file.

	(get_target_file): Renamed from get_and_ref_file_to_display.

	(create_properties_window_callback): Reworked to use StartupData;
	slight reordering due to object lifetime issues.
	
	(cancel_create_properties_window_callback),
	(directory_view_destroyed_callback), (remove_pending_file),
	(fm_properties_window_present):
	Reworked to use StartupData.
	
	(real_destroy): clean up after original_file and target_file.
	
	(set_icon_callback): Use original_file.
	(select_image_button_callback),
	(remove_image_button_callback): Changed signatures to take
	FMPropertiesWindows instead of AthenaFiles; use original_file.

2001-02-13  Michael Engber  <engber@eazel.com>

	reviewed by: John Sullivan

	* libathena-extensions/athena-directory-metafile.c:
	(athena_directory_set_file_metadata_list):
	Fix call to CORBA_sequence_set_release on the wrong
	(non-CORBA) list - bug 6575.

2001-02-13  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fix bug 6408 (athena_view_report_load_failed causes Athena to
	segfault in an idle callback):

	* libathena/athena-idle-queue.c: (execute_queued_functions),
	(athena_idle_queue_destroy): Changed the idle queue so it can
	handle being destroyed while inside one of the queued functions.

	Fix bug 6402 (Click desktop icon -> Athena window not moved to
	front):
	
	* src/athena-window-manage-views.c: (open_location): Bring the
	existing window up when it's reused in the "open icon on desktop"
	in single-window mode.

	Other changes:

	* libathena-extensions/athena-icon-factory.c:
	(is_theme_in_user_directory): Rename from "check_local_theme"
	and changed it to use a normal function result instead of taking
	a gboolean pointer.
	(set_theme): Use new function and booleans by their new names.
	"in_user_directory" instead of "local".
	(make_full_icon_path): Just the name change.
	(get_themed_icon_file_path): Take a boolean parameter instead of
	trying to figure out if the theme is in the user directory, because
	the old way would get it wrong for the default theme.
	(get_icon_file_path): Pass in the boolean to say if the theme is
	in the user directory or not.

	* libathena-extensions/athena-string.h: Remove repeated
	declaration for athena_str_get_prefix.

	(These not reviewed:)
	
	* librsvg/rsvg-ft.c: (rsvg_ft_glyph_evict): Fix code that was
	looking at the "prev" pointer of a victim after freeing it. Also
	made some other code simplifications.

	* src/athena-theme-selector.c:
	(render_theme_name_and_description): Added an explicit call to
	gtk_widget_realize before grabbing the style field and expecting
	it to have gc's in it. Not sure why no one ran into this before.

2001-02-13  Eric Fischer <eric@eazel.com>

	* configure.in:
	Allow RPM 4.* instead of only 4.0

2001-02-13  Andy Hertzfeld  <andy@eazel.com>

	* components/text/athena-text-view.c: (add_services_to_menu),
	(athena_text_view_build_service_menu):
	made the text view look for services in the updates folder, so we
	can add new services in the same fashion as bookmarks.  Also,
	keep a list of the added service filenames so if the same service
	is present in multiple directories, it only gets added once.
	
2001-02-13  Robin * Slomkowski  <rslomkow@rslomkow.org>

	* athena.spec.in: enabled make -k check

2001-02-13  Michael Engber  <engber@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-directory-metafile.c:
	(athena_directory_use_self_contained_metatfile_factory),
	(get_metafile), (athena_directory_set_file_metadata_list):
	* libathena-extensions/athena-directory-metafile.h:
	* libathena-extensions/athena-metafile.c: (destroy),
	(corba_get_list):
	* src/athena-main.c: (main):
	The metafile code now circumvents oaf when athena is performing
	a self check - bug 6552.

2001-02-13  Robin * Slomkowski  <rslomkow@rslomkow.org>

	* athena.spec.in: re-enabled building...

2001-02-13  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5647 (Control-left/right for keyboard focus
	movement conflicts with Sawfish keyboard shortcuts)

	* libathena-extensions/athena-icon-container.c:
	(keyboard_move_to), (keyboard_space): Use Alt instead
	of Control for keyboard focus movement and selection
	toggling, per Don.

2001-02-13  Robin * Slomkowski  <rslomkow@rslomkow.org>

	* athena.spec.in: took make check out of here
	* src/Makefile.am: re-enabled test target

2001-02-13  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-glyph.h:
	* libathena-extensions/athena-glyph.c:
	New class.  A wrapper on RsvgGlyph that makes it simple and fast
	to draw smooth text on pixbufs
	
	* libathena-extensions/athena-clickable-image.c:
	(athena_clickable_image_initialize_class),
	(athena_clickable_image_realize):
	Remove unrealize() method that was a noop.
	
	* libathena-extensions/athena-debug-drawing.c:
	(athena_debug_pixbuf_draw_point),
	(athena_debug_pixbuf_draw_rectangle),
	(athena_debug_pixbuf_draw_rectangle_inset):
	* libathena-extensions/athena-debug-drawing.h:
	Add some pixbuf drawing functions to debug clip areas in pixbufs.

	* libathena-extensions/athena-image-table.c:
	(athena_image_table_initialize_class),
	(athena_image_table_remove):
	Remove add() method that was a noop. 

	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-athena-font-simple.c: (main):
	* test/test-athena-font.c: (main):
	* test/test-athena-glyph-simple.c: (glyph_new), (main):
	* test/test-athena-glyph.c: (glyph_new), (main):
	* test/test.c: (test_window_set_title_with_pid),
	(test_pixbuf_draw_rectangle_tiled):
	* test/test.h:
	New AthenaGlyph tests.  Also remove the broken pixbuf drawing
	debug code.  Use the debugging code in athena-debug-drawing.[ch]
	instead.
	
2001-02-13  Arik Devens  <arik@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fixed bug 5837, 'Home Location' preference should accept ~.
	Fixed bug 6463, GNOME-VFS spews critical errors as you type an
	incomplete path in the location bar. 
	Fixed bug 6478, athena crashes on ~somedir/ if that dir
	doesn't exist.
	Fixed bug 6506, Entering "~" in Add New Background Dialogue box
	causes Athena to crash.

	* libathena-extensions/athena-entry.c:
	(athena_entry_initialize), (athena_entry_key_press): Added
	setting of expand_tilde to FALSE. Added a slash case so that ~/
	gets expanded to $(HOMEDIR).
	* libathena-extensions/athena-entry.h: Added gboolean
	expand_tilde to the AthenaEntry struct.
	* libathena-extensions/athena-file-utilities.c:
	(athena_make_uri_from_input): Added falling into default case
	on ~'s if the dir doesn't exist so they end up at http://'s.
	* libathena-extensions/athena-preferences-item.c:
	(preferences_item_create_editable_string): Added special case
	setting of expand_tilde to TRUE on the home dir preference box.
	As well as a FIXME saying this should be dealt with later on.
	* libathena-extensions/athena-text-caption.c:
	(athena_text_caption_initialize), (entry_changed_callback),
	(athena_text_caption_set_editable),
	(athena_text_caption_set_expand_tilde): Changed
	AthenaTextCaption to use AthenaEntry instead of GtkEntry.
	Added function to set expand tilde on AthenaText Caption.
	Updated set_editable to work with AthenaEntry.
	* libathena-extensions/athena-text-caption.h: Added
	athena_text_caption_set_expand_tilde function prototype.
	* src/athena-location-bar.c: (try_to_expand_path),
	(athena_location_bar_initialize): Added expanding of ~'s at
	the beginning of the location to full path. Added setting of
	expand_tilde to TRUE.
	* src/athena-property-browser.c: (add_pattern_to_browser):
	Added if statement to not attempt to do anything if the dir
	chosen uses ~ do to gtk brokenness. Also added error dialog
	that explains what happened to the user.

2001-02-13  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-theme-selector.c:
	(athena_theme_selector_initialize), (theme_style_set_callback),
	(render_theme_name_and_description), (add_pixbuf_to_theme_list),
	(add_theme):
	fixed bug 5951, hard-coded geometry in the theme selector, by
	implementing the design that Arlo wanted, with the theme name
	above the theme description instead of in separate columns.
	
2001-02-12  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* configure.in:

	Move -lrpmio earlier in the RPM_LIBS line, because the bootstrap
	installer is picky about it.  Also, generate the installer's
	Makefile during the 'configure' stage.
	
	* athena-installer/src/Makefile.am:

	Use predefined macros for most libraries (still keeping them to
	the mininum) and get libtool/automake to do the heavy lifting part
	of making a static binary.
	
	* athena-installer/src/callbacks.c: (druid_cancel),
	(druid_finish):

	Try to avoid unref'ing or using the installer object during button
	callbacks if it hasn't been created yet.

	* athena-installer/src/installer.c: (eazel_installer_finalize):

	Don't unref the service object, it causes assertions.
	
	* athena-installer/src/link.sh:

	Make it so that (at least for me) the bootstrap installer will
	build on a RH70 system now.

2001-02-12  Robin * Slomkowski  <rslomkow@eazel.com>

	* src/Makefile.am: disabled "make check" by commenting
	out the TEST directive

2001-02-12  John Harper  <jsh@eazel.com>

	reviewed by Michael Engber  <engber@eazel.com>

	Fix bug 6383 (Esc-cancel from icon stretching doesn't work on
	desktop):

	* libathena-extensions/athena-icon-container.c
	(start_stretching): call athena_gdk_window_focus on the
	toplevel widget of the icon container

2001-02-12  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* src/athena-application.c: (athena_application_startup):

	Follow --quit's lead and avoid unref'ing to avoid hanging.
	
	* src/athena-shell.c: (restore_window_states):

	Don't double-free the list elements in the restored window list
	after restart.

2001-02-12  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_fetch_remote_file):

	Erase the package if it didn't finish downloading.
	
	* components/services/trilobite/libtrilobite/trilobite-core-messagi
	ng.c:

	Add <string.h> header for RH7.
	
	* athena-installer/src/callbacks.c: (druid_cancel),
	(druid_delete), (druid_finish):
	* athena-installer/src/main.c: (main):

	Clean up object unref'ing to quiet up the install lib's memory
	checker.  Don't hook up with the session manager.
	
	* athena-installer/src/installer.c: (eazel_download_progress),
	(eazel_install_preflight), (check_system),
	(eazel_installer_finalize), (eazel_installer_set_default_texts),
	(eazel_installer_initialize):
	* athena-installer/src/installer.h:
	* athena-installer/src/link.sh:

	Change the no-RH7 message into RH6 and RH7 specific messages, so
	we can build one installer for each platform.  Don't ask to delete
	files if none were downloaded.
	
2001-02-12  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com>

	* libathena-extensions/athena-gtk-extensions.h:
	* libathena-extensions/athena-gtk-extensions.c:
	(while_realized_disconnecter),
	(athena_gtk_signal_connect_while_realized):
	New function to connect to a signal of an object while a widget is
	realized.
	(while_realized_disconnecter): Changed signature to be void - no
	need to return a value here.  As such, the GTK_SIGNAL_FUNC casts
	are no longer needed.
	
	* libathena-extensions/athena-clickable-image.c:
	(athena_clickable_image_realize),
	(athena_clickable_image_unrealize):
	Use athena_gtk_signal_connect_while_realized so that we dont
	have to keep track of the signal ids and ancestor widget.
	
	* libathena-extensions/athena-image-table.c:
	(athena_image_table_realize), (athena_image_table_unrealize):
	Use athena_gtk_signal_connect_while_realized so that we dont
	have to keep track of the signal ids and ancestor widget.

	* test/test-athena-clickable-image.c: (main):
	Add a windowed ancestor inbetween in order to test
	athena_gtk_signal_connect_while_realized.
	
2001-02-12  Mike Fleming  <mfleming@eazel.com>

	reviewed by: <ramiro@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(view_load_location_callback), (mozilla_net_stop_callback),
	(mozilla_link_message_callback), (mozilla_progress_callback),
	(mozilla_dom_mouse_click_callback), (vfs_read_callback),
	(update_athena_uri), (dispatch_report_location_change),
	(dispatch_report_load_complete):

	Bug 6436: Throbber wasn't thobbing on mozilla-to-mozilla navigation.

	Confirmed with Darin: call report_load_underway and report_load_complete
	in case where report_location_changed is used.

2001-02-12  John Harper  <jsh@eazel.com>

	* src/athena-application.c (set_session_restart): set the
	restart command to be `athena --no-default-window'

2001-02-12  Ian McKellar  <ian@eazel.com>

	* configure.in:
	Updated the check to check for RPM 3.0.5 not 3.0.4.

2001-02-12  Gene Z. Ragan  <gzr@eazel.com>

	Turn off repawn behavior in debug mode at request of Andy.
	
	* src/athena-application.c: (set_session_restart):
	Check for debug environment variable.
	
2001-02-12  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: merged changes from branch into
	head BUG 6067

2001-02-11  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <sullivan@eazel.com>

	Bug 5961: Starting athena with path to local HTML file
	causes images not to load.

	The problem here was that any argument specified on the commandline
	was being passed directly into Athena and its components as a
	valid URI.  Added pre-processing to commandline arguments, including
	ability to handle relative file pathnames. (so you can do "athena ."
	to open a window on the current directory)

	* libathena-extensions/athena-file-utilities.c:
	(file_uri_from_local_relative_path),
	(athena_make_uri_from_shell_arg), (is_uri_partial),
	(remove_internal_relative_components),
	(athena_uri_make_full_from_relative),
	(athena_self_check_file_utilities):
	* libathena-extensions/athena-file-utilities.h:
	* src/athena-application.c:
	(athena_make_uri_list_from_shell_strv),
	(athena_application_startup):


2001-02-12  Rebecca Schulman  <rebecka@eazel.com>
	Fix bugzilla.eazel.com bug 4962 that open with
	mpg123 fails.  The problem was a check for 
	a file uri that had its logic backwards

	reviewed by: Mike Engber <engber@eazel.com>

	* libathena-extensions/athena-program-choosing.c:
	(athena_launch_application):
	Change if (file_uri) to if (!file_uri)

2001-02-12  Michael Engber  <engber@eazel.com>

	reviewed by: John Sullivan

	* libathena-extensions/athena-directory-async.c:
	(metafile_read_mark_done), (metafile_read_done_callback):
	* libathena-extensions/athena-directory-metafile.c:
	(free_factory), (get_metafile),
	(athena_directory_get_file_metadata),
	(athena_directory_get_file_metadata_list),
	(athena_directory_set_file_metadata),
	(athena_directory_set_file_metadata_list),
	(athena_directory_copy_file_metadata),
	(athena_directory_remove_file_metadata),
	(athena_directory_rename_file_metadata):
	* libathena-extensions/athena-directory-metafile.h:
	* libathena-extensions/athena-directory.c:
	(athena_directory_destroy):
	* libathena-extensions/athena-metafile-factory.c:
	(free_factory_instance):
	* libathena-extensions/athena-metafile-factory.h:
	* libathena-extensions/athena-metafile-server.idl:
	* libathena-extensions/athena-metafile.c: (destroy),
	(corba_get), (corba_get_list), (corba_set), (corba_set_list),
	(corba_copy), (corba_remove), (corba_rename),
	(get_or_add_directory_monitor_list_entry),
	(remove_directory_monitor_list_entry), (find_monitor_link),
	(corba_register_monitor), (corba_unregister_monitor),
	(get_metadata_from_node), (get_metadata_list_from_node),
	(create_metafile_root), (get_file_node),
	(get_metadata_string_from_metafile),
	(get_metadata_list_from_metafile),
	(set_metadata_string_in_metafile), (set_metadata_list_in_metafile),
	(metadata_value_new), (metadata_value_new_list),
	(metadata_value_destroy), (metadata_value_equal),
	(set_metadata_in_metafile), (get_metadata_string_from_table),
	(get_metadata_list_from_table), (str_or_null_hash),
	(str_or_null_equal), (set_metadata_eat_value),
	(free_file_table_entry), (free_directory_table_entry),
	(destroy_metadata_changes_hash_table), (destroy_xml_string_key),
	(athena_metafile_destroy), (get_file_metadata),
	(get_file_metadata_list), (set_file_metadata),
	(set_file_metadata_list), (rename_file_metadata),
	(apply_one_change), (apply_file_changes), (apply_one_file_changes),
	(athena_metafile_apply_pending_changes), (copy_file_metadata),
	(remove_file_metadata), (athena_metafile_set_metafile_contents):
	* libathena-extensions/athena-metafile.h:
	* src/athena-application.h:

	Metadata setting/getting is now done via CORBA so that
	out of process components stay in sync. bug 5958

2001-02-12  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	* src/athena-property-browser.c:
	(make_properties_from_directories):
	Dont free the object name so soon.  Its needed to determine where
	to put the reset and erase objects.
	
2001-02-12  Rebecca Schulman  <rebecka@eazel.com>
	Fix bug 6333, that a warning about not finding
	unindexed files should not be displayed if the
	backup search is turned on.

	reviewed by: John Sullivan <sullivan@eazel.com>

	* libathena-extensions/athena-global-preferences.h:
	Leave a note that we should change the SEARCH_METHOD
	name to be more clear about what the preference is for
	(whether or not we  do a slow background search)
	* src/file-manager/fm-search-list-view.c: (load_location_callback):
	Check the SEARCH_METHOD preference 

	
2001-02-12  John Sullivan  <sullivan@eazel.com>

	reviewed by: Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6500 (tighter layout option not saved).

	It actually was being saved, it was just being clobbered back to
	off every time a directory was loaded.

	* src/file-manager/fm-icon-view.c: (fm_icon_view_begin_loading):
	Moved the tighter-layout setting code up one line and refined
	comments to explain why.

2001-02-12  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(do_dep_check_internal), (install_packages_helper):

	Make the dep-check logic bail out early if the user has cancelled
	the install.  (It's possible to get the async "stop" callback
	during a package info fetch, I found out the hard way...)
	
	* components/services/install/lib/eazel-install-protocols.c:
	(http_fetch_remote_file):

	Make get_failed into an official bool, since it acts like one
	already.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_dependency_check),
	(athena_service_need_password),
	(service_install_stop_loading_callback):

	Treat aborted password dialog as a cancel, not a failure.  Fix
	abort callback so it doesn't loop endlessly in a GTK event
	handling cycle on fast downloads.

2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* test/.cvsignore:
	* test/Makefile.am:
	* test/test-athena-wrap-table.c: (main):
	New AthenaWrapTable test.
	
2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* test/test-athena-clickable-image.c: (main):
	* test/test-athena-labeled-image.c: (button_callback),
	(labeled_image_button_window_new):
	A tiny bit more debug code.
	
2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/preferences-applet/athena-preferences-applet.c:
	(user_level_changed_callback), (main):
	Make toggle buttons insensitive on novice user level.

2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-viewport.h:
	* libathena-extensions/athena-viewport.c:
	(athena_viewport_draw), (athena_viewport_expose_event),
	(athena_viewport_realize), (athena_viewport_set_is_smooth),
	(athena_viewport_get_is_smooth): Add public is_smooth getter.
	(athena_viewport_set_never_smooth): Add a 'never_smooth'
	attribute.

2001-02-11  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-customization-data.h:
	Add comment clarifying API changes I made in my last checkin.
	* src/file-manager/fm-properties-window.c: (create_emblems_page):
	Remove some left over code from when the emblems table was hard
	coded to 2 columns.
	* src/athena-property-browser.c:
	(make_properties_from_directories):
	Fix a small memory leak.

2001-02-11 John Fleck <jfleck@inkstain.net>

	reviewed by: Ali Abdin <aliabdin@aucegypt.edu>

	* components/help/converters/gnome-db2html2/gdb3html.h
	* components/help/converters/gnome-db2html2/sect-elements.c
	* components/help/converters/gnome-db2html2/sect-elements.h
	* components/help/converters/gnome-db2html2/sect-preparse.c
	* components/help/converters/gnome-db2html2/toc-elements.c
	add support for <bridgehead> tag in DocBook, fix bug #6492

2001-02-11  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Mathieu Lacage <mathieu@gnome.org>

	* cut-n-paste-code/widgets/athenaclist/athenaclist.c: Use
	binary instead of linear search to find the right insert new row
	into a sorted clist. This is part of addressing bug 6290

2001-02-10  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar.c: (add_command_buttons),
	(empty_trash_callback),
	(athena_sidebar_trash_state_changed_callback),
	(athena_sidebar_update_buttons):
	fixed bug 6052, sidebar needs empty trash button when showing
	trash: directory
	
2001-02-09  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libathena-extensions/athena-image-table.c:
	(image_table_handle_motion), (ancestor_button_press_event),
	(ancestor_button_release_event):
	Ignore insensitive widgets when doing the event thing.
	
	* src/athena-property-browser.c:
	(make_properties_from_directories):
	Add an extra empty space between the erase emblem and the next to
	make it stand out more.  Cleanup property image creation a tiny bit.

2001-02-09  Robey Pointer  <robey@eazel.com>

	* po/POTFILES.in:

	Fix build bustage by removing the two missing install-lib files
	from POTFILES.in.

2001-02-09  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-region.c:
	* libathena-extensions/athena-region.h:
	New class for super easy region management using rectangle.

	* libathena-extensions/athena-art-gtk-extensions.h:
	* libathena-extensions/athena-art-gtk-extensions.c:
	(athena_gdk_rectangle_assign_irect):
	New function to convert ArtIRect to GdkRectangles.

	* libathena-extensions/athena-customization-data.h:
	* libathena-extensions/athena-customization-data.c:
	(athena_customization_data_get_next_element_for_display):
	Return pixbufs and labels for the object instead of widgets.  This
	is so that the caller can use the widget that best suits its
	display needs.

	* libathena-extensions/athena-image-table.h:
	* libathena-extensions/athena-image-table.c:
	(athena_image_table_initialize_class),
	(athena_image_table_initialize),
	(athena_image_table_expose_event),
	(athena_image_table_realize), (athena_image_table_unrealize),
	(athena_image_table_set_is_smooth_signal),
	(image_table_foreach_child_subtract_content),
	(image_table_clear_dirty_areas), (image_table_peek_clear_gc),
	(image_table_emit_signal), (image_table_handle_motion),
	(ancestor_button_press_event), (ancestor_button_release_event),
	(athena_image_table_new), (athena_image_table_set_is_smooth),
	(athena_image_table_set_smooth_background_color):
	Add support for smoothnes.  Register widget as a possible smooth
	widget.  When smoothness changes, we modify our background drawing
	behavior such that in smooth mode we dont flicker at all.

	Remove grab/ungrab pair that could screw up operations.  Turns out
	these are not needed.

	Change event signal emissions to include more data from the raw
	gdk events without exposing these.

	* libathena-extensions/athena-image.c:
	(athena_image_initialize_class):
	Update for new smooth widget class registration scheme.

	* libathena-extensions/athena-label.c:
	(athena_label_initialize_class):
	Update for new smooth widget class registration scheme.

	* libathena-extensions/athena-labeled-image.h:
	* libathena-extensions/athena-labeled-image.c:
	(athena_labeled_image_size_allocate),
	(athena_labeled_image_get_image_bounds),
	(athena_labeled_image_get_label_bounds):
	Make these two functions public.
	
	* libathena-extensions/athena-smooth-widget.h:
	* libathena-extensions/athena-smooth-widget.c:
	(smooth_widget_type_list_free), (smooth_widget_list_free),
	(widget_is_smooth), (athena_smooth_widget_register),
	(athena_smooth_widget_register_type):
	Add mechanism for registering types that are meant to be smooth.
	That way we dont need to hardcode the list of smooth widget
	classes.  Also made sure to free the static lists at exit time.
	
	* libathena-extensions/athena-viewport.h:
	* libathena-extensions/athena-viewport.c:
	(athena_viewport_initialize_class),
	(athena_viewport_initialize), (athena_viewport_destroy),
	(athena_viewport_draw), (athena_viewport_expose_event),
	(athena_viewport_realize), (athena_viewport_paint),
	(athena_viewport_set_is_smooth_signal), (athena_viewport_new),
	(athena_viewport_set_is_smooth),
	(athena_viewport_get_scroll_offset):
	Add support for smoothness.  When the is_smooth attribute changes,
	the viewport will not clear the background on resize - and so its
	content will not flicker.

	Add function for querying the scroll offset.
	
	* libathena-extensions/athena-wrap-table.h:
	* libathena-extensions/athena-wrap-table.c:
	(wrap_table_get_content_frame), (wrap_table_get_scroll_offset),
	(athena_wrap_table_get_homogeneous),
	(athena_wrap_table_reorder_child):
	Fix a mod by zero error.
	Add support for reordering children.
	
	* src/file-manager/fm-properties-window.c: (create_emblems_page):
	Simplify a bit by using AthenaWrapTable instead of a GtkTable
	with a hard coded number of columns.  The emblems now wrap to fit
	the available space.  Also use AthenaLabeledImages instead of
	boxes.  Update for changes in customization data api.
	Remove check box painting workaround.  Its taken care of in
	AthenaLabeledImage now.
	
	* src/athena-property-browser.c:
	(athena_property_browser_initialize_class),
	(athena_property_browser_initialize), (element_clicked_callback),
	(athena_property_browser_preferences_changed),
	(make_property_tile), (make_properties_from_directories),
	(add_reset_property), (make_properties_from_xml_node),
	(property_browser_category_button_new), (make_category_link),
	(athena_property_browser_update_contents),
	(emit_emblems_changed_signal):
	Use a AthenaImageTable instead of a GtkTable to make things wrap
	propertly and thus not have to recreate the whole property box
	each time its resized.  Remove a lot of hard coded dimensions.
	Simplified a bit by using AthenaLabeledImages.
	
	* src/athena-search-bar-criterion.c: (make_emblem_value_menu):
	Update for changes in customization data api.
	
	* test/test-athena-image-table.c: (labeled_image_new),
	(foo_timeout), (image_table_size_allocate),
	(image_table_new_scrolled):
	Update for new image table features.

2001-02-09  Andy Hertzfeld  <andy@eazel.com>

	* src/athena-sidebar.c:
	(athena_sidebar_active_panel_matches_id),
	(athena_sidebar_remove_panel):
	fixed bug 6005, help tab still left on sidebar after view is hidden,
	by decrementing the active tab index when an earlier one is deleted,
	and checking for NULL in active_panel_matches_id.

	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_initialize),
	(athena_rpm_view_update_from_uri):
	made it use athena_image so the package image is anti-aliased

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5903 ("Tighter Layout" can't be changed in
	manual layout, but affects Clean Up by Name)

	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_set_tighter_layout): When in
	manual layout mode, invalidate label sizes and update
	all items so the smaller caption width used for
	tighter layout can take effect immediately.
	
	* src/file-manager/fm-icon-view.c: 
	(update_layout_menus): Remove the code that was making
	this item insensitive in manual layout.

2001-02-09  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(eazel_install_callback_get_epv):
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(packagedata_from_corba_packagedatastruct):

	Remove some cruft from the IDL that's not implemented anymore or
	isn't being used by any of the clients.
	
	* components/services/install/lib/eazel-install-metadata.c:
	(eazel_install_configure_use_local_db):
	* components/services/install/lib/eazel-install-metadata.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_initialize):
	* components/services/trilobite/doc/gconf.txt:

	Make an opt-out for people who don't want the "can't get shared
	lock" spam message scrolling endlessly on every install just
	because RPM can't deal with NFS directories well.
	
	* components/services/install/lib/makefile.staticlib.in:

	Remove dead files from the bootstrap installer's makefile, and
	make the package-system object be a var to be filled in later.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_conflict_check),
	(athena_service_install_downloading),
	(athena_service_install_view_update_from_uri_finish),
	(user_login_callback),
	(athena_service_install_view_update_from_uri),
	(athena_service_install_view_load_uri):

	General cleanup, and the addition of the conflict_check signal
	handler.

	* athena-installer/src/Makefile:
	* athena-installer/src/installer.c: (eazel_install_progress),
	(conflict_check), (eazel_install_preflight),
	(eazel_installer_initialize):

	Add conflict check handler; fix 50% bug prior to downloading.

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed problems I ran into while trying to fix bug 5903,
	which is about making "Tighter Layout" sensitive even
	in manual layout, since it affects "Clean Up by Name"

	* libathena-extensions/athena-icon-container.c:
	(athena_icon_container_set_tighter_layout): Don't
	re-sort when tighter layout setting changes if not
	in auto_layout mode.
	
	* src/file-manager/fm-icon-view.c: 
	(handle_radio_item): Don't assume that every id passed
	to this routine is a sort ID; it might be a toggle
	button's id. Use get_sort_criterion_by_id to distinguish.
	(update_layout_menus): Added FIXME comment explaining
	why "tighter layout" is insensitive in manual layout.
	(set_sort_criterion_by_id): Check whether passed id is
	a valid sort criterion; don't try to sort if not.

2001-02-09  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	Fix for 6190, reuse check_if_related. If a package being revived
	is related to the broken (related by name and version diff), don't
	ask softcat for an update, but ask for an exact version.
	
	* components/services/install/lib/eazel-install-rpm-glue.c:
	* components/services/install/lib/eazel-install-rpm-glue.h:
	* components/services/install/lib/eazel-install-logic.c:
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/Makefile.am:
	Removed rpm-glue and logic.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied), (check_if_related_package), (check_tree_helper),
	(download_packages):
	is_satisfied checks name!=null before doing is_installed.
	check_tree_helper now uses check_if_related before doing the
	softcat_available_update. If the packages are related, use
	get_info to get an exacat version (sense=EQ).
	Moved check_if_related here
	Output tuning...
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_download_progress):
	Woops, undid a comment about bug 6425
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_available_update):
	Indention...

2001-02-08  John Harper  <jsh@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	Fix bug 4423 (when a folder that is expanded in the tree view
	is renamed, it collapses)

	* components/tree/athena-tree-model.h,
	components/tree/athena-tree-model.c: added a new signal
	`node_being_renamed'. Has two arguments, the old and new URIs

	(report_node_changed): when the node is being renamed, use
	report_node_removed_internal instead of report_node_removed so
	we can avoid emitting the `node_removed' signal. Before doing
	this, emit the new `node_being_renamed' signal

	* components/tree/athena-tree-view.c
	(athena_tree_view_insert_model_node): if the node is already
	inserted in the tree, call athena_tree_view_update_model_node

	(athena_tree_view_model_node_renamed_callback): connected to
	the `node_being_renamed' signal, propagates the expansion state
	from the old URI to the new one

	Fix bug 4421 (Delete file while folder collapsed -> not
	reflected in Tree View)

	* components/tree/athena-tree-model.c
	(athena_tree_model_monitor_node): if the node being monitored
	is a directory, check if any of the files we think it contains
	got moved away (e.g. while the node was collapsed)

2001-02-09  Andy Hertzfeld  <andy@eazel.com>

	* icons/i-directory-12.png:
	* icons/i-directory-accept-12.png:
	fixed bug 6338, folder moves to the right when highlighted,
	by tweaking the associated images
	
	* src/athena-sidebar-tabs.c: (athena_sidebar_tabs_hit_test):
	consider the tab for hit-testing even if invisible
	* src/athena-sidebar.c: (athena_sidebar_release_event):
	fixed 3538, easier way to minimize active sidebar view, by
	making it close the active view when you click on the space
	its tab formerly occupied.

2001-02-09  Arlo Rose  <arlo@eazel.com>

	* icons/Makefile.am:
	* icons/emblem-symbolic-link-12.png:
	* icons/emblem-symbolic-link-24.png:
	* icons/emblem-symbolic-link-36.png:
	Made more link icons that will work at smaller zoom levels.
	Fixes bug number 5988.

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6473 (counting deep contents of folder in Properties
	window takes tons of CPU)

	Fixed by deploying a timeout, so that the displayed numbers
	only update periodically, instead of with every item count
	increment. The interval is 200 milliseconds. This makes the
	count faster as well as greatly reducing CPU thrashage by
	not pounding on the poor widdle widgets so often.

	* src/file-manager/fm-properties-window.c:
	(directory_contents_value_field_update): Changed signature
	to just take an FMPropertiesWindow, and get the other
	relevant objects from the Details struct.
	(update_directory_contents_callback): New function, updates
	field and clears timeout ID.
	(schedule_directory_contents_update): Schedules update if
	not already pending.
	(attach_directory_contents_value_field): Removed old hack
	to store the title_field in the object data of the value
	field; store value_field after creation in Details struct.
	(append_directory_contents_fields): Store title_field after
	creation in Details struct.
	(real_destroy): Remove timeout if still pending.

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed part of bug 6462 (two error messages after doing search
	in Red Hat 7). Now you should only get one error message.
	Rebecca gets to figure out that one.

	* src/file-manager/fm-search-list-view.c: (real_load_error),
	(fm_search_list_view_initialize_class),
	(fm_search_list_view_initialize): Now replaces function
	pointer for load_error instead of attaching to signal, to
	avoid triggering fm-directory-view's error-handling code
	(which I recently added).

2001-02-09  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6343 (timed-wait dialog is too narrow, often
	clipping dialog title)

	* libathena-extensions/athena-stock-dialogs.c:
	(timed_wait_callback): Enforced a minimum width for timed-wait
	windows. They look better now, and don't clip the titles
	except with extremely long titles, for which the title-writer
	should be flogged.

2001-02-09  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6453, Gnome VFS_CRITICAL received when dragging
	athena link icons over each other.
	
	* libathena-extensions/athena-drag.c:
	(athena_drag_default_drop_action_for_icons):
	
	* libathena-extensions/athena-icon-dnd.c:
	(athena_icon_container_dropped_icon_feedback),
	(athena_icon_dnd_end_drag):

2001-02-08  Robey Pointer  <robey@eazel.com>

	* components/mozilla/athena-mozilla-content-view.c:
	(pre_widget_initialize):

	Fix build bustage in Mozilla content view: profile_name ->
	profile_directory_name.

2001-02-08  Eskil Heyn Olsen  <eskil@eazel.com>

	reviewed by: Robey Pointer  <robey@eazel.com>

	This commit fixed bugs:
	5723 ei2: check that install_failed_signal was not called 
	5752 ei2: port the uninstall stuff to the new ei2 
	5753 ei2: port the revert stuff to ei2 
	5757 fix leaks in EazelProblemHander 
	5957 eazel-install cli tool no longer uninstalls nicely
	6100 RPM4: don't handle dependencies called "rpmlib(.*)"
	6173 ei2: finish conflict and feature breakage  
	6191 make revert work (ei2: resurrect transaction stuff) 
	
	* components/rpmview/athena-rpm-view-install.c:
	(get_detailed_errors_foreach):
	Updated for the CANCELLED status.
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_preflight_check_signal):
	Fixed an output string.
	
	* components/services/install/idl/trilobite-eazel-install.idl:
	Added the CANCELLED status.
	uninstall_progress now has same signature as install_progress.
	
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_uninstall_progress),
	(eazel_install_callback_class_initialize):
	uninstall_progress now has same signature as install_progress.

	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_packagedatastruct_fill_from_packagedata),
	(traverse_packagetree_md5), (corba_packagedatastruct_fill_deps),
	(packagedata_from_corba_packagedatastruct),
	(packagedata_tree_from_corba_packagedatastructlist),
	(categorydata_list_from_corba_categorystructlist):
	Added the CANCELLED status.
	Commented out sending ->provides in signals.
	Added some g_asserts to find a bug.
	categorydata_list_from_corba_categorystructlist uses
	packagedata_list_from_corba_packagedatastructlist.
	
	* components/services/install/lib/eazel-install-logic.h:
	* components/services/install/lib/eazel-install-logic.c:
	(eazel_install_start_transaction), (dump_one_package),
	(compare_break_to_package_by_name),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_downward_traverse):
	Threw out most of the old code. Keeping logic.c untill 6190 is
	closed.
	
	* components/services/install/lib/eazel-install-logic2.c:
	(dump_tree_helper), (check_md5_on_files), (is_satisfied),
	(check_tree_helper), (execute), (set_toplevel),
	(get_packages_with_mod_flag), (check_uninst_vs_downgrade),
	(debug_revert), (compare_break_to_package_by_name),
	(eazel_uninstall_upward_traverse),
	(eazel_uninstall_check_for_install), (eazel_uninstall_globber),
	(install_packages), (uninstall_packages), (revert_transaction):
	Moved revert and uninstall into logic2.c and updated them
	appropriately.
	Added paranoia check in case bad xml dependency has a version but
	an senseless sense.
	When reviving, set parent->topleve to TRUE, not revived package.
	Revived the transaction stuff (for revert).
	Don't allow a package to depend on a package of the same name,
	this is often a problem during softcat updates.
	
	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/lib/eazel-install-private.h:
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_finalize), (eazel_install_start_signal),
	(eazel_install_end_signal), (eazel_install_progress_signal),
	(eazel_install_failed_signal), (eazel_install_class_initialize),
	(eazel_install_initialize), (eazel_install_install_packages),
	(eazel_install_uninstall_packages),
	(eazel_install_revert_transaction_from_xmlstring),
	(eazel_install_do_transaction_save_report_helper),
	(eazel_install_save_transaction_report),
	(eazel_install_init_transaction),
	(eazel_install_emit_uninstall_progress),
	(eazel_install_emit_uninstall_progress_default),
	(eazel_install_emit_download_progress):
	uninstall_progress now has same signature as install_progress.
	Fixed some dumb bugs in install/uninstall progress emission.
	Added some lists to check on install status.
	Moved some of the transaction stuff from logic.c here.
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_foreach),
	(get_detailed_uninstall_messages_foreach),
	(get_detailed_cases_foreach),
	(get_detailed_uninstall_cases_foreach),
	(eazel_install_problem_tree_to_case),
	(eazel_install_problem_tree_to_string),
	(build_categories_from_problem_list):
	Updated again for the new PackageBreaks objects.
	Fixed so cli uninstall works nice again.
	Added the CANCELLED status.
	The problem handler is deteriorating, either we use it or we scrap
	it.
	
	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new),
	(eazel_package_system_rpm3_set_mod_status),
	(monitor_rpm_process_pipe_percent_output),
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(eazel_package_system_rpm3_set_state),
	(eazel_package_system_rpm3_execute), (check_if_all_packages_seen),
	(eazel_package_system_rpm3_install_uninstall):
	Don't spam about the locales decimal seperator.
	Set modification status after handling a package, so transaction
	logs make sense.
	Don't accept requirements of type "rpmlib(.*".
	Ability to set all packages to CANCELLED if root helper failed
	login.
	If TEST is set, fake success all the time.
	
	* components/services/install/lib/eazel-package-system-types.h:
	* components/services/install/lib/eazel-package-system-types.c:
	(categorydata_new), (categorydata_destroy_foreach),
	(packagedata_status_enum_to_str),
	(packagedata_status_str_to_enum):
	Added the CANCELLED status.
	Improved the debug strings for alloc/dealloc of category data
	structures.
	
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_install):
	If TEST, disable FORCE.

2001-02-08  John Harper  <jsh@eazel.com>

	Fixed bug 6044 (Druid should be clearer on what the right
	choice is for proxy users)

	* src/athena-first-time-druid.c (set_up_update_page): added
	the text `If you know your computer uses a proxy connection,
	click Yes and Athena will use it.' to the middle of the label

	Fixed bug 5656 (First time druid should bail out at startup if
	it cannot create .athena and Athena directories)

	* src/athena-application.c (athena_application_startup):
	moved the call to check_required_directories () before that to
	athena_first_time_druid_show ()

2001-02-08  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/mozilla/main.c: (mozilla_process_delayed_exit),
	(mozilla_object_destroyed), (mozilla_make_object), (main):

	Bug 6328 -- Mozilla processes are now kept around for 30
	minutes after last used, so that re-activation is much faster.
	Navigating to and from web pages in Athena is much less agonizing
	now.

2001-02-07  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Rebecca Schulman  <rebecka@eazel.com>

	This change is needed to enable the bonobo-level fix to Athena
	bug 6023 (throbber and proxy processes still around after Athena
	is quit). The throbber was unreffing itself on destroy, which is
	wrong. However, Bonobo was leaking a reference to any toolbar
	control item, so the two bugs were masking each other.
	
	* components/throbber/athena-throbber.c
	(athena_throbber_destroy): Remove incorrect unref.
	(athena_throbber_initialize): Formatting tweaks

2001-02-08  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-gnome-extensions.c:
	(widget_destroy_callback), (icon_selected_callback),
	(icon_cancel_pressed):
	fixed bug 6458, crash if you quickly press cancel after pressing
	OK in the icon picker; fixed by setting a boolean once the
	picker has been dismissed, and checking it so we don't do it twice.
	
2001-02-08  Andy Hertzfeld  <andy@eazel.com>
	
	* src/athena-location-bar.c,h: (get_file_info_list),
	(try_to_expand_path), (editable_key_press_callback),
	(real_activate), (destroy), (athena_location_bar_initialize),
	(athena_location_bar_new), (athena_location_bar_set_location),
	(athena_location_bar_get_location),
	(athena_location_bar_update_label):

	fixed bug 6369, sluggish keyboard response in location bar. I improved
	this in two different ways: the expansion code is deferred to idle
	time now, so it doesn't get in the way of fast typing.  Also, the
	file info list is cached in memory, so it doesn't have to load it
	again for every keystroke.  I also made the instance variables
	private, instead of being exposed in the .h file.
	
2001-02-08  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_downloading),
	(athena_service_install_preflight_check),
	(previous_install_finished), (athena_service_install_installing),
	(athena_service_install_done),
	(athena_service_install_view_update_from_uri_finish):

	Change texts to match Vera's refinements.

2001-02-08  Robey Pointer  <robey@eazel.com>

	reviewed by: Ian McKellar  <ian@eazel.com>

	* components/services/login/athena-view/athena-change-password-
	view.c: (generate_change_password_form),
	(change_password_button_cb):

	Stick the password panels in a viewport so they'll have
	opportunistic scrollbars.

2001-02-08  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5946 (minimum Athena window size is too large)

	* src/athena-window-private.h: Made the minimum window
	size much much smaller. This exposes layout problems in
	some of the bars & such at very small sizes, but none of
	these layout problems seem like 1.0 show-stoppers. Better to
	allow the user who wants to use a stripped-down window at
	minimum size do so than to prevent this because it looks bad
	with some bars showing. Note that other Linux apps don't stop
	you from reducing the window down to nothing at all (the
	Athena limit is somewhat larger than "nothing at all").

	* src/athena-switchable-search-bar.c:
	(athena_switchable_search_bar_new): With Rebecca's OK,
	changed "Search For:" to "Find:" in order to save precious
	horizontal screen real estate.

2001-02-08  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Mike Engber <angber@eazel.com>

	Fixed bug 3087, gmc to Athena transition tool
	
	Added all features except removing gmc from session. Will
	need some additional help to add that feature.
	
	* libathena-extensions/athena-global-preferences.h:
	Add a preferences constant to indicate if Athena should
	respawn in the Gnome session.
	
	* src/athena-application.c: (athena_application_startup),
	(volume_unmounted_callback), (removed_from_session),
	(save_session), (set_session_restart), (init_session):
	Check preferences add add ourselves to session with a respawn
	setting if the user has specified that they wish such behavior.
	
	* src/athena-first-time-druid.c: (druid_finished),
	(set_up_gmc_transition_page):
	Save gmc to athena transition values in athena preferences.

2001-02-08  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <ramiro@eazel.com>

	Significant rework of athena-mozilla-content-view to use
	report_location_change and to do general house-cleaning.

	Fixes following bugs:

	Bug 3547  POSTs in the mozilla component don't update the URI 
	Bug 4682, 6142  Frame sets have difficulty in Athena
	Bug 5461  "http://localhost:xxxx" instead of "eazel-services:" on location bar
	
	Will fix following bugs when I talk with Darin about problems
	with report_location_change:

	5592  athena / mozilla back button goes back 2 pages

	Also removes all module-global and static variables, making gnome-vfs
	and general state-tracking per-instance, thus eliminating latent
	bugs related to using two browsers simultainously

	Removes all special-casing for form POST's and for iframes

	Removes usage of the mozilla "open_uri" signal, which was no longer really
	being used for anything (interruption of eazel-specific schemes is done
	at the DOM event level, notification to Athena of navigation is done
	as a result of the "location" signal

	Introduces/aggravates these bugs:

	6435	No history recorded when using report_location_change
	6436	Throbber doesn't throb when using report_location_change

	I'll wait until Darin returns to figure out solutions to this.

	* components/mozilla/Makefile.am:
	* components/mozilla/main.c: (main):
	* components/mozilla/mozilla-events.cpp:
	* components/mozilla/mozilla-events.h:
	* components/mozilla/athena-mozilla-content-view.c:
	* components/mozilla/athena-mozilla-content-view.h:

2001-02-08  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-gnome-extensions.c:
	(icon_selected_callback), (athena_gnome_icon_selector_new):
	fixed bugs 6437 and 6438 by testing for a directory selected
	instead of a file in the icon selector, and putting up an error
	dialog in that case instead of invoking the callback with the
	directory path.
	
2001-02-08  Pavel Cisler  <pavel@eazel.com>
	
	Fix 6401 (Create Link yields "You cannot link a file to itself"
		  error)
	* libathena-extensions/athena-file-operations.c:
	(athena_file_operations_copy_move):
	Remove a confused link to self check.
	Pass the GNOME_VFS_XFER_USE_UNIQUE_NAMES option to xfer.

2001-02-08  Fatih Demir	<kabalak@kabalak.net>

	* components/services/install/lib/eazel-package-system-rpm3.c:
	Include locale.h as you use localeconv() without including
	it -- bad on debian...

2001-02-08  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	* src/athena-sidebar-title.c:
	(athena_sidebar_title_size_allocate): Found useful
	optimization while investigating sidebar flashiness:
	now it only recomputes the sidebar font in
	size_allocate if the width actually changed.

2001-02-08  Robin * Slomkowski  <rslomkow@eazel.com>

	* athena.spec.in: updated to note that
	/usr/share/hyperbola/maps/*.map have moved to
	/usr/share/athena/components/hyperbola/maps/*.map

2001-02-08  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6421 (Labels for permissions should look insensitive
	when permissions are not settable)

	* src/file-manager/fm-properties-window.c:
	(add_permissions_column_label), (create_permissions_page):
	Pass file parameter into add_permissions_column_label,
	set insensitive if can't set permissions.

	* libathena-extensions/athena-file.c:
	(athena_file_get_string_attribute_with_default):
	Use "--" as item count string instead of "..." when
	the preference is set to not display the item counts.
	("..." implied that it would show up eventually, not 
	true in this case.)
	
2001-02-08  Laszlo Kovacs  <laszlo.kovacs@sun.com>

	* components/help/Makefile.am:
	Man page map file moved to new hyperbola data
	directory.

	* components/help/hyperbola-filefmt.c:
	Compiler warnings fixed

2001-02-08  Laszlo Kovacs  <laszlo.kovacs@sun.com>

	* components/help/hyperbola-filefmt.c:
	Toplevel document support added. Docs specified in
	$(prefix)/share/athena/components/hyperbola/topleveldocs.xml
	will be added to the toplevel section of the help tree if
	Scrollkeeper is enabled
	
	* components/help/Makefile.am:
	topleveldocs.xml installed and hyperbola data directory
	changed to $(prefix)/share/athena/components/hyperbola

	* components/help/topleveldocs.xml:
	new xml file holding the docs that go into the toplevel
	section of the help tree

2001-02-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(expand_package_suites), (install_packages):

	Do a softcat query for any suite ids in the initial package list,
	so they're expanded first and then all future queries will return
	single packages.
	
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_preflight_check):

	Don't restrict the preflight signal to toplevel packages anymore:
	we send the whole package tree now so no editing is necessary.
	
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(osd_parse_provides), (osd_parse_shared):

	Softcat server has started filling in the sense flag differently
	(without notice, I might grumpily add), so handle both types now
	and whine if we can't figure out how to decode it.  Log the
	softcat DB version now (eventually should store it somewhere).
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_error_string), (eazel_softcat_query),
	(eazel_softcat_get_info), (eazel_softcat_available_update):
	* components/services/install/lib/eazel-softcat.h:

	Split up the handling for single-package softcat queries and
	multi-package suite queries.
	
	* components/services/install/athena-view/main.c:
	(service_install_make_object), (main):

	Remove redundant 2nd ammonite_init call and a long-since useless
	printf from object creation.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_downloading),
	(flatten_package_tree_foreach), (athena_service_install_done),
	(athena_service_install_failed):
	* components/services/install/athena-view/athena-service-instal
	l-view.h:

	Clean up final dialog text generation, and only ask about deleting
	RPMs if the user level is "advanced".  Also don't ask if no files
	were even downloaded.
	
2001-02-07  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>
	Minus the 2 new widgets.
		
	* libathena-extensions/Makefile.am:
	New files.

	* libathena-extensions/athena-labeled-image.h:
	* libathena-extensions/athena-labeled-image.c:
	(button_leave_callback), (button_focus_out_event_callback),
	(athena_labeled_image_check_button_new): Add workaround for
	rendering problems with GtkCheckButton.
	(athena_labeled_image_set_label_never_smooth): New function to
	make the label part possibly never smooth.

	* libathena-extensions/athena-clickable-image.h:
	* libathena-extensions/athena-clickable-image.c:
	(ancestor_button_press_event), (ancestor_button_release_event),
	(athena_clickable_image_new),
	(athena_clickable_image_new_from_file_name): New function to
	create clickable images from image files.  Add grab/ungrab calls
	to match the logic in GtkButton.

	* libathena-extensions/athena-wrap-table.h:
	* libathena-extensions/athena-wrap-table.c:
	New class.
	
	* libathena-extensions/athena-image-table.c:
	* libathena-extensions/athena-image-table.h:
	New class.

	* test/test-athena-image-table.c:
	* test/.cvsignore:
	* test/Makefile.am:
	Image table test.
	
2001-02-07  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_start_signal):

	Remove break that caused 0% signals to never get sent on install.

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(rpmmonitorpiggybag_new), (make_rpm_argument_list),
	(monitor_rpm_process_pipe_percent_output),
	(monitor_rpm_process_pipe), (monitor_subcommand_pipe),
	(manual_rpm_command), (eazel_package_system_rpm3_execute):

	Make percent a float for more accurate byte counts.  Give the IO
	channel a lower priority than normal, so that it doesn't outrank X
	refresh events (though this doesn't help much).  Reinsert the
	manual RPM execute from the old logic.c code.
	
	* athena-installer/src/installer.c: (insert_info_page),
	(eazel_install_progress), (eazel_download_progress),
	(get_detailed_errors_foreach_dep), (get_detailed_errors_foreach),
	(get_detailed_errors), (collect_failure_info),
	(eazel_install_preflight):
	* athena-installer/src/installer.h:

	Remove fixed "max assumed download" size and try to set it to the
	total bytes expected.  For some reason this still fails sometimes
	but at least it's on the right track.  Stop calling
	gtk_main_iteration from inside the install progress callback since
	that interacts horribly with the IO channel crap.  Getting
	detailed errors should avoid recursing, and should follow the
	depends struct instead of the old soft_depends one.
	
	* athena-installer/src/link.sh:

	Test for RPM4 build (should build now, but still not work due to
	lingering code that refuses to try under RPM4).
	
	* athena-installer/src/package-tree.c: (get_errant_children_int),
	(get_errant_children), (package_customizer_fill):

	Fix up tree tracing routines to avoid recursing and to use the new
	struct members instead of the old (now empty) ones.
	
2001-02-07  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 6405 (seg fault right-double-clicking when context
	menu is already showing)

	* libathena-extensions/athena-icon-container.c:
	(handle_icon_button_press): Don't create context-menu callback
	if one is already pending; don't let right-double-click activate.
	
	* src/file-manager/athena-directory-view-ui.xml: Added underscore
	accelerator for Show Trash, which didn't have one.

2001-02-07  Ian McKellar  <ian@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/rpmview/athena-rpm-view.c:
	(athena_rpm_view_update_from_uri), (athena_rpm_view_load_uri),
	(rpm_view_load_location_callback):
	* components/rpmview/athena-rpm-view.h:
	If an RPM load fails then report it to Athena with:
	athena_view_report_load_failed,

	* components/services/install/lib/eazel-package-system-rpm3.c:
	(eazel_package_system_rpm3_packagedata_fill_from_header),
	(rpm_packagedata_fill_from_file):
	If an RPM load fails then report it to the caller.

	* components/services/trilobite/libtrilobite/trilobite-core-network
	.c: (trilobite_open_uri):
	Changed the unsafe `setenv' call to the safer `trilobite_setenv'.

2001-02-07  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* components/services/inventory/eazel-inventory-collect-hardware.c:
	(add_device_property), (eazel_inventory_collect_pci),
	(remove_trailing_whitespace), (ide_get_value),
	Separated whitespace removal into a separate function.

	(eazel_inventory_collect_usb), (eazel_inventory_collect_scsi),
	(eazel_inventory_collect_hardware):
	Added USB and SCSI bus scanning. Bugs: 5094, 6285.

2001-02-07  Pavel Cisler  <pavel@eazel.com>

	reviewed by: John Sullivan  <sullivan@eazel.com>

	Fix 6380 (** ERROR ** in trash_callback_destroy when
	          navigating to trash)
	* libathena-extensions/athena-trash-file.c:
	(trash_callback_destroy), (trash_file_call_when_ready):
	Add a missing ref and unref.

2001-02-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 5967, Music View slider is narrow in Eazel GTK theme
	
	Attempt to layout using Arlo's design.
	
	* components/music/athena-music-view.c:
	(music_view_set_selected_song_title), (add_play_controls),
	(athena_music_view_update),
	(music_view_background_appearance_changed_callback):

2001-02-07  Robin * Slomkowski  <rslomkow@eazel.com>

	* README: updated to note using the gnome-vfs-1 branch

2001-02-07  Andy Hertzfeld  <andy@eazel.com>

	fixed bug 6281, property browser should user gnome icon
	selection UI for adding patterns and emblems instead of
	generic file browsing
	
	* libathena-extensions/athena-gnome-extensions.c,h:
	(athena_gnome_open_terminal), (widget_destroy_callback),
	(icon_selected_callback), (icon_cancel_pressed),
	(list_icon_selected_callback), (entry_activated),
	(athena_gnome_icon_selector_new):
	moved code to integrate icon picking UI from the properties
	window into gnome-extensions, so other parts of athena can
	use it.
	
	* src/file-manager/fm-properties-window.c: (set_icon_callback),
	(select_image_button_callback):
	moved icon picking code out of properties window, but call it
	from here instead.
	
	* src/athena-property-browser.c: (athena_emblem_dialog_new),
	(add_pattern_to_browser), (add_new_pattern),
	(emblem_dialog_clicked):
	use icon picking code in property browser to pick patterns, and
	rework the emblem dialog to use gnome-icon-entry.
	
2001-02-07  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Robin Slomkowski <robin@eazel.com>
	
	Fixed bug 6389, Extremely poor performance when
	autodir automounter is present
	
	Detect special NFS autofs directories and filter them out
	of the mount list.
	
	* libathena-extensions/athena-volume-monitor.c:
	(get_removable_volumes), (mount_volume_activate_nfs),
	(mount_volume_activate), (get_current_mount_list),
	(mount_volume_nfs_add), (mount_volume_add_filesystem):

	Worked on cleaning up placement of icons on the edges
	of the desktop based on input from Arlo.
	
	* libathena-extensions/athena-icon-container.c:
	(icon_set_position):
		
2001-02-07  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6363, "Set Cover Image" button assumes
	fixed font height.
	
	* components/music/athena-music-view.c:
	(athena_music_view_initialize):
	Remove call to get_widget_set_usize
	
2001-02-07  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	* libathena-extensions/athena-directory-async.c:
	(show_hidden_files_changed_callback),
	(show_backup_files_changed_callback),
	(get_filter_options_for_directory_count):
	* libathena-extensions/athena-file.c:
	(show_text_in_icons_changed_callback),
	(show_directory_item_count_changed_callback),
	(get_speed_tradeoff_preference_for_file),
	(athena_file_should_show_directory_item_count),
	(athena_file_should_get_top_left_text):
	* libathena-extensions/athena-theme.c:
	(theme_changed_callback), (athena_theme_get_theme),
	(athena_theme_get_theme_data), (athena_theme_get_image_path):
	* src/file-manager/fm-directory-view.c:
	(confirm_trash_changed_callback), (real_update_menus):
	* src/file-manager/fm-icon-text-window.c:
	(icon_captions_changed_callback),
	(fm_get_text_attribute_names_preference_or_default):
	Use calllbacks for some preferences values instead of peeking
	diectly.  The preferences in question here are peeked a lot during
	large directory loads, even though they hardly ever change.  This
	should get preferences stuff mostly out of Pavel's profiles.  Now,
	im still working on bug 6054 which is about making peeking
	preferences in general faster.

2001-02-06  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>

	* libathena-extensions/athena-directory-async.c:
	(dequeue_pending_idle_callback), (mime_list_one):
	Handle the case where mime types don't get returned.

	* libathena-extensions/athena-file.c:
	Fix a comment.

2001-02-06  Andy Hertzfeld  <andy@eazel.com>

	* libathena-extensions/athena-mime-actions.c:
	(athena_do_component_query):
	fixed bug 5479, two "View as Text" items in "View as Other"
	dialog list, by special casing the sample text component so
	it doesn't get added to the list.
	
2001-02-06  Arik Devens  <arik@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	Fixed bug 5919, Preferences dialog jumps around the screen.
	
	* libathena-extensions/athena-preferences-dialog.c:
	(athena_preferences_dialog_construct): Removed the center
	positioning so that the dialog stays where the user put it.

2001-02-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 1736, if icons on desktop are offscreen, need to
	move them somewhre on screen.
	
	* libathena-extensions/athena-icon-container.c:
	(icon_set_position), (athena_icon_container_move_icon):
	icon_set_position may modify the x and y location of the
	icon.  athena_icon_container_move_icon should use the
	modified position instead of the original x and y postion
	when writing the position out into the metafile.

2001-02-06  Andy Hertzfeld  <andy@eazel.com>

	* src/file-manager/fm-properties-window.c:
	(widget_destroy_callback), (icon_selected_callback),
	(icon_cancel_pressed), (list_icon_selected_callback),
	(entry_activated), (select_image_button_callback):
	fixed bug 6280, custom icon selection should use gnome-icon-sel
	instead of the generic file browser, so now it does.
	 
2001-02-06  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	* src/athena-sidebar.c: (athena_sidebar_initialize_class),
	(athena_sidebar_size_allocate), (athena_sidebar_realize):
	Tell X not to clear the window contents when the sidebar is
	resized.  Since we double buffer its contents, this will reduce
	(but not eliminate) flicker in the sidebar.
	
2001-02-06  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Laszlo Kovacs  <laszlo.kovacs@sun.com>

	Fixed bug 795 (help component installs files in athena prefix,
	but uses gnome-libs prefix to find them later) by expanding the
	set of places Athena looks for help files.

	* components/help/hyperbola-filefmt.c:
	(fmt_man_populate_tree_for_subdir): Changed to look in more places
	for help files: the help directory in the gnome prefix, the help
	directory in the athena prefix, and directories in GNOME_PATH.
	(fmt_help_populate_tree): New helper function.
	(append_help_dir_if_exists): New helper function.

	* components/help/Makefile.am: Define DATADIR in compile flags.

	* components/help/hyperbola-main.c: Add copyright notice.

	This part not reviewed:

	* .cvsignore, libathena-extensions/.cvsignore: gnore more
	things.

	* Makefile.am: distribute .in versions of xml-i18n-tools.
	
2001-02-06  John Sullivan  <sullivan@eazel.com>

	Fixed bug 5157 (Athena won't display directories for
	which it thinks it doesn't have permissions)

	I removed the code that prevented Athena from even
	trying to load a location for which the perceived
	permissions didn't allow reading (because the perceived
	permissions can be wrong with some file systems). Now
	it always tries, and puts up an error dialog only if
	it gets an error while actually loading the directory.

	* src/file-manager/fm-error-reporting.h:
	* src/file-manager/fm-error-reporting.c:
	(fm_report_error_loading_directory): New function, currently
	only handles GNOME_VFS_ERROR_ACCESS_DENIED and a fallback
	default case.
	(fm_report_error_renaming_file), (fm_report_error_setting_group),
	(fm_report_error_setting_owner),
	(fm_report_error_setting_permissions), (rename_callback):
	All the report_error functions now take a parent-window
	parameter (which is often NULL). Also, they now all use
	gnome_vfs_error_result_to_string when whining about
	unhandled cases.

	* src/file-manager/fm-directory-view.h: Changed comments
	and copyright notice only.
	* src/file-manager/fm-directory-view.c:
	(real_load_error): New function, calls 
	fm_report_error_loading_directory unless an error has already
	been reported for the current directory load operation.
	(fm_directory_view_initialize_class): Wire up real_load_error
	as default handler for LOAD_ERROR signal.
	(activate_callback): Pass parent window to error-reporting call.
	(load_directory): Reset the reported_load_error boolean since
	we're about to load anew.
	
	* src/file-manager/fm-properties-window.c: (rename_callback),
	(group_change_callback), (owner_change_callback),
	(permission_change_callback):
	Pass parent window to error-reporting-calls. I just passed NULL
	if it was not trivial to pass a good window.

	* src/athena-window-manage-views.c: 
	(handle_unreadable_location), (open_location): Remove code that
	was preventing "unreadable" locations from being loaded.

2001-02-06  Gene Z. Ragan  <gzr@eazel.com>

	Fixed bug 6375, Certain menu shortcuts don't work when
	insertion point is in location bar.
	
	* libathena-extensions/athena-entry.c:
	(athena_entry_key_press):
	Filter out alt and control keyboard events and don't
	allow them to be passed to the parent GtkEntry.
	
2001-02-06  John Sullivan  <sullivan@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fixed bug 6365 (Crash at boot if invalid file name given)

	* src/athena-window-manage-views.c:
	(load_new_location_in_all_views): Added some parameter checking
	to make future bugs like this even easier to find.
	(cancel_location_change): Don't reset to old location when old
	location is NULL.

2001-02-05  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Seth Nickel <seth@eazel.com>

	Fix 5930 (Copy dialog often shows "1" as total number of
		  fields in operation)

	* libathena-extensions/athena-file-operations-progress.c:
	(athena_file_operations_progress_update),
	(athena_file_operations_progress_new_file):
	* libathena-extensions/athena-file-operations.c:
	(create_transfer_dialog):
	Special case the preparing to copy/move phase -- when the
	bytes_total is 0, don't display the count.
	
	* libathena-extensions/athena-file-operations-progress.c:
	(athena_file_operations_progress_thaw):
	Formatting.

	* HACKING:
	Tiny tweak.

2001-02-05  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-public.h:
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (eazel_file_conflict_check_signal),
	(eazel_file_uniqueness_check_signal),
	(eazel_feature_consistency_check_signal), (main):
	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_file_conflict_check), (impl_file_uniqueness_check),
	(impl_feature_consistency_check), (eazel_install_callback_get_epv),
	(eazel_install_callback_class_initialize):
	* components/services/install/lib/eazel-install-corba-callback.h:
	* components/services/install/lib/eazel-install-logic2.c:
	(check_no_two_packages_has_same_file),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_class_initialize),
	(eazel_install_emit_file_conflict_check),
	(eazel_install_emit_file_conflict_check_default),
	(eazel_install_emit_file_uniqueness_check),
	(eazel_install_emit_file_uniqueness_check_default),
	(eazel_install_emit_feature_consistency_check),
	(eazel_install_emit_feature_consistency_check_default):
	Fixed bug 3459 (emit signals when doing file-conflict,
	feature-consistency and file-uniqueness checks).
	
	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_get_readable_name):
	Nyll poynter checking.

2001-02-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6359 (Choosing current view from "View as" menu crashes)

	* src/athena-window-manage-views.c:
	(athena_window_content_view_matches_iid): New function, extracted
	from load_content_view, checks whether passed iid is the one in
	use by this window.
	(load_content_view): Now calls extracted function.
	(athena_window_set_content_view): Bail out early if the
	new content view is the old one. This avoids unpleasant crashing
	later on.

2001-02-05  Gene Z. Ragan  <gzr@eazel.com>

	Add code to send the mime type of the file being examined to the
	mime type capplet so that the capplet can scroll to the mime type
	being examined.
	
	* libathena-extensions/athena-program-chooser.c:
	(repopulate_program_list), (launch_mime_capplet),
	(launch_mime_capplet_and_close_dialog),
	(athena_program_chooser_show_no_choices_message):

2001-02-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed part of bug 6329 (entering "gconf://" as location
	crashes Athena). After this fix, it still crashes Athena,
	but in a gconf-specific way.

	* src/athena-window-manage-views.c:
	(load_new_location_in_all_views): Don't try to load
	a location in new_content_view if it's NULL.

2001-02-05  John Sullivan  <sullivan@eazel.com>

	reviewed by: Mike Fleming <mfleming@eazel.com>

	Fixed bug 6324 (Switching views crashes every time)
	
	* src/athena-window-manage-views.c:
	(set_to_pending_location_and_selection): Added assert
	to make future similar bugs even easier to catch.
	(view_loaded_callback): Don't call set_to_pending_location_and_selection
	when the content view is changing without the location & selection 
	changing; just update the one view instead.

	* libathena-extensions/athena-stock-dialogs.c:
	Reduced the timed-wait timeout from 3 seconds to 2 after
	more investigation of timed-wait-related bugs. 3 seconds
	just felt a little too long.

2001-02-05  Michael Engber  <engber@eazel.com>

	* libathena-extensions/athena-metafile-factory.c:
	(athena_metafile_factory_new), (free_factory_instance),
	(athena_metafile_factory_get_instance):
	* libathena-extensions/athena-metafile-factory.h:
	* src/Athena_shell.oaf.in:
	* src/athena-application.c: (manufactures), (create_object),
	(athena_application_startup):
	* src/athena-application.h:
	Add the MetafileFactory to the main object factory.

2001-02-05  Rebecca Schulman  <rebecka@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* libathena-extensions/athena-mime-actions.c:
	(athena_mime_get_default_component_sort_conditions),
	(athena_mime_get_default_component_for_file_internal),
	(athena_mime_get_short_list_components_for_file):
	Changes to make sure the short list is sorted 
	correctly, so the correct default application is chosen.

2001-02-05  Andy Hertzfeld  <andy@eazel.com>

	* librsvg/rsvg.c: (rsvg_render_svp):
	fixed bug 6301, bad svg crashes Athena, by adding a check
	in rsvg_render_svp to make sure a pixbuf has been allocated; if
	not, don't try to render.
	
2001-02-05  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6321 (Apparently arbitrary item initially selected
	in "Open with Other" dialog)

	* libathena-extensions/athena-program-chooser.c:
	(repopulate_program_list): Select first item in list after sorting.

2001-02-04  Ian McKellar  <ian@eazel.com>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>	

	* components/services/install/lib/Makefile.am:
	* components/services/install/lib/eazel-package-system-dpkg.c:
	(debpackage_free), (debpackage_fill_packagedata),
	(strip_trailing_whitespace), (parse_packages),
	(load_package_callback), (eazel_package_system_dpkg_load_package),
	(query_callback), (eazel_package_system_dpkg_query),
	(eazel_package_system_dpkg_install),
	(eazel_package_system_dpkg_uninstall),
	(eazel_package_system_dpkg_verify),
	(eazel_package_system_dpkg_compare_version),
	(eazel_package_system_dpkg_finalize),
	(eazel_package_system_dpkg_class_initialize),
	(eazel_package_system_dpkg_initialize),
	(eazel_package_system_dpkg_get_type),
	(eazel_package_system_dpkg_new),
	(eazel_package_system_implementation):
	* components/services/install/lib/eazel-package-system-dpkg.h:
	* components/services/install/lib/eazel-package-system.c:
	(eazel_package_system_suggest_id),
	(eazel_package_system_load_implementation):
	Created a minimal, sub-functional Debian package backend for 
	libeazelinstall - essentially only enough to allow me to test my
	software inventory work on my Debian machines.

	* components/services/inventory/Makefile.am:
	* components/services/inventory/eazel-inventory-collect-hardware.c:
	(add_device_property), (eazel_inventory_collect_pci),
	(ide_get_value), (eazel_inventory_collect_ide), (str_has_prefix),
	(add_info), (read_proc_info), (eazel_inventory_collect_memory),
	(eazel_inventory_collect_cpu), (eazel_inventory_collect_hardware):
	* components/services/inventory/eazel-inventory-collect-hardware.h:
	* components/services/inventory/eazel-inventory-collect-software.c:
	(str_has_prefix), (get_package_list),
	(eazel_inventory_collect_packages),
	(eazel_inventory_collect_software):
	* components/services/inventory/eazel-inventory-collect-software.h:
	* components/services/inventory/eazel-inventory-utils.c:
	(eazel_create_configuration_metafile):
	Moved software inventory code into eazel-inventory-collect-software.c
	and hardware inventory code into eazel-inventory-collect-hardware.c.
	Added coded to collect PCI and IDE bus information.

	* components/services/trilobite/libtrilobite/trilobite-core-distrib
	ution.c: (determine_suse_version), (determine_debian_version):
	Added version check code for SuSE and Debian.

2001-02-04  Jason Leach  <jasonleach@usa.net>

	reviewed by: Maciej Stachowiak <mjs@eazel.com>	
	
	* athena-clean.sh: Update to work with Solaris.

2001-02-04  Maciej Stachowiak  <mjs@eazel.com>

	* indent.sh: Script that calls indent with the right parameters to
	get a GNOME coding style (Athena subvariant).

	* components/help/hyperbola-filefmt.c,
	components/help/hyperbola-filefmt.h,
	components/help/hyperbola-main.c,
	components/help/hyperbola-nav-index.c,
	components/help/hyperbola-nav-search.c,
	components/help/hyperbola-nav-tree.c,
	components/help/hyperbola-nav.h,
	components/help/hyperbola-types.h: Run indent.sh on these.

2001-02-03  John Sullivan  <sullivan@eazel.com>

	Fixed bug 6254 ("Display" name for grouping in "Folder Views"
	category is poor)

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions),
	(global_preferences_create_dialog): Verafied a little text.

2001-02-03  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/throbber/Makefile.am:
	Added the oaf.in files to EXTRA_DIST (tinderbox fix)

2001-02-03  Gene Z. Ragan  <gzr@eazel.com>

	Do a simple check for NULL instead of using
	g_return_if_fail.  We don't need the error
	reported to the terminal.
	
	* libathena-extensions/athena-volume-monitor.c:
	(get_removable_volumes), (volume_is_removable),
	(volume_is_read_only):

2001-02-02  Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/command-line/eazel-alt-install-corba.
	c: (tree_helper_helper), (tree_helper):
	Added check for PackageBreaks iterators.
	
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_install_failed):
	Leakfix, freeing the list given to the signal handler after
	handling.
	
	* components/services/install/lib/eazel-install-corba-types.c:
	(empty_hash_table),
	(packagedata_tree_from_corba_packagedatastructlist):
	Leakfix, now correctly frees the contents of the md5_hashtable and
	unrefs the proper objects.

	* components/services/install/lib/eazel-install-logic2.c:
	(eazel_install_check_existing_packages), (get_softcat_info),
	(is_satisfied), (is_satisfied_features),	
	(check_dependencies_foreach), (check_tree_helper),
	(add_file_conflict),
	(check_conflicts_against_already_installed_packages),
	(check_feature_consistency):
	Proper fillflags for some EazelPackageSystem calls.
	Nicer log-output when debug is off.
	Leak fix, the PackageBreaks "objects".
	
	* components/services/install/lib/eazel-install-problem.c:
	(get_detailed_messages_breaks_foreach),
	(get_detailed_messages_foreach),
	(get_detailed_cases_breaks_foreach), (get_detailed_cases_foreach):
	Updated for the new PackageBreaks "objects".
	
	* components/services/install/lib/eazel-package-system-rpm4.c:
	(eazel_package_system_rpm4_query_impl):
	s/packagedata_destroy/gtk_object_unref/
	
	* components/services/install/lib/eazel-package-system-types.c:
	(at_exit_package_data_info), (categorydata_new),
	(categorydata_destroy_foreach), (packagedata_finalize),
	(packagedata_class_initialize), (packagedata_initialize),
	(packagedata_get_readable_name), (packagebreaks_finalize),
	(packagebreaks_class_initialize), (packagebreaks_initialize),
	(packagefileconflict_finalize),
	(packagefileconflict_class_initialize),
	(packagefeaturemissing_finalize),
	(packagefeaturemissing_class_initialize):
	Finally got the destroy crap working for the PackageBreak
	"objects".
	More leakcheck stuff for various structures.
	Again, fixed get_reabable_name.
	
	* components/services/install/lib/eazel-package-system-types.h:
	Added finalizes to the "objects".
	Removed packagedata_destroy prototype.
	
	* components/services/trilobite/libtrilobite/Makefile.am:
	Cleanup and possible tinderbox fix.
	
2001-02-02  Robey Pointer  <robey@eazel.com>

	* components/services/install/lib/eazel-install-corba-types.c:
	(packagedata_tree_from_corba_packagedatastructlist):

	Fix small bug in the package tree inflater that caused break
	structs to be messed up.
	
	* components/services/install/lib/eazel-softcat.c:
	(get_search_url_for_package):
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (create_package),
	(athena_service_install_view_update_from_uri_finish):

	Encode and decode suite_id/suite_name/product_id/product_name from
	eazel-install: urls and pass through to softcat queries.  They are
	all treated like variant flavors of suite_id internally (group of
	packages with a single id).
	
	* athena-installer/src/Makefile:
	* athena-installer/src/installer.c:
	(get_detailed_errors_foreach), (get_detailed_errors),
	(eazel_install_preflight), (eazel_installer_set_default_texts),
	(eazel_installer_initialize):

	Remove eazel-hacking uninstall, since experts claim we no longer
	need it.  Some changes to sync up with the new world order where
	PackageData is now a GTK object.
	
	* athena-installer/src/package-tree.c:
	(find_package_parents_int), (find_package_parents),
	(get_errant_children_int), (get_errant_children),
	(package_customizer_fill_dep), (package_customizer_fill),
	(jump_to_package_tree_page):

	Fix the package customizer to cope with the new world order, where
	the package tree is sent across as a directed graph (instead of
	tree) and the deps are in 'depends' not 'soft_depends'.
	
	* athena-installer/src/prescript:

	Up version to 1.0.

2001-02-02  Darin Adler  <darin@eazel.com>

	reviewed by: John Sullivan <sullivan@eazel.com>

	Fixed bug 6163 (Need AthenaViewFrame ::
	report_location_changed). This is re-adding a feature we also had
	long ago, where a view reports a location change, but does not
	want the location change to come back to it in the form of a
	load_location call.

	* src/athena-applicable-views.h:
	* src/athena-applicable-views.c:
	(get_view_result_from_gnome_vfs_result), (got_file_info_callback),
	(got_minimum_file_info_callback),
	(athena_determine_initial_view),
	(athena_determine_initial_view_cancel): Changed this entire file
	to have a much easier-to-understand API.
	
	* src/athena-view-frame-private.h:
	* src/athena-view-frame-corba.c: (free_location_plus_callback):
	Change existing structure so it can be used for the location-change
	case, which includes a title too.
	(open_force_new_window): Use new structure.
	(report_location_change): Implement new call.
	(impl_Athena_ViewFrame_open_location_force_new_window): Use new
	structure.
	(impl_Athena_ViewFrame_report_location_change): Implement new
	call.
	
	* libathena/athena-view-component.idl: Add the new call.
	* libathena/athena-view.h:
	* libathena/athena-view.c:
	(athena_view_report_location_change): Add the new call.

	* src/athena-view-frame.h:
	* src/athena-view-frame.c:
	(athena_view_frame_initialize_class): Add new signal.
	(athena_view_frame_report_location_change): Implement new call.
	
	* src/athena-window-private.h:
	* src/athena-window-manage-views.h:
	* src/athena-window-manage-views.c: (update_for_new_location):
	Got rid of obsolete assert. Also, no longer clear the selection.
	The selection is set properly earlier, and clearing it at this
	point serves no purpose.
	(location_has_really_changed): Call free_location_change to share
	more code. Also no reason to free "pending_ni" any more, because
	we don't keep it around in the success case.
	(load_new_location_in_one_view): New name.
	(load_new_location_in_sidebar_panels): New name. Also take a
	parameter of a view to skip.
	(load_new_location_in_all_views): New function.
	(set_to_pending_location_and_selection): New name, and removed
	code to handle the case where there is no pending location, since
	that doesn't happen. Also take a parameter of a view to skip. Also
	broke out the guts into load_new_location_in_all_views.
	(free_location_change): Free things by their new names. There's
	also less to free now.
	(cancel_location_change): Key off pending_location instead of
	pending_ni. Also save code by using new function that skips a
	view.
	(determined_initial_view_callback): Changed name, and use new
	interface. No longer need "end_reached" trick, because the new
	interface handles that.
	(begin_location_change): Made a static after moving all the
	functions that use it in here. Also moved some of the reload
	code out into athena_window_reload.
	(report_location_change_callback): New function. Does all the
	steps neede for a location change in place.
	(athena_window_back_or_forward), (athena_window_reload): Moved
	these two functions in here from athena-window.c so we could
	make begin_location_change more private.
	
	* src/athena-window.h:
	* src/athena-window.c: (athena_window_go_to): Changed the name.
	(athena_window_get_location): New function for callers that used
	to get the location field directly.
	(go_to_callback): Changed name.

	* src/athena-desktop-window.c: (athena_desktop_window_new):
	* src/athena-location-bar.c: (drag_data_received_callback):
	* src/athena-shell.c: (open_window), (save_window_states),
	(restore_window_states):
	* src/athena-window-menus.c: (services_button_callback),
	(help_menu_athena_manual_callback),
	(help_menu_athena_license_callback),
	(help_menu_athena_feedback_callback),
	(activate_bookmark_in_menu_item):
	* src/athena-window-service-ui.c: (goto_services_summary),
	(goto_online_storage), (goto_software_catalog),
	(goto_services_support):
	* src/athena-window.c: (location_change_at_idle_callback),
	(athena_window_constructed), (view_as_menu_vfs_method_callback),
	(athena_window_go_web_search), (athena_window_go_home):
	Use athena_go_to under its new name.
	
	* src/athena-shell.c: (restore_window_states): Use
	athena_istr_has_prefix instead of g_strncasecmp. Also did other
	code cleanup.
	
	* libathena-extensions/athena-gtk-extensions.h: Added a new
	marshal function that I needed.
	
	* libathena-extensions/athena-thumbnails.c: Added a FIXME.
	
	* libathena-extensions/athena-view-identifier.h:
	* libathena-extensions/athena-view-identifier.c:
	(athena_view_identifier_copy),
	(athena_view_identifier_compare): Use const.
	
	* src/athena-application.c: (athena_application_startup): Only
	check for root if we are actually running athena, not if we are
	just killing off an existing copy.
	(confirm_ok_to_run_as_root): Changed name of the function and
	improved the wording of the message and button. Also added an
	environment variable you can set to get rid of this. (Probably
	should have been a preference instead, but I am officially being
	lazy about this.)

	Fixed bug that was revealed by the change in the loading sequence
	I made. John didn't review this part:
	
	* libathena-extensions/athena-directory-private.h:
	* libathena-extensions/athena-directory-async.c:
	(load_directory_state_destroy), (load_directory_done):
	Separate out code to free the partly-done state so it can
	be used in the cancel case.
	(dequeue_pending_idle_callback): Ref the directory object
	so that we won't get messed up if the callback destroys it.
	(directory_load_cancel): Separated out the old part of
	file_list_cancel so that we can cancel the idle part too
	when we want to.
	(file_list_cancel): Use the new calls to cancel the idle
	part of directory loading.
	(directory_load_done): Use directory_load_cancel instead of
	file_list_cancel.
	(athena_directory_stop_monitoring_file_list): Use
	directory_load_cancel instead of file_list_cancel.
	(athena_directory_async_state_changed): Added state variables to
	protect cases where we re-enter this function.

2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Michael Engber  <engber@eazel.com>

	* applets/preferences-applet/athena-preferences-applet.c:
	(restart_button_clicked_callback), (main):
	Add a restart button.
	
2001-02-02  Gene Z. Ragan  <gzr@eazel.com>

	Fixed a small bug where I was assuming a value would be valid
	when it could be NULL. Now I check for NULL.
	
	* src/athena-application.c: (volume_unmounted_callback):

2001-02-02  Brett Neely  <brett@eazel.com>

	reviewed by: Eric Fischer  <eric@eazel.com>

	* athena-clean.sh:
	Kill oafd last so athena-clean.sh -x only needs to be run once.

2001-02-02  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>
	
	Fixed bug 5222,
	Athena allows users to rename .Trash (but not copy or link)
	
	* libathena-extensions/athena-file-utilities.c:
	* libathena-extensions/athena-file-utilities.h:
	(athena_uri_is_trash_folder):
	Utility function to indentify if the folder is trash based
	on a text uri.
	
	* libathena-extensions/athena-file.c:
	(athena_file_can_rename):
	Call athena_uri_is_trash_folder to identify a trash
	folder and disallow renaming.
	
2001-02-02  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 5749 (bookmarks are untranslated)

	* data/static_bookmarks.xml:
	An earlier checkin to update the bookmarks stripped off
	all the underscores from "_name=" strings, which was what
	was causing them to be translated. Fixed by returning the
	underscores.

2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	* applets/preferences-applet/athena-preferences-applet.c:
	(boolean_toggle_button_new), (start_button_clicked_callback),
	(main):
	Add a Athena start button.  Also make the fonts smaller to
	conserver panel space.
	
2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	Fix bug 6131 - AthenaLabel does not support proper line wrap.
	Its fixed for smooth mode.  Theres a bug (6243) for the more
	complicated issue of wrapping in non smooth mode.

	* libathena-extensions/athena-label.h:
	* libathena-extensions/athena-label.c:
	(athena_label_initialize_class), (athena_label_set_arg),
	(athena_label_get_arg), (athena_label_size_allocate),
	(athena_label_set_never_smooth),
	(athena_label_set_adjust_wrap_on_resize),
	(athena_label_get_adjust_wrap_on_resize):
	Add a boolean attribute 'adjust_wrap_on_resize' that controls
	whether the label will automatically update its line wrap width
	when its resized.

	* components/services/summary/athena-view/athena-summary-view.c
	: (summary_view_item_label_new), (summary_load_location_callback):
	No longer need size_allocate hack.  Use AthenaLabel's
	'adjust_wrap_on_resize' attribute instead.
	
	* test/test-athena-label-wrapped.c: (create_athena_label),
	(create_gtk_label_window), (create_athena_label_window), (main):
	Update for 'adjust_wrap_on_resize'.
	
2001-02-01  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Pavel Cisler  <pavel@eazel.com>

	Fix bug 4678 (Clicking on a Athena link file in tree view causes
	Athena cannot handle item type error box).
	
	* components/tree/athena-tree-view.c:
	(athena_tree_view_destroy), (got_activation_uri_callback),
	(cancel_possible_activation), (tree_select_row_callback): Activate
	activation URI instead of file URI to support Athena links
	properly. If the link resolves to a "command:" URI, however,
	silently ignore it to avoid giving an ugly error message because
	per John Sullivan, selecting things in the tree view should not
	launch apps.

	* components/tree/athena-tree-view-private.h: Added
	activation_uri_wait_file field to details struct.

	* data/top/Computer, data/top/Services: Updated to new athena
	link format.

2001-02-02  Robey Pointer  <robey@eazel.com>

	* components/services/install/athena-view/athena-service-instal
	l-view.c: (flatten_package_tree_foreach):

	Fix build breakage caused by my previous checkin.

2001-02-02  Robey Pointer  <robey@eazel.com>

	reviewed by: Eskil Heyn Olsen  <eskil@eazel.com>

	* components/services/install/lib/eazel-install-logic2.c:
	(is_satisfied), (download_packages):
	* components/services/install/lib/eazel-install-protocols.c:
	(gnome_vfs_fetch_remote_file):

	Fix thinko (caused by myself in October) that caused the stop
	button to only cancel one download and then aggravatingly continue
	with the remaining downloads.

	* components/services/install/idl/trilobite-eazel-install.idl:
	* components/services/install/lib/eazel-install-corba-callback.c:
	(impl_download_progress), (impl_preflight_check),
	(impl_download_failed), (impl_dep_check), (impl_install_progress),
	(impl_uninstall_progress), (impl_md5_check_failed),
	(impl_install_failed), (impl_uninstall_failed),
	(eazel_install_callback_simple_query):
	* components/services/install/lib/eazel-install-corba-types.c:
	(corba_string_sequence_to_glist),
	(g_list_to_corba_string_sequence),
	(corba_packagedatastruct_fill_from_packagedata),
	(corba_packagedatastruct_from_packagedata),
	(corba_packagedatastructlist_fill_from_packagedata_list),
	(corba_packagedatastructlist_from_packagedata_list),
	(new_fake_md5), (traverse_packagetree_md5),
	(corba_packagedatastruct_fill_deps),
	(corba_packagedatastructlist_foreach),
	(corba_packagedatastructlist_from_packagedata_tree),
	(packagedata_from_corba_packagedatastruct),
	(packagedata_list_from_corba_packagedatastructlist),
	(packagedata_tree_from_corba_packagedatastructlist),
	(corba_category_list_from_categorydata_list),
	(categorydata_list_from_corba_categorystructlist):
	* components/services/install/lib/eazel-install-corba-types.h:
	* components/services/install/lib/eazel-install-corba.c:
	(impl_Eazel_Install_install_packages),
	(impl_Eazel_Install_uninstall_packages),
	(impl_Eazel_Install_simple_query):
	* components/services/install/lib/eazel-install-object.c:
	(eazel_install_emit_preflight_check_default),
	(eazel_install_emit_install_failed_default),
	(eazel_install_emit_uninstall_failed_default):
	* components/services/install/lib/eazel-install-xml-package-list.c:
	(parse_package), (eazel_install_packagedata_to_xml_int),
	(eazel_install_packagedata_to_xml),
	(eazel_install_packagelist_to_xml):
	* components/services/install/lib/eazel-install-xml-package-list.h:

	Add proper "breaks", "modifies", and "depends" structures to the
	corba interface, by using package MD5 strings to serve as "soft
	pointers" between packages in a package tree.  Convert the
	preflight, install_failed, and uninstall_failed signals to use the
	new package-tree type instead of munging into and out of XML.
	Also fixed up the API's to the corba conversion routines so they
	would make a valiant attempt not to leak memory.

	* components/services/install/lib/eazel-package-system-types.c:
	(packagedata_copy):

	Don't forget to copy that pesky MD5!
	
	* components/services/install/lib/eazel-package-system-types.h:

	Satisfy Robey's desire to avoid Carpal Tunnel Syndrome.
	
	* components/services/install/lib/eazel-softcat.c:
	(eazel_softcat_string_to_sense_flags),
	(get_search_url_for_package):
	* components/services/install/lib/eazel-softcat.h:

	Add function to convert a sense string back into flags.
	
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (flatten_package_tree_depends_foreach),
	(flatten_package_tree_foreach):

	Fix up the install view to use the new "depends" chain instead of
	the old "soft_depends" which is now empty.

2001-02-02  Ramiro Estrugo  <ramiro@eazel.com>

	* libathena-extensions/athena-metafile-factory.c: (corba_open):
	Add new line at end of file to make redhat7 build happy. 
	
2001-02-01  Ramiro Estrugo  <ramiro@eazel.com>

	reviewed by: Maciej Stachowiak  <mjs@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_defaults),
	(global_preferences_install_visibility),
	(global_preferences_install_sidebar_panel_defaults):
	* libathena-extensions/athena-preferences.c:
	(athena_preferences_get_user_level):
	* libathena-extensions/athena-preferences.h:
	* src/athena-first-time-druid.c: (set_up_user_level_page):
	* src/athena-window-menus.c: (get_user_level_icon_name),
	(athena_window_initialize_menus), (convert_verb_to_user_level),
	(convert_user_level_to_path):
	* test/test-athena-preferences-change.c: (main):
	Change 'hacker' to 'advanced' for the advanced user level so that
	the names used for storage match those used for display.

2001-02-01  Maciej Stachowiak  <mjs@eazel.com>

	reviewed by: Darin Adler  <darin@eazel.com> and 
	             Robey Pointer  <robey@eazel.com>

	Fix bugs 5528 (oaf command-line options show up in main program
	section, not a separate section) and 5510 (descriptions of
	OAF-specific options in --help are not translated). To do this I
	had to change the way the oaf popt options are processed in all
	the places that do so.

	* components/adapter/main.c: (main):
	* components/hardware/main.c: (main):
	* components/help/hyperbola-main.c: (main):
	* components/image-viewer/Athena_View_image.oaf.in:
	* components/image-viewer/athena-image-view.c:
	(init_server_factory):
	* components/loser/content/main.c: (main):
	* components/loser/sidebar/main.c: (main):
	* components/mozilla/main.c: (main):
	* components/music/main.c: (main):
	* components/notes/athena-notes.c: (main):
	* components/rpmview/main.c: (main):
	* components/services/install/command-line/eazel-alt-install-corba.
	c: (main):
	* components/services/install/athena-view/main.c: (main):
	* components/services/login/athena-view/main.c: (main):
	* components/services/summary/athena-view/main.c: (main):
	* components/services/time/command-line/main.c: (main):
	* components/services/time/athena-view/main.c: (main):
	* components/services/trilobite/libtrilobite/trilobite-core-utils.c
	: (trilobite_init):
	* components/shell/shell.c:
	* components/text/Athena_View_text.oaf.in:
	* components/text/main.c: (main):
	* components/throbber/main.c: (main):
	* components/tree/main.c: (main):
	* libathena/athena-view-standard-main.c:
	(athena_view_standard_main_multi):
	* src/Athena_shell.oaf.in:
	* src/athena-main.c: (main):
	* test/test-athena-mime-actions-set.c: (main):
	* test/test-athena-mime-actions.c: (main): Register oaf options
	with gnomelib_register_popt_options and move oaf_init call to
	before gnome_init to fix the aforementioned bugs.

2001-02-01  Rebecca Schulman  <rebecka@eazel.com>
	Fixed bug 5648, bad ui in the indexing info
	dialog.

	reviewed by: Maciej Stachowiak <mjs@eazel.com>

	* src/file-manager/athena-indexing-info.c:
	(get_index_percentage_complete), (initialize_dialog),
	(get_text_for_progress_label), (update_progress_display),
	(show_index_progress_dialog), (show_reindex_request_dialog),
	(recreate_and_show_reindex_request_dialog),
	(update_file_index_callback),
	(last_index_time_and_reindex_button_dialog_new),
	(index_progress_dialog_new),
	(destroy_indexing_info_dialogs_on_exit),
	(show_indexing_info_dialog): Rework this file.  Use two separate
	index dialogs for the case where the index is going, and not
	going.  When "update now" is pressed, switch to the index progress
	dialog.  Report errors reported by and unavailibility of the
	indexing service.

	* libathena-extensions/athena-stock-dialogs.c:
	(athena_create_info_dialog):
	* libathena-extensions/athena-stock-dialogs.h:
	Add this for use in creating the indexing info dialog.
	

2001-02-01  Michael K. Fleming  <mfleming@eazel.com>

	reviewed by: <robey@eazel.com>

	Bug 6103 a user can install any package from softcat without login 
	Bug 4514 error msg when register during softcat install 

	Login dialog for the install view, with working registration, cancel,
	etc.


	* components/services/install/athena-view/Makefile.am:
	* components/services/install/athena-view/main.c: (main):
	* components/services/install/athena-view/athena-service-instal
	l-view.c: (athena_service_install_view_destroy),
	(athena_install_parse_uri), (athena_service_install_done),
	(user_login_callback),
	(athena_service_install_view_update_from_uri),
	(athena_service_install_view_update_from_uri_finish),
	(athena_service_install_view_load_uri):
	* components/services/summary/athena-view/athena-summary-menu-i
	tems.c: (merge_bonobo_menu_items):
	* components/services/summary/athena-view/athena-summary-view.c
	: (update_header), (athena_summary_view_load_uri):
	* src/athena-window-service-ui.c: (goto_online_storage),
	(goto_software_catalog):

2001-02-01  Michael Engber  <engber@eazel.com>

	* libathena-extensions/Makefile.am:
	* libathena-extensions/athena-metafile-factory.c:
	(athena_metafile_factory_initialize_class),
	(athena_metafile_factory_get_epv),
	(athena_metafile_factory_get_vepv),
	(athena_metafile_factory_create_servant),
	(athena_metafile_factory_initialize), (destroy),
	(athena_meta_file_factory_new), (corba_open):
	* libathena-extensions/athena-metafile-factory.h:
	* libathena-extensions/athena-metafile-server.idl:
	* libathena-extensions/athena-metafile.c:
	(athena_metafile_initialize_class), (athena_metafile_get_epv),
	(athena_metafile_get_vepv), (athena_metafile_create_servant),
	(athena_metafile_initialize), (destroy), (athena_metafile_new),
	(corba_get), (corba_get_list), (corba_set), (corba_set_list),
	(corba_copy), (corba_remove), (corba_rename),
	(corba_register_monitor), (corba_unregister_monitor):
	* libathena-extensions/athena-metafile.h:
	Initiall check-in of new metadata APIs (corba) - not hooked
	up yet.

2001-02-01  Gene Z. Ragan  <gzr@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>
	
	Fixed bug 6941, 'Clean Up By Name' feature on the desktop keep
	switching file locations after being 'cleaned up'
	
	* src/file-manager/fm-desktop-icon-view.c:
	(desktop_icons_compare_callback):
	In the case of identical links tpyes, compare by name.	
		
	More work on gmc transition tool
	
	* src/athena-first-time-druid.c:
	(druid_finished):
	Hide druid widget before performing startup tasks.
	
	(next_proxy_configuration_page_callback),
	(add_athena_to_session):

2001-02-01  Pavel Cisler  <pavel@eazel.com>

	reviewed by: Gene Ragan <gzr@eazel.com>

	Fix 6152 (Dragging a file to the trash will bring up a replace
		  dialog)
	Fix 5387 (Dragging a file within Trash gives "already exists"
		 error)

	* libathena-extensions/athena-drag.c:
	* libathena-extensions/athena-drag.h:
	(athena_drag_items_local), (athena_drag_items_in_trash):
	Add more convenience calls for Trash handling.
	
	* libathena-extensions/athena-file-utilities.h:
	* libathena-extensions/athena-file-utilities.c:
	(athena_uri_is_in_trash):
	New convenience call for Trash handling.

	* libathena-extensions/athena-file.c:
	(athena_file_is_in_trash):
	Use the new athena_uri_is_in_trash call.

	* libathena-extensions/athena-file-operations.c:
	(athena_file_operations_copy_move):
	Handle the case where a file is dragged into a Trash window or
	onto a Trash icon as if the "Move to Trash" command was issued -
	if there is a name conflict with a pre-existing file in the Trash,
	use a new unique name for the new file.
	
	* libathena-extensions/athena-icon-dnd.c:
	(athena_icon_container_selection_items_local):
	Handle files in the Trash properly - doing a parent match with
	the container URI fails for these, special case Trash handling.

2001-02-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Pavel Cisler <pavel@eazel.com>

	Fixed bug 143 (zooming in list view doesn't affect font size)

	Maybe I get the award for "oldest reported bug fixed recently"?

	* src/file-manager/fm-list-view.c: 
	(fm_list_view_update_font): New function, started with guts of
	fm_list_view_font_family_changed but also takes zoom level into
	account when choosing font size.
	(set_up_list): Call _update_font instead of _font_family_changed,
	just 'cuz it makes more sense.
	(fm_list_view_set_zoom_level): Call _update_font.
	(fm_list_view_font_family_changed): Extracted guts to
	_update_font.

2001-02-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	Fixed bug 6181 (funny mouse clicking freezes Athena)

	* libathena-extensions/athena-icon-container.c:
	(button_press_event): Ignore middle & right button
	presses when we're dragging a selection rectangle.

2001-02-01  John Sullivan  <sullivan@eazel.com>

	reviewed by: Darin Adler <darin@eazel.com>

	* libathena-extensions/athena-global-preferences.c:
	(global_preferences_install_descriptions):
	Parenthesize parenthetical part of "slow but complete
	search" checkbox label.
	(global_preferences_create_dialog): Use SHORT_ENUM
	instead of ENUM type for executable text file
	activation options so they all go on one line, taking
	less precious vertical screen real estate.

2001-02-01  Darin Adler  <darin@eazel.com>

	* components/services/install/lib/eazel-package-system-types.h:
	Add missing packagedata_destroy prototype to make it compile
	on systems with RPM 4 (like mine).

2001-02-01  Maciej Stachowiak  <mjs@eazel.com>

	* ChangeLog: rolled over to ChangeLog-20010201.

